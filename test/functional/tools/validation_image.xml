<tool id="validation_image" name="validation_image" version="1.0">
    <command><![CDATA[
      cp '$input' '$output'
    ]]></command>
    <inputs>
        <param name="input" type="data" format="data" />
    </inputs>
    <outputs>
        <data name="output" format="data" />
    </outputs>
    <tests>
        <!-- Tests with intensity images -->
        <test>
            <param name="input" value="im1_uint8.tif" />
            <output name="output">
                <assert_contents>
                    <image_has_metadata width="32" height="32" channels="1" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im3_a.png" />
            <output name="output">
                <assert_contents>
                    <image_has_metadata width="32" height="32" channels="3" />
                </assert_contents>
            </output>
        </test>
        <!-- Tests with label images -->
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <image_has_metadata width="32" height="32" channels="1" />
                    <image_has_labels number_of_objects="1" mean_object_size="256" exclude_labels="0" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <image_has_metadata width="32" height="32" channels="1" />
                    <image_has_labels number_of_objects="2" mean_object_size="512" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <image_has_labels mean_object_size="511" eps="0.9" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <image_has_metadata width="32" height="32" channels="1" />
                    <image_has_labels number_of_objects="2" mean_object_size="511" eps="1.0" />
                </assert_contents>
            </output>
        </test>
    </tests>
</tool>
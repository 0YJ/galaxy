{"version":3,"sources":["mvc/ui/ui-popover.js"],"names":["define","Utils","View","Backbone","extend","optionsDefault","with_close","title","placement","initialize","options","this","setElement","_template","uid","container","append","el","$title","_","defaults","$close","$body","$","body","self","on","e","visible","is","target","has","length","hide","render","html","$el","addClass","removeClass","show","newTitle","undefined","empty","remove","off","_get_placement","top","container_position","width","_get_width","height","$container","container_width","container_height","_get_height","left","indexOf","parseInt","css"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-popover.js","sourcesContent":["/**\n * Popover wrapper\n*/\ndefine([ 'utils/utils' ], function( Utils ) {\nvar View = Backbone.View.extend({\n    optionsDefault: {\n        with_close  : true,\n        title       : null,\n        placement   : 'top',\n        container   : 'body',\n        body        : null\n    },\n\n    initialize: function ( options ) {\n        this.setElement( this._template() );\n        this.uid = Utils.uid();\n        this.options = _.defaults( options || {}, this.optionsDefault );\n        this.options.container.parent().append( this.el );\n        this.$title = this.$( '.popover-title-label' );\n        this.$close = this.$( '.popover-close' );\n        this.$body  = this.$( '.popover-content' );\n\n        // add initial content\n        this.options.body && this.append( this.options.body );\n\n        // add event to hide if click is outside of popup and not on container\n        var self = this;\n        $( 'body' ).on( 'mousedown.' + this.uid,  function( e ) {\n            // the 'is' for buttons that trigger popups\n            // the 'has' for icons within a button that triggers a popup\n            self.visible && !$( self.options.container ).is( e.target ) && !$( self.el ).is( e.target ) &&\n                $( self.el ).has( e.target ).length === 0 && self.hide();\n        });\n    },\n\n    /**\n     * Render popover\n    */\n    render: function() {\n        this.$title.html( this.options.title );\n        this.$el.removeClass().addClass( 'ui-popover popover fade in' ).addClass( this.options.placement );\n        this.$el.css( this._get_placement( this.options.placement ) );\n\n        // configure close option\n        var self = this;\n        if ( this.options.with_close ) {\n            this.$close.on( 'click', function() { self.hide() } ).show();\n        } else {\n            this.$close.off().hide();\n        }\n    },\n\n    /**\n     * Set the popover title\n     * @params{ String }    newTitle    - New popover title\n    */\n    title: function( newTitle ) {\n        if ( newTitle !== undefined ) {\n            this.options.title = newTitle;\n            this.$title.html( newTitle );\n        }\n    },\n\n    /**\n     * Show popover\n    */\n    show: function() {\n        this.render();\n        this.$el.show();\n        this.visible = true;\n    },\n\n    /**\n     * Hide popover\n    */\n    hide: function() {\n        this.$el.hide();\n        this.visible = false;\n    },\n\n    /**\n     * Append new content to the popover\n     * @params{ Object }  $el - Dom element\n    */\n    append: function( $el ) {\n        this.$body.append( $el );\n    },\n\n    /**\n     * Remove all content\n    */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /**\n     * Remove popover\n    */\n    remove: function() {\n        $( 'body' ).off( 'mousedown.' + this.uid );\n        this.$el.remove();\n    },\n\n    /**\n     * Improve popover location/placement\n    */\n    _get_placement: function( placement ) {\n        // get popover dimensions\n        var width               = this._get_width( this.$el );\n        var height              = this.$el.height();\n\n        // get container details\n        var $container = this.options.container;\n        var container_width     = this._get_width( $container );\n        var container_height    = this._get_height( $container );\n        var container_position  = $container.position();\n\n        // get position\n        var top, left;\n        top = left = 0;\n        if ([ 'top', 'bottom' ].indexOf( placement ) != -1) {\n            left = container_position.left - width + ( container_width + width ) / 2;\n            switch ( placement ) {\n                case 'top':\n                    top = container_position.top - height - 5;\n                    break;\n                case 'bottom':\n                    top = container_position.top + container_height + 5;\n                    break;\n            }\n        } else {\n            top = container_position.top - height + ( container_height + height ) / 2;\n            switch ( placement ) {\n                case 'right':\n                    left = container_position.left + container_width;\n                    break;\n            }\n        }\n        return { top: top, left: left };\n    },\n\n    /**\n     * Returns padding/margin corrected width\n    */\n    _get_width: function( $el ) {\n        return $el.width() + parseInt( $el.css( 'padding-left' ) ) + parseInt( $el.css( 'margin-left' ) ) +\n                             parseInt( $el.css( 'padding-right' ) ) + parseInt( $el.css( 'margin-right' ) );\n    },\n\n    /**\n     * Returns padding corrected height\n    */\n    _get_height: function( $el ) {\n        return $el.height() + parseInt( $el.css( 'padding-top' ) ) + parseInt( $el.css( 'padding-bottom' ) );\n    },\n\n    /**\n     * Return the popover template\n    */\n    _template: function( options ) {\n        return  '<div class=\"ui-popover popover fade in\">' +\n                    '<div class=\"arrow\"/>' +\n                    '<div class=\"popover-title\">' +\n                        '<div class=\"popover-title-label\"/>' +\n                        '<div class=\"popover-close fa fa-times-circle\"/>' +\n                    '</div>' +\n                    '<div class=\"popover-content\"/>' +\n                '</div>';\n    }\n});\n\nreturn {\n    View: View\n}\n\n});"]}
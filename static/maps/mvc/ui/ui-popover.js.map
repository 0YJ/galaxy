{"version":3,"sources":["mvc/ui/ui-popover.js"],"names":["define","Utils","View","Backbone","extend","optionsDefault","with_close","title","placement","container","body","initialize","options","this","setElement","_template","uid","_","defaults","parent","append","el","$title","$","$close","$body","self","on","e","visible","is","target","has","length","hide","render","html","$el","removeClass","addClass","css","_get_placement","show","off","newTitle","undefined","empty","remove","width","_get_width","height","$container","container_width","container_height","_get_height","container_position","position","top","left","indexOf","parseInt"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-popover.js","sourcesContent":["/**\n * Popover wrapper\n*/\ndefine([ 'utils/utils' ], function( Utils ) {\nvar View = Backbone.View.extend({\n    optionsDefault: {\n        with_close  : true,\n        title       : null,\n        placement   : 'top',\n        container   : 'body',\n        body        : null\n    },\n\n    initialize: function ( options ) {\n        this.setElement( this._template() );\n        this.uid = Utils.uid();\n        this.options = _.defaults( options || {}, this.optionsDefault );\n        this.options.container.parent().append( this.el );\n        this.$title = this.$( '.popover-title-label' );\n        this.$close = this.$( '.popover-close' );\n        this.$body  = this.$( '.popover-content' );\n\n        // add initial content\n        this.options.body && this.append( this.options.body );\n\n        // add event to hide if click is outside of popup and not on container\n        var self = this;\n        $( 'body' ).on( 'mousedown.' + this.uid,  function( e ) {\n            // the 'is' for buttons that trigger popups\n            // the 'has' for icons within a button that triggers a popup\n            self.visible && !$( self.options.container ).is( e.target ) && !$( self.el ).is( e.target ) &&\n                $( self.el ).has( e.target ).length === 0 && self.hide();\n        });\n    },\n\n    /**\n     * Render popover\n    */\n    render: function() {\n        this.$title.html( this.options.title );\n        this.$el.removeClass().addClass( 'ui-popover popover fade in' ).addClass( this.options.placement );\n        this.$el.css( this._get_placement( this.options.placement ) );\n\n        // configure close option\n        var self = this;\n        if ( this.options.with_close ) {\n            this.$close.on( 'click', function() { self.hide() } ).show();\n        } else {\n            this.$close.off().hide();\n        }\n    },\n\n    /**\n     * Set the popover title\n     * @params{ String }    newTitle    - New popover title\n    */\n    title: function( newTitle ) {\n        if ( newTitle !== undefined ) {\n            this.options.title = newTitle;\n            this.$title.html( newTitle );\n        }\n    },\n\n    /**\n     * Show popover\n    */\n    show: function() {\n        this.render();\n        this.$el.show();\n        this.visible = true;\n    },\n\n    /**\n     * Hide popover\n    */\n    hide: function() {\n        this.$el.hide();\n        this.visible = false;\n    },\n\n    /**\n     * Append new content to the popover\n     * @params{ Object }  $el - Dom element\n    */\n    append: function( $el ) {\n        this.$body.append( $el );\n    },\n\n    /**\n     * Remove all content\n    */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /**\n     * Remove popover\n    */\n    remove: function() {\n        $( 'body' ).off( 'mousedown.' + this.uid );\n        this.$el.remove();\n    },\n\n    /**\n     * Improve popover location/placement\n    */\n    _get_placement: function( placement ) {\n        // get popover dimensions\n        var width               = this._get_width( this.$el );\n        var height              = this.$el.height();\n\n        // get container details\n        var $container = this.options.container;\n        var container_width     = this._get_width( $container );\n        var container_height    = this._get_height( $container );\n        var container_position  = $container.position();\n\n        // get position\n        var top  = left = 0;\n        if ([ 'top', 'bottom' ].indexOf( placement ) != -1) {\n            left = container_position.left - width + ( container_width + width ) / 2;\n            switch ( placement ) {\n                case 'top':\n                    top = container_position.top - height - 5;\n                    break;\n                case 'bottom':\n                    top = container_position.top + container_height + 5;\n                    break;\n            }\n        } else {\n            top = container_position.top - height + ( container_height + height ) / 2;\n            switch ( placement ) {\n                case 'right':\n                    left = container_position.left + container_width;\n                    break;\n            }\n        }\n        return { top: top, left: left };\n    },\n\n    /**\n     * Returns padding/margin corrected width\n    */\n    _get_width: function( $el ) {\n        return $el.width() + parseInt( $el.css( 'padding-left' ) ) + parseInt( $el.css( 'margin-left' ) ) +\n                             parseInt( $el.css( 'padding-right' ) ) + parseInt( $el.css( 'margin-right' ) );\n    },\n\n    /**\n     * Returns padding corrected height\n    */\n    _get_height: function( $el ) {\n        return $el.height() + parseInt( $el.css( 'padding-top' ) ) + parseInt( $el.css( 'padding-bottom' ) );\n    },\n\n    /**\n     * Return the popover template\n    */\n    _template: function( options ) {\n        return  '<div class=\"ui-popover popover fade in\">' +\n                    '<div class=\"arrow\"/>' +\n                    '<div class=\"popover-title\">' +\n                        '<div class=\"popover-title-label\"/>' +\n                        '<div class=\"popover-close fa fa-times-circle\"/>' +\n                    '</div>' +\n                    '<div class=\"popover-content\"/>' +\n                '</div>';\n    }\n});\n\nreturn {\n    View: View\n}\n\n});"]}
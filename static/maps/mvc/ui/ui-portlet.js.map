{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["View","Backbone","extend","visible","initialize","options","self","this","model","Model","id","_utils2","default","uid","cls","title","icon","buttons","body","scrollable","nopadding","onchange_title","_template","$","operations","collapsible","collapsible_button","collapsed","setElement","get","_uiMisc2","ButtonIcon","$title_text","tooltip","$title_icon","$header","onclick","$content","$backdrop","render","html","_","each","$body","$el","hide","off","expand","prop","new_title","on_finish","show","$buttons","empty","name","item","$operations","append","header","enableButton","find","disableButton","hideOperation","showOperation","setOperation","callback","on","collapse","setIcon","fadeIn","disable","enable","addClass"],"mappings":"qMAEIA,EAAOC,SAASD,KAAKE,QACrBC,SAAS,EACTC,WAAY,SAASC,GACjB,IAAIC,EAAOC,KACXA,KAAKC,MACAH,GAAWA,EAAQG,OACpB,IAAIP,SAASQ,OACTC,GAAIC,EAAAC,QAAMC,MACVC,IAAK,aACLC,MAAO,GACPC,KAAM,GACNC,QAAS,KACTC,KAAM,KACNC,YAAY,EACZC,WAAW,EAdhBnB,WAAA,KACPE,aAD4B,EAE5BC,oBAAY,EACJE,WAAJ,EACAe,eACKhB,OAEGK,IAAAA,GACAI,KAAAA,WAAKP,KAAAe,aAGLL,KAAAA,MAAAA,KAASM,EAAA,iBACTL,KAAAA,YANeX,KAAAgB,EAAA,uBAOfJ,KAAAA,YAAAA,KAPeI,EAAA,uBAQfH,KAAAA,QAAAA,KAAWG,EAAA,mBACXC,KAAAA,SAAAA,KAAYD,EAAA,oBACZE,KAAAA,UAAAA,KAAaF,EAAA,qBACbG,KAAAA,SAAAA,KAAAA,EAAAA,oBACAC,KAAAA,YAAWpB,KAZIgB,EAAA,uBAevBhB,KAAAC,MAAKoB,IAAAA,SAAgBN,KAAAA,OAArBf,KAAAC,MAAAqB,IAAA,SAGAtB,KAAAmB,mBAAoB,IAAAI,EAAAlB,QAAAmB,YACpBf,KAAKgB,SACLC,QAAKC,kBACLpB,IAAKqB,uBACLC,QAAKC,WACL/B,EAAKgC,EAALX,UAAwB,SAAA,iBAgBxBpB,KAAKgC,UAGTA,OAAQ,WAZJ,IAAAjC,EAAAC,KACAF,EAAKqB,KAAAA,MAAAA,WA8EJ,OA7EGV,KAAAA,IACAiB,cACAnB,SAAKT,EAAAS,KACLsB,KAAAA,KAAAA,EAAS1B,IACLJ,KAAAA,QAAAA,EAAKA,MAAKqB,OAAY,UACzBpB,KAAAyB,YAAAQ,KAAAnC,EAAAU,OANuC0B,EAAAC,MAA5CnC,KAAA8B,SAAA9B,KAAAoC,OAAA,SAAAC,GAQAA,EAAAvC,EAAAe,UAAA,WAAA,eAAA,gBAIAf,EAAIC,KACJC,KAAIF,YACCuC,cAIAT,SAAQ9B,yBACR2B,SAAAA,EAAiB3B,MACpBqC,OAEDnC,KAFD2B,YAAAW,OAMItC,KAAAyB,YADJ3B,EAMOoB,YAAA,WAAA,eACH,4BAQCqB,MALLzC,EAAAoB,cACAlB,KAAKyB,YACA3B,GAAAA,QAAQoB,WAITpB,EAAAA,EAAQoB,UAAa,SAAA,gBAEjBnB,EAAAA,UAAUqB,KAAAA,WAALpB,KAA4BwC,UAMzCxC,KAAKyB,YAAYgB,KAAK,YAAa3C,EAAQgB,gBAD3ChB,EAAAgB,gBACAd,KAAKyB,YAAYgB,oBACjB3C,UAAQgB,SAAR4B,GAEQC,EAAW7B,eAAA4B,MAKnB5C,EAAAY,SACAV,KAAIF,SAAQY,QAASkC,OACjB5B,EAAAmB,KAAAnC,KAAK6C,MAASC,IAAAA,WAAd,SAAAC,EAAAC,GACAhC,EAAEmB,IAAKM,KAAKxC,KAAMqB,GACd0B,EAAAA,SAASP,OAAKO,EAAMD,QAG3B/C,KAND6C,SAMOP,OAIPtC,KAAAiD,YAAAH,MACAhD,EAAKmD,oBACLjD,KAAIF,YAAQqB,OAAAA,KAAAA,mBAAoBkB,KAE/BvC,EAAAmB,YACDD,EAAAmB,KAAIrC,EAAQmB,WAAY,SAAA8B,EAAAC,GACpBhC,EAAEmB,IAAKrC,KAAAA,KAAQmB,GACX+B,EAAAA,YAAAE,OAAoBH,EAApBV,OAGPrC,MAILkD,OAAA,SAAAb,GACAa,KAAAA,MAAQA,OAAAb,IAIRS,MAAA,WACAA,KAAAA,MAAOA,SAIPK,OAAA,WACAA,OAAAA,KAAQvB,SAIRjB,KAAA,WACAA,OAAMX,KAAAoC,OAINQ,KAAA,WACAA,KAAAA,SAAM,EACF5C,KAAAqC,IAAKzC,OAAL,SAIJ0C,KAAA,WACAA,KAAAA,SAAM,EACFtC,KAAAqC,IAAKzC,QAITwD,aAAA,SAAAjD,GACAiD,KAAAA,SAAcC,KAAA,IAAAlD,GAAAsC,KAAA,YAAa,IAI3Ba,cAAA,SAAAnD,GACAmD,KAAAA,SAAAA,KAAe,IAAAnD,GAAAsC,KAAA,YAAa,IAI5Bc,cAAA,SAAApD,GACAoD,KAAAA,YAAeF,KAAA,IAAAlD,GAAAmC,QAIfkB,cAAA,SAAArD,GACAqD,KAAAA,YAAeH,KAAA,IAAAlD,GAAAyC,QAIfa,aAAA,SAAAtD,EAAAuD,GACAD,KAAAA,YACIJ,KAAKJ,IAAAA,GA7KmBV,IAAA,SAgLnBoB,GAAG,QAASD,IAMjBlD,MAAA,SAAOkC,GAAP,OACHA,GAvL2B1C,KAAAyB,YAAAQ,KAAAS,GAsLjB1C,KAAKyB,YAAYQ,QAMxB2B,SAAA,WACA5D,KAAAoB,WAAWkB,EACXtC,KAAA8B,SAAKX,OAAAA,MACRnB,KA/L2BoC,MAAAE,OA8LxBtC,KAAKmB,mBAAmB0C,QAAQ,iBAMhCrB,OAAA,WACAxC,KAAAoB,WAAW0C,EACX9D,KAAA8B,SAAKX,OAAAA,QACRnB,KAvM2BoC,MAAA0B,OAAA,QAsMxB9D,KAAKmB,mBAAmB0C,QAAQ,WAMnCE,QA5M2B,WA2MxB/D,KAAK+B,UAAUa,QAMlBoB,OAjN2B,WAgNxBhE,KAAK+B,UAAUO,QAuBlBvB,UAAA,WAvOL,OAAAC,EAAA,UAqNakC,OAqBHzD,EAAAA,UAnBWwE,SAAS,kBACTf,OAAOlC,EAAE,UAAUiD,SAAS,uBAC5Bf,OACGlC,EAAE,UACGiD,SAAS,iBACTf,OAAOlC,EAAE,QAAQiD,SAAS,uBAC1Bf,OAAOlC,EAAE,WAAWiD,SAAS,yBAG7Cf,OACGlC,EAAE,UACGiD,SAAS,mBACTf,OAAOlC,EAAE,UAAUiD,SAAS,iBAC5Bf,OAAOlC,EAAE,UAAUiD,SAAS,qBAEpCf,OAAOlC,EAAE,UAAUiD,SAAS,mCAIrCxE,KAAMA","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["import Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\nvar View = Backbone.View.extend({\n    visible: false,\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                id: Utils.uid(),\n                cls: \"ui-portlet\",\n                title: \"\",\n                icon: \"\",\n                buttons: null,\n                body: null,\n                scrollable: true,\n                nopadding: false,\n                operations: null,\n                collapsible: false,\n                collapsible_button: false,\n                collapsed: false,\n                onchange_title: null\n            }).set(options);\n        this.setElement(this._template());\n\n        // link all dom elements\n        this.$body = this.$(\".portlet-body\");\n        this.$title_text = this.$(\".portlet-title-text\");\n        this.$title_icon = this.$(\".portlet-title-icon\");\n        this.$header = this.$(\".portlet-header\");\n        this.$content = this.$(\".portlet-content\");\n        this.$backdrop = this.$(\".portlet-backdrop\");\n        this.$buttons = this.$(\".portlet-buttons\");\n        this.$operations = this.$(\".portlet-operations\");\n\n        // add body to component list\n        this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n        // add icon for collapsible option\n        this.collapsible_button = new Ui.ButtonIcon({\n            icon: \"fa-eye\",\n            tooltip: \"Collapse/Expand\",\n            cls: \"ui-button-icon-plain\",\n            onclick: function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            }\n        });\n        this.render();\n    },\n\n    render: function() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el\n            .removeClass()\n            .addClass(options.cls)\n            .attr(\"id\", options.id);\n        this.$header[options.title ? \"show\" : \"hide\"]();\n        this.$title_text.html(options.title);\n        _.each([this.$content, this.$body], function($el) {\n            $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n        });\n\n        // render title icon\n        if (options.icon) {\n            this.$title_icon\n                .removeClass()\n                .addClass(\"portlet-title-icon fa\")\n                .addClass(options.icon)\n                .show();\n        } else {\n            this.$title_icon.hide();\n        }\n\n        // make portlet collapsible\n        this.$title_text\n            [options.collapsible ? \"addClass\" : \"removeClass\"](\n                \"no-highlight collapsible\"\n            )\n            .off();\n        if (options.collapsible) {\n            this.$title_text.on(\"click\", function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            });\n            options.collapsed ? this.collapse() : this.expand();\n        }\n\n        // allow title editing\n        this.$title_text.prop(\"disabled\", !options.onchange_title);\n        options.onchange_title &&\n            this.$title_text.make_text_editable({\n                on_finish: function(new_title) {\n                    options.onchange_title(new_title);\n                }\n            });\n\n        // render buttons\n        if (options.buttons) {\n            this.$buttons.empty().show();\n            $.each(this.model.get(\"buttons\"), function(name, item) {\n                item.$el.prop(\"id\", name);\n                self.$buttons.append(item.$el);\n            });\n        } else {\n            this.$buttons.hide();\n        }\n\n        // render operations\n        this.$operations.empty;\n        if (options.collapsible_button) {\n            this.$operations.append(this.collapsible_button.$el);\n        }\n        if (options.operations) {\n            $.each(options.operations, function(name, item) {\n                item.$el.prop(\"id\", name);\n                self.$operations.append(item.$el);\n            });\n        }\n        return this;\n    },\n\n    /** Append new doms to body */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /** Remove all content */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /** Return header element */\n    header: function() {\n        return this.$header;\n    },\n\n    /** Return body element */\n    body: function() {\n        return this.$body;\n    },\n\n    /** Show portlet */\n    show: function() {\n        this.visible = true;\n        this.$el.fadeIn(\"fast\");\n    },\n\n    /** Hide portlet */\n    hide: function() {\n        this.visible = false;\n        this.$el.hide();\n    },\n\n    /** Enable a particular button */\n    enableButton: function(id) {\n        this.$buttons.find(\"#\" + id).prop(\"disabled\", false);\n    },\n\n    /** Disable a particular button */\n    disableButton: function(id) {\n        this.$buttons.find(\"#\" + id).prop(\"disabled\", true);\n    },\n\n    /** Hide a particular operation */\n    hideOperation: function(id) {\n        this.$operations.find(\"#\" + id).hide();\n    },\n\n    /** Show a particular operation */\n    showOperation: function(id) {\n        this.$operations.find(\"#\" + id).show();\n    },\n\n    /** Replaces the event callback of an existing operation */\n    setOperation: function(id, callback) {\n        this.$operations\n            .find(\"#\" + id)\n            .off(\"click\")\n            .on(\"click\", callback);\n    },\n\n    /** Change title */\n    title: function(new_title) {\n        new_title && this.$title_text.html(new_title);\n        return this.$title_text.html();\n    },\n\n    /** Collapse portlet */\n    collapse: function() {\n        this.collapsed = true;\n        this.$content.height(\"0%\");\n        this.$body.hide();\n        this.collapsible_button.setIcon(\"fa-eye-slash\");\n    },\n\n    /** Expand portlet */\n    expand: function() {\n        this.collapsed = false;\n        this.$content.height(\"100%\");\n        this.$body.fadeIn(\"fast\");\n        this.collapsible_button.setIcon(\"fa-eye\");\n    },\n\n    /** Disable content access */\n    disable: function() {\n        this.$backdrop.show();\n    },\n\n    /** Enable content access */\n    enable: function() {\n        this.$backdrop.hide();\n    },\n\n    _template: function() {\n        return $(\"<div/>\")\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-header\")\n                    .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                    .append(\n                        $(\"<div/>\")\n                            .addClass(\"portlet-title\")\n                            .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                            .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                    )\n            )\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-content\")\n                    .append($(\"<div/>\").addClass(\"portlet-body\"))\n                    .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n            )\n            .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n    }\n});\nexport default {\n    View: View\n};\n"]}
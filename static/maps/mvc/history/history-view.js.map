{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","_createDefaultCollection","console","log","history","model","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","FETCH_COLLECTION_COUNTS_DELAY","loadHistory","historyId","contentsOptions","_","silent","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpCollectionListeners","listenTo","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","$emptyMsg","$emptyMessage","empty","get","active","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","title","classes","faIcon","prependTo","renderItems","hidsPerSection","$list","html","_mapSectionRanges","section","templates","listItemsSection","join","_renderSection","currentSection","toggle","sectionModels","_filterSectionCollection","bind","_filterItem","_modelsToViews","$section","map","view","delegateEvents","el","children","_renderItemView$el","$currentSection","includeHidden","hidden","includeDeleted","isDeletedOrPurged","_getItemViewClass","contentType","TypeError","_getItemViewOptions","expanded","storage","isExpanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","panel","v","addExpanded","collapsed","removeExpanded","collapseAll","clearExpanded","addItemView","lastSection","_lastSection","isNotLastSection","setCurrentSection","fetchSection","done","scrollTo","hid","insertionIndex","_indexOfHidInSection","set","_createItemView","fadeOut","fxSpeed","_attachView","modelIndex","useFx","isUndefined","hide","viewIndex","prevModel","at","found","findIndex","splice","prepend","eq","after","slideDown","getSelectedModels","speed","isNumber","is","$indicator","size","stop","clearQueue","contentsLoadingIndicator","insertAfter","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","click .list-items-section-link","_clickSectionLink","ev","sectionNumber","currentTarget","parent","data","openSection","isLastSection","sectionElement","sectionBottom","offsetTop","offsetHeight","startAtBottom","$scrollContainer","height","toggleShowDeleted","undefined","setIncludeDeleted","fetch","fetchDeletedInSection","jQuery","toggleShowHidden","store","setIncludeHidden","fetchHiddenInSection","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","listenToOnce","bulkAppendItemViews","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","$target","$messages","scrollToHid","scrollToItem","first","viewsWhereModel","toString","mainTemplate","wrapTemplate","controlsTemplate","contentsLoadingIndicatorTemplate","paginationTemplate","listItemsSectionTemplate","controls","pagination"],"mappings":"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"}
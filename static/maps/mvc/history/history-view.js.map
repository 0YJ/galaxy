{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","_createDefaultCollection","console","log","history","model","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","_","silent","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpCollectionListeners","listenTo","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","$emptyMsg","$emptyMessage","empty","get","active","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","renderItems","hidsPerSection","freeViews","$list","html","_mapSectionRanges","section","templates","listItemsSection","join","_renderSection","currentSection","toggle","sectionModels","_filterSectionCollection","bind","_filterItem","$section","map","itemModel","view","_createItemView","push","_renderItemView$el","$currentSection","includeHidden","hidden","includeDeleted","isDeletedOrPurged","_getItemViewClass","contentType","TypeError","_getItemViewOptions","expanded","storage","isExpanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","panel","v","addExpanded","collapsed","removeExpanded","collapseAll","clearExpanded","addItemView","lastSection","_lastSection","isNotLastSection","fetchSection","done","scrollTo","hid","insertionIndex","_indexOfHidInSection","set","fadeOut","fxSpeed","_attachView","modelIndex","useFx","isUndefined","hide","viewIndex","prevModel","at","found","findIndex","splice","prepend","children","eq","after","slideDown","getSelectedModels","speed","isNumber","is","$indicator","stop","clearQueue","contentsLoadingIndicator","insertAfter","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","click .list-items-section-link","_clickSectionLink","ev","sectionNumber","currentTarget","parent","data","openSection","offsetTop","toggleShowDeleted","undefined","setIncludeDeleted","fetch","fetchDeletedInSection","jQuery","toggleShowHidden","store","setIncludeHidden","fetchHiddenInSection","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","listenToOnce","bulkAppendItemViews","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","$target","$messages","scrollToHid","scrollToItem","first","viewsWhereModel","toString","mainTemplate","wrapTemplate","controlsTemplate","contentsLoadingIndicatorTemplate","paginationTemplate","listItemsSectionTemplate","el","controls","pagination"],"mappings":"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"}
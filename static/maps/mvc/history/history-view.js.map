{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyId","historyFn","contentsFn","info","detailIdsFn","historyData","_","values","HistoryPrefs","get","id","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","show_deleted","show_hidden","storage","stopListening","historyStorageKey","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","searchInput","fetchAllDetails","silent","done","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","omit","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","object","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
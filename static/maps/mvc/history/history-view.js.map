{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","INFINITE_SCROLL_DEBOUNCE_MS","INFINITE_SCROLL_FETCH_THRESHOLD_PX","_setUpBehaviors","$where","self","scrollHandler","_","debounce","bind","$scrollContainer","pxToBottom","_scrollDistanceToBottom","_fetching","isEmpty","panelStack","listenToOnce","contents","bulkAppendItemViews","fetchMore","silent","useSync","always","$container","$el","outerHeight","scrollTop","innerHeight","showContentsLoadingIndicator","speed","isNumber","fxSpeed","$emptyMessage","is","hide","$indicator","$","size","clearQueue","stop","insertAfter","slideDown","hideContentsLoadingIndicator","duration","complete","remove","loadHistory","historyId","contentsOptions","info","setModel","History","id","fetchWithContents","refreshContents","refresh","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","fetching-more-done","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","shown","$emptyMsg","append","show","searchFor","haveSearchDetails","multiselectActions","hideSelectors","find","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","getSelectedModels","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","store","undefined","includeDeleted","set","lastHid","last","console","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","haveDetails","searchItems","searchInput","progressivelyFetchDetails","progress","status","readyState","parsed","_parseErrorMessage","$messages","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","omit","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","object","type","scrollToTop","$msgContainer","$msg","addClass","html","$detailsLink","click","modal","_messageToModalOptions","isObject","functions","text","JSON","stringify","pre","body","buttons","Ok","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
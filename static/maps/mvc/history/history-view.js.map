{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","_","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","getSelectedModels","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","undefined","whenFetched","contents","fetchDeleted","silent","jQuery","done","renderItems","set","toggleShowHidden","fetchHidden","_firstSearch","searchFor","inputSelector","haveDetails","searchItems","searchInput","fetchAllDetails","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","omit","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","object","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","isObject","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
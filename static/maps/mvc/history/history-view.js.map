{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","window","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","shown","$emptyMsg","$emptyMessage","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","_","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","collapseAll","set","getSelectedModels","INFINITE_SCROLL_DEBOUNCE_MS","INFINITE_SCROLL_FETCH_THRESHOLD_PX","_setUpBehaviors","scrollHandler","debounce","bind","$scrollContainer","pxToBottom","_scrollDistanceToBottom","_fetching","isEmpty","panelStack","listenToOnce","bulkAppendItemViews","fetchMore","silent","useSync","$container","outerHeight","scrollTop","innerHeight","speed","isNumber","fxSpeed","is","hide","$indicator","clearQueue","stop","templates","contentsLoadingIndicator","insertAfter","slideDown","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","store","undefined","includeDeleted","last","lastHid","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","console","haveDetails","searchItems","searchInput","progressivelyFetchDetails","progress","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","ev","$target","isUndefined","$messages","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","controlsTemplate","wrapTemplate","contentsLoadingIndicatorTemplate","controls"],"mappings":"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"}
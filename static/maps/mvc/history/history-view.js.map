{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryView","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","FETCH_COLLECTION_COUNTS_DELAY","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","done","delay","contents","fetchCollectionCounts","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","collapsed","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","haveDetails","searchItems","searchInput","fetchAllDetails","silent","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
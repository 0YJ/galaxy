{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","currentSection","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","active","$emptyMsg","$emptyMessage","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","hidsPerSection","minContentsBeforeSectioning","renderItems","contents_active","lastHid","console","sections","_","range","reverse","isNumber","first","map","sectionNumber","templates","listItemsSection","last","Math","min","number","$list","hide","html","join","_getCollectionSection","itemModel","_createItemView","$currentSection","replaceWith","_renderItemView$el","section","filtered","filter","bind","_filterItem","sectioned","m","hid","selector","_getItemViewClass","contentType","TypeError","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","collapseAll","set","getSelectedModels","speed","fxSpeed","is","$indicator","stop","clearQueue","contentsLoadingIndicator","insertAfter","slideDown","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","click .list-items-section","ev","_openSection","currentTarget","data","fetch","silent","filters","hid-ge","hid-le","done","toggleShowDeleted","store","undefined","includeDeleted","jQuery","fetchDeleted","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","listenToOnce","bulkAppendItemViews","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","$target","isUndefined","$messages","children","fadeOut","scrollToHid","scrollToItem","viewsWhereModel","toString","mainTemplate","wrapTemplate","controlsTemplate","contentsLoadingIndicatorTemplate","paginationTemplate","listItemsSectionTemplate","el","controls","pagination"],"mappings":"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"}
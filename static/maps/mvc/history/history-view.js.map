{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HDA_LI","HDCA_LI","USER","faIconButton","PopupMenu","BASE_MVC","_l","logNamespace","HistoryPrefs","SessionStorageModel","extend","defaults","expandedIds","show_deleted","show_hidden","addExpanded","model","key","this","save","_","get","object","id","removeExpanded","omit","toString","storageKeyPrefix","historyStorageKey","historyId","Error","clearAll","sessionStorage","indexOf","removeItem","_super","ModelListPanel","HistoryView","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","linkTarget","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistoryWithDetails","historyFn","contentsFn","info","detailIdsFn","historyData","values","loadHistory","panel","History","getHistoryData","initiallyExpanded","_loadHistoryFromXHR","fail","where","history","always","then","historyJSON","contentsJSON","JSONToModel","render","refreshContents","refresh","$","when","newHistoryJSON","newHdaJSON","log","setModel","_setUpWebStorage","storage","stopListening","isObject","set","isBoolean","listenTo","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","undefined","_buildNewRender","$newRender","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","collapsed","getSelectedModels","collection","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","renderItems","toggleShowHidden","_firstSearch","searchFor","inputSelector","contents","haveDetails","searchItems","searchInput","fetchAllDetails","silent","done","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","type","scrollToTop","$msgContainer","$msg","addClass","html","isEmpty","$detailsLink","click","modal","_messageToModalOptions","append","functions","text","JSON","stringify","pre","body","buttons","Ok","hide","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","fxSpeed","scrollToHid","hid","scrollToItem","first","viewsWhereModel","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
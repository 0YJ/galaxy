{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","_createDefaultCollection","console","log","history","model","freeModel","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","_","silent","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpCollectionListeners","listenTo","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","$emptyMsg","$emptyMessage","empty","get","active","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","title","classes","faIcon","prependTo","renderItems","hidsPerSection","$list","html","_mapSectionRanges","section","templates","listItemsSection","join","_renderSection","currentSection","toggle","sectionModels","_filterSectionCollection","bind","_filterItem","_modelsToViews","$section","map","view","delegateEvents","el","children","_renderItemView$el","$currentSection","includeHidden","hidden","includeDeleted","isDeletedOrPurged","_getItemViewClass","contentType","TypeError","_getItemViewOptions","expanded","storage","isExpanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","panel","v","addExpanded","collapsed","removeExpanded","collapseAll","clearExpanded","addItemView","lastSection","_lastSection","isNotLastSection","setCurrentSection","fetchSection","done","scrollTo","hid","insertionIndex","_indexOfHidInSection","set","_createItemView","fadeOut","fxSpeed","_attachView","modelIndex","useFx","isUndefined","hide","viewIndex","prevModel","at","found","findIndex","splice","prepend","eq","after","slideDown","getSelectedModels","speed","isNumber","is","$indicator","size","stop","clearQueue","contentsLoadingIndicator","insertAfter","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","click .list-items-section-link","_clickSectionLink","ev","sectionNumber","currentTarget","parent","data","openSection","isLastSection","sectionElement","sectionBottom","offsetTop","offsetHeight","startAtBottom","$scrollContainer","height","toggleShowDeleted","undefined","setIncludeDeleted","fetch","fetchDeletedInSection","jQuery","toggleShowHidden","store","setIncludeHidden","fetchHiddenInSection","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","listenToOnce","bulkAppendItemViews","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","$target","$messages","scrollToHid","scrollToItem","first","viewsWhereModel","toString","mainTemplate","wrapTemplate","controlsTemplate","contentsLoadingIndicatorTemplate","paginationTemplate","listItemsSectionTemplate","controls","pagination"],"mappings":"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"}
{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","_setUpBehaviors","$where","DEBOUNCED_MS","self","scrollHandler","_","debounce","bind","$scrollContainer","FETCH_MORE_PX_THRESHOLD","$container","pxToBottom","$el","outerHeight","scrollTop","innerHeight","_fetching","isEmpty","panelStack","listenToOnce","contents","bulkAppendItemViews","fetchMore","silent","useSync","always","addItemView","collection","console","log","showContentsLoadingIndicator","speed","isNumber","fxSpeed","$indicator","$list","find","size","clearQueue","stop","$","hide","appendTo","fadeIn","hideContentsLoadingIndicator","duration","complete","remove","loadHistory","historyId","contentsOptions","info","setModel","History","id","fetchWithContents","refreshContents","refresh","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","fetching-more","fetching-more-done","storage","stopListening","HistoryPrefs","historyStorageKey","get","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","multiselectActions","hideSelectors","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","getSelectedModels","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","undefined","includeDeleted","set","lastHid","last","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","searchFor","inputSelector","haveDetails","searchItems","searchInput","progressivelyFetchDetails","progress","status","readyState","parsed","_parseErrorMessage","$messages","is","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","omit","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","object","type","scrollToTop","$msgContainer","$msg","addClass","html","$detailsLink","click","modal","_messageToModalOptions","append","isObject","functions","text","JSON","stringify","pre","body","buttons","Ok","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
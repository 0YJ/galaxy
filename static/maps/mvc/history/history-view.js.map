{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","window","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","INFINITE_SCROLL_DEBOUNCE_MS","INFINITE_SCROLL_FETCH_THRESHOLD_PX","_setUpBehaviors","$where","self","scrollHandler","_","debounce","bind","$scrollContainer","pxToBottom","_scrollDistanceToBottom","_fetching","isEmpty","panelStack","listenToOnce","contents","bulkAppendItemViews","fetchMore","silent","useSync","always","$container","$el","outerHeight","scrollTop","innerHeight","showContentsLoadingIndicator","speed","isNumber","fxSpeed","$emptyMessage","is","hide","$indicator","$","size","clearQueue","stop","insertAfter","slideDown","hideContentsLoadingIndicator","duration","complete","remove","loadHistory","historyId","contentsOptions","info","setModel","History","id","fetchWithContents","refreshContents","refresh","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","fetching-more-done","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","shown","$emptyMsg","append","show","searchFor","haveSearchDetails","multiselectActions","hideSelectors","find","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","collapseAll","set","getSelectedModels","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","store","undefined","includeDeleted","lastHid","last","console","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","haveDetails","searchItems","searchInput","progressivelyFetchDetails","progress","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","ev","$target","isUndefined","$messages","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"AAAAA,QACI,qBACA,4BACA,+BACA,kCACA,qBACA,sBACA,sBACA,qBACA,oBACA,eACA,qBACA,mBACD,SACCC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEJ,YAEAC,QAAOJ,YAAcA,CAcrB,IAAIK,GAASZ,EAAUa,eACnBC,EAAcF,EAAOG,QAErBC,cAAgB,UAGhBC,aAAsBb,EAAOc,gBAE7BC,cAAsBd,EAAQe,iBAE9BC,gBAAsBnB,EAAiBoB,gBAEvCC,mBAAsB,WAEtBC,QAAsB,MACtBC,UAAsBb,EAAOc,UAAUD,UAAY,iBAGnDE,SAAsBjB,EAAI,yBAE1BkB,aAAsBlB,EAAI,8BAE1BmB,kBAAsBnB,EAAI,mBAM1BoB,WAAa,SAAUC,GACnBnB,EAAOc,UAAUI,WAAWE,KAAMC,KAAMF,GAIxCE,KAAKC,WAAaH,EAAWG,YAAc,UAI/CC,UAAY,WAMR,MALAvB,GAAOc,UAAUS,UAAUH,KAAMC,MAC7BA,KAAKG,OAELH,KAAKG,MAAMC,qBAERJ,MAOXK,gBAAkB,WACd1B,EAAOc,UAAUY,gBAAgBN,KAAMC,MACvCA,KAAKM,IACDC,MAAQ,SAAUJ,EAAOK,EAAKC,EAASC,EAAKC,GACxCX,KAAKY,aAAcT,EAAOK,EAAKC,EAASC,EAAKC,IAEjDE,eAAiB,WACbb,KAAKc,SACAd,KAAKe,MAAMC,QACZhB,KAAKiB,QAAS,gBAAiBjB,OAGvCkB,yCAA2C,WACvClB,KAAKmB,0BAQjBC,4BAA8B,GAE9BC,mCAAqC,IAGrCC,gBAAkB,SAAUC,GACxB,CAAA,GAAIC,GAAOxB,IACMrB,GAAOc,UAAU6B,gBAAgBvB,KAAMC,KAAMuB,GAK9D,MAFAC,GAAKC,cAAgBC,EAAEC,SAAUD,EAAEE,KAAM5B,KAAKyB,cAAeD,GAAQA,EAAKJ,6BAC1EI,EAAKK,iBAAkBN,GAASjB,GAAI,SAAUkB,EAAKC,eAC5CD,GAIXC,cAAgB,WACZ,GAAID,GAAOxB,KACP8B,EAAaN,EAAKO,yBAKlBD,GAAaN,EAAKH,qCAAuCG,EAAKQ,WAAaN,EAAEO,QAAST,EAAKU,cAC3FV,EAAKW,aAAcX,EAAKrB,MAAMiC,SAAU,OAAQZ,EAAKa,qBAErDb,EAAKQ,WAAY,EACjBR,EAAKrB,MAAMiC,SAASE,WAAYC,QAAS,EAAMC,SAAS,IACnDC,OAAQ,iBAAmBjB,GAAKQ,cAK7CD,wBAA0B,WACtB,GAAIW,GAAa1C,KAAK6B,mBAClBC,EAAa9B,KAAK2C,IAAIC,eAAkBF,EAAWG,YAAcH,EAAWI,cAChF,OAAOhB,IAIXiB,6BAA+B,SAAUC,GACrCA,EAAQtB,EAAEuB,SAAUD,GAASA,EAAQhD,KAAKkD,QACtClD,KAAKmD,gBAAgBC,GAAI,aACzBpD,KAAKmD,gBAAgBE,MAGzB,IAAIC,GAAatD,KAAKuD,EAAG,8BACzB,OAAID,GAAWE,OACJF,EAAWG,aAAaC,QAKnCJ,EAAaC,EAAG,mGAAoGF,OAC7GC,EACFK,YAAa3D,KAAKuD,EAAG,kBACrBK,UAAWZ,KAIpBa,6BAA+B,SAAUb,GACrCA,EAAQtB,EAAEuB,SAAUD,GAASA,EAAQhD,KAAKkD,QAC1ClD,KAAKuD,EAAG,iCAAkCF,MAAOS,SAAU,EAAGC,SAAU,WACpER,EAAGvD,MAAOgE,aAMlBC,YAAc,SAAUC,EAAWzD,EAAS0D,GACxCnE,KAAKoE,KAAM,eAAgBF,EAAWzD,EAAS0D,EAC/C,IAAI3C,GAAOxB,IAKX,OAJAwB,GAAK6C,SAAU,GAAIrG,GAAcsG,SAAUC,GAAKL,KAGhD1C,EAAKP,QAAS,WACPO,EAAKrB,MACPqE,kBAAmB/D,EAAS0D,GAC5B1B,OAAQ,WACLjB,EAAKP,QAAS,mBAK1BwD,gBAAkB,SAAUhE,GACxB,MAAIT,MAAKG,MACEH,KAAKG,MAAMuE,QAASjE,GAGxB8C,EAAEoB,QAMbN,SAAW,SAAUlE,EAAOL,GACxBA,EAAaA,MACbnB,EAAOc,UAAU4E,SAAStE,KAAMC,KAAMG,EAAOL,GACzCE,KAAKG,OACLH,KAAK4E,oBAKbC,qBAAuB,WAEnB,MADAlG,GAAOc,UAAUoF,qBAAqB9E,KAAMC,MACrCA,KAAK8E,SAAU9E,KAAKG,OACvB4E,YAAc/E,KAAK4E,oBAK3BI,0BAA4B,WAExB,MADArG,GAAOc,UAAUuF,0BAA0BjF,KAAMC,MAC1CA,KAAK8E,SAAU9E,KAAKiF,YAEvBC,gBAAsBlF,KAAK+C,6BAC3BoC,qBAAsBnF,KAAK6D,gCAQnCe,iBAAmB,WACf,MAAK5E,MAAKG,OAAUH,KAAKG,MAAMoE,IAE3BvE,KAAKoF,SACLpF,KAAKqF,cAAerF,KAAKoF,SAG7BpF,KAAKoF,QAAU,GAAIlH,GAAcoH,cAC7Bf,GAAIrG,EAAcoH,aAAaC,kBAAmBvF,KAAKG,MAAMqF,IAAK,SAEtExF,KAAKiB,QAAS,cAAejB,KAAKoF,QAASpF,MAC3CA,KAAKyF,IAAKzF,KAAO,qBAAuBA,KAAKoF,QAAQI,OAGrDxF,KAAK8E,SAAU9E,KAAKoF,SAChBM,sBAAwB,SAAUC,EAAMC,GACpC5F,KAAK6F,YAAcD,GAEvBE,qBAAuB,SAAUH,EAAMC,GACnC5F,KAAK+F,WAAaH,IAEvB5F,MACHA,KAAK6F,YAAc7F,KAAKoF,QAAQI,IAAK,kBAAoB,EACzDxF,KAAK+F,WAAc/F,KAAKoF,QAAQI,IAAK,iBAAmB,EAEjDxF,MAxBqCA,MA6BhDgG,gBAAkB,WACd,GAAIC,GAAatH,EAAOc,UAAUuG,gBAAgBjG,KAAMC,KAExD,OADAA,MAAKmB,oBAAqB8E,GACnBA,GAIXC,oBAAsB,SAAUC,GAC5B,GAAI3E,GAAOxB,KACPoG,GAAS5E,EAAKrB,MAAMqF,IAAK,kBAAmBa,MAC5CC,EAAY9E,EAAK2B,cAAegD,EAEpC,OAAIC,GACOE,EAAUF,QAAQG,OAAQ/E,EAAK9B,UAAW8G,OAE1ChF,EAAKiF,WAAajF,EAAKrB,MAAMiC,SAASsE,sBAAwBlF,EAAKT,MAAMC,OACzEsF,EAAUF,QAAQG,OAAQ/E,EAAK7B,cAAe6G,OAElDjD,KAIXpC,oBAAsB,SAAUI,GAG5B,GAFAA,EAASA,GAAUvB,KAAK2C,KAEnB3C,KAAK2G,qBAAqB3F,OAC3B,MAAO,KAGX,KAAKhB,KAAKe,MAAMC,OAGZ,MAFAhB,MAAK4G,gBACLrF,EAAOsF,KAAM,0CAA2C7C,SACjD,IAGX,IAAI8C,GAAYvF,EAAOsF,KAAM,yCAC7B,OAAIC,GAAUtD,OACHsD,EAGJvI,GACHwI,MAAUtI,EAAI,mCACduI,QAAU,qBACVC,OAAU,sBACXC,UAAW3F,EAAOsF,KAAM,wBAO/BM,kBAAoB,SAAUhH,GAC1B,GAAIiH,GAAcjH,EAAMqF,IAAK,uBAC7B,QAAQ4B,GACJ,IAAK,UACD,MAAOpH,MAAKhB,YAChB,KAAK,qBACD,MAAOgB,MAAKd,cAEpB,KAAM,IAAImI,WAAW,iCAAmCD,IAI5DE,YAAc,SAAUnH,GACpB,GAAIoH,GAAQvH,IACZ,OAASrB,GAAOc,UAAU6H,YAAYvH,KAAMwH,EAAOpH,MACzCA,EAAMqH,UAAYD,EAAMxB,eACxB5F,EAAMsH,qBAAuBF,EAAM1B,cAIjD6B,oBAAsB,SAAUvH,GAC5B,GAAIM,GAAU9B,EAAOc,UAAUiI,oBAAoB3H,KAAMC,KAAMG,EAC/D,OAAOuB,GAAE5C,OAAQ2B,GACbR,WAAkBD,KAAKC,WACvB0H,WAAoB3H,KAAKoF,QAAQI,IAAK,eAAiBrF,EAAMoE,IAC7DqD,QAAkB5H,KAAKG,MAAM0H,qBAKrCC,wBAA0B,SAAUnC,GAChC,GAAI4B,GAAQvH,IAIZ,OAHArB,GAAOc,UAAUqI,wBAAwB/H,KAAMwH,EAAO5B,GAG/C4B,EAAMzC,SAAUa,GACnBgC,SAAY,SAAUI,GAClBR,EAAMnC,QAAQ4C,YAAaD,EAAE5H,QAEjC8H,UAAa,SAAUF,GACnBR,EAAMnC,QAAQ8C,eAAgBH,EAAE5H,WAM5CgI,YAAc,WACVnI,KAAKoF,QAAQgD,IAAK,kBAClBzJ,EAAOc,UAAU0I,YAAYpI,KAAMC,OAKvCqI,kBAAoB,WAChB,GAAIpD,GAAatG,EAAOc,UAAU4I,kBAAkBtI,KAAMC,KAE1D,OADAiF,GAAWf,UAAYlE,KAAKiF,WAAWf,UAChCe,GAKXqD,OAAS5G,EAAE5C,OAAQ4C,EAAE6G,MAAO5J,EAAOc,UAAU6I,SAEzCE,4BAAsC,kBAEtCC,mCAAsC,kBAM1CC,kBAAoB,SAAUlC,EAAMmC,GAChCnC,EAAkBoC,SAATpC,EAAqB,GAAYxG,KAAK6F,YAC/C8C,EAAoBC,SAAVD,EAAsB,GAAU,CAC1C,IAAInH,GAAOxB,IAEXwB,GAAKqE,YAAcW,EAEnBhF,EAAKrB,MAAMiC,SAASyG,eAAiBrC,EACrChF,EAAKP,QAAS,eAAgBuF,GAC1BmC,GAASnH,EAAK4D,QAAQgD,IAAK,eAAgB5B,EAG/C,IAAIsC,GAAUtH,EAAKyD,WAAW8D,OAAOvD,IAAK,MAC1CwD,SAAQvD,IAAK,WAAYqD,EACzB,IAAIG,GAAQC,OAAOvE,MASnB,OARI6B,KACAyC,EAAQzH,EAAKrB,MAAMiC,SAAS+G,cACxB5G,QAAU,EACV6G,SAAYC,SAAWP,MAG/BG,EAAMK,KAAM,WAAY9H,EAAK+H,gBAEtB/H,EAAKqE,aAMhB2D,iBAAmB,SAAUhD,EAAMmC,GAC/BnC,EAAkBoC,SAATpC,EAAqB,GAAYxG,KAAK+F,WAC/C4C,EAAoBC,SAAVD,EAAsB,GAAU,CAC1C,IAAInH,GAAOxB,IAEXwB,GAAKuE,WAAaS,EAClBhF,EAAKrB,MAAMiC,SAASqH,cAAgBjD,EACpChF,EAAKP,QAAS,cAAeuF,GACzBmC,GACAnH,EAAK4D,QAAQgD,IAAK,cAAe5B,EAErC,IAAIyC,GAAQC,OAAOvE,MAQnB,OAPI6B,KACAyC,EAAQzH,EAAKrB,MAAMiC,SAASsH,aACxBnH,QAAU,KAGlB0G,EAAMK,KAAM,WAAY9H,EAAK+H,gBAEtB/H,EAAKuE,YAIhB4D,aAAe,SAAUlD,GACrB,GAAIjF,GAAOxB,KACP4J,EAAgB,2BAIpB,OAHA5J,MAAKyF,IAAK,gBAAiBgB,GAE3BuC,QAAQvD,IAAK,gBAAiBjE,EAAKrB,MAAMiC,SAASyH,eAC9CrI,EAAKrB,MAAMiC,SAASyH,kBACpBrI,GAAKsI,YAAarD,IAItBjF,EAAKmB,IAAIkE,KAAM+C,GAAgBG,YAAa,sBAE5CvI,GAAKrB,MAAMiC,SAAS4H,2BAA4BzH,QAAQ,IACnD0H,SAAU,WAEPzI,EAAKW,aAAcX,EAAKrB,MAAMiC,SAAU,OAAQZ,EAAKa,uBAExDI,OAAQ,WACLjB,EAAKmB,IAAIkE,KAAM+C,GAAgBG,YAAa,oBAE/CT,KAAM,WACH9H,EAAKsI,YAAatI,EAAKiF,eAYnC7F,aAAe,SAAUT,EAAOK,EAAKC,GAEjC,IAAID,GAAsB,IAAfA,EAAI0J,QAAmC,IAAnB1J,EAAI2J,WAAnC,CASA,GAHAnK,KAAKO,MAAOJ,EAAOK,EAAKC,GAGpBiB,EAAE0I,SAAUjK,IAAWuB,EAAE0I,SAAU5J,GAAO,CAC1C,GAAI6J,GAAUlK,EACV4G,EAAQvG,CACZ,OAAOlC,GAAYgM,WAAYD,EAAStD,EAAOtG,GAInD,MAAID,IAAsB,MAAfA,EAAI0J,OACJ5L,EAAYiM,uBAEhBjM,EAAYkM,eAAgBrK,EAAOK,EAAKC,KAInDgK,cAAgB,SAAUC,GACtB,GAAIC,GAAWjJ,EAAEkJ,YAAaF,GAEzB1K,KAAK6K,YAAYC,SAAU,sBAD5BvH,EAAGmH,EAAGK,cAKV,OAHAJ,GAAQK,QAAShL,KAAKkD,QAAS,WAC3BK,EAAGvD,MAAOgE,WAEPhE,MAQXiL,YAAc,SAAUC,GACpB,MAAOlL,MAAKmL,aAAczJ,EAAE0J,MAAOpL,KAAKqL,iBAAkBH,IAAKA,OAKnEI,SAAW,WACP,MAAO,gBAAoBtL,KAAW,MAAIA,KAAKG,MAAMqF,IAAK,QAAU,IAAU,MAqElF,OA/DJ3G,GAAYY,UAAU8L,UAAa,WAE/B,GAAIC,GAAmBhN,EAASiN,cAC5B,yBACI,sBACI,8CACJ,SACA,+BACA,2DAEA,8BAEA,iDACI,gDACIhN,EAAI,4CACR,SACJ,sCACI,gDACIA,EAAI,iCACR,SACJ,qCACI,gDACIA,EAAI,gCACR,SACJ,UAEA,yBACI,+BAEI,mEACI,8BACJ,SACJ,UACJ,SAGA,mCACA,yCAEA,uBACI,mCACJ,SAEA,6BACI,0BACI,6CACQ,sBAAuBA,EAAI,OAAS,YAC5C,+CACQ,sBAAuBA,EAAI,QAAU,YACjD,SACA,2CACA,SACJ,SACJ,UACD,UAEH,OAAOiD,GAAE5C,OAAQ4C,EAAE6G,MAAO5J,EAAOc,UAAU8L,YACvCG,SAAWF,QAOX3M,YAAaA"}
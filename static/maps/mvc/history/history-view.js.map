{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","ERROR_MODAL","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","_createDefaultCollection","history","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","loadHistory","historyId","contentsOptions","info","self","setModel","History","id","fetchWithContents","always","refreshContents","refresh","$","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","showContentsLoadingIndicator","fetching-more-done","hideContentsLoadingIndicator","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","_renderEmptyMessage","$whereTo","empty","active","$emptyMsg","$emptyMessage","append","show","searchFor","contents","haveSearchDetails","$where","$el","multiselectActions","hideSelectors","find","remove","$existing","size","title","classes","faIcon","prependTo","renderItems","hidsPerSection","contents_active","$list","html","_mapSectionRanges","section","templates","listItemsSection","join","_getCurrentSectionCollection","map","itemModel","_createItemView","hide","$currentSection","replaceWith","_renderItemView$el","_filterCurrentSectionCollection","_","bind","_filterItem","selector","currentSection","_getItemViewClass","contentType","TypeError","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","collapseAll","set","getSelectedModels","speed","isNumber","fxSpeed","is","$indicator","stop","clearQueue","contentsLoadingIndicator","insertAfter","slideDown","slideUp","duration","complete","events","clone","click .show-selectors-btn","click .messages [class$=message]","click .list-items-section","ev","openSection","currentTarget","data","fetchSection","done","toggleShowDeleted","store","undefined","includeDeleted","last","lastHid","fetch","jQuery","fetchDeleted","silent","filters","hid-ge","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","inputSelector","initialContentsLength","searchItems","searchInput","progressivelyFetchDetails","progress","response","limit","offset","listenToOnce","bulkAppendItemViews","status","readyState","isString","message","errorModal","badGatewayErrorModal","ajaxErrorModal","clearMessages","$target","isUndefined","$messages","children","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","mainTemplate","wrapTemplate","controlsTemplate","contentsLoadingIndicatorTemplate","paginationTemplate","listItemsSectionTemplate","el","controls","pagination"],"mappings":"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"}
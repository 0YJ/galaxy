{"version":3,"file":"history-view.js","sources":["../../../src/mvc/history/history-view.js"],"names":["define","LIST_VIEW","HISTORY_MODEL","HISTORY_CONTENTS","HISTORY_PREFS","HDA_LI","HDCA_LI","USER","faIconButton","BASE_MVC","_l","_super","ModelListPanel","HistoryView","extend","_logNamespace","HDAViewClass","HDAListItemView","HDCAViewClass","HDCAListItemView","collectionClass","HistoryContents","modelCollectionKey","tagName","className","prototype","emptyMsg","noneFoundMsg","searchPlaceholder","initialize","attributes","call","this","linkTarget","freeModel","model","clearUpdateTimeout","_setUpListeners","on","error","xhr","options","msg","details","errorHandler","loading-done","render","views","length","trigger","views:ready view:attached view:removed","_renderSelectButton","_setUpBehaviors","$where","DEBOUNCED_MS","self","scrollHandler","_","debounce","bind","$scrollContainer","FETCH_MORE_PX_THRESHOLD","pxToBottom","_scrollDistanceToBottom","_fetching","isEmpty","panelStack","listenToOnce","contents","bulkAppendItemViews","fetchMore","silent","useSync","always","$container","$el","outerHeight","scrollTop","innerHeight","showContentsLoadingIndicator","speed","isNumber","fxSpeed","$emptyMessage","is","hide","$indicator","$list","find","size","clearQueue","stop","$","insertAfter","fadeIn","hideContentsLoadingIndicator","slideUp","duration","complete","remove","loadHistory","historyId","contentsOptions","info","setModel","History","id","fetchWithContents","refreshContents","refresh","when","_setUpWebStorage","_setUpModelListeners","listenTo","change:id","_setUpCollectionListeners","collection","fetching-more","fetching-more-done","storage","stopListening","HistoryPrefs","historyStorageKey","get","log","change:show_deleted","view","newVal","showDeleted","change:show_hidden","showHidden","_buildNewRender","$newRender","multiselectActions","hideSelectors","$existing","title","classes","faIcon","prependTo","_getItemViewClass","contentType","TypeError","_filterItem","panel","hidden","isDeletedOrPurged","_getItemViewOptions","expanded","hasUser","ownedByCurrUser","_setUpItemViewListeners","v","addExpanded","collapsed","removeExpanded","getSelectedModels","events","clone","click .show-selectors-btn","click .messages [class$=message]","toggleShowDeleted","show","store","undefined","includeDeleted","set","lastHid","last","console","fetch","jQuery","fetchDeleted","filters","hid-ge","done","renderItems","toggleShowHidden","includeHidden","fetchHidden","_firstSearch","searchFor","inputSelector","haveDetails","searchItems","searchInput","progressivelyFetchDetails","progress","status","readyState","parsed","_parseErrorMessage","$messages","displayMessage","message","once","user","Galaxy","_bePolite","raven","window","Raven","isFunction","lastEventId","agent","navigator","userAgent","url","lastAjax","data","omit","source","toJSON","User","getAllResponseHeaders","responseHeaders","compact","split","map","header","object","type","scrollToTop","$msgContainer","$msg","addClass","html","$detailsLink","click","modal","_messageToModalOptions","append","isObject","functions","text","JSON","stringify","pre","body","buttons","Ok","clearMessages","ev","$target","isUndefined","children","currentTarget","fadeOut","scrollToHid","hid","scrollToItem","first","viewsWhereModel","toString","templates","controlsTemplate","wrapTemplate","controls"],"mappings":"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"}
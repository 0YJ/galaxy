{"version":3,"sources":["mvc/history/history-import.js"],"names":["View","Backbone","extend","initialize","this","setElement","_mainTemplate","$form","$","$message","self","Galaxy","root","data","processData","cache","response","message","method","responseJSON","err_msg","removeClass","window","location","text"],"mappings":"0HACA,IAAIA,EAAOC,SAASD,KAAKE,QACrBC,WAAY,WAERC,KAAKC,WAAWD,KAAKE,iBACrB,IAAIC,EAAQH,KAAKI,EAAE,QAL3BC,EAAAL,KAAAI,EAAA,eACIR,KAAAA,EAAOC,gBAAcC,GAAAA,QAAO,WAC5BC,EAAAA,MACQO,IAAOC,OAAXC,KAAIF,gBACJG,KAAKR,IAAAA,SAAgBC,EAAAA,IACjBC,OAAAA,EACAE,aAAW,EACfK,aAAO,EACHN,OAAO,SAEHK,KAAAA,SAAAA,GACAE,OAAAA,SAHGJ,OAAAC,KAGHG,0BAHGC,EAAAC,QAGHF,oBAEAD,KAAAA,SAAAA,GACAI,IAAAA,EAAQF,EAAAG,cAAAH,EAAAG,aAAAC,QANLX,EAQDY,cACFC,SAAOC,iCAELC,KAAAP,GAAA,oCACEA,YAShBX,cAAA,WACAA,MAAAA,+uCA+BAN,KAAMA","file":"../../../scripts/mvc/history/history-import.js","sourcesContent":["/** Import history from archive view */\nvar View = Backbone.View.extend({\n    initialize: function() {\n        var self = this;\n        this.setElement(this._mainTemplate());\n        var $form = this.$('form');\n        var $message = this.$('.ui-message');\n        this.$('.btn-primary').on('click', () => {\n            $.ajax({\n                url: `${Galaxy.root}api/histories`,\n                data: new FormData($form[0]),\n                cache: false,\n                contentType: false,\n                processData: false,\n                method: 'POST'\n            })\n            .done(response => {\n                window.location = `${Galaxy.root}histories/list?message=${response.message}&status=success`\n            })\n            .fail(response => {\n                let message = response.responseJSON && response.responseJSON.err_msg;\n                $message.removeClass()\n                        .addClass('ui-message alert alert-danger')\n                        .text(message || 'Import failed for unkown reason.')\n                        .show();\n            });\n        });\n    },\n\n    /** Template */\n    _mainTemplate: function() {\n        return `<div class='ui-portlet-limited'>\n            <div class='portlet-header'>\n                <div class='portlet-title'>\n                    <i class='portlet-title-icon fa fa-upload'></i>\n                    <span class='portlet-title-text'><b>Import a History from an Archive</b></span>\n                </div>\n            </div>\n            <div class='portlet-content'>\n                <div class='portlet-body'>\n                    <div class='ui-message'/>\n                    <form>\n                        <div class='ui-form-element'>\n                            <div class='ui-form-title'>Archived History URL</div>\n                            <input class='ui-input' type='text' name='archive_source'/>\n                        </div>\n                        <div class='ui-form-element'>\n                            <div class='ui-form-title'>Archived History file</div>\n                            <input type='file' name='archive_file'/>\n                        </div>\n                    </form>\n                </div>\n                <div class='portlet-buttons'>\n                    <input class='btn btn-primary' type='button' value='Import History'/>\n                </div>\n            </div>\n        </div>`;\n    }\n});\n\nexport default {\n    View: View\n};\n"]}
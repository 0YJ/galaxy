{"version":3,"sources":["mvc/history/history-content-model.js"],"names":["define","STATES","BASE_MVC","_l","HistoryContentMixin","defaults","history_id","history_content_type","hid","visible","idAttribute","hidden","this","get","isVisible","includeHidden","includeDeleted","url","Galaxy","root","hide","urlRoot","options","save","jQuery","when","unhide","toString","join"],"mappings":"YAAAA,SACI,qBADJA,eAKA,sBADG,SAAUC,EAAQC,EAAUC,GAmFvBC,OADJA,qBAxEIC,UAEAC,WAAA,KAEAC,qBAAA,KAEAC,IAAA,KAPOC,SAHW,GAkBtBC,YAAc,UAKVC,OAAA,WACH,OAxBqBC,KAAAC,IAAA,YAiClBC,UAAIA,SAAAA,EAAJC,GACA,GAAAD,IAAOE,CAWX,OATQF,KACHF,KAAAC,IAAA,aAAAD,KAAAC,IAAA,YACDC,GAAOC,GAGNA,GACDH,KAAOE,IAAAA,aA1CWA,GAAA,GA6CtBA,GAMAG,QAAMC,OAAAC,KAAA,iBAILF,IAvDqB,WA0DtBG,MANcR,MAAKS,QAAUT,KAAKC,IAAK,cAAiB,aAKxDD,KAAAC,IAAA,wBAAA,KAAAD,KAAAC,IAAA,OAGIO,KAAA,SAAOE,GACV,MA7DqBV,MAAAC,IAAA,WA8DtBD,KAAAW,MAAAd,SAAA,GAAAa,GA9DsBE,OAAAC,QAgEWC,OAAA,SAAOF,GAAgB,MAAAZ,MAAAC,IAAA,WAAAW,OAAAC,OACpDb,KAAOW,MAAAd,SAAaA,GAAFa,IAItBK,SAAAA,WACI,OAAAf,KAAUC,IAAA,WAAuBD,KAAKC,IAAK,OAASD,KAAKC,IAAK,SAAgBe,KAA9E","file":"../../../scripts/mvc/history/history-content-model.js","sourcesContent":["define([\n    \"mvc/dataset/states\",\n    \"mvc/base-mvc\",\n    \"utils/localization\"\n], function( STATES, BASE_MVC, _l ){\n'use strict';\n\n//==============================================================================\n/** @class Mixin for HistoryContents content (HDAs, HDCAs).\n */\nvar HistoryContentMixin = {\n\n    /** default attributes for a model */\n    defaults : {\n        /** parent (containing) history */\n        history_id          : null,\n        /** some content_type (HistoryContents can contain mixed model classes) */\n        history_content_type: null,\n        /** indicating when/what order the content was generated in the context of the history */\n        hid                 : null,\n        /** whether the user wants the content shown (visible) */\n        visible             : true\n    },\n\n    // ........................................................................ mixed content element\n    // In order to be part of a MIXED bbone collection, we can't rely on the id\n    //  (which may collide btwn models of different classes)\n    // Instead, use type_id which prefixes the history_content_type so the bbone collection can differentiate\n    idAttribute : 'type_id',\n\n    // ........................................................................ common queries\n    /** the more common alias of visible */\n    hidden : function(){\n        return !this.get( 'visible' );\n    },\n\n//TODO: remove\n    /** based on includeDeleted, includeHidden (gen. from the container control),\n     *      would this ds show in the list of ds's?\n     *  @param {Boolean} includeDeleted are we showing deleted hdas?\n     *  @param {Boolean} includeHidden are we showing hidden hdas?\n     */\n    isVisible : function( includeDeleted, includeHidden ){\n        var isVisible = true;\n        if( ( !includeDeleted )\n        &&  ( this.get( 'deleted' ) || this.get( 'purged' ) ) ){\n            isVisible = false;\n        }\n        if( ( !includeHidden )\n        &&  ( !this.get( 'visible' ) ) ){\n            isVisible = false;\n        }\n        return isVisible;\n    },\n\n    // ........................................................................ ajax\n    //TODO?: these are probably better done on the leaf classes\n    /** history content goes through the 'api/histories' API */\n    urlRoot: Galaxy.root + 'api/histories/',\n\n    /** full url spec. for this content */\n    url : function(){\n        var url = this.urlRoot + this.get( 'history_id' ) + '/contents/'\n             + this.get('history_content_type') + 's/' + this.get( 'id' );\n        return url;\n    },\n\n    /** save this content as not visible */\n    hide : function( options ){\n        if( !this.get( 'visible' ) ){ return jQuery.when(); }\n        return this.save( { visible: false }, options );\n    },\n    /** save this content as visible */\n    unhide : function( options ){\n        if( this.get( 'visible' ) ){ return jQuery.when(); }\n        return this.save( { visible: true }, options );\n    },\n\n    // ........................................................................ misc\n    toString : function(){\n        return ([ this.get( 'type_id' ), this.get( 'hid' ), this.get( 'name' ) ].join(':'));\n    }\n};\n\n\n//==============================================================================\n    return {\n        HistoryContentMixin : HistoryContentMixin\n    };\n});\n"]}
{"version":3,"sources":["mvc/history/history-list.js"],"names":["define","Utils","GridView","HistoryModel","historyCopyDialog","View","Backbone","extend","initialize","options","$","this","self","Model","setElement","url","Galaxy","action_id","response","success","operation","label","onclick","id","_showCopyDialog","render","grid","model","attributes","$el","empty","append","history","fetch","fail","done","window","parent","currHistoryPanel","loadCurrentHistory"],"mappings":"YACAA,SAAU,cAAe,qBAAsB,4BAA6B,2BAA6B,SAAUC,EAAOC,EAAUC,EAAcC,GAE9G,OA2C5BC,KA7CEC,SAAeD,KAAAE,QAGjBC,WAAY,SAAUC,GADtBJ,GAAOC,GAAAA,IACPE,MAAAA,WAAYE,EAAA,WACRC,KAAIC,MAAO,GAAXN,UAAAO,MACAZ,EAAKa,KACLC,IAAaC,OAAIV,KAASO,WAA1BJ,EAAAQ,UACAhB,QAAU,SAAAiB,GACNH,EAAAA,aAAqCN,EACrCU,EAAAA,KAAUD,EAAA,WAAqB,SAAAE,GACC,QAAlBA,EAAAC,QACFH,EAAUI,QAAV,SAA0BC,GAAUH,EAAVI,gBAAsBD,OAEXX,EAAAA,MAAAA,IAAAA,GAA4BA,EAAAa,aAK5EA,OAAA,WAXK,GAAVC,GAAA,GAAAxB,GAAAS,KAAAgB,MAAAC,WALwBjB,MAAAkB,IAAAC,QAAAC,OAAAL,EAAAG,MAqBxBL,gBAAW,SAAAD,GACX,GAAAS,GAAA,GAAiBD,GAAaF,SAA9BN,GAAAA,GAtBwBS,GAAAC,QA4BhBC,KAAM,WAHlBV,MAAiB,mEAELS,KAAR,WAEkB7B,EAAA4B,MAAAG,KAAA,WAEJC,OAAUC,QAAAD,OAAAC,OAAArB,QAAAoB,OAAAC,OAAArB,OAAAsB,kBACblC,OAAmB4B,OAAnBhB,OAAuCsB,iBAAWC,qBAE1CH,OAAOC,SAAOrB,QAAOsB","file":"../../../scripts/mvc/history/history-list.js","sourcesContent":["/** This class renders the grid list. */\ndefine( [ 'utils/utils', 'mvc/grid/grid-view', 'mvc/history/history-model', 'mvc/history/copy-dialog' ], function( Utils, GridView, HistoryModel, historyCopyDialog ) {\n\n    var View = Backbone.View.extend({\n        initialize: function( options ) {\n            var self = this;\n            this.setElement( $( '<div/>' ) );\n            this.model = new Backbone.Model();\n            Utils.get({\n                url     : Galaxy.root + 'history/' + options.action_id,\n                success : function( response ) {\n                    response[ 'dict_format' ] = true;\n                    _.each( response[ 'operations' ], function( operation ) {\n                        if ( operation.label == 'Copy' ) {\n                            operation.onclick = function( id ) { self._showCopyDialog( id ) };\n                        }\n                    });\n                    self.model.set( response );\n                    self.render();\n                }\n            });\n        },\n\n        render: function() {\n            var grid = new GridView( this.model.attributes );\n            this.$el.empty().append( grid.$el );\n        },\n\n        _showCopyDialog: function( id ) {\n            var history = new HistoryModel.History( { id : id } );\n            history.fetch()\n                   .fail( function() {\n                       alert( 'History could not be fetched. Please contact an administrator' );\n                   })\n                   .done( function(){\n                       historyCopyDialog( history, {} ).done( function() {\n                           if( window.parent && window.parent.Galaxy && window.parent.Galaxy.currHistoryPanel ) {\n                               window.parent.Galaxy.currHistoryPanel.loadCurrentHistory();\n                           }\n                           window.location.reload( true );\n                       } );\n                   });\n        }\n    });\n\n    return {\n        View: View\n    }\n});"]}
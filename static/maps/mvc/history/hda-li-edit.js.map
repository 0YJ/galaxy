{"version":3,"sources":["mvc/history/hda-li-edit.js"],"names":["define","DATASET_LI_EDIT","HDA_LI","BASE_MVC","_l","_super","DatasetListItemEdit","HDAListItemEdit","extend","className","prototype","_fetchModelDetails","view","this","model","inReadyState","hasDetails","fetch","silent","has","jQuery","when","data","keys","join","events","_","clone","click .unhide-link","ev","unhide","toString","templates","warnings","hidden","wrapTemplate","titleBar","HDAListItemView"],"mappings":"AAAAA,QACI,8BACA,qBACA,eACA,sBACD,SAAUC,EAAiBC,EAAQC,EAAUC,GAEhD,YAGA,IAAIC,GAASJ,EAAgBK,oBAGzBC,EAAkBF,EAAOG,QAGzBC,UAAcJ,EAAOK,UAAUD,UAAY,mBAK3CE,mBAAqB,WACjB,GAAIC,GAAOC,IACX,OAAID,GAAKE,MAAMC,iBAAmBH,EAAKE,MAAME,aAClCJ,EAAKE,MAAMG,OAAQC,QAAQ,IAI1BN,EAAKE,MAAMK,IAAK,cAMrBC,OAAOC,OALHT,EAAKE,MAAMG,OAAQC,QAAQ,EAAMI,MAEpCC,MAAQ,aAAc,gBAAiBC,KAAK,SAOxDC,OAASC,EAAElB,OAAQkB,EAAEC,MAAOtB,EAAOK,UAAUe,SACzCG,qBAAuB,SAAUC,GAA2B,MAArBhB,MAAKC,MAAMgB,UAAiB,KAIvEC,SAAW,WAEP,MAAO,oBADalB,KAAW,MAAIA,KAAKC,MAAQ,GAAK,cACX,MA8B9C,OAvBJP,GAAgBG,UAAUsB,UAAa,WAEnC,GAAIC,GAAWP,EAAElB,UAAYH,EAAOK,UAAUsB,UAAUC,UACpDC,OAAS/B,EAASgC,cACd,gCAEI,+CACI/B,EAAI,gCACJ,6DAA8DA,EAAI,aAAe,OACrF,SACJ,WACD,YAGP,OAAOsB,GAAElB,UAAYH,EAAOK,UAAUsB,WAElCI,SAAWlC,EAAOmC,gBAAgB3B,UAAUsB,UAAUI,SACtDH,SAAWA,QAOX1B,gBAAmBA","file":"../../../scripts/mvc/history/hda-li-edit.js","sourcesContent":["define([\n    \"mvc/dataset/dataset-li-edit\",\n    \"mvc/history/hda-li\",\n    \"mvc/base-mvc\",\n    \"utils/localization\"\n], function( DATASET_LI_EDIT, HDA_LI, BASE_MVC, _l ){\n\n'use strict';\n\n//==============================================================================\nvar _super = DATASET_LI_EDIT.DatasetListItemEdit;\n/** @class Editing view for HistoryDatasetAssociation.\n */\nvar HDAListItemEdit = _super.extend(\n/** @lends HDAListItemEdit.prototype */{\n\n    className   : _super.prototype.className + \" history-content\",\n\n    /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails : function(){\n        var view = this;\n        if( view.model.inReadyState() && !view.model.hasDetails() ){\n            return view.model.fetch({ silent: true });\n\n        // special case the need for the rerunnable and creating_job attributes\n        // needed for rendering re-run button on queued, running datasets\n        } else if( !view.model.has( 'rerunnable' ) ){\n            return view.model.fetch({ silent: true, data: {\n                // only fetch rerunnable and creating_job to keep overhead down\n                keys: [ 'rerunnable', 'creating_job' ].join(',')\n            }});\n        }\n        return jQuery.when();\n    },\n\n    /** event map */\n    events : _.extend( _.clone( _super.prototype.events ), {\n        'click .unhide-link' : function( ev ){ this.model.unhide(); return false; }\n    }),\n\n    /** string rep */\n    toString : function(){\n        var modelString = ( this.model )?( this.model + '' ):( '(no model)' );\n        return 'HDAListItemEdit(' + modelString + ')';\n    }\n});\n\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nHDAListItemEdit.prototype.templates = (function(){\n\n    var warnings = _.extend( {}, _super.prototype.templates.warnings, {\n        hidden : BASE_MVC.wrapTemplate([\n            '<% if( !dataset.visible ){ %>',\n                // add a link to unhide a dataset\n                '<div class=\"hidden-msg warningmessagesmall\">',\n                    _l( 'This dataset has been hidden' ),\n                    '<br /><a class=\"unhide-link\" a href=\"javascript:void(0);\">', _l( 'Unhide it' ), '</a>',\n                '</div>',\n            '<% } %>'\n        ], 'dataset' )\n    });\n\n    return _.extend( {}, _super.prototype.templates, {\n        //NOTE: *steal* the HDAListItemView titleBar\n        titleBar : HDA_LI.HDAListItemView.prototype.templates.titleBar,\n        warnings : warnings\n    });\n}());\n\n\n//==============================================================================\n    return {\n        HDAListItemEdit  : HDAListItemEdit\n    };\n});\n"]}
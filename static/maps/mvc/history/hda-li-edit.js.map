{"version":3,"sources":["mvc/history/hda-li-edit.js"],"names":["define","DATASET_LI_EDIT","HDA_LI","BASE_MVC","_l","_super","DatasetListItemEdit","HDAListItemEdit","extend","className","prototype","_fetchModelDetails","model","view","this","inReadyState","hasDetails","fetch","silent","has","jQuery","when","keys","data","join","events","_","unhide","click .unhide-link","ev","toString","modelString","templates","hidden","wrapTemplate","warnings","titleBar"],"mappings":"YAAAA,SACI,8BADJA,qBAGI,eAIJ,sBAFG,SAAUC,EAAiBC,EAAQC,EAAUC,GAKhD,GAAIC,GAASJ,EAAgBK,oBAGzBC,EAAkBF,EAAOG,QAKzBC,UAAAJ,EAAAK,UAAAD,UAAA,mBAKIE,mBAASC,WACL,GAAAC,GAAAC,IADJ,OAAID,GAAKD,MAAMG,iBAAmBF,EAAKD,MAAMI,aAG7CH,EAAAD,MAAAK,OAAAC,QAAA,IAIQL,EAAAD,MAAAO,IAAA,cAIDC,OAAOC,OAHNC,EAAAA,MAAML,OAAEC,QAAc,EAAAK,MAE7BD,MAAA,aAAA,gBAAAE,KAAA,SAMsCC,OAAAC,EAAAlB,OAAKI,EAAAA,MAAMe,EAAUjB,UAAAe,SAAeG,qBAAA,SAAAC,GAAA,MAAAf,MAAAF,MAAAe,UAAA,KAI/EG,SAAAA,WAEI,MAAA,oBADIC,KAAgBnB,MAAeE,KAAKF,MAAQ,GAAO,cAC3BmB,MA8BhC,OAvBJxB,GAAgBG,UAAUsB,UAAa,WAG/BC,GAAAA,GAAAA,EAAS9B,UAAS+B,EAAAA,UACdF,UAAAG,UACIF,OAAA9B,EAAA+B,cACA,gCAAA,+CAQH1B,EAAQ,gCACb,6DAAAJ,EAAA,aAAA,OACAgC,SACAD,WAHJ,YAQJ,OAAAT,GAAAlB,UAAAH,EAAAK,UAAAsB,WAEQzB,SAAAA,EAAmBA,gBAAAA,UAAAA,UAAAA,SADvB4B,SAAAA,QACI5B,gBAAmBA","file":"../../../scripts/mvc/history/hda-li-edit.js","sourcesContent":["define([\n    \"mvc/dataset/dataset-li-edit\",\n    \"mvc/history/hda-li\",\n    \"mvc/base-mvc\",\n    \"utils/localization\"\n], function( DATASET_LI_EDIT, HDA_LI, BASE_MVC, _l ){\n\n'use strict';\n\n//==============================================================================\nvar _super = DATASET_LI_EDIT.DatasetListItemEdit;\n/** @class Editing view for HistoryDatasetAssociation.\n */\nvar HDAListItemEdit = _super.extend(\n/** @lends HDAListItemEdit.prototype */{\n\n    className   : _super.prototype.className + \" history-content\",\n\n    /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails : function(){\n        var view = this;\n        if( view.model.inReadyState() && !view.model.hasDetails() ){\n            return view.model.fetch({ silent: true });\n\n        // special case the need for the rerunnable and creating_job attributes\n        // needed for rendering re-run button on queued, running datasets\n        } else if( !view.model.has( 'rerunnable' ) ){\n            return view.model.fetch({ silent: true, data: {\n                // only fetch rerunnable and creating_job to keep overhead down\n                keys: [ 'rerunnable', 'creating_job' ].join(',')\n            }});\n        }\n        return jQuery.when();\n    },\n\n    /** event map */\n    events : _.extend( _.clone( _super.prototype.events ), {\n        'click .unhide-link' : function( ev ){ this.model.unhide(); return false; }\n    }),\n\n    /** string rep */\n    toString : function(){\n        var modelString = ( this.model )?( this.model + '' ):( '(no model)' );\n        return 'HDAListItemEdit(' + modelString + ')';\n    }\n});\n\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nHDAListItemEdit.prototype.templates = (function(){\n\n    var warnings = _.extend( {}, _super.prototype.templates.warnings, {\n        hidden : BASE_MVC.wrapTemplate([\n            '<% if( !dataset.visible ){ %>',\n                // add a link to unhide a dataset\n                '<div class=\"hidden-msg warningmessagesmall\">',\n                    _l( 'This dataset has been hidden' ),\n                    '<br /><a class=\"unhide-link\" a href=\"javascript:void(0);\">', _l( 'Unhide it' ), '</a>',\n                '</div>',\n            '<% } %>'\n        ], 'dataset' )\n    });\n\n    return _.extend( {}, _super.prototype.templates, {\n        //NOTE: *steal* the HDAListItemView titleBar\n        titleBar : HDA_LI.HDAListItemView.prototype.templates.titleBar,\n        warnings : warnings\n    });\n}());\n\n\n//==============================================================================\n    return {\n        HDAListItemEdit  : HDAListItemEdit\n    };\n});\n"]}
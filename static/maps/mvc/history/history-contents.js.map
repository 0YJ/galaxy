{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","PaginatedCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","validationError","limitPerPage","order","urlRoot","Galaxy","root","url","this","historyId","initialize","models","prototype","call","history","setHistoryId","includeDeleted","includeHidden","idAttribute","newId","_setUpWebStorage","storage","HistoryPrefs","id","historyStorageKey","trigger","on","include-deleted","newVal","include-hidden","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filter","c","inReadyState","runningAndActive","get","getByHid","findWhere","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","result","setIncludeHidden","fetch","details","prefs","toJSON","isEmpty","expandedIds","values","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","getTotalItemCount","contentsShown","fetchUpdated","since","remove","update_time-ge","toISOString","fetchDeleted","self","undefined","always","fetchHidden","fetchAllDetails","detailsFlag","data","fetchCollectionCounts","keys","_filterAndUpdate","filterParams","updateWhat","updateArgs","then","fetched","reduce","modelArray","currJson","ajaxQueue","ajaxFn","args","collection","AjaxQueue","slice","reverse","map","content","fn","isString","apply","start","limitPerProgressiveFetch","progressivelyFetchDetails","_recursivelyFetch","offset","_options","view","detailKeys","limit","reset","defer","fail","deferred","reject","done","response","notify","length","resolve","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","contains","model_class","copy","json","type","contentType","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","xhr","post","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","history_id","element_identifiers","save","haveSearchDetails","allFetched","has","attributes","matches","matchesWhat","Backbone","Collection","toString"],"mappings":"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"}
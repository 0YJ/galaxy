{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","PaginatedCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","validationError","limitPerPage","order","urlRoot","Galaxy","root","url","this","historyId","initialize","models","prototype","call","history","setHistoryId","includeDeleted","includeHidden","idAttribute","newId","_setUpWebStorage","storage","HistoryPrefs","id","historyStorageKey","trigger","on","change:include-deleted","newVal","change:include-hidden","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filter","c","inReadyState","runningAndActive","get","getByHid","findWhere","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","result","setIncludeHidden","fetch","details","prefs","toJSON","isEmpty","expandedIds","values","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","fetchUpdated","since","remove","update_time-ge","toISOString","fetchDeleted","self","undefined","always","fetchHidden","fetchAllDetails","detailsFlag","data","fetchCollectionCounts","keys","_filterAndUpdate","filterParams","updateWhat","updateArgs","then","fetched","reduce","modelArray","currJson","ajaxQueue","ajaxFn","args","collection","AjaxQueue","slice","reverse","map","content","fn","isString","apply","start","limitPerProgressiveFetch","progressivelyFetchDetails","_recursivelyFetch","offset","_options","view","detailKeys","limit","reset","defer","fail","deferred","reject","done","response","notify","length","resolve","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","contains","model_class","copy","json","type","contentType","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","xhr","post","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","history_id","element_identifiers","save","haveSearchDetails","allFetched","has","attributes","matches","matchesWhat","Backbone","Collection","toString"],"mappings":"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"}
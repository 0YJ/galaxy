{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","ControlledFetchCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","validationError","limitOnFirstFetch","limitPerFetch","order","initialize","models","this","history","historyId","prototype","idAttribute","includeDeleted","includeHidden","call","urlRoot","Galaxy","root","url","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filterFn","c","inReadyState","filter","getByHid","first","content","get","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","trigger","setIncludeHidden","fetch","details","prefs","HistoryPrefs","toJSON","values","expandedIds","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","fetchUpdated","since","update_time-ge","toISOString","fetchDeleted","self","undefined","remove","always","fetchHidden","fetchAllDetails","detailsFlag","data","ajaxQueue","ajaxFn","queue","AjaxQueue","chain","reverse","map","start","deferred","limitPerProgressiveFetch","progressivelyFetchDetails","_notifyAndContinue","response","offset","notify","limit","allFetched","resolve","_recursivelyFetch","_options","view","keys","detailKeys","reset","fetchFn","fetchFirst","fetchMore","defer","fail","reject","done","r","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","id","contains","model_class","copy","json","type","contentType","isString","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","collection","xhr","post","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","create","history_id","element_identifiers","wait","haveSearchDetails","has","attributes","matches","matchesWhat","Backbone","Collection","toString","length","HidSectionedHistoryContents","console","log","currentSection","sectionsFetched","_getLastHid","_mapSectionRanges","mapFn","sectionCount","_countSections","sectionNumbers","range","sectionNumber","_getSectionRange","number","Math","floor","hidsPerSection","_lastFullSection","count","hasNonFullSection","lastHid","last","_filterCurrentSectionCollection","_filterSectionCollection","section","subcollection","descending","index","at","push","fetchSection","when","silent","hid-ge","max","hid-le","sort"],"mappings":"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"}
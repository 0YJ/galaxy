{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","PaginatedCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","validationError","limitPerPage","limitPerProgressiveFetch","order","urlRoot","Galaxy","root","url","this","historyId","initialize","models","prototype","call","history","setHistoryId","includeDeleted","includeHidden","idAttribute","newId","_setUpWebStorage","storage","HistoryPrefs","id","historyStorageKey","trigger","on","include-deleted","newVal","include-hidden","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filter","c","inReadyState","runningAndActive","get","getByHid","findWhere","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","result","setIncludeHidden","fetch","details","prefs","toJSON","isEmpty","expandedIds","values","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","getTotalItemCount","contentsShown","fetchUpdated","since","remove","update_time-ge","toISOString","fetchDeleted","self","undefined","always","fetchHidden","fetchAllDetails","detailsFlag","data","fetchCollectionCounts","keys","_filterAndUpdate","filterParams","updateWhat","updateArgs","then","fetched","reduce","modelArray","currJson","ajaxQueue","ajaxFn","args","collection","AjaxQueue","slice","reverse","map","content","fn","isString","apply","start","progressivelyFetchDetails","_recursivelyFetch","offset","_options","view","detailKeys","limit","reset","defer","fail","deferred","reject","done","response","notify","length","allFetched","resolve","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","contains","model_class","copy","json","type","contentType","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","xhr","post","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","history_id","element_identifiers","save","haveSearchDetails","has","attributes","matches","matchesWhat","Backbone","Collection","toString"],"mappings":"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"}
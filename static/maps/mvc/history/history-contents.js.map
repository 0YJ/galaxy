{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","ControlledFetchCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","validationError","limitOnFirstFetch","limitPerFetch","order","initialize","models","prototype","call","this","history","historyId","idAttribute","includeDeleted","includeHidden","on","console","log","urlRoot","Galaxy","root","url","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filterFn","c","inReadyState","filter","getByHid","first","content","get","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","trigger","setIncludeHidden","fetch","details","prefs","HistoryPrefs","toJSON","values","expandedIds","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","fetchUpdated","since","remove","update_time-ge","toISOString","fetchDeleted","self","undefined","always","fetchHidden","fetchAllDetails","detailsFlag","data","ajaxQueue","ajaxFn","queue","AjaxQueue","chain","reverse","map","start","deferred","limitPerProgressiveFetch","progressivelyFetchDetails","_notifyAndContinue","response","offset","notify","limit","allFetched","resolve","_recursivelyFetch","_options","view","keys","detailKeys","reset","fetchFn","fetchFirst","fetchMore","defer","fail","reject","done","r","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","id","contains","model_class","copy","json","type","contentType","isString","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","collection","xhr","post","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","create","history_id","element_identifiers","wait","haveSearchDetails","has","attributes","matches","matchesWhat","Backbone","Collection","toString","length","HidSectionedHistoryContents","currentSection","sectionsFetched","_getLastHid","_mapSectionRanges","mapFn","sectionCount","_countSections","sectionNumbers","range","sectionNumber","_getSectionRange","number","Math","max","floor","hidsPerSection","_lastSection","_lastFullSection","count","hasNonFullSection","lastHid","last","_filterSectionCollection","section","_sectionCollection","descending","subcollection","startingIndex","_indexOfHid","index","at","push","_indexOfHidInModelArray","modelArray","test","otherHid","result","_binarySearch","low","high","testFn","mid","_indexOfHidInSection","lastSection","pastEndOfClosedSection","_getCurrentSectionRange","_filterCurrentSectionCollection","silent","fetchSection","bypassCache","when","hid-ge","hid-le","sort","fetchDeletedInSection"],"mappings":"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"}
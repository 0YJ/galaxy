{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","contentsShown","contentsActive","shown","active","includeDeleted","includeHidden","hidden","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","setHistoryId","fetchContents","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
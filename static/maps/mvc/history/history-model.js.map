{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","contentsShown","contentsActive","shown","active","includeDeleted","includeHidden","hidden","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","allFetched","fetchUpdated","done","response","status","xhr","serverResponseDatetime","Date","getResponseHeader","err","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","setHistoryId","fetchContents","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"AACAA,QACI,+BACA,kCACA,uCACA,cACA,eACA,sBACD,SAAUC,EAAkBC,EAAeC,EAA6BC,EAAOC,GAClF,YAQA,IAAIC,GAAUC,SAASC,MACdC,OAAQJ,EAASK,eACjBD,OAAQJ,EAASM,MAAON,EAASO,sBACtCC,cAAgB,UAGhBC,aAAe,IAGfC,UACIC,YAAkB,UAClBC,GAAkB,KAClBC,KAAkB,kBAClBC,MAAkB,MAElBC,SAAkB,EAClBC,mBACAC,oBAGJC,QAASC,OAAOC,KAAO,gBAOvBC,WAAa,SAAUC,EAAaC,GAChCA,EAAUA,MACVC,KAAKC,OAASF,EAAQE,QAAU,KAChCD,KAAKE,IAAKF,KAAO,eAAgBF,EAAaC,GAG9CC,KAAKG,SAAW,GAAI/B,GAAiBgC,oBACjCC,QAAcL,KACdM,UAAcN,KAAKO,IAAK,MACxBC,MAAcT,EAAQS,QAG1BR,KAAKS,kBACLT,KAAKU,4BAGLV,KAAKW,gBAAkB,MAM3BF,gBAAkB,WAEd,MAAOT,MAAKY,IACRC,MAAU,WACNb,KAAKc,sBAETC,YAAc,SAAUC,EAAOC,GACvBjB,KAAKG,WACLH,KAAKG,SAASG,UAAYW,OAO1CP,0BAA4B,WACxB,MAAKV,MAAKG,SAEHH,KAAKkB,SAAUlB,KAAKG,UACvBU,MAAU,WACNb,KAAKmB,QAAQC,MAAOpB,KAAMqB,OAAOC,UAAWC,eAJvBvB,MAWjCwB,cAAgB,WACZ,GAAIC,GAAiBzB,KAAKO,IAAK,mBAC3BmB,EAAQD,EAAeE,QAAU,CAGrC,OAFAD,IAAS1B,KAAKG,SAASyB,eAAgBH,EAAelC,QAAU,EAChEmC,GAAS1B,KAAKG,SAAS0B,cAAgBJ,EAAeK,OAAU,GAKpEC,UAAY,WACR,MAAOxD,GAAMyD,cAAehC,KAAKO,IAAK,SAAU,EAAM,IAI1D0B,OAAS,WACL,MAAOC,GAAEtD,OAAQF,SAASC,MAAMwD,UAAUF,OAAOG,KAAMpC,OACnD+B,UAAY/B,KAAK+B,eAKzBxB,IAAM,SAAU8B,GACZ,MAAY,cAARA,EACOrC,KAAK+B,YAETrD,SAASC,MAAMwD,UAAU5B,IAAIa,MAAOpB,KAAMuB,YAOrDe,gBAAkB,WAEd,MAAK3C,SAAWA,OAAO4C,KAInB5C,OAAO4C,KAAKC,eAAiB7C,OAAO4C,KAAKnD,KAAOY,KAAKO,IAAK,YACnD,GAEJ,GANI,GAUfkC,oBAAsB,WAClB,GAAIC,GAAmB1C,KAAKO,IAAK,iBACjC,OAAOmC,GAAkBA,EAAiBC,OAAS,GAIvDC,6BAA+B,WAC3B,MAAO5C,MAAKG,SAAS0C,mBAAmBF,QAAU,GAKtDG,kBACI,OAAQ,aAAc,QAI1BC,eACIC,MAAc,OACdC,IAAc,QAIlBC,+BAAiC,WAC7B,GAAIC,IAAwB,OAAQ,iBAAkB,kBAAmB,cACzE,OAAOnD,MAAKoD,OAAQC,KAAOC,EAAEC,OAAQC,KAAOL,EAAoBM,KAAM,UAI1EC,QAAU,SAAU3D,GAEhBA,EAAUA,KACV,IAAI4D,GAAO3D,KAGP4D,EAAiBD,EAAKC,cAI1B,OAFA5D,MAAKG,SAAS0D,YAAa,EAEpBF,EAAKxD,SAAS2D,aAAcF,GAC9BG,KAAM,SAAUC,EAAUC,EAAQC,GAC/B,GAAIC,EACJ,KACIA,EAAyB,GAAIC,MAAMF,EAAIG,kBAAmB,SAC5D,MAAOC,IACTX,EAAKC,eAAiBO,GAA0B,GAAIC,MACpDT,EAAKY,gBAAiBxE,MAKlCwE,gBAAkB,SAAUxE,GAOxB,QAASyE,KAELb,EAAK7C,qBACL6C,EAAKhD,gBAAkB8D,WAAY,WAC/Bd,EAAKD,QAAS3D,IACf2E,GAVP3E,EAAUA,KACV,IAAI2E,GAAQ1E,KAAKf,aACb0E,EAAO3D,IACX,IAAK2D,EAAKvE,GAAV,CAWA,GAAIuF,GAAuB3E,KAAK4C,8BAE5B+B,GAAuB,EACvBH,IAMAb,EAAKT,iCACAa,KAAM,WAECJ,EAAKlB,sBAAwB,EAC7B+B,IAIAb,EAAKxC,QAAS,aAOlCL,mBAAqB,WACbd,KAAKW,kBACLiE,aAAc5E,KAAKW,iBACnBX,KAAKW,gBAAkB,OAM/BkE,MAAQ,SAAUb,EAAUjE,GACxB,GAAI+E,GAASpG,SAASC,MAAMwD,UAAU0C,MAAMzC,KAAMpC,KAAMgE,EAAUjE,EAOlE,OANI+E,GAAOC,cACPD,EAAOC,YAAc,GAAIX,MAAMU,EAAOC,cAEtCD,EAAOE,cACPF,EAAOE,YAAc,GAAIZ,MAAMU,EAAOE,cAEnCF,GAIXG,kBAAoB,SAAUlF,EAASmF,GACnCnF,EAAUA,KACV,IAAI4D,GAAO3D,IAOX,OAHAD,GAAQoF,KAAO,eAGRnF,KAAKoD,MAAOrD,GAAUqF,KAAM,SAAsB/E,GAGrD,MAFAsD,GAAKxD,SAASE,QAAUsD,EACxBA,EAAKxD,SAASkF,aAAchF,EAAQjB,IAC7BuE,EAAK2B,cAAeJ,MAKnCI,cAAgB,SAAUvF,GACtBA,EAAUA,KACV,IAAI4D,GAAO3D,IAIX,OADA2D,GAAKC,eAAiB,GAAIQ,MACnBT,EAAKxD,SAASoF,WAAYxF,IAIrCyF,QAAU,SAAUzF,GAChB,MAAIC,MAAKO,IAAK,WAAsBc,OAAOoE,OACpCzF,KAAK0F,MAAQnG,SAAS,GAAQQ,IAGzC4F,MAAQ,SAAU5F,GACd,MAAIC,MAAKO,IAAK,UAAqBc,OAAOoE,OACnCzF,KAAK0F,MAAQnG,SAAS,EAAMqG,QAAQ,GAAQ7F,IAGvD8F,SAAW,SAAU9F,GACjB,MAAKC,MAAKO,IAAK,WACRP,KAAK0F,MAAQnG,SAAS,GAASQ,GADDsB,OAAOoE,QAUhDK,KAAO,SAAUC,EAAS1G,EAAM2G,GAE5B,GADAD,EAAwBE,SAAZF,EAAwB,GAAY,GAC3C/F,KAAKZ,GACN,KAAM,IAAI8G,OAAO,iDAGrB,IAAIC,IAAaC,WAAcpG,KAAKZ,GAChC2G,KACAI,EAASJ,SAAU,GAEnB1G,IACA8G,EAAS9G,KAAOA,GAEf2G,IACDG,EAASE,cAAe,GAE5BF,EAAShB,KAAO,cAEhB,IAAI9E,GAAUL,KACV8F,EAAOzE,OAAOiF,KAAMtG,KAAKN,QAASyG,EAEtC,OAAIJ,GACOD,EAAKS,KAAM,SAAUvC,GACxB,GAAIwC,GAAa,GAAI/H,GAASuF,EAC9B,OAAOwC,GAAWC,eACb1C,KAAM,WACH1D,EAAQc,QAAS,SAAUd,EAAS2D,OAI7C8B,EAAK/B,KAAM,SAAUC,GACxB3D,EAAQc,QAAS,SAAUd,EAAS2D,MAI5CyC,aAAe,WACX,GAAIpG,GAAUL,KACVkE,EAAM7C,OAAOqF,QAAS/G,OAAOC,KAAO,6BAA+BI,KAAKZ,GAK5E,OAHA8E,GAAIH,KAAM,WACN1D,EAAQc,QAAS,iBAAkBd,KAEhC6D,GAIXyC,SAAW,WACP,MAAO,WAAa3G,KAAKO,IAAK,MAAS,IAAMP,KAAKO,IAAK,QAAW,QAMtEqG,EAAmBtI,EAA4BuI,8BAK/CC,EAAoBF,EAAiBhI,OAAQJ,EAASK,eAAgBD,QACtEI,cAAsB,UAEtBgC,MAAsBvC,EAEtB+B,MAAsB,cAEtBuG,kBAAsB,GAEtBC,cAAsB,GAEtBnH,WAAa,SAAUoH,EAAQlH,GAC3BA,EAAUA,MACVC,KAAKE,IAAK,+BAAgC+G,EAAQlH,GAClD6G,EAAiBzE,UAAUtC,WAAWuC,KAAMpC,KAAMiH,EAAQlH,GAG1DC,KAAK4B,eAAiB7B,EAAQ6B,iBAAkB,EAGhD5B,KAAKkH,iBAAmBnH,EAAQmH,iBAEhClH,KAAKmH,kBAKTzH,QAAUC,OAAOC,KAAO,gBAExBwH,IAAU,WAAY,MAAOpH,MAAKN,SAGlCyH,eAAiB,WACb,MAAOnH,MAAKY,IAERyG,iBAAmB,SAAUhH,GAEzBL,KAAKsH,MAAO,iBAAkBtH,KAAK4B,eAAgBvB,EAAQE,IAAK,aAC3DP,KAAK4B,gBAAkBvB,EAAQE,IAAK,YACrCP,KAAKuH,OAAQlH,IAIrBmH,OAAW,SAAUC,EAAUC,GAC3B1H,KAAK2H,WAAY,GAAIlJ,GAASiJ,QAGlCE,iBAAmB,SAAUvH,GACzB,GAAIwH,GAAe7H,KAAKkH,gBACxBlH,MAAKmB,QAAS,oBAAqB0G,GACnC7H,KAAKkH,iBAAmB7G,EAAQjB,OAM5C0I,gBAAkB,SAAU/H,GACxB,MAAOmC,GAAEtD,OAAQgI,EAAiBzE,UAAU2F,gBAAgB1F,KAAMpC,KAAMD,IACpEoF,KAAO,kBAKf4C,mBAAqB,SAAUhI,GAC3B,GAAIiI,GAAepB,EAAiBzE,UAAU4F,mBAAmB3F,KAAMpC,KAAMD,OACzEkI,IASJ,OARKjI,MAAK4B,eAMNqG,EAAQ1I,QAAU,MALlB0I,EAAQ1I,SAAU,EAClB0I,EAAQrC,QAAS,GAMd1D,EAAEhD,SAAU8I,EAAcC,IAIrCC,YAAchG,EAAEtD,OAAQsD,EAAEiG,MAAOvB,EAAiBzE,UAAU+F,cACxD7I,KAAeb,EAAS4J,gBAAiB,QAAUC,WAAW,IAC9DC,WAAe9J,EAAS4J,gBAAiB,QAAUC,WAAW,IAC9DE,KAAe/J,EAAS4J,gBAAiB,QAAUC,WAAW,IAC9DG,WAAehK,EAAS4J,gBAAiB,QAAUC,WAAW,MAIlEI,KAAO,SAAU1I,GACbA,EAAUA,KACV,IAAI2I,GAAS3I,EAAQ2I,OACjBC,EAAiB3I,KAAKuH,OAAQvH,KAAKO,IAAKP,KAAKkH,kBAMjD,OALAN,GAAiBzE,UAAUsG,KAAKrG,KAAMpC,KAAMkC,EAAEhD,UAAWwJ,QAAQ,GAAQ3I,IACzEC,KAAK4I,QAASD,GAAkBD,QAAQ,IACnCA,GACD1I,KAAKmB,QAAS,OAAQnB,KAAMD,GAEzBC,MAIX6I,OAAS,SAAiBxF,EAAMyF,EAAMC,GAElC,GAAIC,GAAahJ,KACbkE,EAAM7C,OAAOqF,QAAS/G,OAAOC,KAAO,6BACxC,OAAOsE,GAAIH,KAAM,SAAU2D,GACvBsB,EAAWrB,WAAY,GAAIlJ,GAASiJ,KAAaqB,WAQzDpB,WAAa,SAAUtH,EAASN,GAQ5B,MAPAA,GAAUA,MAEVC,KAAK4I,QAASvI,EAASN,GACvBC,KAAKkH,iBAAmB7G,EAAQE,IAAK,MAChCR,EAAQ2I,QACT1I,KAAKmB,QAAS,cAAed,EAASL,MAEnCA,MAGX2G,SAAU,WACN,MAAO,qBAAuB3G,KAAK2C,OAAS,YAAc3C,KAAKkH,iBAAmB,MAM1F,QACIzI,QAAoBA,EACpBqI,kBAAoBA"}
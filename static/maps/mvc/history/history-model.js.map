{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","console","contents","HistoryContents","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","history","fetchContents","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","ControlledFetchCollection","HistoryCollection","models","setOrder","has","comparators","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","filters","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","currentHistory","unshift","silent","create","hdas","historyOptions","collection","reset"],"mappings":"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"}
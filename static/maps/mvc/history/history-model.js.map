{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","clearTimeout","fetchWithContents","contentsOptions","view","pipe","history","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","response","newHistory","setAsCurrent","xhr","getJSON","toString","HistoryCollection","ControlledFetchCollection","DEFAULT_ORDER","sortOrders","update_time","getter","h","asc","update_time-asc","name-dsc","size","size-asc","models","includeDeleted","setOrder","order","currentHistoryId","setUpListeners","url","_fetchDefaults","filters","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","sort","Collection","collection","sortOrder","isUndefined","comparator","a","b","create","hdas","historyOptions","unshift","silent","reset"],"mappings":"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"}
{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","fetchContents","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
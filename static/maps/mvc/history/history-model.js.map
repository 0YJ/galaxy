{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","contentsShown","contentsActive","shown","active","includeDeleted","includeHidden","hidden","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","allFetched","fetchUpdated","done","response","status","xhr","serverResponseDatetime","Date","getResponseHeader","err","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","then","setHistoryId","fetchContents","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","newHistory","setAsCurrent","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","console","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","fetchContents","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
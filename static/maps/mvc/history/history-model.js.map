{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","console","nonReadyContentCount","historyData","non_ready_jobs","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","history","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","reset","silent","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","ControlledFetchCollection","HistoryCollection","order","models","setOrder","has","comparators","currentHistoryId","info","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","filters","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
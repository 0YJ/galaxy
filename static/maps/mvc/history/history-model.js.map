{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","_l","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","contentsShown","contentsActive","shown","active","includeDeleted","includeHidden","hidden","nice_size","size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","searchAttributes","searchAliases","title","tag","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","allFetched","fetchUpdated","done","response","status","xhr","serverResponseDatetime","Date","getResponseHeader","err","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","then","setHistoryId","fetchContents","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","newHistory","setAsCurrent","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"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"}
{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","history","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","ControlledFetchCollection","HistoryCollection","order","models","setOrder","has","comparators","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","filters","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","currentHistory","unshift","silent","create","hdas","historyOptions","collection","reset"],"mappings":"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"}
{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","console","view","pipe","history","reset","silent","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","ControlledFetchCollection","HistoryCollection","order","models","includeDeleted","setOrder","has","comparators","currentHistoryId","info","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","filters","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"AACAA,QACI,+BACA,uCACA,cACA,eACA,sBACD,SAAUC,EAAkBC,EAA6BC,EAAOC,GACnE,YAQA,IAAIC,GAAUC,SAASC,MACdC,OAAQJ,EAASK,eACjBD,OAAQJ,EAASM,MAAON,EAASO,sBACtCC,cAAgB,UAGhBC,aAAe,IAGfC,UACIC,YAAkB,UAClBC,GAAkB,KAClBC,KAAkB,kBAClBC,MAAkB,MAElBC,SAAkB,EAClBC,mBAGJC,QAASC,OAAOC,KAAO,gBAQvBC,WAAa,SAAUC,EAAaC,EAAcC,GAC9CA,EAAUA,MACVC,KAAKC,OAASF,EAAQE,QAAU,KAChCD,KAAKE,IAAKF,KAAO,eAAgBH,EAAaC,EAAcC,GAG5DC,KAAKE,IAAK,6BAA8BJ,GACxCE,KAAKG,SAAW,GAAI9B,GAAiB+B,gBAAiBN,OAAsBO,UAAWL,KAAKM,IAAK,QAEjGN,KAAKO,kBACLP,KAAKQ,4BAGLR,KAAKS,gBAAkB,MAM3BF,gBAAkB,WAEd,MAAOP,MAAKU,IACRC,MAAU,WACNX,KAAKY,sBAETC,YAAc,SAAUC,EAAOC,GACvBf,KAAKG,WACLH,KAAKG,SAASE,UAAYU,OAO1CP,0BAA4B,WACxB,MAAKR,MAAKG,SAEHH,KAAKgB,SAAUhB,KAAKG,UACvBQ,MAAU,WACNX,KAAKiB,QAAQC,MAAOlB,KAAMmB,OAAOC,UAAWC,eAJvBrB,MAWjCsB,UAAY,WACR,MAAO/C,GAAMgD,cAAevB,KAAKM,IAAK,SAAU,EAAM,IAI1DkB,OAAS,WACL,MAAOC,GAAE7C,OAAQF,SAASC,MAAM+C,UAAUF,OAAOG,KAAM3B,OACnDsB,UAAYtB,KAAKsB,eAKzBhB,IAAM,SAAUsB,GACZ,MAAY,cAARA,EACO5B,KAAKsB,YAET5C,SAASC,MAAM+C,UAAUpB,IAAIY,MAAOlB,KAAMqB,YAOrDQ,gBAAkB,WAEd,MAAKnC,SAAWA,OAAOoC,KAInBpC,OAAOoC,KAAKC,eAAiBrC,OAAOoC,KAAK1C,KAAOY,KAAKM,IAAK,YACnD,GAEJ,GANI,GAUf0B,oBAAsB,WAClB,GAAIC,GAAmBjC,KAAKM,IAAK,iBACjC,OAAO2B,GAAkBA,EAAiBC,OAAS,GAIvDC,6BAA+B,WAC3B,GAAIhC,GAAWH,KAAKG,SAASiC,UAAUC,qBACvC,OAAOlC,GAAUA,EAAS+B,OAAS,GAKvCI,kBACI,OAAQ,aAAc,QAI1BC,eACIC,MAAc,OACdC,IAAc,QAIlBC,mBAAqB,WACjB,MAAO1C,MAAK2C,OAAQC,KAAOC,EAAEC,OAAQC,KAAO,2BAIhDC,QAAU,SAAUjD,GAEhBA,EAAUA,KACV,IAAIkD,GAAOjD,KAGPkD,EAAiBD,EAAKC,cAK1B,OAJAD,GAAKC,eAAiB,GAAIC,MAG1BnD,KAAKG,SAASiD,YAAa,EACpBH,EAAK9C,SAASkD,aAAcH,GAC9BI,KAAM7B,EAAE8B,KAAMN,EAAKO,gBAAiBP,KAI7CO,gBAAkB,SAAUzD,GAOxB,QAAS0D,KAELR,EAAKrC,qBACLqC,EAAKxC,gBAAkBiD,WAAY,WAC/BT,EAAKD,QAASjD,IACf4D,GAVP5D,EAAUA,KACV,IAAI4D,GAAQ3D,KAAKf,aACbgE,EAAOjD,IACNiD,GAAK7D,KAWNY,KAAKmC,+BAAiC,EACtCsB,IAMAR,EAAKP,qBACAY,KAAM,WACCL,EAAKjB,sBAAwB,EAC7ByB,IAIAR,EAAKhC,QAAS,aAQlCL,mBAAqB,WACbZ,KAAKS,kBACLmD,aAAc5D,KAAKS,iBACnBT,KAAKS,gBAAkB,OAM/BoD,MAAQ,SAAUC,EAAU/D,GACxB,GAAIgE,GAASrF,SAASC,MAAM+C,UAAUmC,MAAMlC,KAAM3B,KAAM8D,EAAU/D,EAOlE,OANIgE,GAAOC,cACPD,EAAOC,YAAc,GAAIb,MAAMY,EAAOC,cAEtCD,EAAOE,cACPF,EAAOE,YAAc,GAAId,MAAMY,EAAOE,cAEnCF,GAIXG,kBAAoB,SAAUnE,EAASoE,GACnCC,QAAQlE,IAAKF,KAAO,sBAEpBD,EAAUA,MACVoE,EAAkBA,MAClBpE,EAAQsE,KAAO,SAEf,IAAIpB,GAAOjD,IAEX,OAAOA,MAAK2C,MAAO5C,GAAUuE,KAAM,SAAsBC,GAOrD,MANAtB,GAAK9C,SAASE,UAAYkE,EAAQnF,GAElC6D,EAAKC,eAAiB,GAAIC,MAE1BgB,EAAgBK,OAAQ,EACxBL,EAAgBM,QAAS,EAClBxB,EAAK9C,SAASwC,MAAOwB,MAOpCO,QAAU,SAAU3E,GAChB,MAAIC,MAAKM,IAAK,WAAsBa,OAAOwD,OACpC3E,KAAK4E,MAAQrF,SAAS,GAAQQ,IAGzC8E,MAAQ,SAAU9E,GACd,MAAIC,MAAKM,IAAK,UAAqBa,OAAOwD,OACnC3E,KAAK4E,MAAQrF,SAAS,EAAMuF,QAAQ,GAAQ/E,IAGvDgF,SAAW,SAAUhF,GACjB,MAAKC,MAAKM,IAAK,WACRN,KAAK4E,MAAQrF,SAAS,GAASQ,GADDoB,OAAOwD,QAUhDK,KAAO,SAAUC,EAAS5F,EAAM6F,GAE5B,GADAD,EAAwBE,SAAZF,EAAwB,GAAY,GAC3CjF,KAAKZ,GACN,KAAM,IAAIgG,OAAO,iDAGrB,IAAIC,IAAaC,WAActF,KAAKZ,GAChC6F,KACAI,EAASJ,SAAU,GAEnB5F,IACAgG,EAAShG,KAAOA,GAEf6F,IACDG,EAASE,cAAe,EAG5B,IAAIhB,GAAUvE,KACVgF,EAAO7D,OAAOqE,KAAMxF,KAAKP,QAAS4F,EAEtC,OAAIJ,GACOD,EAAKS,KAAM,SAAU3B,GACxB,GAAI4B,GAAa,GAAIjH,GAASqF,EAC9B,OAAO4B,GAAWC,eACbrC,KAAM,WACHiB,EAAQtD,QAAS,SAAUsD,EAAST,OAI7CkB,EAAK1B,KAAM,SAAUQ,GACxBS,EAAQtD,QAAS,SAAUsD,EAAST,MAI5C6B,aAAe,WACX,GAAIpB,GAAUvE,KACV4F,EAAMzE,OAAO0E,QAASnG,OAAOC,KAAO,6BAA+BK,KAAKZ,GAK5E,OAHAwG,GAAItC,KAAM,WACNiB,EAAQtD,QAAS,iBAAkBsD,KAEhCqB,GAIXE,SAAW,WACP,MAAO,WAAa9F,KAAKM,IAAK,MAAS,IAAMN,KAAKM,IAAK,QAAW,QAMtEyF,EAAmBzH,EAA4B0H,0BAK/CC,EAAoBF,EAAiBnH,OAAQJ,EAASK,eAAgBD,QACtEI,cAAgB,UAEhB8B,MAAUrC,EACVyH,MAAU,cAEVtG,WAAa,SAAUuG,EAAQpG,GAC3BA,EAAUA,MACVC,KAAKE,IAAK,+BAAgCiG,EAAQpG,GAGlDC,KAAKoG,eAAiBrG,EAAQqG,iBAAkB,EAEhDpG,KAAKqG,SAAU5E,EAAE6E,IAAKtG,KAAKuG,YAAaxG,EAAQmG,OAASnG,EAAQmG,MAAQlG,KAAKkG,OAG9ElG,KAAKwG,iBAAmBzG,EAAQyG,iBAEhCxG,KAAKU,GAAI,MAAO,WACbV,KAAKyG,KAAMzG,KAAO,WAAYqB,aAEjCrB,KAAK0G,kBAKTjH,QAAUC,OAAOC,KAAO,gBAExBgH,IAAU,WAAY,MAAO3G,MAAKP,SAGlCiH,eAAiB,WACb1G,KAAKU,IAEDkG,iBAAmB,SAAUrC,GAEzBvE,KAAK6G,MAAO,iBAAkB7G,KAAKoG,eAAgB7B,EAAQjE,IAAK,aAC3DN,KAAKoG,gBAAkB7B,EAAQjE,IAAK,YACrCN,KAAK8G,OAAQvC,IAIrBwC,OAAW,SAAUC,EAAUC,GAC3BjH,KAAKkH,WAAY,GAAIzI,GAASwI,QAGlCE,iBAAmB,SAAU5C,GACzB,GAAI6C,GAAepH,KAAKwG,gBACxBxG,MAAKiB,QAAS,oBAAqBmG,GACnCpH,KAAKwG,iBAAmBjC,EAAQnF,OAO5CiI,gBAAkB,SAAUtH,GACxB,GAAIb,IACAmF,KAAU,WAETrE,MAAKoG,iBACNlH,EAASoI,SACL/H,SAAU,EACVuF,QAAU,GAGlB,IAAIlC,GAAOmD,EAAiBrE,UAAU2F,gBAAgB1F,KAAM3B,KAAMD,EAClE,OAAO0B,GAAEvC,SAAU0D,EAAM1D,IAI7BqH,YAAc9E,EAAE7C,OAAQ6C,EAAE8F,MAAOxB,EAAiBrE,UAAU6E,cACxDlH,KAAeb,EAASgJ,gBAAiB,QAAUC,WAAW,IAC9DC,WAAelJ,EAASgJ,gBAAiB,QAAUC,WAAW,IAC9DE,KAAenJ,EAASgJ,gBAAiB,QAAUC,WAAW,IAC9DG,WAAepJ,EAASgJ,gBAAiB,QAAUC,WAAW,MAIlEI,KAAO,SAAU9H,GACb,GAAI+H,GAAiB9H,KAAK8G,OAAQ9G,KAAKM,IAAKN,KAAKwG,kBAGjD,OAFAT,GAAiBrE,UAAUmG,KAAKlG,KAAM3B,KAAMD,GAC5CC,KAAK+H,QAASD,GAAkBrD,QAAQ,IACjCzE,MAIXgI,OAAS,SAAiBpF,EAAMqF,EAAMC,GAElC,GAAIC,GAAanI,KACb4F,EAAMzE,OAAO0E,QAASnG,OAAOC,KAAO,6BACxC,OAAOiG,GAAItC,KAAM,SAAU2D,GACvBkB,EAAWjB,WAAY,GAAIzI,GAASwI,KAAaiB,WAQzDhB,WAAa,SAAU3C,EAASxE,GAQ5B,MAPAA,GAAUA,MAEVC,KAAK+H,QAASxD,EAASxE,GACvBC,KAAKwG,iBAAmBjC,EAAQjE,IAAK,MAChCP,EAAQ0E,QACTzE,KAAKiB,QAAS,cAAesD,EAASvE,MAEnCA,MAIXwE,MAAQ,SAAU2B,EAAQpG,GAEtB,MADAC,MAAKoD,YAAa,EACX2C,EAAiBrE,UAAU8C,MAAM7C,KAAM3B,KAAMmG,EAAQpG,IAGhE+F,SAAU,WACN,MAAO,qBAAuB9F,KAAKkC,OAAS,YAAclC,KAAKwG,iBAAmB,MAK1F,QACI/H,QAAoBA,EACpBwH,kBAAoBA"}
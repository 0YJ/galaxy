{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","UTILS","BASE_MVC","logNamespace","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","defaults","model_class","id","name","state","diskSize","deleted","urlRoot","galaxy_config","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","updateTimeoutId","on","model","xhr","msg","details","errorHandler","listenTo","trigger","apply","concat","jQuery","makeArray","arguments","newId","clearUpdateTimeout","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","Galaxy","currUser","isAnonymous","contentsCount","reduce","values","memo","num","searchAttributes","searchAliases","title","tag","checkForUpdates","onReadyCallback","running","length","setUpdateTimeout","isFunction","delay","UPDATE_DELAY","history","setTimeout","refresh","clearTimeout","detailIds","data","join","fetch","done","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","response","newHistory","setAsCurrent","getJSON","toString","getHistoryData","getHistory","ajax","isEmpty","historyData","empty","getContents","detailIdsFn","hdcaDetailIds","dataset_details","dataset_collection_details","df","Deferred","historyFn","contentsFn","historyXHR","json","notify","status","fail","reject","contentsXHR","resolve","ControlledFetchMixin","_buildFetchData","traditional","Collection","_fetchOptions","fetchDefaults","_fetchDefaults","pick","filters","has","_buildFetchFilters","filterMap","q","qv","each","v","k","push","HistoryCollection","namespaced","DEFAULT_ORDER","sortOrders","update_time","getter","h","Date","asc","update_time-asc","name-dsc","size","size-asc","models","includeDeleted","setOrder","order","currentHistoryId","allFetched","setUpListeners","window","url","view","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","sort","collection","sortOrder","isUndefined","comparator","a","b","fetchOptions","offset","limit","fetchData","numFetched","isArray","create","hdas","historyOptions","unshift","silent","reset"],"mappings":"AACAA,QACI,+BACA,cACA,eACA,sBACD,SAAUC,EAAkBC,EAAOC,GAEtC,GAAIC,GAAe,UAOfC,EAAUC,SAASC,MACdC,OAAQL,EAASM,eACjBD,OAAQL,EAASO,MAAOP,EAASQ,sBACtCC,cAAgBR,EAGhBS,UACIC,YAAkB,UAClBC,GAAkB,KAClBC,KAAkB,kBAClBC,MAAkB,MAElBC,SAAkB,EAClBC,SAAkB,GAItBC,QAASC,cAAcC,KAAO,gBAQ9BC,WAAa,SAAUC,EAAaC,EAAcC,GAC9CA,EAAUA,MACVC,KAAKC,OAASF,EAAQE,QAAU,KAChCD,KAAKE,IAAKF,KAAO,eAAgBH,EAAaC,EAAcC,GAG5DC,KAAKE,IAAK,6BAA8BJ,GACxCE,KAAKG,SAAW,GAAI7B,GAAiB8B,gBAAiBN,OAAsBO,UAAWL,KAAKM,IAAK,QAOjGN,KAAKO,kBAGLP,KAAKQ,gBAAkB,MAQ3BD,gBAAkB,WACdP,KAAKS,GAAI,QAAS,SAAUC,EAAOC,EAAKZ,EAASa,EAAKC,GAClDb,KAAKc,aAAcJ,EAAOC,EAAKZ,EAASa,EAAKC,KAI7Cb,KAAKG,UACLH,KAAKe,SAAUf,KAAKG,SAAU,QAAS,WACnCH,KAAKgB,QAAQC,MAAOjB,MAAQ,kBAAmBkB,OAAQC,OAAOC,UAAWC,eAIjFrB,KAAKS,GAAI,YAAa,SAAUC,EAAOY,GAC/BtB,KAAKG,WACLH,KAAKG,SAASE,UAAYiB,IAE/BtB,OAWPc,aAAe,WAEXd,KAAKuB,sBAITC,UAAY,WACR,MAAOjD,GAAMkD,cAAezB,KAAKM,IAAK,SAAU,EAAM,IAI1DoB,OAAS,WACL,MAAOC,GAAE9C,OAAQF,SAASC,MAAMgD,UAAUF,OAAOG,KAAM7B,OACnDwB,UAAYxB,KAAKwB,eAKzBlB,IAAM,SAAUwB,GACZ,MAAY,cAARA,EACO9B,KAAKwB,YAET7C,SAASC,MAAMgD,UAAUtB,IAAIW,MAAOjB,KAAMqB,YAOrDU,gBAAkB,WAEd,MAAKC,SAAWA,OAAOC,SAInBD,OAAOC,SAASC,eAAiBF,OAAOC,SAAS7C,KAAOY,KAAKM,IAAK,YAC3D,GAEJ,GANI,GAUf6B,cAAgB,WACZ,MAAOR,GAAES,OAAQT,EAAEU,OAAQrC,KAAKM,IAAK,kBAAqB,SAAUgC,EAAMC,GAAO,MAAOD,GAAOC,GAAQ,IAK3GC,kBACI,OAAQ,aAAc,QAI1BC,eACIC,MAAc,OACdC,IAAc,QASlBC,gBAAkB,SAAUC,GAcxB,MATI7C,MAAKG,SAAS2C,UAAUC,OACxB/C,KAAKgD,oBAGLhD,KAAKgB,QAAS,SACVW,EAAEsB,WAAYJ,IACdA,EAAgBhB,KAAM7B,OAGvBA,MAIXgD,iBAAmB,SAAUE,GACzBA,EAAQA,GAASxE,EAAQyE,YACzB,IAAIC,GAAUpD,IAOd,OAJAA,MAAKuB,qBACLvB,KAAKQ,gBAAkB6C,WAAY,WAC/BD,EAAQE,WACTJ,GACIlD,KAAKQ,iBAIhBe,mBAAqB,WACbvB,KAAKQ,kBACL+C,aAAcvD,KAAKQ,iBACnBR,KAAKQ,gBAAkB,OAS/B8C,QAAU,SAAUE,EAAWzD,GAE3ByD,EAAYA,MACZzD,EAAUA,KACV,IAAIqD,GAAUpD,IAGdD,GAAQ0D,KAAO1D,EAAQ0D,SACnBD,EAAUT,SACVhD,EAAQ0D,KAAK5C,QAAU2C,EAAUE,KAAM,KAE3C,IAAI/C,GAAMX,KAAKG,SAASwD,MAAO5D,EAO/B,OANAY,GAAIiD,KAAM,WACNR,EAAQR,gBAAiB,WAErB5C,KAAK2D,YAGNhD,GAKXkD,QAAU,SAAU9D,GAChB,MAAIC,MAAKM,IAAK,WAAsBa,OAAO2C,OACpC9D,KAAK+D,MAAQvE,SAAS,GAAQO,IAGzCiE,MAAQ,SAAUjE,GACd,MAAIC,MAAKM,IAAK,UAAqBa,OAAO2C,OACnC9D,KAAK+D,MAAQvE,SAAS,EAAMyE,QAAQ,GAAQlE,IAGvDmE,SAAW,SAAUnE,GACjB,MAAKC,MAAKM,IAAK,WACRN,KAAK+D,MAAQvE,SAAS,GAASO,GADDoB,OAAO2C,QAUhDK,KAAO,SAAUC,EAAS/E,EAAMgF,GAE5B,GADAD,EAAwBE,SAAZF,EAAwB,GAAY,GAC3CpE,KAAKZ,GACN,KAAM,IAAImF,OAAO,iDAGrB,IAAIC,IAAaC,WAAczE,KAAKZ,GAChCgF,KACAI,EAASJ,SAAU,GAEnB/E,IACAmF,EAASnF,KAAOA,GAEfgF,IACDG,EAASE,cAAe,EAG5B,IAAItB,GAAUpD,KACVmE,EAAOhD,OAAOwD,KAAM3E,KAAKP,QAAS+E,EAEtC,OAAIJ,GACOD,EAAKS,KAAM,SAAUC,GACxB,GAAIC,GAAa,GAAIpG,GAASmG,EAC9B,OAAOC,GAAWC,eACbnB,KAAM,WACHR,EAAQpC,QAAS,SAAUoC,EAASyB,OAI7CV,EAAKP,KAAM,SAAUiB,GACxBzB,EAAQpC,QAAS,SAAUoC,EAASyB,MAI5CE,aAAe,WACX,GAAI3B,GAAUpD,KACVW,EAAMQ,OAAO6D,QAAStF,cAAcC,KAAO,6BAA+BK,KAAKZ,GAKnF,OAHAuB,GAAIiD,KAAM,WACNR,EAAQpC,QAAS,iBAAkBoC,KAEhCzC,GAIXsE,SAAW,WACP,MAAO,WAAajF,KAAKM,IAAK,MAAS,IAAMN,KAAKM,IAAK,QAAW,OAQ1E5B,GAAQyE,aAAe,IAGvBzE,EAAQwG,eAAiB,SAAyB7E,EAAWN,GASzD,QAASoF,KAEL,MAAkB,YAAd9E,EACOc,OAAO6D,QAAStF,cAAcC,KAAO,gCAEzCwB,OAAOiE,KAAM1F,cAAcC,KAAO,iBAAmBU,GAEhE,QAASgF,GAASC,GAEd,MAAOA,IAAeA,EAAYC,MAEtC,QAASC,GAAaF,GAGlB,GAAID,EAASC,GAAiB,QAE1B3D,GAAEsB,WAAYwC,KACdA,EAAcA,EAAaH,IAE3B3D,EAAEsB,WAAYyC,KACdA,EAAgBA,EAAeJ,GAEnC,IAAI7B,KASJ,OARIgC,GAAY1C,SACZU,EAAKkC,gBAAkBF,EAAY/B,KAAM,MAEzCgC,EAAc3C,SAGdU,EAAKmC,2BAA6BF,EAAchC,KAAM,MAEnDvC,OAAOiE,KAAM1F,cAAcC,KAAO,iBAAmB2F,EAAYlG,GAAK,aAAeqE,KAAMA,IAvCtG1D,EAAUA,KACV,IAAI0F,GAAc1F,EAAQ0F,gBACtBC,EAAgB3F,EAAQ2F,kBAGxBG,EAAK1E,OAAO2E,WACZjG,EAAc,KAuCdkG,EAAYhG,EAAQgG,WAAaZ,EACjCa,EAAajG,EAAQiG,YAAcR,EAGnCS,EAAaF,EAAW1F,EAC5B4F,GAAWrC,KAAM,SAAUsC,GAEvBrG,EAAcqG,EACdL,EAAGM,QAASC,OAAQ,yBAA0BvG,YAAaA,MAE/DoG,EAAWI,KAAM,SAAU1F,GAEvBkF,EAAGS,OAAQ3F,EAAK,wBAGpB,IAAI4F,GAAcN,EAAWrB,KAAMoB,EAWnC,OAVAO,GAAY3B,KAAM,SAAU9E,GACxB+F,EAAGM,QAASC,OAAQ,0BAA2BvG,YAAaA,EAAaC,aAAcA,IAEvF+F,EAAGW,QAAS3G,EAAaC,KAE7ByG,EAAYF,KAAM,SAAU1F,GAExBkF,EAAGS,OAAQ3F,EAAK,wBAA0ByC,QAASvD,MAGhDgG,EAKX,IAAIY,IAGA9C,MAAQ,SAAU5D,GAKd,MAJAA,GAAUA,MACVA,EAAQ0D,KAAO1D,EAAQ0D,MAAQzD,KAAK0G,gBAAiB3G,GAErDA,EAAQ4G,aAAc,EACfhI,SAASiI,WAAWhF,UAAU+B,MAAM9B,KAAM7B,KAAMD,IAI3D8G,eAEI,QAEA,QAEA,SAEA,OAEA,QAIJH,gBAAkB,SAAU3G,GACxB,GAAI0D,MACAqD,EAAgB9G,KAAK+G,gBACzBhH,GAAU4B,EAAEzC,SAAUa,MAAe+G,GACrCrD,EAAO9B,EAAEqF,KAAMjH,EAASC,KAAK6G,cAE7B,IAAII,GAAUtF,EAAEuF,IAAKnH,EAAS,WAAaA,EAAQkH,QAAYH,EAAcG,WAI7E,OAHKtF,GAAE0D,QAAS4B,IACZtF,EAAE9C,OAAQ4E,EAAMzD,KAAKmH,mBAAoBF,IAEtCxD,GAIXsD,eAAiB,WAEb,UAIJI,mBAAqB,SAAUF,GAC3B,GAAIG,IACAC,KACAC,MAQJ,OANA3F,GAAE4F,KAAMN,EAAS,SAAUO,EAAGC,GACtBD,KAAM,IAAQA,EAAI,QAClBA,KAAM,IAASA,EAAI,SACvBJ,EAAUC,EAAEK,KAAMD,GAClBL,EAAUE,GAAGI,KAAMF,KAEhBJ,IAQXO,EAAoBhJ,SAASiI,WACxB/H,OAAQL,EAASM,cAAc8I,WAAYnJ,IAC3CI,OAAQ4H,GACR5H,QACLI,cAAgBR,EAEhBiC,MAAUhC,EAGVmJ,cAAgB,cAKhBC,YACIC,aACIC,OAAS,SAAUC,GAAK,MAAO,IAAIC,MAAMD,EAAE3H,IAAK,iBAChD6H,KAAM,GAEVC,mBACIJ,OAAS,SAAUC,GAAK,MAAO,IAAIC,MAAMD,EAAE3H,IAAK,iBAChD6H,KAAM,GAEV9I,MACI2I,OAAS,SAAUC,GAAK,MAAOA,GAAE3H,IAAK,SACtC6H,KAAM,GAEVE,YACIL,OAAS,SAAUC,GAAK,MAAOA,GAAE3H,IAAK,SACtC6H,KAAM,GAEVG,MACIN,OAAS,SAAUC,GAAK,MAAOA,GAAE3H,IAAK,SACtC6H,KAAM,GAEVI,YACIP,OAAS,SAAUC,GAAK,MAAOA,GAAE3H,IAAK,SACtC6H,KAAM,IAIdvI,WAAa,SAAU4I,EAAQzI,GAC3BA,EAAUA,MACVC,KAAKE,IAAK,+BAAgCmB,WAI1CrB,KAAKyI,eAAiB1I,EAAQ0I,iBAAkB,EAEhDzI,KAAK0I,SAAU3I,EAAQ4I,OAAS3I,KAAK6H,eAErC7H,KAAK4I,iBAAmB7I,EAAQ6I,iBAEhC5I,KAAK6I,WAAa9I,EAAQ8I,aAAc,EAKxC7I,KAAK8I,kBAGTrJ,SAAYsJ,OAAOrJ,cAAeA,cAAcC,KAAO,KAAQ,gBAC/DqJ,IAAU,WAAY,MAAOhJ,MAAKP,SAGlCsH,eAAiB,WAEb,GAAI7H,IACAyJ,MAAU3I,KAAK2I,MACfM,KAAU,WAQd,OANKjJ,MAAKyI,iBACNvJ,EAAS+H,SACLzH,SAAU,EACVyE,QAAU,IAGX/E,GAIX4J,eAAiB,WACb9I,KAAKS,IAEDyI,iBAAmB,SAAU9F,GAEzBpD,KAAKmJ,MAAO,iBAAkBnJ,KAAKyI,eAAgBrF,EAAQ9C,IAAK,aAC3DN,KAAKyI,gBAAkBrF,EAAQ9C,IAAK,YACrCN,KAAKoJ,OAAQhG,IAIrBiG,OAAW,SAAUC,EAAUC,GAC3BvJ,KAAKwJ,WAAY,GAAI9K,GAAS6K,QAGlCE,iBAAmB,SAAUrG,GACzB,GAAIsG,GAAe1J,KAAK4I,gBACxB5I,MAAKgB,QAAS,oBAAqB0I,GACnC1J,KAAK4I,iBAAmBxF,EAAQhE,KAErCY,OAIP2J,KAAO,SAAU5J,GAGb,MAFAA,GAAUA,MACVC,KAAK0I,SAAU3I,EAAQ4I,OAChBhK,SAASiI,WAAWhF,UAAU+H,KAAK9H,KAAM7B,KAAMD,IAM1D2I,SAAW,SAAUC,GACjB,GAAIiB,GAAa5J,KACb6J,EAAY7J,KAAK8H,WAAYa,EACjC,KAAIhH,EAAEmI,YAAaD,GAgBnB,MAdAD,GAAWjB,MAAQA,EACnBiB,EAAWG,WAAa,SAAqBC,EAAGC,GAC5C,GAAIrB,GAAmBgB,EAAWhB,gBAElC,OAAIoB,GAAE5K,KAAOwJ,EAA2B,GACpCqB,EAAE7K,KAAOwJ,EAA2B,GAExCoB,EAAIH,EAAU7B,OAAQgC,GACtBC,EAAIJ,EAAU7B,OAAQiC,GACfJ,EAAU1B,IACT6B,IAAMC,EAAI,EAAQD,EAAIC,EAAK,EAAI,GAC/BD,IAAMC,EAAI,EAAQD,EAAIC,EAAI,GAAM,IAE5CL,EAAW5I,QAAS,gBAAiB4I,EAAWjB,MAAOiB,GAChDA,GAMXjG,MAAQ,SAAU5D,GAEd,GADAA,EAAUA,MACNC,KAAK6I,WAAc,MAAO1H,QAAO2C,QACrC,IAAI8F,GAAa5J,KACbkK,EAAevI,EAAEzC,SAAUa,GACvBqJ,QAAS,EACTe,OAASP,EAAW7G,QAAU,EAAK6G,EAAW7G,OAAS,EAAM,EAC7D4F,MAASiB,EAAWjB,QAExByB,EAAQrK,EAAQqK,KAKpB,OAJKzI,GAAEmI,YAAaM,KAChBF,EAAaE,MAAQA,GAGlB3D,EAAqB9C,MAAM9B,KAAM7B,KAAMkK,GACzCtG,KAAM,SAAyByG,GAC5B,GAAIC,GAAa3I,EAAE4I,QAASF,GAAaA,EAAUtH,OAAS,IAEvDqH,GAAsBA,EAAbE,KACVV,EAAWf,YAAa,EACxBe,EAAW5I,QAAS,cAAe4I,OAOnDY,OAAS,SAAiB/G,EAAMgH,EAAMC,GAElC,GAAId,GAAa5J,KACbW,EAAMQ,OAAO6D,QAAStF,cAAcC,KAAO,6BAC/C,OAAOgB,GAAIiD,KAAM,SAAU2F,GACvBK,EAAWJ,WAAY,GAAI9K,GAAS6K,KAAamB,WAQzDlB,WAAa,SAAUpG,EAASrD,GAQ5B,MAPAA,GAAUA,MAEVC,KAAK2K,QAASvH,EAASrD,GACvBC,KAAK4I,iBAAmBxF,EAAQ9C,IAAK,MAChCP,EAAQ6K,QACT5K,KAAKgB,QAAS,cAAeoC,EAASpD,MAEnCA,MAIX6K,MAAQ,SAAUrC,EAAQzI,GAEtB,MADAC,MAAK6I,YAAa,EACXlK,SAASiI,WAAWhF,UAAUiJ,MAAMhJ,KAAM7B,KAAMwI,EAAQzI,IAGnEkF,SAAU,WACN,MAAO,qBAAuBjF,KAAK+C,OAAS,MAKpD,QACIrE,QAAoBA,EACpBiJ,kBAAoBA"}
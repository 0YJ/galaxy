{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_shown","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","history","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","ControlledFetchCollection","HistoryCollection","order","models","includeDeleted","setOrder","has","comparators","currentHistoryId","info","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","filters","clone","buildComparator","name-dsc","size","size-asc","sort","currentHistory","unshift","silent","create","hdas","historyOptions","collection","reset"],"mappings":"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"}
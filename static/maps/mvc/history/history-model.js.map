{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","clearUpdateTimeout","change:id","model","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","running","visibleAndUndeleted","searchAttributes","searchAliases","title","tag","_getSizeAndRunning","fetch","data","$","param","keys","refresh","self","lastUpdateTime","Date","allFetched","fetchUpdated","done","bind","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","clearTimeout","parse","response","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","pipe","fetchContents","prefs","HistoryPrefs","includeDeleted","show_deleted","includeHidden","show_hidden","fetchFirst","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","then","newHistory","setAsCurrent","xhr","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","comparators","clone","buildComparator","ascending","name-dsc","size","size-asc","sort","silent","currentHistory","unshift","create","hdas","historyOptions","collection"],"mappings":"AACAA,QACI,+BACA,kCACA,uCACA,cACA,eACA,sBACD,SAAUC,EAAkBC,EAAeC,EAA6BC,EAAOC,GAClF,YAQA,IAAIC,GAAUC,SAASC,MACdC,OAAQJ,EAASK,eACjBD,OAAQJ,EAASM,MAAON,EAASO,sBACtCC,cAAgB,UAGhBC,aAAe,IAGfC,UACIC,YAAkB,UAClBC,GAAkB,KAClBC,KAAkB,kBAClBC,MAAkB,MAElBC,SAAkB,EAClBC,mBACAC,oBAGJC,QAASC,OAAOC,KAAO,gBAQvBC,WAAa,SAAUC,EAAaC,EAAcC,GAC9CA,EAAUA,MACVC,KAAKC,OAASF,EAAQE,QAAU,KAChCD,KAAKE,IAAKF,KAAO,eAAgBH,EAAaC,EAAcC,GAG5DC,KAAKG,SAAW,GAAIhC,GAAiBiC,gBAAiBN,OAClDO,QAAcL,KACdM,UAAcN,KAAKO,IAAK,MACxBC,MAAcT,EAAQS,QAG1BR,KAAKS,kBACLT,KAAKU,4BAGLV,KAAKW,gBAAkB,MAM3BF,gBAAkB,WAEd,MAAOT,MAAKY,IACRC,MAAU,WACNb,KAAKc,sBAETC,YAAc,SAAUC,EAAOC,GACvBjB,KAAKG,WACLH,KAAKG,SAASG,UAAYW,OAO1CP,0BAA4B,WACxB,MAAKV,MAAKG,SAEHH,KAAKkB,SAAUlB,KAAKG,UACvBU,MAAU,WACNb,KAAKmB,QAAQC,MAAOpB,KAAMqB,OAAOC,UAAWC,eAJvBvB,MAWjCwB,UAAY,WACR,MAAOlD,GAAMmD,cAAezB,KAAKO,IAAK,SAAU,EAAM,IAI1DmB,OAAS,WACL,MAAOC,GAAEhD,OAAQF,SAASC,MAAMkD,UAAUF,OAAOG,KAAM7B,OACnDwB,UAAYxB,KAAKwB,eAKzBjB,IAAM,SAAUuB,GACZ,MAAY,cAARA,EACO9B,KAAKwB,YAET/C,SAASC,MAAMkD,UAAUrB,IAAIa,MAAOpB,KAAMuB,YAOrDQ,gBAAkB,WAEd,MAAKrC,SAAWA,OAAOsC,KAInBtC,OAAOsC,KAAKC,eAAiBvC,OAAOsC,KAAK7C,KAAOa,KAAKO,IAAK,YACnD,GAEJ,GANI,GAUf2B,oBAAsB,WAClB,GAAIC,GAAmBnC,KAAKO,IAAK,iBACjC,OAAO4B,GAAkBA,EAAiBC,OAAS,GAIvDC,6BAA+B,WAC3B,MAAOrC,MAAKG,SAASmC,UAAUC,sBAAsBH,QAAU,GAKnEI,kBACI,OAAQ,aAAc,QAI1BC,eACIC,MAAc,OACdC,IAAc,QAIlBC,mBAAqB,WACjB,MAAO5C,MAAK6C,OAAQC,KAAOC,EAAEC,OAAQC,KAAO,2BAIhDC,QAAU,SAAUnD,GAEhBA,EAAUA,KACV,IAAIoD,GAAOnD,KAGPoD,EAAiBD,EAAKC,cAK1B,OAJAD,GAAKC,eAAiB,GAAIC,MAG1BrD,KAAKG,SAASmD,YAAa,EACpBH,EAAKhD,SAASoD,aAAcH,GAC9BI,KAAM7B,EAAE8B,KAAMN,EAAKO,gBAAiBP,KAI7CO,gBAAkB,SAAU3D,GAOxB,QAAS4D,KAELR,EAAKrC,qBACLqC,EAAKxC,gBAAkBiD,WAAY,WAC/BT,EAAKD,QAASnD,IACf8D,GAVP9D,EAAUA,KACV,IAAI8D,GAAQ7D,KAAKhB,aACbmE,EAAOnD,IACX,IAAKmD,EAAKhE,GAAV,CAWA,GAAI2E,GAAuB9D,KAAKqC,8BAE5ByB,GAAuB,EACvBH,IAMAR,EAAKP,qBACAY,KAAM,WAECL,EAAKjB,sBAAwB,EAC7ByB,IAIAR,EAAKhC,QAAS,aAQlCL,mBAAqB,WACbd,KAAKW,kBACLoD,aAAc/D,KAAKW,iBACnBX,KAAKW,gBAAkB,OAM/BqD,MAAQ,SAAUC,EAAUlE,GACxB,GAAImE,GAASzF,SAASC,MAAMkD,UAAUoC,MAAMnC,KAAM7B,KAAMiE,EAAUlE,EAOlE,OANImE,GAAOC,cACPD,EAAOC,YAAc,GAAId,MAAMa,EAAOC,cAEtCD,EAAOE,cACPF,EAAOE,YAAc,GAAIf,MAAMa,EAAOE,cAEnCF,GAIXG,kBAAoB,SAAUtE,EAASuE,GACnCvE,EAAUA,KACV,IAAIoD,GAAOnD,IAOX,OAHAD,GAAQwE,KAAO,eAGRvE,KAAK6C,MAAO9C,GAAUyE,KAAM,SAAsBnE,GAGrD,MAFA8C,GAAKhD,SAASE,QAAU8C,EACxBA,EAAKhD,SAASG,UAAYD,EAAQlB,GAC3BgE,EAAKsB,cAAeH,MAKnCG,cAAgB,SAAU1E,GACtBA,EAAUA,KACV,IAAIoD,GAAOnD,KAGP0E,EAAQtG,EAAcuG,aAAapE,IAAK4C,EAAKhE,IAAKuC,QAMtD,OALAyB,GAAKhD,SAASyE,eAAiBF,EAAMG,aACrC1B,EAAKhD,SAAS2E,cAAgBJ,EAAMK,YAGpC5B,EAAKC,eAAiB,GAAIC,MACnBF,EAAKhD,SAAS6E,WAAYjF,IAIrCkF,QAAU,SAAUlF,GAChB,MAAIC,MAAKO,IAAK,WAAsBc,OAAO6D,OACpClF,KAAKmF,MAAQ7F,SAAS,GAAQS,IAGzCqF,MAAQ,SAAUrF,GACd,MAAIC,MAAKO,IAAK,UAAqBc,OAAO6D,OACnClF,KAAKmF,MAAQ7F,SAAS,EAAM+F,QAAQ,GAAQtF,IAGvDuF,SAAW,SAAUvF,GACjB,MAAKC,MAAKO,IAAK,WACRP,KAAKmF,MAAQ7F,SAAS,GAASS,GADDsB,OAAO6D,QAUhDK,KAAO,SAAUC,EAASpG,EAAMqG,GAE5B,GADAD,EAAwBE,SAAZF,EAAwB,GAAY,GAC3CxF,KAAKb,GACN,KAAM,IAAIwG,OAAO,iDAGrB,IAAIC,IAAaC,WAAc7F,KAAKb,GAChCqG,KACAI,EAASJ,SAAU,GAEnBpG,IACAwG,EAASxG,KAAOA,GAEfqG,IACDG,EAASE,cAAe,GAE5BF,EAASrB,KAAO,cAEhB,IAAIlE,GAAUL,KACVuF,EAAOlE,OAAO0E,KAAM/F,KAAKP,QAASmG,EAEtC,OAAIJ,GACOD,EAAKS,KAAM,SAAU/B,GACxB,GAAIgC,GAAa,GAAIzH,GAASyF,EAC9B,OAAOgC,GAAWC,eACb1C,KAAM,WACHnD,EAAQc,QAAS,SAAUd,EAAS4D,OAI7CsB,EAAK/B,KAAM,SAAUS,GACxB5D,EAAQc,QAAS,SAAUd,EAAS4D,MAI5CiC,aAAe,WACX,GAAI7F,GAAUL,KACVmG,EAAM9E,OAAO+E,QAAS1G,OAAOC,KAAO,6BAA+BK,KAAKb,GAK5E,OAHAgH,GAAI3C,KAAM,WACNnD,EAAQc,QAAS,iBAAkBd,KAEhC8F,GAIXE,SAAW,WACP,MAAO,WAAarG,KAAKO,IAAK,MAAS,IAAMP,KAAKO,IAAK,QAAW,QAMtE+F,EAAmBjI,EAA4BkI,8BAK/CC,EAAoBF,EAAiB3H,OAAQJ,EAASK,eAAgBD,QACtEI,cAAsB,UAEtBiC,MAAsBxC,EAEtBgC,MAAsB,cAEtBiG,kBAAsB,GAEtBC,cAAsB,GAEtB9G,WAAa,SAAU+G,EAAQ5G,GAC3BA,EAAUA,MACVC,KAAKE,IAAK,+BAAgCyG,EAAQ5G,GAClDuG,EAAiB1E,UAAUhC,WAAWiC,KAAM7B,KAAM2G,EAAQ5G,GAG1DC,KAAK4E,eAAiB7E,EAAQ6E,iBAAkB,EAGhD5E,KAAK4G,iBAAmB7G,EAAQ6G,iBAEhC5G,KAAK6G,kBAKTpH,QAAUC,OAAOC,KAAO,gBAExBmH,IAAU,WAAY,MAAO9G,MAAKP,SAGlCoH,eAAiB,WACb,MAAO7G,MAAKY,IAERmG,iBAAmB,SAAU1G,GAEzBL,KAAKgH,MAAO,iBAAkBhH,KAAK4E,eAAgBvE,EAAQE,IAAK,aAC3DP,KAAK4E,gBAAkBvE,EAAQE,IAAK,YACrCP,KAAKiH,OAAQ5G,IAIrB6G,OAAW,SAAUC,EAAUC,GAC3BpH,KAAKqH,WAAY,GAAI7I,GAAS4I,QAGlCE,iBAAmB,SAAUjH,GACzB,GAAIkH,GAAevH,KAAK4G,gBACxB5G,MAAKmB,QAAS,oBAAqBoG,GACnCvH,KAAK4G,iBAAmBvG,EAAQlB,OAM5CqI,gBAAkB,SAAUzH,GACxB,MAAO4B,GAAEhD,OAAQ2H,EAAiB1E,UAAU4F,gBAAgB3F,KAAM7B,KAAMD,IACpEwE,KAAO,kBAKfkD,mBAAqB,SAAU1H,GAC3B,GAAI2H,GAAepB,EAAiB1E,UAAU6F,mBAAmB5F,KAAM7B,KAAMD,OACzE4H,IASJ,OARK3H,MAAK4E,eAMN+C,EAAQrI,QAAU,MALlBqI,EAAQrI,SAAU,EAClBqI,EAAQtC,QAAS,GAMd1D,EAAE1C,SAAUyI,EAAcC,IAIrCC,YAAcjG,EAAEhD,OAAQgD,EAAEkG,MAAOvB,EAAiB1E,UAAUgG,cACxDxI,KAAeb,EAASuJ,gBAAiB,QAAUC,WAAW,IAC9DC,WAAezJ,EAASuJ,gBAAiB,QAAUC,WAAW,IAC9DE,KAAe1J,EAASuJ,gBAAiB,QAAUC,WAAW,IAC9DG,WAAe3J,EAASuJ,gBAAiB,QAAUC,WAAW,MAIlEI,KAAO,SAAUpI,GACbA,EAAUA,KACV,IAAIqI,GAASrI,EAAQqI,OACjBC,EAAiBrI,KAAKiH,OAAQjH,KAAKO,IAAKP,KAAK4G,kBAMjD,OALAN,GAAiB1E,UAAUuG,KAAKtG,KAAM7B,KAAM2B,EAAE1C,UAAWmJ,QAAQ,GAAQrI,IACzEC,KAAKsI,QAASD,GAAkBD,QAAQ,IACnCA,GACDpI,KAAKmB,QAAS,OAAQnB,KAAMD,GAEzBC,MAIXuI,OAAS,SAAiBzF,EAAM0F,EAAMC,GAElC,GAAIC,GAAa1I,KACbmG,EAAM9E,OAAO+E,QAAS1G,OAAOC,KAAO,6BACxC,OAAOwG,GAAI3C,KAAM,SAAU4D,GACvBsB,EAAWrB,WAAY,GAAI7I,GAAS4I,KAAaqB,WAQzDpB,WAAa,SAAUhH,EAASN,GAQ5B,MAPAA,GAAUA,MAEVC,KAAKsI,QAASjI,EAASN,GACvBC,KAAK4G,iBAAmBvG,EAAQE,IAAK,MAChCR,EAAQqI,QACTpI,KAAKmB,QAAS,cAAed,EAASL,MAEnCA,MAGXqG,SAAU,WACN,MAAO,qBAAuBrG,KAAKoC,OAAS,YAAcpC,KAAK4G,iBAAmB,MAM1F,QACIpI,QAAoBA,EACpBgI,kBAAoBA"}
{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","panel","on","ev","data","dataDropped","dropTargetOff","_renderCounts","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleItemDeletedChange","change:visible","_handleItemVisibleChange","change:purged","fetch","change","console","log","arguments","fetching-deleted","$","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","renderItems","$whereTo","views","jQuery","$el","templates","counts","toJSON","find","$where","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","text","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","createListCollection","done","refresh","createPairCollection","createListOfPairsCollection","_getItemViewOptions","options","_","hidden","itemModel","contents","_handleItemDeletion","_handleItemUndeletion","contentsShown","deleted","active","includeDeleted","removeItemView","set","includeHidden","showOrHide","speed","each","view","toggle","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","css","dataTransfer","originalEvent","dropEffect","getData","JSON","parse","err","warn","trigger","isObject","model_class","copy","when","toString","countsTemplate","wrapTemplate"],"mappings":"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"}
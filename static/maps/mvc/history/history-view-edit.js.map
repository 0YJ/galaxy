{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","panel","on","ev","data","dataDropped","dropTargetOff","_renderCounts","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleItemDeletionChange","change:visible","_handleItemVisibleChange","change:purged","fetch","fetching-deleted","$","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","renderItems","$whereTo","views","jQuery","$el","templates","counts","toJSON","find","$where","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","text","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","createListCollection","done","refresh","createPairCollection","createListOfPairsCollection","_getItemViewOptions","options","_","hidden","itemModel","console","log","contentsShown","showDeleted","deleted","removeItemView","shown","set","showHidden","showOrHide","speed","each","view","toggle","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","css","dataTransfer","originalEvent","dropEffect","getData","JSON","parse","err","warn","trigger","isObject","model_class","contents","copy","when","toString","countsTemplate","wrapTemplate"],"mappings":"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"}
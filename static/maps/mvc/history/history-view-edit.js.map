{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","panel","on","ev","data","dataDropped","dropTargetOff","_renderCounts","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleHdaDeletionChange","change:visible","_handleHdaVisibleChange","change:purged","fetch","fetching-deleted","$","parent","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","renderItems","$whereTo","views","jQuery","$el","templates","counts","toJSON","find","$where","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","text","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","createListCollection","done","refresh","createPairCollection","createListOfPairsCollection","_getItemViewOptions","options","_","hidden","itemModel","contentsShown","deleted","showDeleted","shown","removeItemView","set","showHidden","args","Array","slice","arguments","each","view","toggle","apply","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","css","height","margin","border","border-radius","color","font-size","font-style","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","dataTransfer","originalEvent","dropEffect","getData","JSON","parse","err","warn","trigger","isObject","model_class","contents","copy","when","toString","countsTemplate","wrapTemplate"],"mappings":"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"}
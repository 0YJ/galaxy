{"version":3,"file":"workflow-manager.js","sources":["../../../src/mvc/workflow/workflow-manager.js"],"names":["define","Connector","Workflow","app","canvas_container","this","id_counter","nodes","name","has_changes","active_form_has_changes","$","extend","prototype","create_node","type","title_text","tool_id","node","prebuildNode","add_node","fit_canvas_to_nodes","canvas_manager","draw_overview","activate_node","id","element","attr","workflow","remove_node","active_node","clear_active_node","remove_all","wf","each","k","v","destroy","rectify_workflow_outputs","using_workflow_outputs","has_existing_pjas","workflow_outputs","length","post_job_actions","pja_id","pja","action_type","self","node_changed","pjas_to_rem","push","i","pja_name","output_terminals","ot_id","ot","create_pja","isWorkflowOutput","output_name","action_arguments","reload_active_node","to_simple","input_connections","input_terminals","t","cons","connectors","c","handle1","act","node_data","tool_state","tool_errors","position","annotation","uuid","label","steps","from_simple","data","max_id","step","init_field_data","css","top","left","Math","max","parseInt","isArray","l","x","other_node","connect","redraw","undefined","addWorkflowOutput","callout","find","Galaxy","root","check_changes_in_active_form","submit","make_inactive","showToolForm","form_html","make_active","force","layout","n_pred","successors","j","other","node_ids_by_level","level_parents","pred_k","sk","all_nodes","h_pad","v_pad","ids","sort","a","b","max_width","width","height","_","bounds_for_all_nodes","p","xmin","xmax","ymin","ymax","e","min","round_up","n","ceil","fix_delta","new_pos","bounds","parent","xmin_delta","ymin_delta","children"],"mappings":"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"}
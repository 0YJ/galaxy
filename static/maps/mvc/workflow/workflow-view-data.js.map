{"version":3,"sources":["mvc/workflow/workflow-view-data.js"],"names":["define","Globals","DataInputView","Backbone","View","extend","className","initialize","options","input","this","nodeView","terminalElement","$el","html","label","skipResize","attr","position","left","top","el","display","outerWidth","css","$","append","DataOutputView","output","name","node","extensions","indexOf","isInput","join","calloutView","type","OutputCalloutView","hoverImage","resetImage","detach","redrawWorkflowOutput","tagName","view","addWorkflowOutput","canvas_manager","Galaxy","root","click","outputName","isWorkflowOutput","removeWorkflowOutput","workflow","has_changes","draw_overview","tooltip","delay","title","margin","right","show"],"mappings":"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","file":"../../../scripts/mvc/workflow/workflow-view-data.js","sourcesContent":["define([\"mvc/workflow/workflow-globals\"], function(Globals) {\n    var DataInputView = Backbone.View.extend({\n        className: \"form-row dataRow input-data-row\",\n\n        initialize: function(options) {\n            this.input = options.input;\n            this.nodeView = options.nodeView;\n            this.terminalElement = options.terminalElement;\n\n            this.$el.attr(\"name\", this.input.name).html(this.input.label);\n\n            if (!options.skipResize) {\n                this.$el.css({\n                    position: \"absolute\",\n                    left: -1000,\n                    top: -1000,\n                    display: \"none\"\n                });\n                $(\"body\").append(this.el);\n                this.nodeView.updateMaxWidth(this.$el.outerWidth());\n                this.$el.css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                });\n                this.$el.remove();\n            }\n        }\n    });\n\n    var DataOutputView = Backbone.View.extend({\n        className: \"form-row dataRow\",\n\n        initialize: function(options) {\n            this.output = options.output;\n            this.terminalElement = options.terminalElement;\n            this.nodeView = options.nodeView;\n\n            var output = this.output;\n            var label = output.name;\n            var node = this.nodeView.node;\n\n            var isInput =\n                output.extensions.indexOf(\"input\") >= 0 ||\n                output.extensions.indexOf(\"input_collection\") >= 0;\n            if (!isInput) {\n                label = label + \" (\" + output.extensions.join(\", \") + \")\";\n            }\n            this.$el.html(label);\n            this.calloutView = null;\n            if ([\"tool\", \"subworkflow\"].indexOf(node.type) >= 0) {\n                var calloutView = new OutputCalloutView({\n                    label: label,\n                    output: output,\n                    node: node\n                });\n                this.calloutView = calloutView;\n                this.$el.append(calloutView.el);\n                this.$el.hover(\n                    function() {\n                        calloutView.hoverImage();\n                    },\n                    function() {\n                        calloutView.resetImage();\n                    }\n                );\n            }\n            this.$el.css({\n                position: \"absolute\",\n                left: -1000,\n                top: -1000,\n                display: \"none\"\n            });\n            $(\"body\").append(this.el);\n            this.nodeView.updateMaxWidth(this.$el.outerWidth() + 17);\n            this.$el\n                .css({\n                    position: \"\",\n                    left: \"\",\n                    top: \"\",\n                    display: \"\"\n                })\n                .detach();\n        },\n        redrawWorkflowOutput: function() {\n            if (this.calloutView) {\n                this.calloutView.resetImage();\n            }\n        }\n    });\n\n    var OutputCalloutView = Backbone.View.extend({\n        tagName: \"div\",\n\n        initialize: function(options) {\n            this.label = options.label;\n            this.node = options.node;\n            this.output = options.output;\n\n            var view = this;\n            var node = this.node;\n            this.$el\n                .attr(\"class\", \"callout \" + this.label)\n                .css({ display: \"none\" })\n                .append(\n                    $(\"<div class='buttons'></div>\").append(\n                        $(\"<img/>\")\n                            .attr(\n                                \"src\",\n                                Galaxy.root +\n                                    \"static/images/fugue/asterisk-small-outline.png\"\n                            )\n                            .click(function() {\n                                var outputName = view.output.name;\n                                if (node.isWorkflowOutput(outputName)) {\n                                    node.removeWorkflowOutput(outputName);\n                                    view\n                                        .$(\"img\")\n                                        .attr(\n                                            \"src\",\n                                            Galaxy.root +\n                                                \"static/images/fugue/asterisk-small-outline.png\"\n                                        );\n                                } else {\n                                    node.addWorkflowOutput(outputName);\n                                    view\n                                        .$(\"img\")\n                                        .attr(\n                                            \"src\",\n                                            Galaxy.root +\n                                                \"static/images/fugue/asterisk-small.png\"\n                                        );\n                                }\n                                Globals.workflow.has_changes = true;\n                                Globals.canvas_manager.draw_overview();\n                            })\n                    )\n                )\n                .tooltip({\n                    delay: 500,\n                    title:\n                        \"Mark dataset as a workflow output. All unmarked datasets will be hidden.\"\n                });\n\n            this.$el.css({\n                top: \"50%\",\n                margin: \"-8px 0px 0px 0px\",\n                right: 8\n            });\n            this.$el.show();\n            this.resetImage();\n        },\n\n        resetImage: function() {\n            if (!this.node.isWorkflowOutput(this.output.name)) {\n                this.$(\"img\").attr(\n                    \"src\",\n                    Galaxy.root +\n                        \"static/images/fugue/asterisk-small-outline.png\"\n                );\n            } else {\n                this.$(\"img\").attr(\n                    \"src\",\n                    Galaxy.root + \"static/images/fugue/asterisk-small.png\"\n                );\n            }\n        },\n\n        hoverImage: function() {\n            this.$(\"img\").attr(\n                \"src\",\n                Galaxy.root + \"static/images/fugue/asterisk-small-yellow.png\"\n            );\n        }\n    });\n\n    return {\n        DataInputView: DataInputView,\n        DataOutputView: DataOutputView\n    };\n});\n"]}
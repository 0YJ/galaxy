{"version":3,"sources":["mvc/toolshed/repositories-view.js"],"names":["ToolShedCategoryContentsView","Backbone","View","extend","el","initialize","params","this","model","_toolshedModel2","default","CategoryCollection","listenTo","render","shed","tool_shed","replace","url","category_id","category","fetch","options","_","templateCategoryContents","$el","self","category_contents_template","models","queue","queueLength","$","bindEvents","that","autocomplete","request","Galaxy","term","css","shed_url","post","base_url","data","result_list","_util2","shedParser","minLength","select","tsr_id","value","tool_shed_url","history","navigate","new_route","reDraw","empty","template","Category","join"],"mappings":"iRAGIA,EAA+BC,SAASC,KAAKC,QAC7CC,GAAI,UAEJC,WAAY,SAASC,GAEjBC,KAAKC,MAAQ,IAAIC,EAAAC,QAAeC,mBAChCJ,KAAKK,SAASL,KAAKC,MAAO,OAAQD,KAAKM,QACvC,IAAIC,EAAOR,EAAOS,UAAUC,QAAQ,MAAO,OAC3CT,KAAKC,MAAMS,KACP,kBAAoBH,EAAO,gBAAkBR,EAAOY,YACxDX,KAAKC,MAAMO,UAAYD,EACvBP,KAAKC,MAAMW,SAAWb,EAAOY,YAC7BX,KAAKC,MAAMY,SAXfhB,OAAI,SADgDiB,GAgBhDd,KAAKc,QAAUC,EAAEnB,OAAOI,KAAKc,QAASA,GAb1ChB,IAAAA,EAAqBC,KAATiB,yBACRhB,KAAAiB,IAAIC,KACJC,GACAP,SAAcZ,KAAKC,MAAnBmB,OAAA,GACIb,UAAOR,KAAOS,MAAAA,UAClBa,MAAWX,EAAAA,QACPY,iBAGJC,EAAA,WAAKtB,IAAMY,WAAX,QACHb,KAbmDwB,cAgBhDA,WAAA,WACA,IAAAC,EAAIN,KACJI,EAAA,eAAAG,cAEQd,OAAAA,SAAUe,EAAWP,GACrBZ,IAAAA,EAAWiB,EAAKxB,MAAMO,UAFCC,QAAA,OAAA,KAGvBY,EAAOO,OAAcN,KAAAA,uBAJ7BvB,GAOE8B,KAAWC,EAAID,KACZL,cAALO,GAaQR,EAAES,KAAKC,EAAUlC,EAAQ,SAASmC,GAVlC,IAAAC,EAAAC,EAAAjC,QAAWkC,WAAAH,GACfT,EAAJU,MAGQG,UAAA,EACAC,OAAA,SAAIN,EAAWL,GACf,IAAAY,EAAIzC,EAAAA,KAAS0C,MACTZ,EACAa,gBAAAA,EAAeX,MAAAA,UAAAA,MAAAA,EAFNrC,SAAbiD,QAAAC,SAAAC,GAIAtB,SAAOU,EACHxB,SAAI0B,QAMRW,OAAA,SAAAhC,GACAd,KAAAiB,IAAA8B,QAEArD,KAAAA,WAAAA,IAAqCsB,yBAArCD,EAAAiC,UAlBsB,0BA/BkB,+CAkE5C,6CATRF,WACI,yEACA,4FA3DgD,wJAuE5C,SATR9B,0DA9DJ,+DA0EY,4BACA,8LAiCRiC,UA/BQ,SACA,8CACA,uBACA,iCACA,OACA,qCACA,oCACA,oBACA,oCACA,QACA,WACA,oEACA,OACA,mCACA,OACA,wEACA,8FACA,SACA,QACA,yCACA,kCACA,QACA,YACA,WACA,SACA,UACFC,KAAK,kBAKXD,SAAUxD","file":"../../../scripts/mvc/toolshed/repositories-view.js","sourcesContent":["import toolshed_model from \"mvc/toolshed/toolshed-model\";\nimport toolshed_util from \"mvc/toolshed/util\";\nimport \"libs/jquery/jquery-ui\";\nvar ToolShedCategoryContentsView = Backbone.View.extend({\n    el: \"#center\",\n\n    initialize: function(params) {\n        var self = this;\n        this.model = new toolshed_model.CategoryCollection();\n        this.listenTo(this.model, \"sync\", this.render);\n        var shed = params.tool_shed.replace(/\\//g, \"%2f\");\n        this.model.url +=\n            \"?tool_shed_url=\" + shed + \"&category_id=\" + params.category_id;\n        this.model.tool_shed = shed;\n        this.model.category = params.category_id;\n        this.model.fetch();\n    },\n\n    render: function(options) {\n        this.options = _.extend(this.options, options);\n        var category_contents_template = this.templateCategoryContents;\n        this.$el.html(\n            category_contents_template({\n                category: this.model.models[0],\n                tool_shed: this.model.tool_shed,\n                queue: toolshed_util.queueLength()\n            })\n        );\n        $(\"#center\").css(\"overflow\", \"auto\");\n        this.bindEvents();\n    },\n\n    bindEvents: function() {\n        var that = this;\n        $(\"#search_box\").autocomplete({\n            source: function(request, response) {\n                var shed_url = that.model.tool_shed.replace(/%2f/g, \"/\");\n                var base_url = Galaxy.root + \"api/tool_shed/search\";\n                var params = {\n                    term: request.term,\n                    tool_shed_url: shed_url\n                };\n                $.post(base_url, params, function(data) {\n                    var result_list = toolshed_util.shedParser(data);\n                    response(result_list);\n                });\n            },\n            minLength: 3,\n            select: function(event, ui) {\n                var tsr_id = ui.item.value;\n                var new_route =\n                    \"repository/s/\" + that.model.tool_shed + \"/r/\" + tsr_id;\n                Backbone.history.navigate(new_route, {\n                    trigger: true,\n                    replace: true\n                });\n            }\n        });\n    },\n\n    reDraw: function(options) {\n        this.$el.empty();\n        this.initialize(options);\n    },\n\n    templateCategoryContents: _.template(\n        [\n            '<style type=\"text/css\">',\n            \".ui-autocomplete { background-color: #fff; }\",\n            \"li.ui-menu-item { list-style-type: none; }\",\n            \"</style>\",\n            '<div class=\"unified-panel-header\" id=\"panel_header\" unselectable=\"on\">',\n            '<div class=\"unified-panel-header-inner\">Repositories in <%= category.get(\"name\") %></div>',\n            '<div class=\"unified-panel-header-inner\" style=\"position: absolute; right: 5px; top: 0px;\"><a href=\"#/queue\">Repository Queue (<%= queue %>)</a></div>',\n            \"</div>\",\n            '<div class=\"unified-panel-body\" id=\"list_repositories\">',\n            '<div id=\"standard-search\" style=\"height: 2em; margin: 1em;\">',\n            '<span class=\"ui-widget\" >',\n            '<input class=\"search-box-input\" id=\"search_box\" name=\"search\" data-shedurl=\"<%= tool_shed.replace(/%2f/g, \"/\") %>\" placeholder=\"Search repositories by name or id\" size=\"60\" type=\"text\" />',\n            \"</span>\",\n            \"</div>\",\n            '<div style=\"clear: both; margin-top: 1em;\">',\n            '<table class=\"grid\">',\n            '<thead id=\"grid-table-header\">',\n            \"<tr>\",\n            '<th style=\"width: 10%;\">Owner</th>',\n            '<th style=\"width: 15%;\">Name</th>',\n            \"<th>Synopsis</th>\",\n            '<th style=\"width: 10%;\">Type</th>',\n            \"</tr>\",\n            \"</thead>\",\n            '<% _.each(category.get(\"repositories\"), function(repository) { %>',\n            \"<tr>\",\n            \"<td><%= repository.owner %></td>\",\n            \"<td>\",\n            '<div style=\"float: left; margin-left: 1px;\" class=\"menubutton split\">',\n            '<a href=\"#/repository/s/<%= tool_shed %>/r/<%= repository.id %>\"><%= repository.name %></a>',\n            \"</div>\",\n            \"</td>\",\n            \"<td><%= repository.description %></td>\",\n            \"<td><%= repository.type %></td>\",\n            \"</tr>\",\n            \"<% }); %>\",\n            \"</table>\",\n            \"</div>\",\n            \"</div>\"\n        ].join(\"\")\n    )\n});\n\nexport default {\n    Category: ToolShedCategoryContentsView\n};\n"]}
{"version":3,"sources":["mvc/library/library-dataset-view.js"],"names":["define","model","mod_library_model","options","mod_select","LibraryDatasetView","Backbone","View","extend","el","events","click .toolbtn_modify_dataset","click .toolbtn_cancel_modifications","click .toolbtn-download-dataset","select_genome","click .toolbtn-share-dataset","click .btn-copy-link-to-clipboard","select_extension","click .btn-remove-restrictions","click .toolbtn_save_permissions","list_extensions","text","auto","id","fetchDataset","description","list_genomes","initialize","that","fetchVersion","this","fetchExtAndGenomes","render","mod_toastr","error","Galaxy","libraries","library_router","Item","show_permissions","showPermissions","show_version","$","remove","response","template","templateDataset","item","err_msg","onclick","back","_","$el","ldda","url","urlRoot","tooltip","Ldda","ldda_id","fetch","success","renderVersion","templateVersion","responseJSON","html","downloadDataset","get","enableModification","processDownload","templateModifyDataset","renderSelectBoxes","genome_build","file_ext","data","inputs","split","pair","method","info","param","importIntoHistory","refreshUserHistoriesList","self","templateBulkImportInModal","title","body","histories","modal","show","closing_events","callback","Import","GalaxyHistories","Close","hide","window","location","root","disableButton","importCurrentIntoHistory","xhr","new_history_name","val","post","name","done","history_id","processImportToHistory","fail","status","historyItem","find","jQuery","enableButton","HistoryItem","getJSON","save","content","source","shareDataset","goBack","set","is_unrestricted","undefined","is_admin","fetched_permissions","access_dataset_roles","length","templateDatasetPermissions","prepareSelectBoxes","user","isAdmin","_serializeRoles","role_list","selected_roles","i","push","selected_access_dataset_roles","selected_modify_item_roles","selected_manage_dataset_roles","minimumInputLength","ajax","css","multiple","modify_item_roles","placeholder","manage_dataset_roles","dataType","quietMillis","container","q","page_limit","page","term","results","more","formatResult","roleFormatResult","role","type","roles","initSelection","element","formatSelection","each","initialData","dropdownCssClass","join","manage_select_options","total","roleFormatSelection","accessSelectObject","access_select_options","modifySelectObject","templateAccessSelect","modify_select_options","manageSelectObject","select2","comingSoon","copyToClipboard","href","history","prompt","substr","lastIndexOf","makeDatasetPrivate","_extractIds","ids_list","roles_list","event","manage_ids","access_ids[]","access_ids","manage_ids[]","modify_ids[]","modify_ids","datatypes","description_url","key","sort","b","extension","unshift","a","genomes","mod_utils","current_ext","current_genome","value"],"mappings":"YAAAA,SACE,cADFA,4BAGE,cAUF,oBAPA,SAUEC,EARMC,EAUNC,EARMC,GAukCR,OACIC,mBA1jCAC,SAAAC,KAAAC,QACAC,GAAA,UAEAR,MAAA,KAEAE,WAPFO,QAAQC,gCAToC,qBAW1CC,sCAA0C,SAY5CC,kCAAA,kBACAC,gCAxB4C,oBAc1CC,+BAA0C,eAY5CC,oCAAA,kBACAC,0BA3B4C,qBAiB1CC,iCAA0C,4BAY5CC,kCAAA,kBACAC,oCA9B4C,cAmCxCC,cAAc,KARlBJ,iBAAmB,KAGnBG,mBAmBEE,MACAC,GAASpB,OACPkB,KAAKG,cACNC,YAAA,sZASGC,gBAECC,WAFD,SAEWC,GACPA,KAAAA,QAAKC,EAAAA,OAAAA,KAAL1B,QAAAA,GACH2B,KAAAC,qBACGH,KAAAA,QAAKI,IACRF,KAAAN,gBAICS,aAAAA,SAAWC,GAA2FC,KAAAA,QAAAA,EAAAA,OAAOC,KAAUC,QAAAA,GAAuBP,KAAA7B,MAA9I,GAAAC,GAAAoC,MAAAf,GAAAO,KAAA3B,QAAAoB,IACD,IAAAK,GAFDE,IAGEG,MAAAA,MAAAA,OAAuFE,QAAAA,WAAwCP,EAA/HzB,QAAAoC,iBACDX,EAAAY,kBACFZ,EAAAzB,QAAAsC,aAhBHb,EAAAC,eAOQD,EAAKI,UAebU,MAAE,SAAYC,EAAdC,OACA,KAAIC,EAAgBC,aACpBb,EAAcY,MAAAA,EAAUE,aAAVC,QAAd,0BAAA,IAAAC,QAAA,WAAAd,OAAAC,UAAAC,eAAAa,UAEEjB,EAAAC,MAAA,2CAAF,IAAAe,QAAA,WAAAd,OAAAC,UAAAC,eAAAa,cAMAlB,OAAI,SAAM7B,GACR2B,KAAA3B,QAAAgD,EAAA3C,OAAAsB,KAAA3B,QAAAA,GACA8B,EAAAA,YAAAA,QACD,IAHDY,GAGOf,KAAAgB,iBACLhB,MAAAsB,IAAKC,KAALR,GAAgB3C,KAAAA,KAAAA,SAChBwC,EAAA,SAAKW,KAAKC,KAAMrD,MAAKoD,IAAKE,SAC1Bb,EAAA,yBAAgBc,WAGb3B,aAHa,SAAA1B,GAId+B,KAAAA,QAAOiB,EAAA3C,OAAAsB,KAAS7B,QAAO2C,GACrBhB,KAAAE,KACEG,KAAAA,QAAAA,SAIHH,KAAAuB,KAAA,GAAAnD,GAAAuD,MAAAlC,GAAAO,KAAA3B,QAAAuD,UAVa5B,KAAhBuB,KAAAC,IAAAxB,KAAAuB,KAAAE,QAAAzB,KAAA7B,MAAAsB,GAAA,aAAAO,KAAAuB,KAAA9B,GAYDO,KAAAuB,KAAAM,OA7GyCC,QAAA,WAmGpChC,KAAKiC,iBAcT3B,MAAA,SAAYS,EAAdC,OACA,KAAeA,EAAKkB,aACfV,EAASP,MAASD,EAAOmB,aAAYV,SAnHApB,EAAAC,MAAA,0BAwGnCJ,KAAAE,SACCC,EAAAA,MAAAA,2DAmBRS,cAAWsB,WACXtB,EAAAA,YAAEC,QACH,IA9H2CE,GAAAf,KAAAgC,iBAmH1ChC,MAAKsB,IAAIY,KAAKnB,GAAUE,KAAMjB,KAAK7B,MAAOoD,KAAMvB,KAAKuB,QAavDY,EAAAA,SAAAA,KAAAA,KAAiBZ,KAAAa,IAAA,UAGfC,mBAAKC,WACN1B,EApI2C,YAAAC,QAyH1C,IAAIE,GAAWf,KAAKuC,uBAatBD,MAAAA,IAAAA,KAAAA,GAAiBrB,KAAAjB,KAAA7B,SACX6B,KAAAwC,mBAAAC,aAAAzC,KAAA7B,MAAAiE,IAAA,gBAAAM,SAAA1C,KAAA7B,MAAAiE,IAAA,cACAxB,EAAA,SAAIY,KAAOmB,KAAMxE,MAAAiE,IAAA,SACfxB,EAAA,yBAAAc,WAGAS,gBAAIS,WACJhC,GAAAA,GAAAP,OAAYwC,KAAM,+CAChBF,GAAIG,OAAYD,KAALpD,GACXmD,MAAAA,gBAAQpB,EAAAmB,IAGV/B,gBAAE,SAAAY,EAAAmB,EAAuBI,GAGzB5C,GAAAA,GAAW6C,EAAK,CArJoBL,EAAA,gBAAAA,GAAAA,EAAA/B,EAAAqC,MAAAN,EAyJ5CO,IAAAA,GAAmB,EACjBtC,GAAKuC,KAAAA,EAAAA,MAAAA,KAAAA,WACOpC,GAAAA,GAAWqC,KAAKC,MAAAA,IACpBD,IAAA,8BAAAN,EAAA,GAAA,YAAAA,EAAA,GAAA,SAGIQ,EAAAA,iBAAkB9B,EAAA,cAFNuB,GAAA,QAAA,KAAAH,EAAA,WAGZW,SAAkBxC,QAAUyC,SAAAA,SAExBrD,EAAA6C,KAAc,oCACY3C,kBAAOoD,WAAczD,KAAAmD,yBAAA,SAAAC,GAFjC,GAAArC,GAAAqC,EAAAC,2BAJtBD,GAAAK,MAAApD,OAAAoD,MAHRL,EAAAK,MAAAC,MA1J0CC,gBAAA,EA+J9BL,MAAkB,sBAUjCH,KAA0BpC,GAAAyC,UAAAJ,EAAAI,UAASI,SAC5BR,SACJS,OAAqBzF,WAAkB0F,EAAAA,4BACvCC,MAAqB,WAAA1D,OAAAoD,MAAAO,cAIhBb,yBAAM,SAAAS,GACLA,GAAAA,GAAAA,IACD5D,MAAAwD,UAAA,GAAApF,GAAA0F,gBACF9D,KAPkBwD,UAAA3B,OAQnBzB,QAAO,SAAAoD,GACevB,IAApBuB,EAAW1C,OACTX,EAAAA,QAAiBW,yDAAjB,IAAAK,QAAA,WAAA8C,OAAAC,SAAA7D,OAAA8D,QAEAhE,EAAAA,IAZeC,MAArB,SAAAjC,EAAA2C,OA5K0C,KAAAA,EAAAmB,aAsLpC9B,EAAWC,MAAMU,EAASmB,aAAaf,SAS7Cf,EAAWiE,MAAAA,yBAONC,yBACeC,WACdnE,KAAAA,MAAAA,cAAiB,SAClB,IAAAoE,GACOvE,KAAWyD,MAAA7C,EAAA,4BAAA4D,MACjB1E,EAAK2D,IACN,IATH,KASGc,EACJ3D,EAXD6D,KAWOpE,OAAA8D,KAAA,iBAAAO,KAAAH,IACLI,KAAIC,SAAAA,GACJ9E,EAAK+E,uBAAuBD,EAA5BnF,MAEDqF,KAAA,SAAAR,EAAAS,EAAA3E,GAjNyCD,EAAAC,MAAA,uBAoN5CyE,OAAAA,WACMG,EAAAA,MAAAA,aAAkB5G,gBAEtB,CACA,GAAAwG,GAAAhE,EAAAZ,KAAAyD,MAAAnC,KAAA2D,KAAA,sDAAAT,KACAU,MAAAA,uBAAgBN,GAChB5E,KAAAyD,MAAA0B,aAAA,YAIIhF,uBAAW2B,SAAQ8C,GAAiFX,GAAAA,GAAOC,GAAAA,GAAPkB,WAA6BJ,GAAjIxD,IAAAwD,EAAAvD,QAAAmD,EAAA,YAGAM,OAAAG,QAAIhF,OAAOS,KAASmB,6BAA6B2C,GAEhDI,EAFDM,MAEOC,QAAAvF,KAAAP,GAAA+F,OAAA,YACLrF,QAAAA,WACDE,OAAAoD,MAAAO,OACF7D,EAAA2B,QAAA,sDAAA,IAAAX,QAAA,WAAA8C,OAAAC,SAAA7D,OAAA8D,SAtOuC/D,MAAA,SAAAjC,EAAA2C,OAiOD,KAA1BA,EAASmB,aAS1BwD,EAAcrF,MAAA,yBAAUU,EAAAmB,aAAAf,SA1OoBf,EAAAC,MAAA,iEAkP5CM,aAAAA,WACEP,EAAK9B,KAAL,yBAGEqH,OAAA,WACErF,OAAAC,UAAWqF,eAAKC,QAGjBlF,gBAAA,SAAArC,GACF2B,KAAA3B,QAAAgD,EAAA3C,OAAAsB,KAAA3B,QAAAA,GACDuC,EAAA,YAAAC,aACAgF,KAAA7F,KAAI8F,QAAWC,sBACC,IAAZ1F,KAAAA,QAAY0F,oBAAAC,qBAAAC,OACdH,KAAAA,MAAWzF,KAAAA,iBAAX,IAEFL,KAAIe,MAAAA,KAAW6E,iBAAKM,IAIlB9C,IAAAA,IAAK+C,CADP9F,QAEQ+F,OACJjG,EAAAA,OAAAiG,KAAiBC,UAErBzF,IAAEG,GAAAf,KAAAkG,4BACFtF,MAAEU,IAAAY,KAAFnB,GAAiBE,KAAjBjB,KAA4B7B,MAA5B2H,SAAAA,IACD,IA3Q2C1C,GAAApD,IAoQ1CY,GAAEwB,IAAK/B,OAAO8D,KAAO,0BAA4Bf,EAAK3D,GAAK,8BAA8BkF,KAAK,SAASoB,GASzGO,EAAAA,oBAAkBP,oBAASQ,EAAUT,SAAAA,MACnChB,KAAI0B,WACJrG,EAAaC,MAAGqG,sEAEf7F,EAAA,yBAAAc,UACDd,EAAA,WAAO4F,IAAAA,WAAP,SAGFL,gBAAAA,SAAoBI,GAElB,IAAA,GADAC,MACIT,EAAAA,EAAAA,EAAAA,EAAsBE,OAAK5H,IAC/BmI,EAAeE,KAAKrI,EAAQyH,GAAAA,GAA5B,IAAAS,EAAAE,GAAA,GAEA,OAAIE,IAGJA,mBAAAA,SAAAA,GACAC,KAAAA,QAAAA,EAAAA,OAAAA,KAAAA,QAAkCN,EAClCO,IAAAA,GAAAA,KAAAA,QAAqCP,oBAPjCR,EAAW9F,KAAK3B,QAAQyH,SAS5B1C,EAAI0C,KAAWa,KACXC,KACEE,IAKAC,IAJAC,EAF0BhH,KAAAsG,gBAAAP,EAAAC,sBAG1BiB,EAH0BjH,KAAAsG,gBAAAP,EAAAmB,mBAI1BC,EAAanH,KAAAsG,gBAJaP,EAAAqB,sBAM1BL,EAAM,CACFvF,GAAAA,IACA6F,mBAFE,EAGFC,IAAAA,cACA3E,UAAM,EAAwBwE,YAAA,yBAC1BI,UAAOnE,EAAA9B,IAAA2D,KAAA,gBACHuC,MACAC,IAAAA,OAAAA,KAAgB,0BAAArE,EAAA3D,GAAA,+BAChBiI,SAAMA,OAHHJ,YAAP,IALF3E,KAAA,SAAAgF,EAAAD,GAWFE,OACQC,EAAQH,EACZD,WAAA,GACOC,KAACE,IAGhBE,QAAAA,SAAwBC,EAAAA,GACpB,GAAOC,GAAY,GAAZN,EAAwBM,EAAKC,KAJhC,QAAQL,QAASjF,EAAKuF,MAAOL,KAAMA,KAS1CC,aA7ByB,SAAAE,GA8B1BG,MAAAA,GAAezD,KAAA,UAAAsD,EAASI,MAGxBC,gBAAA,SAAAL,GACI,MAAIrF,GAAJ+B,MAEIyD,cAAW,SAAKtF,EAAhBe,GACU,GAAVjB,KAFJ/B,GAAAwH,EAAA5D,MAAA3B,MAAA,MAAAyF,KAAA,WAOA1E,GAASjB,GAAT3C,KAAA6C,MAAA,IA1CsBF,GAAA+D,MA4C1B6B,GAAa5B,EAAAA,GACb6B,KAAkBvH,EAAA,OAGlB6F,EAAAA,IAEAG,YAASN,EAHiB8B,KAAA,KAI1BtB,iBAAa,WAEbJ,GACIvF,mBAAK,EACL6F,IAAAA,cACAC,UAAAA,EACA3E,YAAM,yBAAwB4E,UAAAnE,EAAA9B,IAAA2D,KAAA,gBAC1B8B,MACIS,IAAGG,OAAMxD,KAAA,0BAAAf,EAAA3D,GAAA,+BACTgI,SAAAA,OACAC,YAAW,IAHR/E,KAAP,SAAAgF,EAAAD,GALF,OAWOF,EAAAG,EACDE,WAAO,GACXH,KAAAA,IAnBkBE,QAAA,SAAAjF,EAAA+E,GAuB1BI,GAAAA,GAAwBC,GAATL,EAASK,EAAAA,KAvBE,QAAAH,QAAAjF,EAAAuF,MAAAL,KAAAA,KA4BtBC,aAAYpD,SAAZsD,GA5BsB,MAAAA,GAAAtD,KAAA,UAAAsD,EAAAC,MAgC1BI,gBAAA,SAAAL,GACA,MAAAA,GAAAtD,MAEI9D,cAAE,SAAoBwH,EAAME,GAIpB5D,GAAAA,KAFM9D,GAAVwH,EAAA5D,MAAA3B,MAAA,MAAAyF,KAAA,WAFJ,GAAArH,GAAAjB,KAAA6C,MAAA,IAOAe,GAASjB,MA1CalD,GAAAwB,EAAA,GA4C1BsH,KAAa3B,EAAAA,OAGX8B,EAAAA,IAEF1B,YAAKJ,EAFqB6B,KAAA,KAG1BxB,iBAH0B,WAK1BM,GACAR,mBAAM,EACFvF,IAAAA,cACA6F,UAAAA,EACAC,YAAAA,yBACA3E,UAAMS,EAAA9B,IAAA2D,KAAU0C,gBAAcZ,MAC1BvF,IAAAnB,OAAO8D,KAAA,0BAAAf,EAAA3D,GAAA,+BACH+H,SADG,OAEHC,YAAAA,IACAC,KAAAA,SAAWC,EAAAD,GAHf,OALFF,EAAAG,EAWOF,WAAA,GACDI,KAAQH,IAGfE,QAAA,SAAAjF,EAAA+E,GArBqB,GAAAG,GAAA,GAAAH,EAAA/E,EAAAgG,KAwBtB,QAAYjE,QAAO/B,EAAZuF,MAAwBF,KAA/BH,KAGJQ,aAAAA,SAA0BO,GACtB,MAAOZ,GAAKtD,KAAZ,UAAAsD,EAAAC,MAGJI,gBAAA,SAAAL,GACA,MAAAA,GAAAtD,MAEIyD,cAAA,SAAAC,EAAAxE,GAIQnE,GAAAA,KACAiF,GAAAA,EAAMzD,MAAA4B,MAAA,MAAAyF,KAAA,WAFV,GAAArH,GAAAjB,KAAA6C,MAAA,IAFJF,GAAA+D,MAOS/D,GAAT1B,EAAA,GA1CsByD,KAAAzD,EAAA,OAA5B2C,EAAAjB,IAgDAS,YAAKyF,EAAqBJ,KAAoBK,KAC9C1F,iBAAK2F,UAEA3F,GAAAyF,mBAAA,GAAAvK,GAAAG,KAAAqK,GACL1F,EAAIrC,mBAAgBiI,GAAAA,GAALvK,KAAfwK,GACArI,EAAAsI,mBAAqB,GAAA5K,GAAAG,KAAdiK,OACH9H,CACAwC,GAAAA,GAAKyF,EAAAA,sBACRjI,GAHDwB,IAAA/B,OAGQ8D,KAAW,0BAAAf,EAAA3D,GAAA,+BAAA,SAAAkD,GACfxC,EAAAA,gBAAiB+B,KAAAnB,GAAA1C,QAAAsE,EAAAuF,SAJrB9E,EAAAyF,mBAAAjI,EAAA,kBAAAuI,YAMHrE,KAAA,WA3byC3E,EAAAC,MAAA,wEA8b5CgJ,WAAY,WAIZC,EAAAA,QAAiB,yBAGbC,gBAAOA,WACR,GAAAA,GAAA9K,SAAA+K,QAAArF,SAAAoF,MACa,IAAdrF,EAAOuF,YAAO,kBAvc4BF,EAAAA,EAAAG,OAAA,EAAAH,EAAAI,YAAA,kBA0c5CC,OAAAA,OAAAA,mCAA8BL,IAG1BlG,mBAAA,WACAA,GAAAA,GAAK1C,IACLP,GAAAA,KAAAA,OAAW2B,KAAX,0BAAmBsB,EAAA3D,GAAnB,oCAAAkF,KAAA,SAAAoB,GACD3C,EAAE0B,MAAKa,KAAAC,iBAAU,IAChBzF,EAAAA,iBAAiB4F,oBAAAA,IAClB5F,EAND2B,QAAA,wCA5c0CgD,KAAA,WAidxC3E,EAAWC,MAAM,kEAQjBgD,0BAAgBwC,WAChBxC,GAAAA,GAAK1C,IACLP,GAAAA,KAAAA,OAAW2B,KAAX,0BAAmBsB,EAAA3D,GAAA,2CACpBkF,KACAG,SAAKiB,GACJ5F,EAAAA,MAAAA,KAAWC,iBAAM,IAClBgD,EARD1C,iBAAAqF,oBAAAA,IAvd0C5F,EAAA2B,QAAA,iDAke5CgD,KAAA,WAJI3E,EAAWC,MAAM,uEAYnBwJ,YAAOC,SAAPC,GACDD,WAJC,KAAK,GAAIpD,GAAIqD,EAAW7D,OAAS,EAAGQ,GAAK,EAAGA,IAM9CoD,SAAAnD,KAAAoD,EAAArD,GAAAhH,GAHE,OAAOoK,WAWPjJ,gBAAQP,SAAc0J,GAEpB3G,GAAAA,GAAK1C,KACLP,EAAW2B,KAAX8H,YAAmB5J,KAAA6I,mBAAnBvH,IAAA6H,QAAA,SAHFa,EAKMhK,KAAU4J,YAAA5J,KAAAkJ,mBAAA5H,IAAA6H,QAAA,SACdhJ,EAAWC,KAAMwJ,YAAA5J,KAAA+I,mBAAAzH,IAAA6H,QAAA,QAClBvI,GAAA6D,KAPDpE,OAAA8D,KAAA,0BAAAf,EAAA3D,GAAA,uCAAAwK,eAAAC,EAAAC,eAAAH,EAAAI,eAAAC,IArf0C1F,KAAA,SAAAoB,GAufxC3C,EAAK1C,iBAAiBqF,oBAAqBA,IAQ/C5F,EAAA2B,QAAA,wBALGgD,KAAK,WACJ3E,EAAWC,MAAM,qEAeSX,mBAAkB6K,WAClB/K,GAAAA,GAAAA,IACAI,GAAAA,KACA4K,IAAAA,OAAAA,KAAkBD,qCAJIxI,QAA1B,SAAAwI,GAMH,IAAAE,MAAAF,GACIhL,EAAgBmL,gBAAiBC,MAC3BjL,GAAkB6K,EAAzBE,KAAAG,UADJpL,KAAA+K,EAAAE,KAAAG,UAGqBC,YAArBN,EAAAE,KAAA7K,YACH4K,gBAAAD,EAAAE,KAAAD,iBAGAzK,GAAcR,gBADjBmL,KAAA,SAAAI,EAAAH,GAEA,MAAUI,GAAAA,GAAVJ,EAAoBjL,GAAA,EAAAoL,EAAApL,GAAAiL,EAAAjL,IAAA,EAAA,IAETG,EAALN,gBAAuBsL,QAAA9K,EAAAN,SAAAuL,EAAvB3I,KAIHZ,IAAAnB,OAAA8D,KAAA,cACDrE,QAAKF,SAAa6K,GACPI,IAAOH,MAAOI,GADzBhL,EAAAF,aAAA8G,MAGHjH,GAAAqL,EAAAN,KAAA,GAZbjL,KAAAuL,EAAAN,KAAA,IAgBFhI,GAAmB5C,aAAA6K,KAAA,SAASpM,EAAAA,GAC1B,MAAAwM,GAAApL,GAAAiL,EAAAjL,GAAA,EAAAoL,EAAApL,GAAAiL,EAAAjL,IAAA,EAAA,QAMA+C,kBAAWnE,SAAYA,GAKnB2M,GAAAA,GAAc3M,IACf2M,EAAA,WACF,KAAA3M,QACD,KAAWA,EAAXoE,eACAwI,EAAA5M,EAAyBC,kBAAiB,KAEhCwB,EAAKF,WACX2H,EAAWzH,EAASmF,UAGxB,IAAAnF,GAAKX,IACH6H,MAAAA,cAAK,GAAA1I,GADqCG,MAE1CkE,IAAAA,wBACA4E,KAAAA,EAAWzH,aACXoL,UAAOF,EAAAA,IAAAA,KAAAA,0BAJTE,MAAAD,IAAAjL,KAAKb,iBAAmB,GAAIb,GAAWG,MAQzCuC,IAAAA,2BACE2B,KAAA7C,EAASiB,gBACTwG,UAAAzH,EAAAwB,IAAA2D,KAAA,6BACAiG,MAAAF,KAHFhK,gBAAkB,WAmDhB,MAAAK,GAAAN,UAsGA,wCACA,6BACA,0KACA,uCAhuB0C,iBA4kBtC,YAwJNiB,mLACE,mCACA,mBACA,YAtJI,2CAgKF,2KACA,qCAYA,eACA,YAyFA,UACA,2CACF,uFACA,8KA31B0C,oCA2lBhC,oBAoQZO,YACE,OACA,UACA,SAaE,0BAyEI,6EACA,4DAYN,uCACA,2GAt8B0C,iBAwmBpC,gFAkWR2D,UACE,YACA,QA/VA,2CAgXE,iCACA,6FAgEF,gKACA,wCA/hC0C,qBAmnBtC,aAgbN7C,SACE,UAoBF2F,8BACE,2DAOD,OArcO,oHA3nBV,6CA6nBQ,QAucR,oCACIzK,OADJ,iCAjlCA,iDA+oBU,QACF,UACA,wCACE,OACE,oCACA,qDACF,QACF,UACA,qCACE,OACE,4BACA,kDACF,QACF,UACA,yCACE,OACE,2CACA,sDACF,QACF,UACA,uCACE,OACE,mCACA,oDACF,QACF,UACA,+CACE,OACE,kCACA,wEACF,QACF,UACA,kDACE,OACE,qCACA,2EACF,QACF,UACA,4CACE,OACE,yCACA,qEACF,QACF,UACA,iDACE,OACE,oCACA,0EACF,QACF,UACA,mCACE,OACE,+BACA,4DACF,QACF,UACA,sCACE,OACE,2CACA,+DACF,QACF,UACA,qCACE,OACE,iDACA,8DACF,QACF,UACA,gCACE,OACE,4BACA,yDACF,QACF,UACF,WAEF,QACE,qBACA,SACF,SAEA,wCACE,QACE,6BACA,OACE,iEACE,wKACF,WACF,OACF,SACF,UAEA,SAEA,UACEkK,KAAK,MAGTzG,gBAAkB,WAChB,MAAOX,GAAEN,UAET,wCACE,6BACE,2EACE,qJACE,+CACA,uBACF,YACF,MACF,SAGA,0BACE,6EACA,4DACE,uCACE,2GACF,iBACE,gFACF,UACF,YACF,QAEA,8HAEA,8BACE,2DACE,OACE,2EACA,6CACF,QACA,oCACE,OACE,iCACA,iDACF,QACF,UACA,wCACE,OACE,oCACA,qDACF,QACF,UACA,qCACE,OACE,4BACA,kDACF,QACF,UACA,yCACE,OACE,2CACA,sDACF,QACF,UACA,uCACE,OACE,mCACA,oDACF,QACF,UACA,+CACE,OACE,kCACA,wEACF,QACF,UACA,kDACE,OACE,qCACA,2EACF,QACF,UACA,4CACE,OACE,yCACA,qEACF,QACF,UACA,iDACE,OACE,oCACA,0EACF,QACF,UACA,mCACE,OACE,+BACA,4DACF,QACF,UACA,sCACE,OACE,2CACA,+DACF,QACF,UACA,qCACE,OACE,iDACA,8DACF,QACF,UACA,gCACE,OACE,4BACA,yDACF,QACF,UACF,WACA,QACE,qBACA,SACF,SAEF,SAEF,UACE0H,KAAK,MAGTlG,sBAAwB,WACtB,MAAOlB,GAAEN,UAET,wCACE,6BACE,kLACE,oCACA,eACF,YACA,8KACE,uCACA,aACF,YACF,SAGA,0BACE,6EACA,4DACE,uCACE,2GACF,iBACE,gFACF,UACF,YACF,QAEA,8BACE,wGACA,2DACE,OACE,oHACA,oIACF,QACA,OACE,iCACA,OACE,0EACF,QACF,QACA,OACE,oCACA,OACE,oEACF,QACF,QACA,OACE,4BACA,kDACF,QACA,OACE,2CACA,sDACF,QACA,OACE,mCACA,oDACF,QACA,mBACE,kCACA,wEACF,QACE,qCACA,yDACE,2EACF,iBACE,+BACF,UACF,QACA,OACE,yCACA,qEACF,QACA,OACE,oCACA,0EACF,QACA,OACE,+BACA,4DACF,QACA,OACE,iDACA,8DACF,QACA,OACE,2CACA,+DACF,QAEA,gCACE,OACE,4BACA,yDACF,QACF,UACF,WACA,QACE,qBACA,SACF,SACF,SAEF,UACE0H,KAAK,MAGTvC,2BAA6B,WAC3B,MAAO7E,GAAEN,UAET,wCACE,6BACE,mDACE,6JACE,4CACA,0BACF,YACF,OACA,2EACE,mJACE,qCACA,wBACF,YACF,MACF,SAGA,0BACE,6EACE,4DACE,uCACE,2GACF,iBACE,gFACF,UACJ,YACF,QAEA,sDACA,oCACE,wBACE,yKACF,iBACE,+IACF,UACF,SACA,8BACE,uCACA,kDACA,mEACA,8KACA,QACA,uCACA,+LACA,4CACE,8DACE,yLACE,oCACA,4BACF,YACF,OACF,iBACE,4FACA,gKACE,wCACA,qBACA,YACF,gDACE,iLACE,kCACA,qBACF,YACF,OACF,UACA,6CACA,mEACA,iDACE,qFACA,mGACA,mGACF,SACA,4DACA,mEACA,iDACE,uLACF,SACA,iLACE,uCACA,aACF,YACF,SAEF,UACE0H,KAAK,MAGTpF,0BAA2B,WACzB,MAAOhC,GAAEN,UACT,QACE,mCACE,mBACA,qHACE,8CACE,mGACF,YACF,YACF,SACA,mCACE,kBACA,4GACA,WACF,SACF,UACE0H,KAAK,MAITO,qBAAsB,WACpB,MAAO3H,GAAEN,UACT,uCACE,2CACE,iEACF,YACF,aACE0H,KAAK","file":"../../../scripts/mvc/library/library-dataset-view.js","sourcesContent":["define([\n  \"libs/toastr\",\n  \"mvc/library/library-model\",\n  \"utils/utils\",\n  'mvc/ui/ui-select'\n  ],\nfunction(\n        mod_toastr,\n        mod_library_model,\n        mod_utils,\n        mod_select\n        ) {\n\nvar LibraryDatasetView = Backbone.View.extend({\n  el: '#center',\n\n  model: null,\n\n  options: {\n\n  },\n\n  events: {\n    \"click .toolbtn_modify_dataset\"       :   \"enableModification\",\n    \"click .toolbtn_cancel_modifications\" :   \"render\",\n    \"click .toolbtn-download-dataset\"     :   \"downloadDataset\",\n    \"click .toolbtn-import-dataset\"       :   \"importIntoHistory\",\n    \"click .toolbtn-share-dataset\"        :   \"shareDataset\",\n    \"click .btn-copy-link-to-clipboard\"   :   \"copyToClipboard\",\n    \"click .btn-make-private\"             :   \"makeDatasetPrivate\",\n    \"click .btn-remove-restrictions\"      :   \"removeDatasetRestrictions\",\n    \"click .toolbtn_save_permissions\"     :   \"savePermissions\",\n    \"click .toolbtn_save_modifications\"   :   \"comingSoon\",\n\n  },\n\n  // genome select\n  select_genome : null,\n\n  // extension select\n  select_extension : null,\n\n  // extension types\n  list_extensions :[],\n\n  // datatype placeholder for extension auto-detection\n  auto: {\n      id          : 'auto',\n      text        : 'Auto-detect',\n      description : 'This system will try to detect the file type automatically.' +\n                    ' If your file is not detected properly as one of the known formats,' +\n                    ' it most likely means that it has some format problems (e.g., different' +\n                    ' number of columns on different rows). You can still coerce the system' +\n                    ' to set your data to the format you think it should be.' +\n                    ' You can also upload compressed files, which will automatically be decompressed.'\n  },\n\n  // genomes\n  list_genomes : [],\n\n  initialize: function(options){\n    this.options = _.extend(this.options, options);\n    this.fetchExtAndGenomes();\n    if (this.options.id){\n      this.fetchDataset();\n    }\n  },\n\n  fetchDataset: function(options){\n    this.options = _.extend(this.options, options);\n    this.model = new mod_library_model.Item({id: this.options.id});\n    var that = this;\n    this.model.fetch({\n      success: function() {\n        if (that.options.show_permissions){\n            that.showPermissions();\n        } else if (that.options.show_version) {\n            that.fetchVersion();\n        } else {\n            that.render();\n        }\n      },\n      error: function(model, response){\n        if (typeof response.responseJSON !== \"undefined\"){\n          mod_toastr.error(response.responseJSON.err_msg + ' Click this to go back.', '', {onclick: function() {Galaxy.libraries.library_router.back();}});\n        } else {\n          mod_toastr.error('An error ocurred. Click this to go back.', '', {onclick: function() {Galaxy.libraries.library_router.back();}});\n        }\n      }\n    });\n  },\n\n  render: function(options){\n    this.options = _.extend(this.options, options);\n    $(\".tooltip\").remove();\n    var template = this.templateDataset();\n    this.$el.html(template({item: this.model}));\n    $(\".peek\").html(this.model.get(\"peek\"));\n    $(\"#center [data-toggle]\").tooltip();\n  },\n\n  fetchVersion: function(options){\n    this.options = _.extend(this.options, options);\n    that = this;\n    if (!this.options.ldda_id){\n      this.render();\n      mod_toastr.error('Library dataset version requested but no id provided.');\n    } else {\n      this.ldda = new mod_library_model.Ldda({id: this.options.ldda_id});\n      this.ldda.url = this.ldda.urlRoot + this.model.id + '/versions/' + this.ldda.id;\n      this.ldda.fetch({\n        success: function(){\n          that.renderVersion();\n        },\n        error: function(model, response){\n          if (typeof response.responseJSON !== \"undefined\"){\n            mod_toastr.error(response.responseJSON.err_msg);\n          } else {\n            mod_toastr.error('An error ocurred.');\n          }\n        }\n      });\n    }\n  },\n\n  renderVersion: function(){\n    $(\".tooltip\").remove();\n    var template = this.templateVersion();\n    this.$el.html(template({item: this.model, ldda: this.ldda}));\n    $(\".peek\").html(this.ldda.get(\"peek\"));\n  },\n\n  enableModification: function(){\n    $(\".tooltip\").remove();\n    var template = this.templateModifyDataset();\n    this.$el.html(template({item: this.model}));\n    this.renderSelectBoxes({genome_build: this.model.get('genome_build'), file_ext: this.model.get('file_ext') });\n    $(\".peek\").html(this.model.get(\"peek\"));\n    $(\"#center [data-toggle]\").tooltip();\n  },\n\n  downloadDataset: function(){\n    var url = Galaxy.root + 'api/libraries/datasets/download/uncompressed';\n    var data = {'ld_ids': this.id};\n    this.processDownload(url, data);\n  },\n\n  processDownload: function(url, data, method){\n        //url and data options required\n        if( url && data ){\n          //data can be string of parameters or array/object\n          data = typeof data == 'string' ? data : $.param(data);\n          //split params into form inputs\n          var inputs = '';\n          $.each(data.split('&'), function(){\n            var pair = this.split('=');\n            inputs+='<input type=\"hidden\" name=\"'+ pair[0] +'\" value=\"'+ pair[1] +'\" />';\n          });\n          //send request\n          $('<form action=\"'+ url +'\" method=\"'+ (method||'post') +'\">'+inputs+'</form>')\n          .appendTo('body').submit().remove();\n\n          mod_toastr.info('Your download will begin soon.');\n        }\n   },\n\n  importIntoHistory: function(){\n    this.refreshUserHistoriesList(function(self){\n            var template = self.templateBulkImportInModal();\n            self.modal = Galaxy.modal;\n            self.modal.show({\n                closing_events  : true,\n                title           : 'Import into History',\n                body            : template({histories : self.histories.models}),\n                buttons         : {\n                    'Import'    : function() {self.importCurrentIntoHistory();},\n                    'Close'     : function() {Galaxy.modal.hide();}\n                }\n            });\n          });\n  },\n\n refreshUserHistoriesList: function(callback){\n    var self = this;\n    this.histories = new mod_library_model.GalaxyHistories();\n    this.histories.fetch({\n      success: function (histories){\n        if (histories.length === 0){\n          mod_toastr.warning('You have to create history first. Click this to do so.', '', {onclick: function() {window.location=Galaxy.root;}});\n        } else {\n          callback(self);\n        }\n      },\n      error: function(model, response){\n        if (typeof response.responseJSON !== \"undefined\"){\n          mod_toastr.error(response.responseJSON.err_msg);\n        } else {\n          mod_toastr.error('An error ocurred.');\n        }\n      }\n    });\n  },\n\n  importCurrentIntoHistory: function(){\n    this.modal.disableButton('Import');\n    var new_history_name = this.modal.$('input[name=history_name]').val();\n    var that = this;\n    if (new_history_name !== ''){\n      $.post( Galaxy.root + 'api/histories', {name: new_history_name})\n        .done(function( new_history ) {\n          that.processImportToHistory(new_history.id);\n        })\n        .fail(function( xhr, status, error ) {\n          mod_toastr.error('An error ocurred.');\n        })\n        .always(function() {\n          that.modal.enableButton('Import');\n        });\n    } else {\n      var history_id = $(this.modal.$el).find('select[name=dataset_import_single] option:selected').val();\n      this.processImportToHistory(history_id);\n      this.modal.enableButton('Import');\n    }\n  },\n\n  processImportToHistory: function( history_id ){\n    var historyItem = new mod_library_model.HistoryItem();\n    historyItem.url = historyItem.urlRoot + history_id + '/contents';\n    // set the used history as current so user will see the last one\n    // that he imported into in the history panel on the 'analysis' page\n    jQuery.getJSON( Galaxy.root + 'history/set_as_current?id=' + history_id  );\n    // save the dataset into selected history\n    historyItem.save({ content : this.id, source : 'library' }, {\n      success : function(){\n        Galaxy.modal.hide();\n        mod_toastr.success('Dataset imported. Click this to start analyzing it.', '', {onclick: function() {window.location=Galaxy.root;}});\n      },\n      error : function(model, response){\n        if (typeof response.responseJSON !== \"undefined\"){\n          mod_toastr.error('Dataset not imported. ' + response.responseJSON.err_msg);\n        } else {\n          mod_toastr.error('An error occured. Dataset not imported. Please try again.');\n        }\n      }\n      });\n  },\n\n  shareDataset: function(){\n    mod_toastr.info('Feature coming soon.');\n  },\n\n  goBack: function(){\n    Galaxy.libraries.library_router.back();\n  },\n\n  showPermissions: function(options){\n    this.options = _.extend(this.options, options);\n    $(\".tooltip\").remove();\n    if (this.options.fetched_permissions !== undefined){\n      if (this.options.fetched_permissions.access_dataset_roles.length === 0){\n        this.model.set({is_unrestricted:true});\n      } else{\n        this.model.set({is_unrestricted:false});\n      }\n    }\n    // Select works different for admins, details in this.prepareSelectBoxes\n    var is_admin = false;\n    if (Galaxy.user){\n      is_admin = Galaxy.user.isAdmin();\n    }\n    var template = this.templateDatasetPermissions();\n    this.$el.html(template({item: this.model, is_admin: is_admin}));\n    var self = this;\n    $.get( Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?scope=current\").done(function(fetched_permissions) {\n      self.prepareSelectBoxes({fetched_permissions: fetched_permissions, is_admin: is_admin});\n    }).fail(function(){\n        mod_toastr.error('An error occurred while attempting to fetch dataset permissions.');\n    });\n    $(\"#center [data-toggle]\").tooltip();\n    $(\"#center\").css('overflow','auto');\n  },\n\n  _serializeRoles : function(role_list){\n    var selected_roles = [];\n    for (var i = 0; i < role_list.length; i++) {\n      selected_roles.push(role_list[i][1] + ':' + role_list[i][0]);\n    }\n    return selected_roles;\n  },\n\n  prepareSelectBoxes: function(options){\n    this.options = _.extend(this.options, options);\n    var fetched_permissions = this.options.fetched_permissions;\n    var is_admin = this.options.is_admin\n    var self = this;\n    var selected_access_dataset_roles = [];\n    var selected_modify_item_roles = [];\n    var selected_manage_dataset_roles = [];\n    selected_access_dataset_roles = this._serializeRoles(fetched_permissions.access_dataset_roles);\n    selected_modify_item_roles = this._serializeRoles(fetched_permissions.modify_item_roles);\n    selected_manage_dataset_roles = this._serializeRoles(fetched_permissions.manage_dataset_roles);\n\n    if (is_admin){ // Admin has a special select that allows AJAX searching\n        var access_select_options = {\n          minimumInputLength: 0,\n          css: 'access_perm',\n          multiple:true,\n          placeholder: 'Click to select a role',\n          container: self.$el.find('#access_perm'),\n          ajax: {\n              url: Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?scope=available\",\n              dataType: 'json',\n              quietMillis: 100,\n              data: function (term, page) { // page is the one-based page number tracked by Select2\n                  return {\n                      q: term, //search term\n                      page_limit: 10, // page size\n                      page: page // page number\n                  };\n              },\n              results: function (data, page) {\n                  var more = (page * 10) < data.total; // whether or not there are more results available\n                  // notice we return the value of more so Select2 knows if more results can be loaded\n                  return {results: data.roles, more: more};\n              }\n          },\n          formatResult : function roleFormatResult(role) {\n              return role.name + ' type: ' + role.type;\n          },\n\n          formatSelection: function roleFormatSelection(role) {\n              return role.name;\n          },\n          initSelection: function(element, callback) {\n          // the input tag has a value attribute preloaded that points to a preselected role's id\n          // this function resolves that id attribute to an object that select2 can render\n          // using its formatResult renderer - that way the role name is shown preselected\n              var data = [];\n              $(element.val().split(\",\")).each(function() {\n                  var item = this.split(':');\n                  data.push({\n                      id: item[0],\n                      name: item[1]\n                  });\n              });\n              callback(data);\n          },\n          initialData: selected_access_dataset_roles.join(','),\n          dropdownCssClass: \"bigdrop\" // apply css that makes the dropdown taller\n        };\n        var modify_select_options = {\n          minimumInputLength: 0,\n          css: 'modify_perm',\n          multiple:true,\n          placeholder: 'Click to select a role',\n          container: self.$el.find('#modify_perm'),\n          ajax: {\n              url: Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?scope=available\",\n              dataType: 'json',\n              quietMillis: 100,\n              data: function (term, page) { // page is the one-based page number tracked by Select2\n                  return {\n                      q: term, //search term\n                      page_limit: 10, // page size\n                      page: page // page number\n                  };\n              },\n              results: function (data, page) {\n                  var more = (page * 10) < data.total; // whether or not there are more results available\n                  // notice we return the value of more so Select2 knows if more results can be loaded\n                  return {results: data.roles, more: more};\n              }\n          },\n          formatResult : function roleFormatResult(role) {\n              return role.name + ' type: ' + role.type;\n          },\n\n          formatSelection: function roleFormatSelection(role) {\n              return role.name;\n          },\n          initSelection: function(element, callback) {\n          // the input tag has a value attribute preloaded that points to a preselected role's id\n          // this function resolves that id attribute to an object that select2 can render\n          // using its formatResult renderer - that way the role name is shown preselected\n              var data = [];\n              $(element.val().split(\",\")).each(function() {\n                  var item = this.split(':');\n                  data.push({\n                      id: item[0],\n                      name: item[1]\n                  });\n              });\n              callback(data);\n          },\n          initialData: selected_modify_item_roles.join(','),\n          dropdownCssClass: \"bigdrop\" // apply css that makes the dropdown taller\n        };\n        var manage_select_options = {\n          minimumInputLength: 0,\n          css: 'manage_perm',\n          multiple:true,\n          placeholder: 'Click to select a role',\n          container: self.$el.find('#manage_perm'),\n          ajax: {\n              url: Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?scope=available\",\n              dataType: 'json',\n              quietMillis: 100,\n              data: function (term, page) { // page is the one-based page number tracked by Select2\n                  return {\n                      q: term, //search term\n                      page_limit: 10, // page size\n                      page: page // page number\n                  };\n              },\n              results: function (data, page) {\n                  var more = (page * 10) < data.total; // whether or not there are more results available\n                  // notice we return the value of more so Select2 knows if more results can be loaded\n                  return {results: data.roles, more: more};\n              }\n          },\n          formatResult : function roleFormatResult(role) {\n              return role.name + ' type: ' + role.type;\n          },\n\n          formatSelection: function roleFormatSelection(role) {\n              return role.name;\n          },\n          initSelection: function(element, callback) {\n          // the input tag has a value attribute preloaded that points to a preselected role's id\n          // this function resolves that id attribute to an object that select2 can render\n          // using its formatResult renderer - that way the role name is shown preselected\n              var data = [];\n              $(element.val().split(\",\")).each(function() {\n                  var item = this.split(':');\n                  data.push({\n                      id: item[0],\n                      name: item[1]\n                  });\n              });\n              callback(data);\n          },\n          initialData: selected_manage_dataset_roles.join(','),\n          dropdownCssClass: \"bigdrop\" // apply css that makes the dropdown taller\n        };\n\n        self.accessSelectObject = new mod_select.View(access_select_options);\n        self.modifySelectObject = new mod_select.View(modify_select_options);\n        self.manageSelectObject = new mod_select.View(manage_select_options);\n    } else { // Non-admins have select with pre-loaded options\n        var template = self.templateAccessSelect();\n        $.get( Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?scope=available\", function( data ) {\n            $('.access_perm').html(template({options: data.roles}));\n            self.accessSelectObject = $('#access_select').select2();\n        }).fail(function() {\n            mod_toastr.error('An error occurred while attempting to fetch dataset permissions.');\n        });\n    }\n  },\n\n  comingSoon: function(){\n    mod_toastr.warning('Feature coming soon.');\n  },\n\n  copyToClipboard: function(){\n    var href = Backbone.history.location.href;\n    if (href.lastIndexOf('/permissions') !== -1){\n      href = href.substr(0, href.lastIndexOf('/permissions'));\n    }\n    window.prompt(\"Copy to clipboard: Ctrl+C, Enter\", href);\n  },\n\n  makeDatasetPrivate: function(){\n    var self = this;\n    $.post( Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?action=make_private\").done(function(fetched_permissions) {\n      self.model.set({is_unrestricted: false});\n      self.showPermissions({fetched_permissions: fetched_permissions})\n      mod_toastr.success('The dataset is now private to you.');\n    }).fail(function(){\n      mod_toastr.error('An error occurred while attempting to make dataset private.');\n    });\n  },\n\n  removeDatasetRestrictions: function(){\n    var self = this;\n    $.post( Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?action=remove_restrictions\")\n    .done(function(fetched_permissions) {\n      self.model.set({is_unrestricted: true});\n      self.showPermissions({fetched_permissions: fetched_permissions})\n      mod_toastr.success('Access to this dataset is now unrestricted.');\n    })\n    .fail(function(){\n      mod_toastr.error('An error occurred while attempting to make dataset unrestricted.');\n    });\n  },\n\n  /**\n   * Extract the role ids from Select2 elements's 'data'\n   */\n  _extractIds: function(roles_list){\n    ids_list = [];\n    for (var i = roles_list.length - 1; i >= 0; i--) {\n      ids_list.push(roles_list[i].id);\n    };\n    return ids_list;\n  },\n\n  /**\n   * Save the permissions for roles entered in the select boxes.\n   */\n  savePermissions: function(event){\n    var self = this;\n    var access_ids = this._extractIds(this.accessSelectObject.$el.select2('data'));\n    var manage_ids = this._extractIds(this.manageSelectObject.$el.select2('data'));\n    var modify_ids = this._extractIds(this.modifySelectObject.$el.select2('data'));\n    $.post( Galaxy.root + \"api/libraries/datasets/\" + self.id + \"/permissions?action=set_permissions\", { 'access_ids[]': access_ids, 'manage_ids[]': manage_ids, 'modify_ids[]': modify_ids, } )\n    .done(function(fetched_permissions){\n      self.showPermissions({fetched_permissions: fetched_permissions})\n      mod_toastr.success('Permissions saved.');\n    })\n    .fail(function(){\n      mod_toastr.error('An error occurred while attempting to set dataset permissions.');\n    })\n  },\n\n  /**\n   * Request all extensions and genomes from Galaxy\n   * and save them sorted in arrays.\n   */\n  fetchExtAndGenomes: function(){\n    var that = this;\n    mod_utils.get({\n        url      :  Galaxy.root + \"api/datatypes?extension_only=False\",\n        success  :  function( datatypes ) {\n                        for (key in datatypes) {\n                            that.list_extensions.push({\n                                id              : datatypes[key].extension,\n                                text            : datatypes[key].extension,\n                                description     : datatypes[key].description,\n                                description_url : datatypes[key].description_url\n                            });\n                        }\n                        that.list_extensions.sort(function(a, b) {\n                            return a.id > b.id ? 1 : a.id < b.id ? -1 : 0;\n                        });\n                        that.list_extensions.unshift(that.auto);\n                    }\n      });\n    mod_utils.get({\n        url     :    Galaxy.root + \"api/genomes\",\n        success : function( genomes ) {\n                    for ( key in genomes ) {\n                        that.list_genomes.push({\n                            id      : genomes[key][1],\n                            text    : genomes[key][0]\n                        });\n                    }\n                    that.list_genomes.sort(function(a, b) {\n                        return a.id > b.id ? 1 : a.id < b.id ? -1 : 0;\n                    });\n                }\n    });\n  },\n\n  renderSelectBoxes: function(options){\n    // This won't work properly unlesss we already have the data fetched.\n    // See this.fetchExtAndGenomes()\n    // TODO switch to common resources:\n    // https://trello.com/c/dIUE9YPl/1933-ui-common-resources-and-data-into-galaxy-object\n    var current_genome = '?';\n    var current_ext = 'auto';\n    if (typeof options !== 'undefined'){\n      if (typeof options.genome_build !== 'undefined'){\n        current_genome = options.genome_build;\n      }\n      if (typeof options.file_ext !== 'undefined'){\n        current_ext = options.file_ext;\n      }\n    }\n    var that = this;\n    this.select_genome = new mod_select.View( {\n        css: 'dataset-genome-select',\n        data: that.list_genomes,\n        container: that.$el.find( '#dataset_genome_select' ),\n        value: current_genome\n    } );\n    this.select_extension = new mod_select.View({\n      css: 'dataset-extension-select',\n      data: that.list_extensions,\n      container: that.$el.find( '#dataset_extension_select' ),\n      value: current_ext\n    });\n  },\n\n  templateDataset : function(){\n    return _.template([\n    // CONTAINER START\n    '<div class=\"library_style_container\">',\n      '<div id=\"library_toolbar\">',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Download dataset\" class=\"btn btn-default toolbtn-download-dataset primary-button toolbar-item\" type=\"button\">',\n          '<span class=\"fa fa-download\"></span>',\n          '&nbsp;Download',\n        '</button>',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Import dataset into history\" class=\"btn btn-default toolbtn-import-dataset primary-button toolbar-item\" type=\"button\">',\n          '<span class=\"fa fa-book\"></span>',\n          '&nbsp;to History',\n        '</button>',\n        '<% if (item.get(\"can_user_modify\")) { %>',\n          '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Modify library item\" class=\"btn btn-default toolbtn_modify_dataset primary-button toolbar-item\" type=\"button\">',\n            '<span class=\"fa fa-pencil\"></span>',\n            '&nbsp;Modify',\n          '</button>',\n        '<% } %>',\n        '<% if (item.get(\"can_user_manage\")) { %>',\n          '<a href=\"#folders/<%- item.get(\"folder_id\") %>/datasets/<%- item.id %>/permissions\">',\n            '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Manage permissions\" class=\"btn btn-default toolbtn_change_permissions primary-button toolbar-item\" type=\"button\">',\n              '<span class=\"fa fa-group\"></span>',\n              '&nbsp;Permissions',\n            '</button>',\n          '</a>',\n        '<% } %>',\n      '</div>',\n\n    // BREADCRUMBS\n    '<ol class=\"breadcrumb\">',\n      '<li><a title=\"Return to the list of libraries\" href=\"#\">Libraries</a></li>',\n      '<% _.each(item.get(\"full_path\"), function(path_item) { %>',\n        '<% if (path_item[0] != item.id) { %>',\n          '<li><a title=\"Return to this folder\" href=\"#/folders/<%- path_item[0] %>\"><%- path_item[1] %></a> </li> ',\n        '<% } else { %>',\n          '<li class=\"active\"><span title=\"You are here\"><%- path_item[1] %></span></li>',\n        '<% } %>',\n      '<% }); %>',\n    '</ol>',\n\n    '<% if (item.get(\"is_unrestricted\")) { %>',\n      '<div class=\"alert alert-info\">',\n        'This dataset is unrestricted so everybody can access it. Just share the URL of this page. ',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Copy to clipboard\" class=\"btn btn-default btn-copy-link-to-clipboard primary-button\" type=\"button\">',\n          '<span class=\"fa fa-clipboard\"></span>',\n          '&nbsp;To Clipboard',\n        '</button> ',\n      '</div>',\n    '<% } %>',\n\n    // TABLE START\n    '<div class=\"dataset_table\">',\n      '<table class=\"grid table table-striped table-condensed\">',\n        '<tr>',\n          '<th class=\"dataset-first-column\" scope=\"row\" id=\"id_row\" data-id=\"<%= _.escape(item.get(\"ldda_id\")) %>\">Name</th>',\n          '<td><%= _.escape(item.get(\"name\")) %></td>',\n        '</tr>',\n        '<% if (item.get(\"file_ext\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Data type</th>',\n            '<td><%= _.escape(item.get(\"file_ext\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"genome_build\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Genome build</th>',\n            '<td><%= _.escape(item.get(\"genome_build\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"file_size\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Size</th>',\n            '<td><%= _.escape(item.get(\"file_size\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"date_uploaded\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Date uploaded (UTC)</th>',\n            '<td><%= _.escape(item.get(\"date_uploaded\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"uploaded_by\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Uploaded by</th>',\n            '<td><%= _.escape(item.get(\"uploaded_by\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"metadata_data_lines\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Data Lines</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_data_lines\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"metadata_comment_lines\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Comment Lines</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_comment_lines\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"metadata_columns\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Number of Columns</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_columns\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"metadata_column_types\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Column Types</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_column_types\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"message\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Message</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"message\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"misc_blurb\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Miscellaneous blurb</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"misc_blurb\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"misc_info\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Miscellaneous information</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"misc_info\")) %></td>',\n          '</tr>',\n        '<% } %>',\n        '<% if (item.get(\"tags\")) { %>',\n          '<tr>',\n            '<th scope=\"row\">Tags</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"tags\")) %></td>',\n          '</tr>',\n        '<% } %>',\n      '</table>',\n\n    '<div>',\n      '<pre class=\"peek\">',\n      '</pre>',\n    '</div>',\n\n    '<% if (item.get(\"has_versions\")) { %>',\n      '<div>',\n        '<h3>Expired versions:</h3>',\n        '<ul>',\n          '<% _.each(item.get(\"expired_versions\"), function(version) { %>',\n            '<li><a title=\"See details of this version\" href=\"#folders/<%- item.get(\"folder_id\") %>/datasets/<%- item.id %>/versions/<%- version[0] %>\"><%- version[1] %></a></li>',\n          '<% }) %>',\n        '<ul>',\n      '</div>',\n    '<% } %>',\n    // TABLE END\n    '</div>',\n    // CONTAINER END\n    '</div>'\n    ].join(''));\n  },\n\n  templateVersion : function(){\n    return _.template([\n    // CONTAINER START\n    '<div class=\"library_style_container\">',\n      '<div id=\"library_toolbar\">',\n        '<a href=\"#folders/<%- item.get(\"folder_id\") %>/datasets/<%- item.id %>\">',\n          '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Go to latest dataset\" class=\"btn btn-default primary-button toolbar-item\" type=\"button\">',\n            '<span class=\"fa fa-caret-left fa-lg\"></span>',\n            '&nbsp;Latest dataset',\n          '</button>',\n        '<a>',\n      '</div>',\n\n      // BREADCRUMBS\n      '<ol class=\"breadcrumb\">',\n        '<li><a title=\"Return to the list of libraries\" href=\"#\">Libraries</a></li>',\n        '<% _.each(item.get(\"full_path\"), function(path_item) { %>',\n          '<% if (path_item[0] != item.id) { %>',\n            '<li><a title=\"Return to this folder\" href=\"#/folders/<%- path_item[0] %>\"><%- path_item[1] %></a> </li> ',\n          '<% } else { %>',\n            '<li class=\"active\"><span title=\"You are here\"><%- path_item[1] %></span></li>',\n          '<% } %>',\n        '<% }); %>',\n      '</ol>',\n\n      '<div class=\"alert alert-warning\">This is an expired version of the library dataset: <%= _.escape(item.get(\"name\")) %></div>',\n      // DATASET START\n      '<div class=\"dataset_table\">',\n        '<table class=\"grid table table-striped table-condensed\">',\n          '<tr>',\n            '<th scope=\"row\" id=\"id_row\" data-id=\"<%= _.escape(ldda.id) %>\">Name</th>',\n            '<td><%= _.escape(ldda.get(\"name\")) %></td>',\n          '</tr>',\n          '<% if (ldda.get(\"file_ext\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Data type</th>',\n              '<td><%= _.escape(ldda.get(\"file_ext\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"genome_build\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Genome build</th>',\n              '<td><%= _.escape(ldda.get(\"genome_build\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"file_size\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Size</th>',\n              '<td><%= _.escape(ldda.get(\"file_size\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"date_uploaded\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Date uploaded (UTC)</th>',\n              '<td><%= _.escape(ldda.get(\"date_uploaded\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"uploaded_by\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Uploaded by</th>',\n              '<td><%= _.escape(ldda.get(\"uploaded_by\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"metadata_data_lines\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Data Lines</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"metadata_data_lines\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"metadata_comment_lines\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Comment Lines</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"metadata_comment_lines\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"metadata_columns\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Number of Columns</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"metadata_columns\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"metadata_column_types\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Column Types</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"metadata_column_types\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"message\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Message</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"message\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"misc_blurb\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Miscellaneous blurb</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"misc_blurb\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (ldda.get(\"misc_info\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Miscellaneous information</th>',\n              '<td scope=\"row\"><%= _.escape(ldda.get(\"misc_info\")) %></td>',\n            '</tr>',\n          '<% } %>',\n          '<% if (item.get(\"tags\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Tags</th>',\n              '<td scope=\"row\"><%= _.escape(item.get(\"tags\")) %></td>',\n            '</tr>',\n          '<% } %>',\n        '</table>',\n        '<div>',\n          '<pre class=\"peek\">',\n          '</pre>',\n        '</div>',\n      // DATASET END\n      '</div>',\n    // CONTAINER END\n    '</div>'\n    ].join(''));\n  },\n\n  templateModifyDataset : function(){\n    return _.template([\n    // CONTAINER START\n    '<div class=\"library_style_container\">',\n      '<div id=\"library_toolbar\">',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Cancel modifications\" class=\"btn btn-default toolbtn_cancel_modifications primary-button toolbar-item\" type=\"button\">',\n          '<span class=\"fa fa-times\"></span>',\n          '&nbsp;Cancel',\n        '</button>',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Save modifications\" class=\"btn btn-default toolbtn_save_modifications primary-button toolbar-item\" type=\"button\">',\n          '<span class=\"fa fa-floppy-o\"></span>',\n          '&nbsp;Save',\n        '</button>',\n      '</div>',\n\n      // BREADCRUMBS\n      '<ol class=\"breadcrumb\">',\n        '<li><a title=\"Return to the list of libraries\" href=\"#\">Libraries</a></li>',\n        '<% _.each(item.get(\"full_path\"), function(path_item) { %>',\n          '<% if (path_item[0] != item.id) { %>',\n            '<li><a title=\"Return to this folder\" href=\"#/folders/<%- path_item[0] %>\"><%- path_item[1] %></a> </li> ',\n          '<% } else { %>',\n            '<li class=\"active\"><span title=\"You are here\"><%- path_item[1] %></span></li>',\n          '<% } %>',\n        '<% }); %>',\n      '</ol>',\n\n      '<div class=\"dataset_table\">',\n        '<p>For full editing options please import the dataset to history and use \"Edit attributes\" on it.</p>',\n        '<table class=\"grid table table-striped table-condensed\">',\n          '<tr>',\n            '<th class=\"dataset-first-column\" scope=\"row\" id=\"id_row\" data-id=\"<%= _.escape(item.get(\"ldda_id\")) %>\">Name</th>',\n            '<td><input class=\"input_dataset_name form-control\" type=\"text\" placeholder=\"name\" value=\"<%= _.escape(item.get(\"name\")) %>\"></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Data type</th>',\n            '<td>',\n              '<span id=\"dataset_extension_select\" class=\"dataset-extension-select\" />',\n            '</td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Genome build</th>',\n            '<td>',\n              '<span id=\"dataset_genome_select\" class=\"dataset-genome-select\" />',\n            '</td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Size</th>',\n            '<td><%= _.escape(item.get(\"file_size\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Date uploaded (UTC)</th>',\n            '<td><%= _.escape(item.get(\"date_uploaded\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Uploaded by</th>',\n            '<td><%= _.escape(item.get(\"uploaded_by\")) %></td>',\n          '</tr>',\n          '<tr scope=\"row\">',\n            '<th scope=\"row\">Data Lines</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_data_lines\")) %></td>',\n          '</tr>',\n            '<th scope=\"row\">Comment Lines</th>',\n            '<% if (item.get(\"metadata_comment_lines\") === \"\") { %>',\n              '<td scope=\"row\"><%= _.escape(item.get(\"metadata_comment_lines\")) %></td>',\n            '<% } else { %>',\n              '<td scope=\"row\">unknown</td>',\n            '<% } %>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Number of Columns</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_columns\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Column Types</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"metadata_column_types\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Message</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"message\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Miscellaneous information</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"misc_info\")) %></td>',\n          '</tr>',\n          '<tr>',\n            '<th scope=\"row\">Miscellaneous blurb</th>',\n            '<td scope=\"row\"><%= _.escape(item.get(\"misc_blurb\")) %></td>',\n          '</tr>',\n          //TODO: add functionality to modify tags here\n          '<% if (item.get(\"tags\")) { %>',\n            '<tr>',\n              '<th scope=\"row\">Tags</th>',\n              '<td scope=\"row\"><%= _.escape(item.get(\"tags\")) %></td>',\n            '</tr>',\n          '<% } %>',\n        '</table>',\n        '<div>',\n          '<pre class=\"peek\">',\n          '</pre>',\n        '</div>',\n      '</div>',\n    // CONTAINER END\n    '</div>'\n    ].join(''));\n  },\n\n  templateDatasetPermissions : function(){\n    return _.template([\n    // CONTAINER START\n    '<div class=\"library_style_container\">',\n      '<div id=\"library_toolbar\">',\n        '<a href=\"#folders/<%- item.get(\"folder_id\") %>\">',\n          '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Go back to containing folder\" class=\"btn btn-default primary-button toolbar-item\" type=\"button\">',\n            '<span class=\"fa fa-folder-open-o\"></span>',\n            '&nbsp;Containing Folder',\n          '</button>',\n        '</a>',\n        '<a href=\"#folders/<%- item.get(\"folder_id\") %>/datasets/<%- item.id %>\">',\n          '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Go back to dataset\" class=\"btn btn-default primary-button toolbar-item\" type=\"button\">',\n            '<span class=\"fa fa-file-o\"></span>',\n            '&nbsp;Dataset Details',\n          '</button>',\n        '<a>',\n      '</div>',\n\n      // BREADCRUMBS\n      '<ol class=\"breadcrumb\">',\n        '<li><a title=\"Return to the list of libraries\" href=\"#\">Libraries</a></li>',\n          '<% _.each(item.get(\"full_path\"), function(path_item) { %>',\n            '<% if (path_item[0] != item.id) { %>',\n              '<li><a title=\"Return to this folder\" href=\"#/folders/<%- path_item[0] %>\"><%- path_item[1] %></a> </li> ',\n            '<% } else { %>',\n              '<li class=\"active\"><span title=\"You are here\"><%- path_item[1] %></span></li>',\n            '<% } %>',\n        '<% }); %>',\n      '</ol>',\n\n      '<h1>Dataset: <%= _.escape(item.get(\"name\")) %></h1>',\n      '<div class=\"alert alert-warning\">',\n        '<% if (is_admin) { %>',\n          'You are logged in as an <strong>administrator</strong> therefore you can manage any dataset on this Galaxy instance. Please make sure you understand the consequences.',\n        '<% } else { %>',\n          'You can assign any number of roles to any of the following permission types. However please read carefully the implications of such actions.',\n        '<% } %>',\n      '</div>',\n      '<div class=\"dataset_table\">',\n        '<h2>Library-related permissions</h2>',\n        '<h4>Roles that can modify the library item</h4>',\n        '<div id=\"modify_perm\" class=\"modify_perm roles-selection\"></div>',\n        '<div class=\"alert alert-info roles-selection\">User with <strong>any</strong> of these roles can modify name, metadata, and other information about this library item.</div>',\n        '<hr/>',\n        '<h2>Dataset-related permissions</h2>',\n        '<div class=\"alert alert-warning\">Changes made below will affect <strong>every</strong> library item that was created from this dataset and also every history this dataset is part of.</div>',\n        '<% if (!item.get(\"is_unrestricted\")) { %>',\n          '<p>You can remove all access restrictions on this dataset. ',\n            '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Everybody will be able to access the dataset.\" class=\"btn btn-default btn-remove-restrictions primary-button\" type=\"button\">',\n              '<span class=\"fa fa-globe\"></span>',\n              '&nbsp;Remove restrictions',\n            '</button>',\n          '</p>',\n        '<% } else { %>',\n          'This dataset is unrestricted so everybody can access it. Just share the URL of this page.',\n          '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Copy to clipboard\" class=\"btn btn-default btn-copy-link-to-clipboard primary-button\" type=\"button\">',\n            '<span class=\"fa fa-clipboard\"></span>',\n            '&nbsp;To Clipboard',\n            '</button>',\n          '<p>You can make this dataset private to you. ',\n            '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Only you will be able to access the dataset.\" class=\"btn btn-default btn-make-private primary-button\" type=\"button\">',\n              '<span class=\"fa fa-key\"></span>',\n              '&nbsp;Make Private',\n            '</button>',\n          '</p>',\n        '<% } %>',\n        '<h4>Roles that can access the dataset</h4>',\n        '<div id=\"access_perm\" class=\"access_perm roles-selection\"></div>',\n        '<div class=\"alert alert-info roles-selection\">',\n          'User has to have <strong>all these roles</strong> in order to access this dataset.',\n          ' Users without access permission <strong>cannot</strong> have other permissions on this dataset.',\n          ' If there are no access roles set on the dataset it is considered <strong>unrestricted</strong>.',\n        '</div>',\n        '<h4>Roles that can manage permissions on the dataset</h4>',\n        '<div id=\"manage_perm\" class=\"manage_perm roles-selection\"></div>',\n        '<div class=\"alert alert-info roles-selection\">',\n          'User with <strong>any</strong> of these roles can manage permissions of this dataset. If you remove yourself you will loose the ability manage this dataset unless you are an admin.',\n        '</div>',\n        '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Save modifications made on this page\" class=\"btn btn-default toolbtn_save_permissions primary-button\" type=\"button\">',\n          '<span class=\"fa fa-floppy-o\"></span>',\n          '&nbsp;Save',\n        '</button>',\n      '</div>',\n    // CONTAINER END\n    '</div>'\n    ].join(''));\n  },\n\n  templateBulkImportInModal: function(){\n    return _.template([\n    '<div>',\n      '<div class=\"library-modal-item\">',\n        'Select history: ',\n        '<select id=\"dataset_import_single\" name=\"dataset_import_single\" style=\"width:50%; margin-bottom: 1em; \" autofocus>',\n          '<% _.each(histories, function(history) { %>',\n            '<option value=\"<%= _.escape(history.get(\"id\")) %>\"><%= _.escape(history.get(\"name\")) %></option>',\n          '<% }); %>',\n        '</select>',\n      '</div>',\n      '<div class=\"library-modal-item\">',\n        'or create new: ',\n        '<input type=\"text\" name=\"history_name\" value=\"\" placeholder=\"name of the new history\" style=\"width:50%;\">',\n        '</input>',\n      '</div>',\n    '</div>'\n    ].join(''));\n  },\n\n\n  templateAccessSelect: function(){\n    return _.template([\n    '<select id=\"access_select\" multiple>',\n      '<% _.each(options, function(option) { %>',\n        '<option value=\"<%- option.name %>\"><%- option.name %></option>',\n      '<% }); %>',\n    '</select>'\n    ].join(''));\n  }\n\n});\n\nreturn {\n    LibraryDatasetView: LibraryDatasetView\n};\n\n});\n"]}
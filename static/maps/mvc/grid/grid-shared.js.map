{"version":3,"sources":["mvc/grid/grid-shared.js"],"names":["define","GridView","View","Backbone","extend","initialize","options","$","this","self","Model","setElement","get","ajax","url","Galaxy","model","item","response","success","set","render","grid","attributes","$el","empty","append","_templateShared","shared_by_others","length","$table","_","each","it","index","$tmpl","toLowerCase","username","slug","display_url","escape","title"],"mappings":"aACAA,QAAU,sBAAwB,SAAUC,GAqDxC,OACIC,KAvDRC,SAAAD,KAAAE,QACUC,WAAA,SAAVC,GACQJ,IAAOC,EAAAA,KACPE,KAAAA,WAAYE,EAAA,WACRC,KAAIC,MAAO,IAAXN,SAAAO,MAAAJ,GACAE,KAAKG,KAAAA,KAAYJ,MAAGK,IAApB,QACAL,EAAAM,MACAC,IAAYC,OAAKC,KAAWR,KAAhBS,KAAZ,IAAAT,KAAAQ,MAAAJ,IAAA,aACEC,QAAK,SAAAK,GACHJ,EAAAA,aAAoC,EACpCK,EAAUH,MAAAI,IAAAF,GACNA,EAAAA,aAKXG,OAd2B,WAiBxB,IAAIC,EAAO,IAAIrB,EAAUO,KAAKQ,MAAMO,YADxCF,KAAQG,IAAAC,QAAAC,OAAWJ,EAAAE,KACfhB,KAAIc,IAAAA,OAAWrB,KAAAA,oBAGlB0B,gBApB2B,WAuBxB,IAAIlB,EAAOD,KADfmB,EAAAA,EAAiB,YACbnB,KAAAQ,MAAAJ,IAAA,UAAA,yCAIIN,EAAUE,KAAKQ,MAAMO,WACzB,GAAKjB,EAAQsB,kBAAoBtB,EAAQsB,iBAAiBC,OAA1D,EAAuE,CACnE,IAAIC,EAASvB,EAAG,+IADpBwB,EAAAC,KAiBO1B,EAAAsB,iBAAA,SAAAK,EAAAC,GACHC,IAAMT,EAAgBX,OAAKC,KAAWP,EAAAQ,KAAWmB,0CAAjDH,EAAAI,SAAA,SAAAJ,EAAAK,KACHR,EAAAJ,OAAA,oBAEJa,EAAA,KAAAR,EAAAS,OAAAP,EAAAQ,OAAA,gBARwCV,EAAES,OAAQP,EAAGI,UAAa,gBAWvEF,EAAAT,OAAAI,QANYK,EAAMT,OAAQ,MAAQlB,KAAKQ,MAAMJ,IAAK,UAAWwB,cAAgB,+BAErE,OAAOD","file":"../../../scripts/mvc/grid/grid-shared.js","sourcesContent":["/** This class renders the grid list with shared section. */\ndefine( [ 'mvc/grid/grid-view' ], function( GridView ) {\n    var View = Backbone.View.extend({\n        initialize: function( options ) {\n            var self = this;\n            this.setElement( $( '<div/>' ) );\n            this.model = new Backbone.Model( options );\n            this.item = this.model.get( 'item' );\n            $.ajax({\n                url     : Galaxy.root + this.item + '/' + this.model.get( 'action_id' ),\n                success : function( response ) {\n                    response[ 'dict_format' ] = true;\n                    self.model.set( response );\n                    self.render();\n                }\n            });\n        },\n\n        render: function() {\n            var grid = new GridView( this.model.attributes );\n            this.$el.empty().append( grid.$el );\n            this.$el.append( this._templateShared() );\n        },\n\n        _templateShared: function() {\n            var self = this;\n            var $tmpl = $(  '<div>' +\n                                '<h2>' + this.model.get( 'plural' ) + ' shared with you by others</h2>' +\n                            '</div>' );\n            var options = this.model.attributes;\n            if ( options.shared_by_others && options.shared_by_others.length > 0 ) {\n                var $table = $( '<table class=\"colored\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">' +\n                                    '<tr class=\"header\">' +\n                                        '<th>Title</th>' +\n                                        '<th>Owner</th>' +\n                                    '</tr>' +\n                                '</table>' );\n                _.each( options.shared_by_others, function( it, index ) {\n                    var display_url = Galaxy.root + self.item + '/display_by_username_and_slug?username=' + it.username + '&slug=' + it.slug;\n                    $table.append(  '<tr>' +\n                                        '<td>' +\n                                            '<a href=\"' + display_url + '\">' + _.escape( it.title ) + '</a>' +\n                                        '</td>' +\n                                        '<td>' + _.escape( it.username ) + '</td>' +\n                                    '</tr>' );\n                });\n                $tmpl.append( $table );\n            } else {\n                $tmpl.append( 'No ' + this.model.get( 'plural' ).toLowerCase() + ' have been shared with you.' );\n            }\n            return $tmpl;\n        }\n    });\n\n    return {\n        View: View\n    }\n});"]}
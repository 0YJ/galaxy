{"version":3,"sources":["ui/scroll-panel.js"],"names":["$","ui","plugin","add","drag","e","instance","this","data","clearTimeout","timeout","options","element","panel_pos","position","panel_w","panel_h","panel","viewport","viewport_w","width","viewport_h","height","element_w","element_h","moved","p_min_x","close_dist","p_min_y","min_vis_x","max_vis_x","p_max_x","min_vis_y","p_max_y","top","max_vis_y","offset","click","left","mouse_y","t","Math","min","css","mouse_x","parent","nudge","amount_moved","max","ddmanager","prepareOffsets","stop","old_e","setTimeout"],"mappings":"kCACAA,EAAAC,GAAAC,OAAAC,IAAA,YAAA,eACAC,KAAA,SAAAC,EAAAJ,GAIQ,IAAIK,EAAWN,EAAEO,MAAMC,KAAK,aAFpCC,aAAgBH,EAAAI,SACZN,IAAAA,EAAMH,EAAAU,QACFC,EAAIN,EAAaM,QACjBH,EAAAA,EAAAA,MACAI,EAAWF,EAAXG,WAAAC,EACIH,EAAUN,QADdU,EAEIC,EAAUA,SAFdC,EAGIL,EAAYI,SAHhBE,EAIIJ,EAAgBK,QAJpBC,EAKIL,EAAgBM,SALpBC,EAMIL,EAAWD,QANfO,EAOIL,EAAaD,SAPjBO,GAQIJ,EARJK,IAYIC,EAZJR,GAAAS,IAaYZ,EAbZK,GAAAQ,GAgBID,EAAYZ,KAhBhBc,EAiBIC,EAjBJZ,EAAAa,GAkBIC,EAlBJC,IAuBIC,EAAYH,EAAYX,EAHxBQ,EAAAA,EAAahB,SAAAA,KApBjBP,EAAA8B,OAAAC,MAAAC,KAAA,GAAAC,QAqBIT,EAAAA,SAAYD,IAAAA,EAAYV,OArB5BkB,MAAAH,IAAArB,EAuBIsB,KANU,GAMcd,EAdxBE,EATJM,EAAA,CA6BQW,EAAIC,KAAKC,IAnBblB,GAOU,EAYwBX,EAAUyB,MAL5CrB,EAAA0B,IAAA,OAAA9B,EAAAyB,KAAAE,GACAI,GAAAA,EACJL,EAAAA,OAAazB,OAASoB,MAAM5B,EAC5BL,EAAAa,SAAAwB,MAAAE,EAEI,IACAvB,GACAQ,EAAAA,KAAAC,GACApB,EAvBAiB,EAuBgBsB,EAChB5C,CACHuC,EAAAC,KAAAC,IAxBGlB,GAwBHX,EAAAyB,KAAAZ,GACDT,EACKQ,IAAD,OACAZ,EAAAyB,KAAiBZ,GAGjBD,GAAIe,EACJvB,EAAAA,OAAU4B,OAAQhC,MAAAA,EAClBY,EAAAA,SAAQa,MAARE,EAEAvC,IACHwB,GACDZ,EACIqB,IAjCA,GAqCAK,QA1CAhB,EA0CiBuB,EACjB7B,CACAuB,EAAAC,KAAAC,IA3CAlB,GAIA,EAuCAX,EAAAqB,KACAjB,EAAA0B,IAAII,MAAAA,EAAe9B,IAAMH,GAEzBb,EAAAgB,EAAmB8B,WAAnBb,IAAArB,EAAAqB,IACAT,EAAAA,OAAAoB,OAAAX,KAAAa,EACH9C,EAAAa,SAAAoB,KAAAa,EACDtB,GACKA,EAKDR,IACAQ,GACAZ,EAAIkC,IAAAA,GACJzC,QA3DAiB,EA2DgBsB,EAChB5C,CACAwB,IAAAA,EAAAA,KAAQiB,IA5DRlB,GA4DAX,EAAAqB,IAAAR,GACHT,EAAA0B,IAAA,MAAA9B,EAAAqB,IAAAM,EAAA,MAEDvC,IAAGa,EAAgB2B,EAASxC,IAAGa,EAASwB,WAAxCJ,IACAjC,EAAGa,OAAH+B,OAAuBG,KAAOlC,EAC9Bb,EAAGa,SAASwB,KAAOG,EACnBxC,GAAGa,EAGCd,EAAAA,SAAAsC,KAAKW,KAAUC,IAAAA,EAAAA,SAAe5C,KAA9B,GACHL,EAAAa,SAAAoB,IAAAO,KAAAO,IAAA/C,EAAAa,SAAAoB,IAAA,GACDjC,EAAAa,SAAAwB,KAAAG,KAAAC,IAAAzC,EAAAa,SAAAwB,KAAAvB,EAAAQ,GACAtB,EAAAa,SAAIW,IAAOgB,KAAAC,IAAAzC,EAAAa,SAAAoB,IAAAlB,EAAAQ,GAEPlB,GACIA,EAAAA,GAAAA,UAAAA,eAAAA,EAAAD,GAzF4BoB,IA6FxC0B,EAAMC,MAAA/C,EACFC,EAAIA,QAAa+C,WAAW,WAC5B5C,EAAaH,UAASI,IACzB,MAHDyC,KAAM,SAAS9C,EAAGJ,GACd,IAAIK,EAAWN,EAAEO,MAAMC,KAAK,aAC5BC,aAAaH,EAASI","file":"../../scripts/ui/scroll-panel.js","sourcesContent":["// This is an extension to jQuery UI draggable\n// When dragging move the parent element (\"panel\") relative to its parent\n// (\"viewport\") so that the draggable is always visible.\n\n$.ui.plugin.add(\"draggable\", \"scrollPanel\", {\n    drag: function(e, ui) {\n        var instance = $(this).data(\"draggable\");\n        clearTimeout(instance.timeout);\n        var o = ui.options,\n            element = instance.element,\n            panel = o.panel,\n            panel_pos = panel.position(),\n            panel_w = panel.width(),\n            panel_h = panel.height(),\n            viewport = panel.parent(),\n            viewport_w = viewport.width(),\n            viewport_h = viewport.height(),\n            element_w = element.width(),\n            element_h = element.height(),\n            moved = false,\n            close_dist = 5,\n            nudge = 23,\n            // Legal panel range\n            p_min_x = -(panel_w - viewport_w),\n            p_min_y = -(panel_h - viewport_h),\n            p_max_x = 0,\n            p_max_y = 0,\n            // Visible\n            min_vis_x = -panel_pos.left,\n            max_vis_x = min_vis_x + viewport_w,\n            min_vis_y = -panel_pos.top,\n            max_vis_y = min_vis_y + viewport_h,\n            // Mouse\n            mouse_x = ui.position.left + instance.offset.click.left;\n        mouse_y = ui.position.top + instance.offset.click.top;\n        // Move it\n        if (panel_pos.left < p_max_x && mouse_x - close_dist < min_vis_x) {\n            var t = Math.min(nudge, p_max_x - panel_pos.left);\n            panel.css(\"left\", panel_pos.left + t);\n            moved = true;\n            instance.offset.parent.left += t;\n            ui.position.left -= t;\n        }\n        if (\n            !moved &&\n            panel_pos.left > p_min_x &&\n            mouse_x + close_dist > max_vis_x\n        ) {\n            var t = Math.min(nudge, panel_pos.left - p_min_x);\n            panel.css(\"left\", panel_pos.left - t);\n            moved = true;\n            instance.offset.parent.left -= t;\n            ui.position.left += t;\n        }\n        if (\n            !moved &&\n            panel_pos.top < p_max_y &&\n            mouse_y - close_dist < min_vis_y\n        ) {\n            var t = Math.min(nudge, p_max_y - panel_pos.top);\n            panel.css(\"top\", panel_pos.top + t);\n            // Firefox sometimes moves by less, so we need to check. Yuck.\n            var amount_moved = panel.position().top - panel_pos.top;\n            instance.offset.parent.top += amount_moved;\n            ui.position.top -= amount_moved;\n            moved = true;\n        }\n        if (\n            !moved &&\n            panel_pos.top > p_min_y &&\n            mouse_y + close_dist > max_vis_y\n        ) {\n            var t = Math.min(nudge, panel_pos.top - p_min_x);\n            panel.css(\"top\", panel_pos.top - t + \"px\");\n            // Firefox sometimes moves by less, so we need to check. Yuck.\n            var amount_moved = panel_pos.top - panel.position().top;\n            instance.offset.parent.top -= amount_moved;\n            ui.position.top += amount_moved;\n            moved = true;\n        }\n        // Still contain in panel\n        ui.position.left = Math.max(ui.position.left, 0);\n        ui.position.top = Math.max(ui.position.top, 0);\n        ui.position.left = Math.min(ui.position.left, panel_w - element_w);\n        ui.position.top = Math.min(ui.position.top, panel_h - element_h);\n        // Update offsets\n        if (moved) {\n            $.ui.ddmanager.prepareOffsets(instance, e);\n        }\n        // Keep moving even if mouse doesn't move\n        if (moved) {\n            instance.old_e = e;\n            instance.timeout = setTimeout(function() {\n                instance.mouseMove(e);\n            }, 50);\n        }\n    },\n    stop: function(e, ui) {\n        var instance = $(this).data(\"draggable\");\n        clearTimeout(instance.timeout);\n    }\n});\n"]}
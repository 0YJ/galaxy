{"version":3,"sources":["ui/editable-text.js"],"names":["factory","define","amd","jQuery","$","fn","make_text_editable","config_dict","num_cols","num_rows","use_textarea","on_finish","help_text","container","this","addClass","click","e","children","length","removeClass","input_elt","button_elt","set_text","new_text","find","remove","text","html","cur_text","attr","rows","cols","trim","keyup","keyCode","val","value","size","blur","trigger","stopPropagation","append","focus","select","tooltip"],"mappings":"CAEC,SAAUA,GACe,kBAAXC,SAAyBA,OAAOC,IAIvCD,QAAS,UAAYD,GAGrBA,EAAQG,SAGd,SAAWA,GACb,YAEA,IAAIC,GAAID,CAQRC,GAAEC,GAAGC,mBAAqB,SAASC,GAE/B,GAAIC,GAAY,YAAcD,GAAcA,EAAYC,SAAW,GAC/DC,EAAY,YAAcF,GAAcA,EAAYE,SAAW,EAC/DC,EAAgB,gBAAkBH,IAAcA,EAAYG,aAC5DC,EAAa,aAAeJ,GAAcA,EAAYI,UAAY,KAClEC,EAAa,aAAeL,GAAcA,EAAYK,UAAY,KAGlEC,EAAYT,EAAEU,KAiFlB,OAhFAD,GAAUE,SAAS,iBAAiBC,MAAM,SAASC,GAE/C,KAAIb,EAAEU,MAAMI,SAAS,UAAUC,OAAS,GAAxC,CAIAN,EAAUO,YAAY,gBAGtB,IAkBIC,GAAWC,EAlBXC,EAAW,SAASC,GACpBX,EAAUY,KAAK,UAAUC,SAER,KAAbF,EACAX,EAAUc,KAAKH,GAGfX,EAAUe,KAAK,QAEnBf,EAAUE,SAAS,iBAEfJ,GACAA,EAAUa,IAKdK,EAAY,YAActB,GAAcA,EAAYsB,SAAWhB,EAAUc,MAGzEjB,IACAW,EAAYjB,EAAE,eACT0B,MAAOC,KAAMtB,EAAUuB,KAAMxB,IAAYmB,KAAKvB,EAAE6B,KAAKJ,IACrDK,MAAM,SAASjB,GACM,KAAdA,EAAEkB,SAEFZ,EAASM,KAGrBP,EAAalB,EAAE,aAAauB,KAAK,QAAQX,MAAM,WAG3C,MAFAO,GAASF,EAAUe,QAEZ,KAIXf,EAAYjB,EAAE,wBAAwB0B,MAAOO,MAAOjC,EAAE6B,KAAKJ,GAAWS,KAAM9B,IAC3E+B,KAAK,WACFhB,EAASM,KACVK,MAAM,SAASjB,GACI,KAAdA,EAAEkB,QAEF/B,EAAEU,MAAM0B,QAAQ,QACK,KAAdvB,EAAEkB,SAETZ,EAASnB,EAAEU,MAAMsB,OAIrBnB,EAAEwB,oBAKV5B,EAAUc,KAAK,IACfd,EAAU6B,OAAOrB,GACbC,GACAT,EAAU6B,OAAOpB,GAErBD,EAAUsB,QACVtB,EAAUuB,SAGV3B,EAAEwB,qBAIF7B,GACAC,EAAUiB,KAAK,QAASlB,GAAWiC,UAGhChC","file":"../../scripts/ui/editable-text.js","sourcesContent":["// from: https://raw.githubusercontent.com/umdjs/umd/master/jqueryPlugin.js\n// Uses AMD or browser globals to create a jQuery plugin.\n(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        //TODO: So...this turns out to be an all or nothing thing. If I load jQuery in the define below, it will\n        //  (of course) wipe the old jquery *and all the plugins loaded into it*. So the define below *is still\n        //  relying on jquery being loaded globally* in order to preserve plugins.\n        define([ 'jquery' ], factory);\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n\n}(function ( jQuery ) {\n'use_strict';\n\nvar $ = jQuery;\n\n// ============================================================================\n/**\n * Make an element with text editable: (a) when user clicks on text, a textbox/area\n * is provided for editing; (b) when enter key pressed, element's text is set and on_finish\n * is called.\n */\n$.fn.make_text_editable = function(config_dict) {\n    // Get config options.\n    var num_cols = (\"num_cols\" in config_dict ? config_dict.num_cols : 30),\n        num_rows = (\"num_rows\" in config_dict ? config_dict.num_rows : 4),\n        use_textarea = (\"use_textarea\" in config_dict ? config_dict.use_textarea : false),\n        on_finish = (\"on_finish\" in config_dict ? config_dict.on_finish : null),\n        help_text = (\"help_text\" in config_dict ? config_dict.help_text : null);\n\n    // Add element behavior.\n    var container = $(this);\n    container.addClass(\"editable-text\").click(function(e) {\n        // If there's already an input element, editing is active, so do nothing.\n        if ($(this).children(\":input\").length > 0) {\n            return;\n        }\n\n        container.removeClass(\"editable-text\");\n\n        // Handler for setting element text.\n        var set_text = function(new_text) {\n            container.find(\":input\").remove();\n\n            if (new_text !== \"\") {\n                container.text(new_text);\n            } else {\n                // No text; need a line so that there is a click target.\n                container.html(\"<br>\");\n            }\n            container.addClass(\"editable-text\");\n\n            if (on_finish) {\n                on_finish(new_text);\n            }\n        };\n\n        // Create input element(s) for editing.\n        var cur_text = (\"cur_text\" in config_dict ? config_dict.cur_text : container.text() ),\n            input_elt, button_elt;\n\n        if (use_textarea) {\n            input_elt = $(\"<textarea/>\")\n                .attr({ rows: num_rows, cols: num_cols }).text($.trim(cur_text))\n                .keyup(function(e) {\n                    if (e.keyCode === 27) {\n                        // Escape key.\n                        set_text(cur_text);\n                    }\n                });\n            button_elt = $(\"<button/>\").text(\"Done\").click(function() {\n                set_text(input_elt.val());\n                // Return false so that click does not propogate to container.\n                return false;\n            });\n        }\n        else {\n            input_elt = $(\"<input type='text'/>\").attr({ value: $.trim(cur_text), size: num_cols })\n            .blur(function() {\n                set_text(cur_text);\n            }).keyup(function(e) {\n                if (e.keyCode === 27) {\n                    // Escape key.\n                    $(this).trigger(\"blur\");\n                } else if (e.keyCode === 13) {\n                    // Enter key.\n                    set_text($(this).val());\n                }\n\n                // Do not propogate event to avoid unwanted side effects.\n                e.stopPropagation();\n            });\n        }\n\n        // Replace text with input object(s) and focus & select.\n        container.text(\"\");\n        container.append(input_elt);\n        if (button_elt) {\n            container.append(button_elt);\n        }\n        input_elt.focus();\n        input_elt.select();\n\n        // Do not propogate to elements below b/c that blurs input and prevents it from being used.\n        e.stopPropagation();\n    });\n\n    // Add help text if there some.\n    if (help_text) {\n        container.attr(\"title\", help_text).tooltip();\n    }\n\n    return container;\n};\n\n// ============================================================================\n}));\n"]}
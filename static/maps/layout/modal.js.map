{"version":3,"sources":["layout/modal.js"],"names":["define","jQuery","modal","show_modal","show_message","title","body","buttons","extra_buttons","backdrop","init_fn","show_in_overlay","options","setContent","width","show","height","hide_modal","$","scroll","closeButton","bind","unbind","url","Modal","this","$dialog","$overlay","$header","dialog","$body","find","$footer","$backdrop","on","proxy","hide","extend","prototype","html","$buttons","each","name","value","click","append","$extraButtons","callback","removeClass","css","window","outerHeight","parseInt","children","remove","undefined","overlay"],"mappings":"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","file":"../../scripts/layout/modal.js","sourcesContent":["define([\n    'jquery',\n], function (jQuery){\n\n\"use strict\";\n// ============================================================================\n//TODO: (the older version) unify with ui-modal (the newer version)\nvar $ = jQuery;\n\n// Modal dialog boxes\nvar Modal = function( options ) {\n    this.$overlay = options.overlay;\n    this.$dialog = options.dialog;\n    this.$header = this.$dialog.find( \".modal-header\" );\n    this.$body = this.$dialog.find( \".modal-body\" );\n    this.$footer = this.$dialog.find( \".modal-footer\" );\n    this.$backdrop = options.backdrop;\n    // Close button\n    this.$header.find( \".close\" ).on( \"click\", $.proxy( this.hide, this ) );\n};\n\n$.extend( Modal.prototype, {\n    setContent: function( options ) {\n        this.$header.hide();\n        // Title\n        if ( options.title ) {\n            this.$header.find( \".title\" ).html( options.title );\n            this.$header.show();\n        }\n        if ( options.closeButton ) {\n            this.$header.find( \".close\" ).show();\n            this.$header.show();\n        } else {\n            this.$header.find( \".close\" ).hide();\n        }\n        // Buttons\n        this.$footer.hide();\n        var $buttons = this.$footer.find( \".buttons\" ).html( \"\" );\n        if ( options.buttons ) {\n            $.each( options.buttons, function( name, value ) {\n                 $buttons.append( $( '<button></button> ' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        var $extraButtons = this.$footer.find( \".extra_buttons\" ).html( \"\" );\n        if ( options.extra_buttons ) {\n            $.each( options.extra_buttons, function( name, value ) {\n                 $extraButtons.append( $( '<button></button>' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        // Body\n        var body = options.body;\n        if ( body == \"progress\" ) {\n            body = $(\"<div class='progress progress-striped active'><div class='progress-bar' style='width: 100%'></div></div>\");\n        }\n        this.$body.html( body );\n    },\n    show: function( options, callback ) {\n        if ( ! this.$dialog.is( \":visible\" ) ) {\n            if ( options.backdrop) {\n                this.$backdrop.addClass( \"in\" );\n            } else {\n                this.$backdrop.removeClass( \"in\" );\n            }\n            this.$overlay.show();\n            this.$dialog.show();\n            this.$overlay.addClass(\"in\");\n            // Fix min-width so that modal cannot shrink considerably if new content is loaded.\n            this.$body.css( \"min-width\", this.$body.width() );\n            // Set max-height so that modal does not exceed window size and is in middle of page.\n            // TODO: this could perhaps be handled better using CSS.\n            this.$body.css( \"max-height\",\n                            $(window).height() -\n                            this.$footer.outerHeight() -\n                            this.$header.outerHeight() -\n                            parseInt( this.$dialog.css( \"padding-top\" ), 10 ) -\n                            parseInt( this.$dialog.css( \"padding-bottom\" ), 10 )\n                            );\n        }\n        // Callback on init\n        if ( callback ) {\n            callback();\n        }\n    },\n    hide: function() {\n        var modal = this;\n        modal.$dialog.fadeOut( function() {\n           modal.$overlay.hide();\n           modal.$backdrop.removeClass( \"in\" );\n           modal.$body.children().remove();\n           // Clear min-width to allow for modal to take size of new body.\n           modal.$body.css( \"min-width\", undefined );\n       });\n   }\n});\n\nvar modal;\n\n$(function(){\n   modal = new Modal( { overlay: $(\"#top-modal\"), dialog: $(\"#top-modal-dialog\"), backdrop: $(\"#top-modal-backdrop\") } );\n});\n\n// Backward compatibility\nfunction hide_modal() {\n    modal.hide();\n}\n\nfunction show_modal( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: true }, init_fn );\n}\n\nfunction show_message( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: false }, init_fn  );\n}\n\nfunction show_in_overlay( options ) {\n    var width = options.width || '600';\n    var height = options.height || '400';\n    var scroll = options.scroll || 'auto';\n    $(\"#overlay-background\").bind( \"click.overlay\", function() {\n        hide_modal();\n        $(\"#overlay-background\").unbind( \"click.overlay\" );\n    });\n    modal.setContent({\n        closeButton: true,\n        title: \"&nbsp;\",\n        body: $(\n            \"<div style='margin: -5px;'><iframe style='margin: 0; padding: 0;' src='\" + options.url +\n            \"' width='\" + width +\n            \"' height='\" + height +\n            \"' scrolling='\" + scroll +\n            \"' frameborder='0'></iframe></div>\"\n        )\n    });\n    modal.show( { backdrop: true } );\n}\n\n\n// ============================================================================\n    return {\n        Modal : Modal,\n        hide_modal : hide_modal,\n        show_modal : show_modal,\n        show_message : show_message,\n        show_in_overlay : show_in_overlay,\n    };\n});\n"]}
{"version":3,"sources":["layout/modal.js"],"names":["define","jQuery","modal","$","Modal","options","this","$dialog","$overlay","$header","dialog","$body","find","$footer","$backdrop","on","proxy","hide","extend","prototype","setContent","title","html","closeButton","show","$buttons","each","buttons","name","value","click","append","$extraButtons","extra_buttons","body","callback","backdrop","removeClass","css","width","window","height","outerHeight","parseInt","children","remove","undefined","overlay","hide_modal","show_modal","show_message","init_fn","show_in_overlay","scroll","bind","unbind","url"],"mappings":"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","file":"../../scripts/layout/modal.js","sourcesContent":["define([\n    'jquery',\n], function (jQuery){\n\n\"use strict\";\n// ============================================================================\n//TODO: (the older version) unify with ui-modal (the newer version)\nvar $ = jQuery;\n\n// Modal dialog boxes\nvar Modal = function( options ) {\n    this.$overlay = options.overlay;\n    this.$dialog = options.dialog;\n    this.$header = this.$dialog.find( \".modal-header\" );\n    this.$body = this.$dialog.find( \".modal-body\" );\n    this.$footer = this.$dialog.find( \".modal-footer\" );\n    this.$backdrop = options.backdrop;\n    // Close button\n    this.$header.find( \".close\" ).on( \"click\", $.proxy( this.hide, this ) );\n};\n\n$.extend( Modal.prototype, {\n    setContent: function( options ) {\n        this.$header.hide();\n        // Title\n        if ( options.title ) {\n            this.$header.find( \".title\" ).html( options.title );\n            this.$header.show();\n        }\n        if ( options.closeButton ) {\n            this.$header.find( \".close\" ).show();\n            this.$header.show();\n        } else {\n            this.$header.find( \".close\" ).hide();\n        }\n        // Buttons\n        this.$footer.hide();\n        var $buttons = this.$footer.find( \".buttons\" ).html( \"\" );\n        if ( options.buttons ) {\n            $.each( options.buttons, function( name, value ) {\n                 $buttons.append( $( '<button></button> ' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        var $extraButtons = this.$footer.find( \".extra_buttons\" ).html( \"\" );\n        if ( options.extra_buttons ) {\n            $.each( options.extra_buttons, function( name, value ) {\n                 $extraButtons.append( $( '<button></button>' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        // Body\n        var body = options.body;\n        if ( body == \"progress\" ) {\n            body = $(\"<div class='progress progress-striped active'><div class='progress-bar' style='width: 100%'></div></div>\");\n        }\n        this.$body.html( body );\n    },\n    show: function( options, callback ) {\n        if ( ! this.$dialog.is( \":visible\" ) ) {\n            if ( options.backdrop) {\n                this.$backdrop.addClass( \"in\" );\n            } else {\n                this.$backdrop.removeClass( \"in\" );\n            }\n            this.$overlay.show();\n            this.$dialog.show();\n            this.$overlay.addClass(\"in\");\n            // Fix min-width so that modal cannot shrink considerably if new content is loaded.\n            this.$body.css( \"min-width\", this.$body.width() );\n            // Set max-height so that modal does not exceed window size and is in middle of page.\n            // TODO: this could perhaps be handled better using CSS.\n            this.$body.css( \"max-height\",\n                            $(window).height() -\n                            this.$footer.outerHeight() -\n                            this.$header.outerHeight() -\n                            parseInt( this.$dialog.css( \"padding-top\" ), 10 ) -\n                            parseInt( this.$dialog.css( \"padding-bottom\" ), 10 )\n                            );\n        }\n        // Callback on init\n        if ( callback ) {\n            callback();\n        }\n    },\n    hide: function() {\n        var modal = this;\n        modal.$dialog.fadeOut( function() {\n           modal.$overlay.hide();\n           modal.$backdrop.removeClass( \"in\" );\n           modal.$body.children().remove();\n           // Clear min-width to allow for modal to take size of new body.\n           modal.$body.css( \"min-width\", undefined );\n       });\n   }\n});\n\nvar modal;\n\n$(function(){\n   modal = new Modal( { overlay: $(\"#top-modal\"), dialog: $(\"#top-modal-dialog\"), backdrop: $(\"#top-modal-backdrop\") } );\n});\n\n// Backward compatibility\nfunction hide_modal() {\n    modal.hide();\n}\n\nfunction show_modal( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: true }, init_fn );\n}\n\nfunction show_message( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: false }, init_fn  );\n}\n\nfunction show_in_overlay( options ) {\n    var width = options.width || '600';\n    var height = options.height || '400';\n    var scroll = options.scroll || 'auto';\n    $(\"#overlay-background\").bind( \"click.overlay\", function() {\n        hide_modal();\n        $(\"#overlay-background\").unbind( \"click.overlay\" );\n    });\n    modal.setContent({\n        closeButton: true,\n        title: \"&nbsp;\",\n        body: $(\n            \"<div style='margin: -5px;'><iframe style='margin: 0; padding: 0;' src='\" + options.url +\n            \"' width='\" + width +\n            \"' height='\" + height +\n            \"' scrolling='\" + scroll +\n            \"' frameborder='0'></iframe></div>\"\n        )\n    });\n    modal.show( { backdrop: true } );\n}\n\n\n// ============================================================================\n    return {\n        Modal : Modal,\n        hide_modal : hide_modal,\n        show_modal : show_modal,\n        show_message : show_message,\n        show_in_overlay : show_in_overlay,\n    };\n});\n"]}
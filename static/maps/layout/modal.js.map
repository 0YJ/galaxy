{"version":3,"sources":["layout/modal.js"],"names":["define","jQuery","hide_modal","modal","hide","show_modal","title","body","buttons","extra_buttons","init_fn","setContent","show","backdrop","show_message","show_in_overlay","options","width","height","scroll","$","bind","unbind","closeButton","url","Modal","this","$overlay","overlay","$dialog","dialog","$header","find","$body","$footer","$backdrop","on","proxy","extend","prototype","html","$buttons","each","name","value","append","text","click","$extraButtons","callback","is","addClass","removeClass","css","window","outerHeight","parseInt","fadeOut","children","remove","undefined"],"mappings":"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","file":"../../scripts/layout/modal.js","sourcesContent":["define([\n    'jquery',\n], function (jQuery){\n\n\"use strict\";\n// ============================================================================\n//TODO: (the older version) unify with ui-modal (the newer version)\nvar $ = jQuery;\n\n// Modal dialog boxes\nvar Modal = function( options ) {\n    this.$overlay = options.overlay;\n    this.$dialog = options.dialog;\n    this.$header = this.$dialog.find( \".modal-header\" );\n    this.$body = this.$dialog.find( \".modal-body\" );\n    this.$footer = this.$dialog.find( \".modal-footer\" );\n    this.$backdrop = options.backdrop;\n    // Close button\n    this.$header.find( \".close\" ).on( \"click\", $.proxy( this.hide, this ) );\n};\n\n$.extend( Modal.prototype, {\n    setContent: function( options ) {\n        this.$header.hide();\n        // Title\n        if ( options.title ) {\n            this.$header.find( \".title\" ).html( options.title );\n            this.$header.show();\n        }\n        if ( options.closeButton ) {\n            this.$header.find( \".close\" ).show();\n            this.$header.show();\n        } else {\n            this.$header.find( \".close\" ).hide();\n        }\n        // Buttons\n        this.$footer.hide();\n        var $buttons = this.$footer.find( \".buttons\" ).html( \"\" );\n        if ( options.buttons ) {\n            $.each( options.buttons, function( name, value ) {\n                 $buttons.append( $( '<button></button> ' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        var $extraButtons = this.$footer.find( \".extra_buttons\" ).html( \"\" );\n        if ( options.extra_buttons ) {\n            $.each( options.extra_buttons, function( name, value ) {\n                 $extraButtons.append( $( '<button></button>' ).text( name ).click( value ) ).append( \" \" );\n            });\n            this.$footer.show();\n        }\n        // Body\n        var body = options.body;\n        if ( body == \"progress\" ) {\n            body = $(\"<div class='progress progress-striped active'><div class='progress-bar' style='width: 100%'></div></div>\");\n        }\n        this.$body.html( body );\n    },\n    show: function( options, callback ) {\n        if ( ! this.$dialog.is( \":visible\" ) ) {\n            if ( options.backdrop) {\n                this.$backdrop.addClass( \"in\" );\n            } else {\n                this.$backdrop.removeClass( \"in\" );\n            }\n            this.$overlay.show();\n            this.$dialog.show();\n            this.$overlay.addClass(\"in\");\n            // Fix min-width so that modal cannot shrink considerably if new content is loaded.\n            this.$body.css( \"min-width\", this.$body.width() );\n            // Set max-height so that modal does not exceed window size and is in middle of page.\n            // TODO: this could perhaps be handled better using CSS.\n            this.$body.css( \"max-height\",\n                            $(window).height() -\n                            this.$footer.outerHeight() -\n                            this.$header.outerHeight() -\n                            parseInt( this.$dialog.css( \"padding-top\" ), 10 ) -\n                            parseInt( this.$dialog.css( \"padding-bottom\" ), 10 )\n                            );\n        }\n        // Callback on init\n        if ( callback ) {\n            callback();\n        }\n    },\n    hide: function() {\n        var modal = this;\n        modal.$dialog.fadeOut( function() {\n           modal.$overlay.hide();\n           modal.$backdrop.removeClass( \"in\" );\n           modal.$body.children().remove();\n           // Clear min-width to allow for modal to take size of new body.\n           modal.$body.css( \"min-width\", undefined );\n       });\n   }\n});\n\nvar modal;\n\n$(function(){\n   modal = new Modal( { overlay: $(\"#top-modal\"), dialog: $(\"#top-modal-dialog\"), backdrop: $(\"#top-modal-backdrop\") } );\n});\n\n// Backward compatibility\nfunction hide_modal() {\n    modal.hide();\n}\n\nfunction show_modal( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: true }, init_fn );\n}\n\nfunction show_message( title, body, buttons, extra_buttons, init_fn ) {\n    modal.setContent( { title: title, body: body, buttons: buttons, extra_buttons: extra_buttons } );\n    modal.show( { backdrop: false }, init_fn  );\n}\n\nfunction show_in_overlay( options ) {\n    var width = options.width || '600';\n    var height = options.height || '400';\n    var scroll = options.scroll || 'auto';\n    $(\"#overlay-background\").bind( \"click.overlay\", function() {\n        hide_modal();\n        $(\"#overlay-background\").unbind( \"click.overlay\" );\n    });\n    modal.setContent({\n        closeButton: true,\n        title: \"&nbsp;\",\n        body: $(\n            \"<div style='margin: -5px;'><iframe style='margin: 0; padding: 0;' src='\" + options.url +\n            \"' width='\" + width +\n            \"' height='\" + height +\n            \"' scrolling='\" + scroll +\n            \"' frameborder='0'></iframe></div>\"\n        )\n    });\n    modal.show( { backdrop: true } );\n}\n\n\n// ============================================================================\n    return {\n        Modal : Modal,\n        hide_modal : hide_modal,\n        show_modal : show_modal,\n        show_message : show_message,\n        show_in_overlay : show_in_overlay,\n    };\n});\n"]}
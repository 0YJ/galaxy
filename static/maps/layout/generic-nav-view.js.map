{"version":3,"sources":["layout/generic-nav-view.js"],"names":["GenericNavView","Backbone","View","extend","initialize","this","modal","makeModalIframe","e","$el_chat_modal_header","$el_chat_modal_body","Galaxy","iframe_template","window","config","communication_server_host","communication_server_port","query_string","escape","user","attributes","username","persistent_communication_rooms","$","length","header_template","frame_width","_uiModal2","default","body","class_names","height","width","closing_events","cls","frame_height","addClass","find","remove","removeAttr","css","hasClass","removeClass","attr","click","render","tooltip","icon","self","navItem","id"],"mappings":"sMAEIA,EAAiBC,SAASC,KAAKC,QAC/BC,WAAY,WACRC,KAAKC,MAAQ,MAIjBC,gBAAiB,SAASC,GAEtB,IADAC,EAAA,KACAC,EAAkBC,KAElBC,EAAAA,+DAFWC,OAAOF,OAAOG,OAAOC,0BAFpCR,IAIeM,OAAOF,OAAOG,OAAOE,2BAO5BC,aANWC,OAAOL,OAAOF,OAAOQ,KAAKC,WAAWC,UAMhD,mCAjBSH,OACjBd,OAAAA,OAAYU,OAAAQ,kCASR,eAoEQC,OA3CJA,EAAE,eAAeC,OAAS,GAV9BD,EAAA,eAAIE,SAMJzB,EAAI0B,MAAc,IAAlBC,EAAAC,QAAA1B,MACA2B,KAAIC,EASAC,OAtBA,IAeJC,MAdIvB,IAeJwB,gBAAM,EACFV,iBAAE,EACLW,IAhBGxB,wBAoBAqB,EAAAA,MAAQI,OACRH,EAAON,EAH2B,6BAIlCO,EAAAA,EAAgB,2BAEhBC,EAAKJ,SAAAA,qBAN6BpB,EAAtC0B,SAAA,qBAgBA3B,EAAsB4B,KAAK,MAAMC,SAPjC7B,EAAA8B,WAAA,6BACAvC,EAAeM,OApCf,uPAsCAI,EAAAA,gBAAAA,MAAAA,SAAAA,GACAa,EAAA,eAAAiB,IAAA,UAAA,UAGA/B,EAAAA,0BAAsB4B,MAAK,SAAA7B,GAC3BC,EAAAA,0BAAAgC,SAAiC,cACjChC,EAAAA,6BAA6BgB,MAAAA,UAC7BF,EAAA,2BAAAQ,OAAA,SACER,EAAA,0BACImB,YAAeF,aADrBJ,SAAA,eAGAb,EAAA,0BAAAoB,KAAA,QAAA,YACEpB,EAAA,0BAA0BqB,IAAM,cAAK,WAE/BrB,EAAAA,6BAAES,MAAFN,SACAH,EAAAA,2BAAEQ,OAAFI,SACAZ,EAAAA,0BAGAA,YAAE,eACFA,SAAE,aACLA,EARD,0BAQOoB,KAAA,QAAA,YACHpB,EAAAA,0BAAEiB,IAAA,cAAsCd,YAKxCH,MAIRsB,OAAA,WAUIC,OANRD,GAAQ,mBACJE,KAAIC,eACJF,QAAIG,cACJA,SAAAA,EACIC,QA1F8B7C,KA0F1BE,+BAOXP,eAAAA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["/** Real-time Communication feature **/\nimport Modal from \"mvc/ui/ui-modal\";\nvar GenericNavView = Backbone.View.extend({\n    initialize: function() {\n        this.modal = null;\n    },\n\n    /** makes bootstrap modal and iframe inside it */\n    makeModalIframe: function(e) {\n        // make modal\n        var host = window.Galaxy.config.communication_server_host;\n\n        var port = window.Galaxy.config.communication_server_port;\n        var username = escape(window.Galaxy.user.attributes.username);\n\n        var persistent_communication_rooms = escape(\n            window.Galaxy.config.persistent_communication_rooms\n        );\n\n        var query_string = `?username=${username}&persistent_communication_rooms=${persistent_communication_rooms}`;\n\n        var src = `${host}:${port}${query_string}`;\n        var $el_chat_modal_header = null;\n        var $el_chat_modal_body = null;\n\n        var iframe_template = `<iframe class=\"f-iframe fade in communication-iframe\" src=\"${src}\"> </iframe>`;\n\n        var header_template =\n            '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n            '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n            '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>';\n\n        var frame_height = 350;\n        var frame_width = 600;\n        var class_names = \"ui-modal chat-modal\";\n\n        // deletes the chat modal if already present and create one\n        if ($(\".chat-modal\").length > 0) {\n            $(\".chat-modal\").remove();\n        }\n        // creates a modal\n        GenericNavView.modal = new Modal.View({\n            body: iframe_template,\n            height: frame_height,\n            width: frame_width,\n            closing_events: true,\n            title_separator: false,\n            cls: class_names\n        });\n\n        // shows modal\n        GenericNavView.modal.show();\n        $el_chat_modal_header = $(\".chat-modal .modal-header\");\n        $el_chat_modal_body = $(\".chat-modal .modal-body\");\n        // adjusts the css of bootstrap modal for chat\n        $el_chat_modal_header.addClass(\"modal-header-body\");\n        $el_chat_modal_body.addClass(\"modal-header-body\");\n        $el_chat_modal_header.find(\"h4\").remove();\n        $el_chat_modal_header.removeAttr(\"min-height padding border\");\n        $el_chat_modal_header.append(header_template);\n        // click event of the close button for chat\n        $(\".close-modal\").click(e => {\n            $(\".chat-modal\").css(\"display\", \"none\");\n        });\n        // click event of expand and compress icon\n        $(\".expand-compress-modal\").click(e => {\n            if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                $(\".chat-modal .modal-body\").height(\"575px\");\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-expand\")\n                    .addClass(\"fa-compress\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n            } else {\n                $(\".chat-modal .modal-dialog\").width(`${frame_width}px`);\n                $(\".chat-modal .modal-body\").height(`${frame_height}px`);\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-compress\")\n                    .addClass(\"fa-expand\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n            }\n        });\n        return this;\n    },\n\n    /**renders the chat icon as a nav item*/\n    render: function() {\n        var self = this;\n        var navItem = {};\n        navItem = {\n            id: \"show-chat-online\",\n            icon: \"fa-comment-o\",\n            tooltip: \"Chat online\",\n            visible: false,\n            onclick: self.makeModalIframe\n        };\n        return navItem;\n    }\n});\n\nexport default {\n    GenericNavView: GenericNavView\n};\n"]}
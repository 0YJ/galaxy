{"version":3,"sources":["layout/generic-nav-view.js"],"names":["GenericNavView","Backbone","View","extend","initialize","this","modal","makeModalIframe","e","$el_chat_modal_header","window","$el_chat_modal_body","iframe_template","Galaxy","config","communication_server_host","communication_server_port","escape","user","attributes","username","persistent_communication_rooms","$","length","remove","_uiModal2","default","body","height","frame_height","width","frame_width","closing_events","title_separator","show","addClass","click","css","hasClass","attr","removeClass","navItem","visible","onclick","tooltip","id"],"mappings":"sMAEIA,EAAiBC,SAASC,KAAKC,QAC/BC,WAAY,WACRC,KAAKC,MAAQ,MAIjBC,gBAAiB,SAASC,GAEtB,IAGAC,EAAsBC,KAclBC,EAAsB,KAEtBC,EAVJ,+DATWF,OAAOG,OAAOC,OAAOC,0BAErBL,IAAAA,OAAOG,OAAOC,OAAOE,2BALpC,aAMmBC,OAAOP,OAAOG,OAAOK,KAAKC,WAAWC,UAJpD,mCAPaH,OACjBb,OAAAA,OAAYU,OAAAO,kCAsBR,eAqEJ,OAnDIC,EAAA,eAAAC,OAAA,GACAD,EAAA,eAAME,SAGNxB,EAAAM,MAAA,IAAAmB,EAAAC,QAAAxB,MACAF,KAAAA,EACI2B,OAVe,IAWfC,MAXAC,IAYAC,gBAAOC,EACPC,iBAAAA,EACAC,IAbAF,wBAiBJ/B,EAAAM,MAAA4B,OACAlC,EAAAsB,EAAqBY,6BACrBzB,EAAAA,EAAAA,2BAEAA,EAAA0B,SAAA,qBACA1B,EAAAA,SAAsB0B,qBACtBxB,EAAAA,KAAoBwB,MAASX,SAC7Bf,EAAAA,WAA2B,6BAC3BA,EAAAA,OA9BI,uPAgCJa,EAAA,gBAAAc,MAAA,SAAA5B,GACAc,EAAE,eAAFe,IAAkBD,UAAM,UAGxBd,EAAA,0BAAAc,MAAA,SAAA5B,GACEc,EAAA,0BAA0Bc,SAAM,cAC9Bd,EAAA,6BAAIQ,MAA4BQ,UAC5BhB,EAAAA,2BAAEM,OAA6BE,SAC/BR,EAAAA,0BACAA,YAAE,aAGFA,SAAE,eACFA,EAAAA,0BAAEiB,KAA0BF,QAAI,YACnCf,EARD,0BAQOe,IAAA,cAAA,WAEHf,EAAAA,6BAAAQ,MAA6BF,SAC7BN,EAAAA,2BAAEM,OACGY,SAELlB,EAAAA,0BACAA,YAAE,eACLa,SAAA,aAjBLb,EAAA,0BAAAiB,KAAA,QAAA,YAmBAjB,EAAA,0BAAAe,IAAA,cAAA,YAGJhC,MAIIoC,OAAAA,WAOA,OAHIC,GAAAA,mBACAC,KAAAA,eALMC,QAAV,cAOAF,SAAOD,EACVE,QAPOE,KAOPtC,+BAIDP,eAAgBA","file":"../../scripts/layout/generic-nav-view.js","sourcesContent":["/** Real-time Communication feature **/\nimport Modal from \"mvc/ui/ui-modal\";\nvar GenericNavView = Backbone.View.extend({\n    initialize: function() {\n        this.modal = null;\n    },\n\n    /** makes bootstrap modal and iframe inside it */\n    makeModalIframe: function(e) {\n        // make modal\n        var host = window.Galaxy.config.communication_server_host;\n\n        var port = window.Galaxy.config.communication_server_port;\n        var username = escape(window.Galaxy.user.attributes.username);\n\n        var persistent_communication_rooms = escape(\n            window.Galaxy.config.persistent_communication_rooms\n        );\n\n        var query_string =\n            \"?username=\" +\n            username +\n            \"&persistent_communication_rooms=\" +\n            persistent_communication_rooms;\n\n        var src = host + \":\" + port + query_string;\n        var $el_chat_modal_header = null;\n        var $el_chat_modal_body = null;\n\n        var iframe_template =\n            '<iframe class=\"f-iframe fade in communication-iframe\" src=\"' +\n            src +\n            '\"> </iframe>';\n\n        var header_template =\n            '<i class=\"fa fa-comment\" aria-hidden=\"true\" title=\"Communicate with other users\"></i>' +\n            '<i class=\"fa fa-expand expand-compress-modal\" aria-hidden=\"true\" title=\"Maximize\"></i>' +\n            '<i class=\"fa fa-times close-modal\" aria-hidden=\"true\" title=\"Close\"></i>';\n\n        var frame_height = 350;\n        var frame_width = 600;\n        var class_names = \"ui-modal chat-modal\";\n\n        // deletes the chat modal if already present and create one\n        if ($(\".chat-modal\").length > 0) {\n            $(\".chat-modal\").remove();\n        }\n        // creates a modal\n        GenericNavView.modal = new Modal.View({\n            body: iframe_template,\n            height: frame_height,\n            width: frame_width,\n            closing_events: true,\n            title_separator: false,\n            cls: class_names\n        });\n\n        // shows modal\n        GenericNavView.modal.show();\n        $el_chat_modal_header = $(\".chat-modal .modal-header\");\n        $el_chat_modal_body = $(\".chat-modal .modal-body\");\n        // adjusts the css of bootstrap modal for chat\n        $el_chat_modal_header.addClass(\"modal-header-body\");\n        $el_chat_modal_body.addClass(\"modal-header-body\");\n        $el_chat_modal_header.find(\"h4\").remove();\n        $el_chat_modal_header.removeAttr(\"min-height padding border\");\n        $el_chat_modal_header.append(header_template);\n        // click event of the close button for chat\n        $(\".close-modal\").click(function(e) {\n            $(\".chat-modal\").css(\"display\", \"none\");\n        });\n        // click event of expand and compress icon\n        $(\".expand-compress-modal\").click(function(e) {\n            if ($(\".expand-compress-modal\").hasClass(\"fa-expand\")) {\n                $(\".chat-modal .modal-dialog\").width(\"1000px\");\n                $(\".chat-modal .modal-body\").height(\"575px\");\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-expand\")\n                    .addClass(\"fa-compress\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Minimize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"96.2%\");\n            } else {\n                $(\".chat-modal .modal-dialog\").width(frame_width + \"px\");\n                $(\".chat-modal .modal-body\").height(frame_height + \"px\");\n                $(\".expand-compress-modal\")\n                    .removeClass(\"fa-compress\")\n                    .addClass(\"fa-expand\");\n                $(\".expand-compress-modal\").attr(\"title\", \"Maximize\");\n                $(\".expand-compress-modal\").css(\"margin-left\", \"93.2%\");\n            }\n        });\n        return this;\n    },\n\n    /**renders the chat icon as a nav item*/\n    render: function() {\n        var self = this;\n        var navItem = {};\n        navItem = {\n            id: \"show-chat-online\",\n            icon: \"fa-comment-o\",\n            tooltip: \"Chat online\",\n            visible: false,\n            onclick: self.makeModalIframe\n        };\n        return navItem;\n    }\n});\n\nexport default {\n    GenericNavView: GenericNavView\n};\n"]}
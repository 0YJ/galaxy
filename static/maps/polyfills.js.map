{"version":3,"sources":["polyfills.js"],"names":["window","console","log","debug","info","warn","error","assert","Object","assign","_","extend","lastTime","vendors","x","length","requestAnimationFrame","cancelRequestAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","cancelAnimationFrame","clearTimeout","features","name","compatible","CanvasRenderingContext2D","sessionStorage","err","incompatibilities","filter","feature","map","root","document","querySelectorAll","item","location","href","join"],"mappings":"CAKA,WAMI,YAKAA,QAAOC,QAAUD,OAAOC,UACpBC,IAAU,aACVC,MAAU,aACVC,KAAU,aACVC,KAAU,aACVC,MAAU,aACVC,OAAU,cAIdC,OAAOC,OAASD,OAAOC,QAAUC,EAAEC,MAKnC,KAAI,GAFAC,GAAW,EACXC,GAAW,KAAM,MAAO,SAAU,KAC9BC,EAAI,EAAGA,EAAID,EAAQE,SAAWf,OAAOgB,wBAAyBF,EAClEd,OAAOgB,sBAAwBhB,OAAOa,EAAQC,GAAG,yBACjDd,OAAOiB,4BAA8BjB,OAAOa,EAAQC,GAClD,8BAGDd,QAAOgB,wBACRhB,OAAOgB,sBAAwB,SAASE,EAAUC,GAC9C,GAAIC,IAAW,GAAIC,OAAOC,UACtBC,EAAaC,KAAKC,IAAI,EAAG,IAAML,EAAWR,IAC1Cc,EAAK1B,OAAO2B,WAAW,WAAaT,EAASE,EAAWG,IAC1DA,EAEF,OADAX,GAAWQ,EAAWG,EACfG,IAGV1B,OAAO4B,uBACR5B,OAAO4B,qBAAuB,SAASF,GACnCG,aAAaH,IAIrB,IAAII,KACEC,KAAM,SAAoBC,WAAY,WAAY,MAAOhC,QAAOiC,4BAChEF,KAAM,iBAAoBC,WAAY,WACpC,IACI,MAAOhC,QAAOkC,eAAenB,QAAU,EACzC,MAAOoB,IACT,OAAO,KAIXC,EAAoBN,EACnBO,OAAQ,SAAUC,GAAW,OAAQA,EAAQN,eAC7CO,IAAK,SAAUD,GAAW,MAAOA,GAAQP,MAG9C,IAAMK,EAAkBrB,OAAQ,CAC5B,GAAIyB,GAAOC,SAASC,iBAAkB,qBAAsBC,KAAM,EAC9DH,KACAxC,OAAO4C,SAAWJ,EAAKK,KAAO,oCAElC5C,QAAQC,IAAK,0BAA4BkC,EAAkBU,KAAM","file":"../scripts/polyfills.js","sourcesContent":["/**\n    Perform feature inference and redirect if below some minimum (must have canvas, etc.)\n    and polyfill for non-standard features.\n */\n\n(function() {\n    /* TODO: move to modernizr or something besides us doing this...\n     * These are across all of our apps (reports, tool shed), but:\n     *     these should be configurable via options because they all need different things.\n     * So, analysis-polyfills.js, reports-polyfills.js (or analysis/polyfills)\n     */\n    'use strict';\n    /*globals window, clearTimeout */\n\n    // ------------------------------------------------------------------ polyfills\n    // console protection needed in some versions of IE (at this point (IE>=9), shouldn't be needed)\n    window.console = window.console || {\n        log     : function(){},\n        debug   : function(){},\n        info    : function(){},\n        warn    : function(){},\n        error   : function(){},\n        assert  : function(){}\n    };\n\n    // phantomjs: does not have the native extend fn assign\n    Object.assign = Object.assign || _.extend;\n\n    // requestAnimationFrame polyfill\n    var lastTime = 0;\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n        window.cancelRequestAnimationFrame = window[vendors[x]+\n          'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = function(callback, element) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); },\n              timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = function(id) {\n            clearTimeout(id);\n    };\n\n    // ------------------------------------------------------------------ can't/won't polyfill\n    var features = [\n        { name: 'canvas',           compatible: function(){ return window.CanvasRenderingContext2D; } },\n        { name: 'sessionStorage',   compatible: function(){\n            try {\n                return window.sessionStorage.length >= 0;\n            } catch( err ){}\n            return false;\n        }},\n    ];\n    // build a list of feature names for features that were not found\n    var incompatibilities = features\n        .filter( function( feature ){ return !feature.compatible(); })\n        .map( function( feature ){ return feature.name; });\n\n    // if there are needed features missing, follow the index link to the static incompat warning\n    if( !!incompatibilities.length ){\n        var root = document.querySelectorAll( 'link[rel=\"index\"]' ).item( 0 );\n        if( root ){\n            window.location = root.href + 'static/incompatible-browser.html';\n        }\n        console.log( 'incompatible browser:\\n' + incompatibilities.join( '\\n' ) );\n    }\n\n})();\n"]}
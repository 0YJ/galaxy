{"version":3,"sources":["polyfills.js"],"names":["window","console","log","debug","info","Object","assign","_","extend","vendors","x","length","requestAnimationFrame","lastTime","callback","element","getTime","currTime","Date","timeToCall","Math","id","cancelAnimationFrame","features","compatible","CanvasRenderingContext2D","name","sessionStorage","err","incompatibilities","filter","feature","map","root","document","querySelectorAll","item","location","join"],"mappings":"cAKA,WASIA,OAAAC,QAAAD,OAAAC,UACAC,IAAA,aAGIC,MAAU,aAFdH,KAAA,aACIE,KAAU,aACVC,MAAU,aACVC,OAAU,cAHqBC,OAAnCC,OAAAD,OAAAC,QAAAC,EAAAC,MAYA,KAAA,GAFAH,GAAA,EAIII,GAAW,KAAM,MAAO,SAAU,KAFtCC,EAAA,EAAAA,EAAAD,EAAAE,SAAAX,OAAAY,wBAAAF,EACIG,OAAAA,sBAAJb,OAAAS,EAAAC,GAAA,yBACID,OAAAA,4BAAUT,OAAdS,EAAAC,GACI,8BAIHV,QAAAY,wBAGGZ,OAAOY,sBAAwB,SAASE,EAAUC,GADjDf,GAAOY,IAAAA,GAAAA,OAAZI,UAEYC,EAAeC,KAAOF,IAAAA,EAAX,IAAfC,EAAAJ,IACIM,EAAAA,OAAaC,WAAY,WAAMH,EAAWJ,EAA9CM,IACIE,EACFF,OADsCL,GAASG,EAAWE,EAC1DA,IAJNnB,OAAAsB,uBAUAtB,OAAOsB,qBAAuB,SAASD,GADtCrB,aAAOsB,IAKZ,IAAAC,KACIA,KAAAA,SACAC,WAA4BA,WAAY,MAAAxB,QAAUyB,4BAAEC,KAAA,iBAAcD,WAAAA,WADvD,IAGH,MAAAzB,QAAA2B,eAAAhB,QAAA,EACA,MAAAiB,IACH,OAAC,KAKNC,EAAoBN,EACUO,OAAQC,SAAQP,GAAhB,OAAAO,EAAAP,eAC7BQ,IAAK,SAAUD,GAAS,MAAAA,GAAAL,MAG7B,IAAMG,EAAkBlB,OAAQ,CADhC,GAAAsB,GAAAC,SAAAC,iBAAA,qBAAAC,KAAA,EACMP,KACEI,OAAOC,SAASC,EAAAA,KAAAA,oCAEhBnC,QAAAA,IAAOqC,0BAAuBR,EAAAS,KAAA","file":"../scripts/polyfills.js","sourcesContent":["/**\n    Perform feature inference and redirect if below some minimum (must have canvas, etc.)\n    and polyfill for non-standard features.\n */\n\n(function() {\n    /* TODO: move to modernizr or something besides us doing this...\n     * These are across all of our apps (reports, tool shed), but:\n     *     these should be configurable via options because they all need different things.\n     * So, analysis-polyfills.js, reports-polyfills.js (or analysis/polyfills)\n     */\n    'use strict';\n    /*globals window, clearTimeout */\n\n    // ------------------------------------------------------------------ polyfills\n    // console protection needed in some versions of IE (at this point (IE>=9), shouldn't be needed)\n    window.console = window.console || {\n        log     : function(){},\n        debug   : function(){},\n        info    : function(){},\n        warn    : function(){},\n        error   : function(){},\n        assert  : function(){}\n    };\n\n    // phantomjs: does not have the native extend fn assign\n    Object.assign = Object.assign || _.extend;\n\n    // requestAnimationFrame polyfill\n    var lastTime = 0;\n    var vendors = ['ms', 'moz', 'webkit', 'o'];\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n        window.cancelRequestAnimationFrame = window[vendors[x]+\n          'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = function(callback, element) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); },\n              timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = function(id) {\n            clearTimeout(id);\n    };\n\n    // ------------------------------------------------------------------ can't/won't polyfill\n    var features = [\n        { name: 'canvas',           compatible: function(){ return window.CanvasRenderingContext2D; } },\n        { name: 'sessionStorage',   compatible: function(){\n            try {\n                return window.sessionStorage.length >= 0;\n            } catch( err ){}\n            return false;\n        }},\n    ];\n    // build a list of feature names for features that were not found\n    var incompatibilities = features\n        .filter( function( feature ){ return !feature.compatible(); })\n        .map( function( feature ){ return feature.name; });\n\n    // if there are needed features missing, follow the index link to the static incompat warning\n    if( !!incompatibilities.length ){\n        var root = document.querySelectorAll( 'link[rel=\"index\"]' ).item( 0 );\n        if( root ){\n            window.location = root.href + 'static/incompatible-browser.html';\n        }\n        console.log( 'incompatible browser:\\n' + incompatibilities.join( '\\n' ) );\n    }\n\n})();\n"]}
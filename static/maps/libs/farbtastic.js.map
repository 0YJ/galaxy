{"version":3,"sources":["libs/farbtastic.js"],"names":["$","fn","farbtastic","options","this","container","_farbtastic","fb","linkTo","callback","unbind","updateValue","color","bind","value","setColor","event","unpack","rgb","hsl","RGBToHSL","updateDisplay","setHSL","HSLToRGB","pack","initWidget","dim","width","height","html","find","attr","css","end","browser","msie","radius","wheelWidth","square","Math","floor","mid","markerSize","solidFill","left","top","cnvMask","ctxMask","getContext","cnvOverlay","ctxOverlay","translate","drawCircle","drawMask","color1","d1","r","Date","w","nudge","PI","m","angle1","save","lineWidth","scale","i","d2","angle2","x1","sin","y1","cos","x2","y2","am","tan","xm","ym","color2","corr","min","abs","grad","createLinearGradient","addColorStop","fillStyle","r1","r2","beginPath","moveTo","quadraticCurveTo","lineTo","fill","strokeStyle","stroke","restore","calculateMask","sizex","sizey","outputPixel","isx","isy","y","l","x","s","a","c","size","sq","getImageData","sz","buffer","document","createElement","ctx","frame","data","putImageData","drawImage","cache_last","cache","round","c_last","a_last","packDX","position","filter","appendTo","push","fillRect","drawMarkers","lw","ceil","angle","c1","invert","c2","circles","clearRect","length","arc","backgroundColor","each","change","call","widgetCoords","pageX","offset","pageY","mousedown","dragging","mousemove","mouseup","pos","circleDrag","max","hue","atan2","sat","lum","dec2hex","toString","g","b","parseInt","substring","m1","m2","h","hueToRGB","delta","extend","jQuery"],"mappings":"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","file":"../../scripts/libs/farbtastic.js","sourcesContent":["// Farbtastic 2.0.0-alpha.1\n(function ($) {\n\nvar __debug = false;\n\n$.fn.farbtastic = function (options) {\n  $.farbtastic(this, options);\n  return this;\n};\n\n$.farbtastic = function (container, options) {\n  var container = $(container)[0];\n  return container.farbtastic || (container.farbtastic = new $._farbtastic(container, options));\n}\n\n$._farbtastic = function (container, options) {\n  var fb = this;\n\n  /////////////////////////////////////////////////////\n\n  /**\n   * Link to the given element(s) or callback.\n   */\n  fb.linkTo = function (callback) {\n    // Unbind previous nodes\n    if (typeof fb.callback == 'object') {\n      $(fb.callback).unbind('keyup', fb.updateValue);\n    }\n\n    // Reset color\n    fb.color = null;\n\n    // Bind callback or elements\n    if (typeof callback == 'function') {\n      fb.callback = callback;\n    }\n    else if (typeof callback == 'object' || typeof callback == 'string') {\n      fb.callback = $(callback);\n      fb.callback.bind('keyup', fb.updateValue);\n      if (fb.callback[0].value) {\n        fb.setColor(fb.callback[0].value);\n      }\n    }\n    return this;\n  }\n  fb.updateValue = function (event) {\n    if (this.value && this.value != fb.color) {\n      fb.setColor(this.value);\n    }\n  }\n\n  /**\n   * Change color with HTML syntax #123456\n   */\n  fb.setColor = function (color) {\n    var unpack = fb.unpack(color);\n    if (fb.color != color && unpack) {\n      fb.color = color;\n      fb.rgb = unpack;\n      fb.hsl = fb.RGBToHSL(fb.rgb);\n      fb.updateDisplay();\n    }\n    return this;\n  }\n\n  /**\n   * Change color with HSL triplet [0..1, 0..1, 0..1]\n   */\n  fb.setHSL = function (hsl) {\n    fb.hsl = hsl;\n    fb.rgb = fb.HSLToRGB(hsl);\n    fb.color = fb.pack(fb.rgb);\n    fb.updateDisplay();\n    return this;\n  }\n\n  /////////////////////////////////////////////////////\n\n  /**\n   * Initialize the color picker widget.\n   */\n  fb.initWidget = function () {\n\n    // Insert markup and size accordingly.\n    var dim = {\n      width: options.width,\n      height: options.width\n    };\n    $(container)\n      .html(\n        '<div class=\"farbtastic\" style=\"position: relative\">' +\n          '<div class=\"farbtastic-solid\"></div>' +\n          '<canvas class=\"farbtastic-mask\"></canvas>' +\n          '<canvas class=\"farbtastic-overlay\"></canvas>' +\n        '</div>'\n      )\n      .find('*').attr(dim).css(dim).end()\n      .find('div>*').css('position', 'absolute');\n\n    // IE Fix: Recreate canvas elements with doc.createElement and excanvas.\n    $.browser.msie || false && $('canvas', container).each(function () {\n      // Fetch info.\n      var attr = { 'class': $(this).attr('class'), style: this.getAttribute('style') },\n          e = document.createElement('canvas');\n      // Replace element.\n      $(this).before($(e).attr(attr)).remove();\n      // Init with explorerCanvas.\n      G_vmlCanvasManager && G_vmlCanvasManager.initElement(e);\n      // Set explorerCanvas elements dimensions and absolute positioning.\n      $(e).attr(dim).css(dim).css('position', 'absolute')\n        .find('*').attr(dim).css(dim);\n    });\n\n    // Determine layout\n    fb.radius = (options.width - options.wheelWidth) / 2 - 1;\n    fb.square = Math.floor((fb.radius - options.wheelWidth / 2) * 0.7) - 1;\n    fb.mid = Math.floor(options.width / 2);\n    fb.markerSize = options.wheelWidth * 0.3;\n    fb.solidFill = $('.farbtastic-solid', container).css({\n      width: fb.square * 2 - 1,\n      height: fb.square * 2 - 1,\n      left: fb.mid - fb.square,\n      top: fb.mid - fb.square\n    });\n\n    // Set up drawing context.\n    fb.cnvMask = $('.farbtastic-mask', container);\n    fb.ctxMask = fb.cnvMask[0].getContext('2d');\n    fb.cnvOverlay = $('.farbtastic-overlay', container);\n    fb.ctxOverlay = fb.cnvOverlay[0].getContext('2d');\n    fb.ctxMask.translate(fb.mid, fb.mid);\n    fb.ctxOverlay.translate(fb.mid, fb.mid);\n\n    // Draw widget base layers.\n    fb.drawCircle();\n    fb.drawMask();\n  }\n\n  /**\n   * Draw the color wheel.\n   */\n  fb.drawCircle = function () {\n    var tm = +(new Date());\n    // Draw a hue circle with a bunch of gradient-stroked beziers.\n    // Have to use beziers, as gradient-stroked arcs don't work.\n    var n = 24,\n        r = fb.radius,\n        w = options.wheelWidth,\n        nudge = 8 / r / n * Math.PI, // Fudge factor for seams.\n        m = fb.ctxMask,\n        angle1 = 0, color1, d1;\n    m.save();\n    m.lineWidth = w / r;\n    m.scale(r, r);\n    // Each segment goes from angle1 to angle2.\n    for (var i = 0; i <= n; ++i) {\n      var d2 = i / n,\n          angle2 = d2 * Math.PI * 2,\n          // Endpoints\n          x1 = Math.sin(angle1), y1 = -Math.cos(angle1);\n          x2 = Math.sin(angle2), y2 = -Math.cos(angle2),\n          // Midpoint chosen so that the endpoints are tangent to the circle.\n          am = (angle1 + angle2) / 2,\n          tan = 1 / Math.cos((angle2 - angle1) / 2),\n          xm = Math.sin(am) * tan, ym = -Math.cos(am) * tan,\n          // New color\n          color2 = fb.pack(fb.HSLToRGB([d2, 1, 0.5]));\n      if (i > 0) {\n        if ($.browser.msie || false) {\n          // IE's gradient calculations mess up the colors. Correct along the diagonals.\n          var corr = (1 + Math.min(Math.abs(Math.tan(angle1)), Math.abs(Math.tan(Math.PI / 2 - angle1)))) / n;\n          color1 = fb.pack(fb.HSLToRGB([d1 - 0.15 * corr, 1, 0.5]));\n          color2 = fb.pack(fb.HSLToRGB([d2 + 0.15 * corr, 1, 0.5]));\n          // Create gradient fill between the endpoints.\n          var grad = m.createLinearGradient(x1, y1, x2, y2);\n          grad.addColorStop(0, color1);\n          grad.addColorStop(1, color2);\n          m.fillStyle = grad;\n          // Draw quadratic curve segment as a fill.\n          var r1 = (r + w / 2) / r, r2 = (r - w / 2) / r; // inner/outer radius.\n          m.beginPath();\n          m.moveTo(x1 * r1, y1 * r1);\n          m.quadraticCurveTo(xm * r1, ym * r1, x2 * r1, y2 * r1);\n          m.lineTo(x2 * r2, y2 * r2);\n          m.quadraticCurveTo(xm * r2, ym * r2, x1 * r2, y1 * r2);\n          m.fill();\n        }\n        else {\n          // Create gradient fill between the endpoints.\n          var grad = m.createLinearGradient(x1, y1, x2, y2);\n          grad.addColorStop(0, color1);\n          grad.addColorStop(1, color2);\n          m.strokeStyle = grad;\n          // Draw quadratic curve segment.\n          m.beginPath();\n          m.moveTo(x1, y1);\n          m.quadraticCurveTo(xm, ym, x2, y2);\n          m.stroke();\n        }\n      }\n      // Prevent seams where curves join.\n      angle1 = angle2 - nudge; color1 = color2; d1 = d2;\n    }\n    m.restore();\n    __debug && $('body').append('<div>drawCircle '+ (+(new Date()) - tm) +'ms');\n  };\n\n  /**\n   * Draw the saturation/luminance mask.\n   */\n  fb.drawMask = function () {\n    var tm = +(new Date());\n\n    // Iterate over sat/lum space and calculate appropriate mask pixel values.\n    var size = fb.square * 2, sq = fb.square;\n    function calculateMask(sizex, sizey, outputPixel) {\n      var isx = 1 / sizex, isy = 1 / sizey;\n      for (var y = 0; y <= sizey; ++y) {\n        var l = 1 - y * isy;\n        for (var x = 0; x <= sizex; ++x) {\n          var s = 1 - x * isx;\n          // From sat/lum to alpha and color (grayscale)\n          var a = 1 - 2 * Math.min(l * s, (1 - l) * s);\n          var c = (a > 0) ? ((2 * l - 1 + a) * .5 / a) : 0;\n          outputPixel(x, y, c, a);\n        }\n      }\n    }\n\n    // Method #1: direct pixel access (new Canvas).\n    if (fb.ctxMask.getImageData) {\n      // Create half-resolution buffer.\n      var sz = Math.floor(size / 2);\n      var buffer = document.createElement('canvas');\n      buffer.width = buffer.height = sz + 1;\n      var ctx = buffer.getContext('2d');\n      var frame = ctx.getImageData(0, 0, sz + 1, sz + 1);\n\n      var i = 0;\n      calculateMask(sz, sz, function (x, y, c, a) {\n        frame.data[i++] = frame.data[i++] = frame.data[i++] = c * 255;\n        frame.data[i++] = a * 255;\n      });\n\n      ctx.putImageData(frame, 0, 0);\n      fb.ctxMask.drawImage(buffer, 0, 0, sz + 1, sz + 1, -sq, -sq, sq * 2, sq * 2);\n    }\n    // Method #2: drawing commands (old Canvas).\n    else if (!($.browser.msie || false)) {\n      // Render directly at half-resolution\n      var sz = Math.floor(size / 2);\n      calculateMask(sz, sz, function (x, y, c, a) {\n        c = Math.round(c * 255);\n        fb.ctxMask.fillStyle = 'rgba(' + c + ', ' + c + ', ' + c + ', ' + a +')';\n        fb.ctxMask.fillRect(x * 2 - sq - 1, y * 2 - sq - 1, 2, 2);\n      });\n    }\n    // Method #3: vertical DXImageTransform gradient strips (IE).\n    else {\n      var cache_last, cache, w = 6; // Each strip is 6 pixels wide.\n      var sizex = Math.floor(size / w);\n      // 6 vertical pieces of gradient per strip.\n      calculateMask(sizex, 6, function (x, y, c, a) {\n        if (x == 0) {\n          cache_last = cache;\n          cache = [];\n        }\n        c = Math.round(c * 255);\n        a = Math.round(a * 255);\n        // We can only start outputting gradients once we have two rows of pixels.\n        if (y > 0) {\n          var c_last = cache_last[x][0],\n              a_last = cache_last[x][1],\n              color1 = fb.packDX(c_last, a_last),\n              color2 = fb.packDX(c, a),\n              y1 = Math.round(fb.mid + ((y - 1) * .333 - 1) * sq),\n              y2 = Math.round(fb.mid + (y * .333 - 1) * sq);\n          $('<div>').css({\n            position: 'absolute',\n            filter: \"progid:DXImageTransform.Microsoft.Gradient(StartColorStr=\"+ color1 +\", EndColorStr=\"+ color2 +\", GradientType=0)\",\n            top: y1,\n            height: y2 - y1,\n            // Avoid right-edge sticking out.\n            left: fb.mid + (x * w - sq - 1),\n            width: w - (x == sizex ? Math.round(w / 2) : 0)\n          }).appendTo(fb.cnvMask);\n        }\n        cache.push([c, a]);\n      });\n    }\n    __debug && $('body').append('<div>drawMask '+ (+(new Date()) - tm) +'ms');\n  }\n\n  /**\n   * Draw the selection markers.\n   */\n  fb.drawMarkers = function () {\n    // Determine marker dimensions\n    var sz = options.width, lw = Math.ceil(fb.markerSize / 4), r = fb.markerSize - lw + 1;\n    var angle = fb.hsl[0] * 6.28,\n        x1 =  Math.sin(angle) * fb.radius,\n        y1 = -Math.cos(angle) * fb.radius,\n        x2 = 2 * fb.square * (.5 - fb.hsl[1]),\n        y2 = 2 * fb.square * (.5 - fb.hsl[2]),\n        c1 = fb.invert ? '#fff' : '#000',\n        c2 = fb.invert ? '#000' : '#fff';\n    var circles = [\n      { x: x1, y: y1, r: r,             c: '#000', lw: lw + 1 },\n      { x: x1, y: y1, r: fb.markerSize, c: '#fff', lw: lw },\n      { x: x2, y: y2, r: r,             c: c2,     lw: lw + 1 },\n      { x: x2, y: y2, r: fb.markerSize, c: c1,     lw: lw },\n    ];\n\n    // Update the overlay canvas.\n    fb.ctxOverlay.clearRect(-fb.mid, -fb.mid, sz, sz);\n    for (var i = 0; i < circles.length; i++) {\n      var c = circles[i];\n      fb.ctxOverlay.lineWidth = c.lw;\n      fb.ctxOverlay.strokeStyle = c.c;\n      fb.ctxOverlay.beginPath();\n      fb.ctxOverlay.arc(c.x, c.y, c.r, 0, Math.PI * 2, true);\n      fb.ctxOverlay.stroke();\n    }\n  }\n\n  /**\n   * Update the markers and styles\n   */\n  fb.updateDisplay = function () {\n    // Determine whether labels/markers should invert.\n    fb.invert = (fb.rgb[0] * 0.3 + fb.rgb[1] * .59 + fb.rgb[2] * .11) <= 0.6;\n\n    // Update the solid background fill.\n    fb.solidFill.css('backgroundColor', fb.pack(fb.HSLToRGB([fb.hsl[0], 1, 0.5])));\n\n    // Draw markers\n    fb.drawMarkers();\n\n    // Linked elements or callback\n    if (typeof fb.callback == 'object') {\n      // Set background/foreground color\n      $(fb.callback).css({\n        backgroundColor: fb.color,\n        color: fb.invert ? '#fff' : '#000'\n      });\n\n      // Change linked value\n      $(fb.callback).each(function() {\n        if ((typeof this.value == 'string') && this.value != fb.color) {\n          this.value = fb.color;\n        }\n      }).change();\n    }\n    else if (typeof fb.callback == 'function') {\n      fb.callback.call(fb, fb.color);\n    }\n  }\n\n  /**\n   * Helper for returning coordinates relative to the center.\n   */\n  fb.widgetCoords = function (event) {\n    return {\n      x: event.pageX - fb.offset.left - fb.mid,\n      y: event.pageY - fb.offset.top - fb.mid\n    };\n  }\n\n  /**\n   * Mousedown handler\n   */\n  fb.mousedown = function (event) {\n    // Capture mouse\n    if (!$._farbtastic.dragging) {\n      $(document).bind('mousemove', fb.mousemove).bind('mouseup', fb.mouseup);\n      $._farbtastic.dragging = true;\n    }\n\n    // Update the stored offset for the widget.\n    fb.offset = $(container).offset();\n\n    // Check which area is being dragged\n    var pos = fb.widgetCoords(event);\n    fb.circleDrag = Math.max(Math.abs(pos.x), Math.abs(pos.y)) > (fb.square + 2);\n\n    // Process\n    fb.mousemove(event);\n    return false;\n  }\n\n  /**\n   * Mousemove handler\n   */\n  fb.mousemove = function (event) {\n    // Get coordinates relative to color picker center\n    var pos = fb.widgetCoords(event);\n\n    // Set new HSL parameters\n    if (fb.circleDrag) {\n      var hue = Math.atan2(pos.x, -pos.y) / 6.28;\n      fb.setHSL([(hue + 1) % 1, fb.hsl[1], fb.hsl[2]]);\n    }\n    else {\n      var sat = Math.max(0, Math.min(1, -(pos.x / fb.square / 2) + .5));\n      var lum = Math.max(0, Math.min(1, -(pos.y / fb.square / 2) + .5));\n      fb.setHSL([fb.hsl[0], sat, lum]);\n    }\n    return false;\n  }\n\n  /**\n   * Mouseup handler\n   */\n  fb.mouseup = function () {\n    // Uncapture mouse\n    $(document).unbind('mousemove', fb.mousemove);\n    $(document).unbind('mouseup', fb.mouseup);\n    $._farbtastic.dragging = false;\n  }\n\n  /* Various color utility functions */\n  fb.dec2hex = function (x) {\n    return (x < 16 ? '0' : '') + x.toString(16);\n  }\n\n  fb.packDX = function (c, a) {\n    return '#' + fb.dec2hex(a) + fb.dec2hex(c) + fb.dec2hex(c) + fb.dec2hex(c);\n  };\n\n  fb.pack = function (rgb) {\n    var r = Math.round(rgb[0] * 255);\n    var g = Math.round(rgb[1] * 255);\n    var b = Math.round(rgb[2] * 255);\n    return '#' + fb.dec2hex(r) + fb.dec2hex(g) + fb.dec2hex(b);\n  };\n\n  fb.unpack = function (color) {\n    if (color.length == 7) {\n      function x(i) {\n        return parseInt(color.substring(i, i + 2), 16) / 255;\n      }\n      return [ x(1), x(3), x(5) ];\n    }\n    else if (color.length == 4) {\n      function x(i) {\n        return parseInt(color.substring(i, i + 1), 16) / 15;\n      }\n      return [ x(1), x(2), x(3) ];\n    }\n  };\n\n  fb.HSLToRGB = function (hsl) {\n    var m1, m2, r, g, b;\n    var h = hsl[0], s = hsl[1], l = hsl[2];\n    m2 = (l <= 0.5) ? l * (s + 1) : l + s - l * s;\n    m1 = l * 2 - m2;\n    return [\n      this.hueToRGB(m1, m2, h + 0.33333),\n      this.hueToRGB(m1, m2, h),\n      this.hueToRGB(m1, m2, h - 0.33333)\n    ];\n  };\n\n  fb.hueToRGB = function (m1, m2, h) {\n    h = (h + 1) % 1;\n    if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;\n    if (h * 2 < 1) return m2;\n    if (h * 3 < 2) return m1 + (m2 - m1) * (0.66666 - h) * 6;\n    return m1;\n  };\n\n  fb.RGBToHSL = function (rgb) {\n    var r = rgb[0], g = rgb[1], b = rgb[2],\n        min = Math.min(r, g, b),\n        max = Math.max(r, g, b),\n        delta = max - min,\n        h = 0,\n        s = 0,\n        l = (min + max) / 2;\n    if (l > 0 && l < 1) {\n      s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));\n    }\n    if (delta > 0) {\n      if (max == r && max != g) h += (g - b) / delta;\n      if (max == g && max != b) h += (2 + (b - r) / delta);\n      if (max == b && max != r) h += (4 + (r - g) / delta);\n      h /= 6;\n    }\n    return [h, s, l];\n  };\n\n  // Parse options.\n  if (!options.callback) {\n    options = { callback: options };\n  }\n  options = $.extend({\n    width: 300,\n    wheelWidth: (options.width || 300) / 10,\n    callback: null\n  }, options);\n\n  // Initialize.\n  fb.initWidget();\n\n  // Install mousedown handler (the others are set on the document on-demand)\n  $('canvas.farbtastic-overlay', container).mousedown(fb.mousedown);\n\n  // Set linked elements/callback\n  if (options.callback) {\n    fb.linkTo(options.callback);\n  }\n  // Set to gray.\n  if (!fb.color) fb.setColor('#808080');\n}\n\n})(jQuery);\n"]}
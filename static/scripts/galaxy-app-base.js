define(["mvc/user/user-model","utils/metrics-logger","utils/add-logging","utils/localization","bootstrapped-data"],function(a,b,c,d,e){function f(a){var b=this;return b._init(a||{})}c(f,"GalaxyApp");var g="galaxy:debug",h=g+":namespaces",i=!1;try{i="true"==localStorage.getItem(g)}catch(j){console.log(_l("localStorage not available for debug flag retrieval"))}return f.prototype._init=function(a){var b=this;return _.extend(b,Backbone.Events),i&&(b.logger=console),b._processOptions(a),b.debug("GalaxyApp.options: ",b.options),b._initConfig(a.config||e.config||{}),b.debug("GalaxyApp.config: ",b.config),b._patchGalaxy(window.Galaxy),b._initLogger(b.options.loggerOptions||{}),b.debug("GalaxyApp.logger: ",b.logger),b._initLocale(),b.debug("GalaxyApp.localize: ",b.localize),b._initUser(a.user||e.user||{}),b.debug("GalaxyApp.user: ",b.user),b.trigger("ready",b),b._setUpListeners(),b},f.prototype.defaultOptions={patchExisting:!0,root:"/",loggerOptions:{}},f.prototype._processOptions=function(a){var b=this,c=b.defaultOptions;b.debug("_processOptions: ",a),b.options={};for(var d in c)c.hasOwnProperty(d)&&(b.options[d]=a.hasOwnProperty(d)?a[d]:c[d]);return b},f.prototype._initConfig=function(a){var b=this;return b.debug("_initConfig: ",a),b.config=a,b.config.debug=i||b.config.debug,b},f.prototype._patchGalaxy=function(a){var b=this;if(b.options.patchExisting&&a){b.debug("found existing Galaxy object:",a);for(var c in a)a.hasOwnProperty(c)&&(b.debug("	 patching in "+c+" to Galaxy"),b[c]=a[c])}},f.prototype._initLogger=function(a){var c=this;if(c.config.debug){try{a.consoleNamespaceWhitelist=localStorage.getItem(h).split(",")}catch(d){}a.consoleLogger=a.consoleLogger||console,a.consoleLevel=a.consoleLevel||b.MetricsLogger.ALL}return c.debug("_initLogger:",a),c.logger=new b.MetricsLogger(a),c},f.prototype._initLocale=function(a){var b=this;return b.debug("_initLocale:",a),b.localize=d,window._l=b.localize,b},f.prototype._initUser=function(b){var c=this;return c.debug("_initUser:",b),c.user=new a.User(b),c.currUser=c.user,c},f.prototype._setUpListeners=function(){var a=this;return a.lastAjax={},$(document).bind("ajaxSend",function(b,c,d){var e=d.data;try{e=JSON.parse(e)}catch(f){}a.lastAjax={url:location.href.slice(0,-1)+d.url,data:e}}),a},f.prototype.debugging=function(a){var b=this;try{i=a,a?localStorage.setItem(g,!0):(localStorage.removeItem(g),b.debuggingNamespaces(null))}catch(c){console.log(_l("localStorage not available for debug flag retrieval"))}return b},f.prototype.debuggingNamespaces=function(a){var b=this;try{if(void 0===a){var c=localStorage.getItem(h);return"string"==typeof c?c.split(","):[]}null===a?localStorage.removeItem(h):localStorage.setItem(h,a);var d=b.debuggingNamespaces();return b.logger&&(b.logger.options.consoleNamespaceWhitelist=d),d}catch(e){console.log(_l("localStorage not available for debug namespace retrieval"))}},f.prototype.toString=function(){var a=this.user?this.user.get("email")||"(anonymous)":"uninitialized";return"GalaxyApp("+a+")"},{GalaxyApp:f}});
//# sourceMappingURL=../maps/galaxy-app-base.js.map
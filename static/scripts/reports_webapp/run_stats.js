function days_in_month(a,b){return new Date(b,a,0).getDate()}function date_by_subtracting_days(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate()-b,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function date_by_subtracting_hours(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours()-b,a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function get_utc_time_hours(){var a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),0,0)}function refresh(){window.location.reload(!0)}function create_chart(a,b,c,d){require(["d3"],function(){function e(){var a=d3.select(this).attr("class");a=a.split(" "),d3.selectAll("."+a[0]).filter("."+a[1]).transition().duration(750).attr("height",o).attr("width",r),d3.select(this).transition().duration(750).attr("height",o*h).attr("width",r*h)}for(var f=a,g={top:60,right:30,bottom:50,left:60},h=1.75,i=[],j=get_utc_time_hours(),k=0;24>k;k++)i.push(date_by_subtracting_hours(j,k));for(var l=[],j=get_utc_time_hours(),k=0;30>k;k++)l.push(date_by_subtracting_days(j,k));var m=150;if(0!=d3.max(f))var n=m/d3.max(f);else var n=1;var o=m+g.top+g.bottom;$(".charts").css("height",o*h);var p=300,q=0;"hours"==c?q=p/24:"days"==c&&(q=p/30);var r=p+g.left+g.right,s=d3.select("#"+b).attr("width",r).attr("height",r).attr("preserveAspectRatio","xMidYMin").attr("viewBox","0 0 "+r+" "+o).on("click",e),t=s.selectAll("g").data(f).enter().append("g").attr("transform",function(a,b){return curr_margin=+g.left,curr_margin+=+(b*q),"translate("+curr_margin+","+g.top+")"}).on("mouseenter",function(a){for(var b=1,c=a;c>=10;)c/=10,b++;var d=4*b+10;d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("transform","translate( "+(g.left-5)+", "+(m-a*n+ +g.top+10)+" )").attr("visibility","visible").text(a),d3.select(d3.event.path[1]).select(".tool_tip").attr("width",d+"px").attr("height","15px").select("rect").attr("transform","translate( "+(+g.left-d)+", "+(m-a*n+ +g.top)+" )").attr("width",d+"px").attr("height","15px").attr("fill","#ebd9b2")}).on("mouseleave",function(a){d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("visibility","hidden"),d3.select(d3.event.path[1]).select(".tool_tip").select("rect").attr("width","0").attr("height","0").attr("fill","").text(a)});s.append("g").append("text").attr("class","title").attr("text-anchor","end").attr("transform",function(){return"translate( "+p+",15 )"}).text(d),s.append("g").attr("class","axis").append("path").attr("class","x").attr("d",function(){var a=g.left,b=+g.top+m,c=a+p,d=b;return"M"+a+" "+b+" L "+c+" "+d});var u=d3.scale.linear().range([m,0]),v=d3.svg.axis().scale(u).orient("left").tickFormat(function(a){return d3.round(a*d3.max(f),0)});if(s.append("g").attr("class","y axis").attr("id","y_"+b).attr("text-anchor","end").attr("transform","translate( "+g.left+","+g.top+")").call(v).select(".domain"),s.append("g").append("text").attr("class","ax_title").attr("transform",function(){var a=d3.select("#y_"+b).node(),c=+g.left-a.getBoundingClientRect().width-5,d=+g.top+a.getBoundingClientRect().height/2-30,e="translate("+c+","+d+")rotate(-90)";return e}).text("Number of Jobs"),t.append("rect").attr("y",function(a){return m-a*n}).attr("height",function(a){return a*n}).attr("width",q-1),"hours"==c){t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",3).attr("stroke","black").attr("stroke-width",1).attr("transform",function(){return"translate( "+q/2+", "+m+")"}),t.append("text").attr("fill","rgb(0,0,0)").attr("transform","translate( 10, "+(m+10)+" )").text(function(a,b){var c="0000";return c=i[b].getHours()<10?"0"+String(i[b].getHours()):i[b].getHours()});var w="",x=!1;t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(a,b){var c=0;return i[b].getDate()!=w&&(x?c=20:(c=27,x=!0),w=i[b].getDate()),c}).attr("stroke","black").attr("stroke-width",1).attr("transform",function(){return"translate( 0, "+m+")"}),w="",curr_day_text="",x=!1,t.append("text").attr("fill","rgb(0,0,0)").text(function(a,b){var c="",d="en-us";return i[b].getDate()!=curr_day_text&&(c=String(i[b].toLocaleString(d,{month:"long"})),c+=" "+String(i[b].getDate()),curr_day_text=i[b].getDate()),c}).attr("transform",function(a,b){var c=m,d=d3.select(this).node().getBBox().width;return i[b].getDate()!=w&&(x?c+=18:(c+=25,x=!0),w=i[b].getDate()),"translate( "+(d+2)+", "+c+" )"})}else if("days"==c){t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",3).attr("stroke","black").attr("stroke-width",1).attr("transform",function(){return"translate( "+q/2+", "+m+")"}),t.append("text").attr("fill","rgb(0,0,0)").attr("transform","translate( 9, "+(m+10)+" )").text(function(a,b){var c="0000";return c=l[b].getDate()<10?"0"+String(l[b].getDate()):l[b].getDate()});var y="",x=!1;t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(a,b){var c=0;return l[b].getMonth()!=y&&(x?c=20:(c=27,x=!0),y=l[b].getMonth()),c}).attr("stroke","black").attr("stroke-width",1).attr("transform",function(){return"translate( 0, "+m+")"}),y="",curr_month_text="",x=!1,t.append("text").attr("fill","rgb(0,0,0)").text(function(a,b){var c="",d="en-us";return l[b].getMonth()!=curr_month_text&&(c=String(l[b].toLocaleString(d,{month:"long"})),c+=" "+String(l[b].getFullYear()),curr_month_text=l[b].getMonth()),c}).attr("transform",function(a,b){var c=m,d=d3.select(this).node().getBBox().width;return l[b].getMonth()!=y&&(x?c+=18:(c+=25,x=!0),y=l[b].getMonth()),"translate( "+(d+2)+", "+c+" )"})}s.append("g").attr("class","tool_tip").append("rect"),s.select(".tool_tip").append("text"),("jc_dy_chart"==b||"jc_hr_chart"==b)&&d3.select("#"+b).attr("height",o*h).attr("width",r*h)})}function create_histogram(a,b,c){require(["d3"],function(){function d(){var a=d3.select(this).attr("class");a=a.split(" "),d3.selectAll("."+a[0]).filter("."+a[1]).transition().duration(750).attr("height",j).attr("width",l),d3.select(this).transition().duration(750).attr("height",j*f).attr("width",l*f)}for(var e=a,f=1.75,g=function(a){return hours=Math.floor(a/60),minutes=Math.floor(a-60*hours),hours<10&&(hours="0"+hours),minutes<10&&(minutes="0"+minutes),hours+":"+minutes},h={top:60,right:30,bottom:50,left:60},i=150,j=i+h.top+h.bottom,k=300,l=k+h.left+h.right,m=[],n=d3.scale.linear().domain([0,d3.max(e)]).range([0,k]),e=d3.layout.histogram().bins(n.ticks(20))(e),o=0;o<e.length;o++)m.push(e[o].length);if(0!=d3.max(e))var p=i/d3.max(m);else var p=1;var q=d3.scale.linear().domain([0,d3.max(e,function(a){return a.y})]).range([i,0]),r=d3.select("#"+b).attr("viewBox","0 0 "+l+" "+j).attr("width",l).attr("height",j).attr("preserveAspectRatio","xMidYMin").on("click",d);r.append("g").append("text").attr("class","title").attr("transform",function(){return"translate( "+k+",15 )"}).text(c);var s,t=r.selectAll(".bar").data(e).enter().append("g").attr("class","bar").attr("transform",function(a){return"translate("+(+n(a.x)+ +h.left)+","+(+q(a.y)+ +h.top)+")"}).on("mouseenter",function(a){for(o=0,size=a.length;size>=1;)size/=10,o++;var b=4*o+10;d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("transform","translate( "+(h.left-5)+", "+(i-a.length*p+ +h.top+10)+" )").attr("visibility","visible").text(a.length),d3.select(d3.event.path[1]).select(".tool_tip").attr("width",b+"px").attr("height","15px").select("rect").attr("transform","translate( "+(+h.left-b)+", "+(i-a.length*p+ +h.top)+" )").attr("width",b+"px").attr("height","15px").attr("fill","#ebd9b2")}).on("mouseleave",function(){d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("visibility","hidden"),d3.select(d3.event.path[1]).select(".tool_tip").select("rect").attr("width","0").attr("height","0").attr("fill","")});s=void 0==e[0]?1:n(e[0].dx),t.append("rect").attr("x",1).attr("width",s-1).attr("height",function(a){return i-q(a.y)});var u=d3.svg.axis().scale(n).orient("bottom").tickFormat(g);r.append("g").attr("class","x axis").attr("id","x_"+b).attr("transform","translate( "+h.left+","+(+i+ +h.top)+")").call(u),r.append("g").append("text").attr("class","ax_title").attr("transform",function(){var a=d3.select("#x_"+b).node(),c=+h.left+a.getBoundingClientRect().width/2+30,d=+h.top+i+a.getBoundingClientRect().height+10,e="translate("+c+","+d+")";return e}).text("ETA - hrs:mins");var v=d3.svg.axis().scale(q).orient("left");r.append("g").attr("class","y axis").attr("id","y_"+b).attr("transform","translate( "+h.left+","+h.top+")").call(v),r.append("g").append("text").attr("class","ax_title").attr("transform",function(){var a=d3.select("#y_"+b).node(),c=+h.left-a.getBoundingClientRect().width-5,d=+h.top+a.getBoundingClientRect().height/2-30,e="translate("+c+","+d+")rotate(-90)";return e}).text("Number of Jobs"),r.append("g").attr("class","tool_tip").append("rect"),r.select(".tool_tip").append("text")})}setTimeout(refresh,9e5);
//# sourceMappingURL=../../maps/reports_webapp/run_stats.js.map
function get_utc_time(){var a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())}function date_by_subtracting_days(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate()-b,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function create_chart(a,b,c,d){require(["d3"],function(){function e(){var a=d3.select(this).attr("class");a=a.split(" "),d3.selectAll("."+a[0]).filter("."+a[1]).transition().duration(750).attr("height",k).attr("width",n),d3.select(this).transition().duration(750).attr("height",k*h).attr("width",n*h)}var f=a,g={top:60,right:30,bottom:50,left:60},h=1.8,i=150;if(0!=d3.max(f))var j=i/d3.max(f);else var j=1;var k=i+g.top+g.bottom;$(".charts").css("height",k*h);var l=300,m=0;"hours"==c?m=l/24:"days"==c&&(m=l/30);var n=l+g.left+g.right,o=d3.scale.linear().range([i,0]),p=d3.svg.axis().scale(o).orient("left").tickFormat(function(a){return d3.round(a*d3.max(f),1)});if("hours"==c)var q=d3.time.scale().domain([get_utc_time(),date_by_subtracting_days(get_utc_time(),1)]).rangeRound([0,l]),r=d3.svg.axis().scale(q).tickFormat(d3.time.format("%b %d %H")).ticks(d3.time.hours,1).orient("bottom").tickSize(0).tickPadding(8);else if("days"==c)var q=d3.time.scale().domain([get_utc_time(),date_by_subtracting_days(get_utc_time(),30)]).rangeRound([0,l]),r=d3.svg.axis().scale(q).tickFormat(d3.time.format("%b %d")).ticks(d3.time.days,1).orient("bottom").tickSize(0).tickPadding(8);var s=d3.select("#"+b).attr("width",function(){var a=0;return a="jc_hr_chart"==b||"jc_dy_chart"==b?n*h:n}).attr("height",function(){var a=0;return a="jc_hr_chart"==b||"jc_dy_chart"==b?k*h:k}).attr("preserveAspectRatio","xMidYMin").attr("viewBox","0 0 "+n+" "+k).on("click",e),t=s.selectAll("g").data(f).enter().append("g").attr("transform",function(a,b){return curr_margin=+g.left,curr_margin+=+(b*m),"translate("+curr_margin+","+g.top+")"}).on("mouseenter",function(a){d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("transform","translate( 45, "+(i-a*j+ +g.top+10)+" )").attr("visibility","visible").text(a),d3.select(d3.event.path[1]).select(".tool_tip").attr("width","40px").attr("height","15px").select("rect").attr("transform","translate( 19.5, "+(i-a*j+ +g.top)+" )").attr("width","40px").attr("height","15px").attr("fill","#ebd9b2")}).on("mouseleave",function(a){d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("visibility","hidden"),d3.select(d3.event.path[1]).select(".tool_tip").select("rect").attr("width","0").attr("height","0").attr("fill","").text(a)});s.append("g").append("text").attr("class","title").attr("text-anchor","middle").attr("transform",function(){return"translate( "+l+",15 )"}).text(d),s.append("g").attr("class","x axis").attr("transform","translate("+g.left+","+(+i+ +g.top)+")").call(r).selectAll("text").attr("transform",function(){return"hours"==c?"translate( "+(-(m/2)-1)+", 17)rotate(-90)":"days"==c?"translate( "+(-(m/2)-9)+", 13)rotate(-90)":void 0}),s.append("g").append("text").attr("class","ax_title").attr("transform",function(){var a="";return"hours"==c?a="translate("+ +g.left/2+","+g.top+")rotate(-90)":"days"==c&&(a="translate("+ +g.left/4+","+g.top+")rotate(-90)"),a}).text("Number of Jobs"),s.append("g").append("text").attr("class","ax_title").attr("transform",function(){var a="";return"hours"==c?a=a="translate("+(2*+g.left+20)+","+(+k-7)+")":"days"==c&&(a="translate("+2*+g.left+","+(+k-7)+")"),a}).text(function(){var a="";return"hours"==c?a="Date(month day hour)":"days"==c&&(a="Date(month day)"),a}),s.append("g").attr("class","y axis").attr("transform","translate( "+g.left+","+g.top+")").call(p),t.append("rect").attr("y",function(a){return i-a*j}).attr("height",function(a){return a*j}).attr("width",m-1),s.append("g").attr("class","tool_tip").append("rect"),s.select(".tool_tip").append("text")})}function create_histogram(a,b,c,d){require(["d3"],function(){function c(){var a=d3.select(this).attr("class");a=a.split(" "),d3.selectAll("."+a[0]).filter("."+a[1]).transition().duration(750).attr("height",k).attr("width",m),d3.select(this).transition().duration(750).attr("height",k*f).attr("width",m*f)}var e=a,f=1.8,g=function(a){return hours=Math.floor(a/60),minutes=Math.floor(a-60*hours),hours<10&&(hours="0"+hours),minutes<10&&(minutes="0"+minutes),hours+":"+minutes},h={top:60,right:30,bottom:50,left:60},j=150,k=j+h.top+h.bottom,l=300,m=l+h.left+h.right,n=d3.scale.linear().domain([0,d3.max(e)]).range([0,l]),e=d3.layout.histogram().bins(n.ticks(20))(e),o=d3.scale.linear().domain([0,d3.max(e,function(a){return a.y})]).range([j,0]),p=d3.svg.axis().scale(n).orient("bottom").tickFormat(g),q=d3.select("#"+b).attr("viewBox","0 0 "+m+" "+k).attr("width",m).attr("height",k).attr("preserveAspectRatio","xMidYMin").on("click",c);q.append("g").append("text").attr("class","title").attr("transform",function(){return"translate( "+l+",15 )"}).text(d);var r,s=q.selectAll(".bar").data(e).enter().append("g").attr("class","bar").attr("transform",function(a){return"translate("+(+n(a.x)+ +h.left)+","+(+o(a.y)+ +h.top)+")"}).on("mouseenter",function(a){for(i=0,size=a.length;size>=1;)size/=10,i++;var b=4*i+10;d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("transform","translate( "+(h.left-5)+", "+(j+ +h.top-5)+" )").attr("visibility","visible").text(a.length),d3.select(d3.event.path[1]).select(".tool_tip").attr("width",b+"px").attr("height","15px").select("rect").attr("transform","translate( "+(+h.left-b)+", "+(j+ +h.top-15)+" )").attr("width",b+"px").attr("height","15px").attr("fill","#ebd9b2")}).on("mouseleave",function(){d3.select(d3.event.path[1]).select(".tool_tip").select("text").attr("visibility","hidden"),d3.select(d3.event.path[1]).select(".tool_tip").select("rect").attr("width","0").attr("height","0").attr("fill","")});r=void 0==e[0]?1:n(e[0].dx),s.append("rect").attr("x",1).attr("width",r-1).attr("height",function(a){return j-o(a.y)}),q.append("g").attr("class","x axis").attr("transform","translate( "+h.left+","+(+j+ +h.top)+")").call(p),q.append("g").attr("class","tool_tip").append("rect"),q.select(".tool_tip").append("text")})}
//# sourceMappingURL=../../maps/reports_webapp/run_stats.js.map
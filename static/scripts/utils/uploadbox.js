!function(a){jQuery.event.props.push("dataTransfer"),a.fn.uploadbox=function(b){function c(a){return a.dataTransfer?(g(a.dataTransfer.files),a.preventDefault(),!1):void 0}function d(a){a.preventDefault(),z.dragover.call(a)}function e(a){a.stopPropagation(),z.dragleave.call(a)}function f(a){a.lengthComputable&&z.progress(this.index,this.file,Math.round(100*a.loaded/a.total))}function g(a){if(!w){for(var b=u,c=0;c<a.length;c++){var d=String(u++);t[d]=a[c],z.announce(d,t[d],""),v++}return b}}function h(a){t[a]&&(delete t[a],v--)}function i(){if(0==v||x)return x=!1,w=!1,void z.complete();w=!0;var a=-1;for(var b in t){a=b;break}var c=t[a];h(a);var d=c.size,e=(c.mode,1048576*z.maxfilesize);if(e>d||"ftp"==c.mode){var f=z.initialize(a,c);f?j(a,c,f):l(a,c,z.error_missing)}else l(a,c,z.error_filesize)}function j(a,b,c){var d=new FormData;for(var e in c)d.append(e,c[e]);b.size>0&&z.paramname&&d.append(z.paramname,b,b.name),y=new XMLHttpRequest,y.open("POST",z.url,!0),y.setRequestHeader("Accept","application/json"),y.setRequestHeader("Cache-Control","no-cache"),y.setRequestHeader("X-Requested-With","XMLHttpRequest"),y.onreadystatechange=function(){if(y.readyState==y.DONE){var c=null;if(y.responseText)try{c=jQuery.parseJSON(y.responseText)}catch(d){c=y.responseText}if(y.status<200||y.status>299){var e=y.statusText;403==y.status?e=z.error_login:0==y.status?e=z.error_server:e||(e=z.error_default),l(a,b,e+" ("+y.status+")")}else k(a,b,c)}},y.upload.index=a,y.upload.file=b,y.upload.addEventListener("progress",f,!1),y.send(d)}function k(a,b,c){z.success(a,b,c),i()}function l(a,b,c){z.error(a,b,c),i()}function m(){B.trigger("click")}function n(a){for(a in t)h(a)}function o(){w||(w=!0,i())}function p(){x=!0}function q(b){return z=a.extend({},z,b)}function r(){return window.File&&window.FormData&&window.XMLHttpRequest&&window.FileList}var s={url:"",paramname:"content",maxfilesize:2048,dragover:function(){},dragleave:function(){},announce:function(){},initialize:function(){},progress:function(){},success:function(){},error:function(a,b,c){alert(c)},complete:function(){},error_filesize:"File exceeds 2GB. Please use an FTP client.",error_default:"Please make sure the file is available.",error_server:"Upload request failed.",error_login:"Uploads require you to log in.",error_missing:"No upload content available."},t={},u=0,v=0,w=!1,x=!1,y=null,z=a.extend({},s,b),A=this,B=a('<input id="uploadbox_input" type="file" style="display: none" multiple/>');return A.append(B),A.on("drop",c),A.on("dragover",d),A.on("dragleave",e),B.change(function(b){g(b.target.files),a(this).val("")}),{select:m,add:g,remove:h,start:o,stop:p,reset:n,configure:q,compatible:r}}}(jQuery);
//# sourceMappingURL=../../maps/utils/uploadbox.js.map
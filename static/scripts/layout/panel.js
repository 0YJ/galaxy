define(["jquery","libs/underscore","libs/backbone","mvc/base-mvc"],function(e,i,t,n){"use strict";var a=e,s=160,o=800,h=t.View.extend(n.LoggableMixin).extend({_logNamespace:"layout",initialize:function(e){this.log(this+".initialize:",e),this.title=e.title||this.title||"",this.hidden=!1,this.savedSize=null,this.hiddenByTool=!1},$center:function(){return this.$el.siblings("#center")},$toggleButton:function(){return this.$(".unified-panel-footer > .panel-collapse")},render:function(){this.log(this+".render:"),this.$el.html(this.template(this.id))},template:function(){return[this._templateHeader(),this._templateBody(),this._templateFooter()].join("")},_templateHeader:function(e){return['<div class="unified-panel-header" unselectable="on">','<div class="unified-panel-header-inner">','<div class="panel-header-buttons" style="float: right"/>','<div class="panel-header-text">',i.escape(this.title),"</div>","</div>","</div>"].join("")},_templateBody:function(e){return'<div class="unified-panel-body"/>'},_templateFooter:function(e){return['<div class="unified-panel-footer">','<div class="panel-collapse ',i.escape(this.id),'"/>','<div class="drag"/>',"</div>"].join("")},events:{"mousedown .unified-panel-footer > .drag":"_mousedownDragHandler","click .unified-panel-footer > .panel-collapse":"toggle"},_mousedownDragHandler:function(e){function i(e){var i=e.pageX-h;h=e.pageX;var a=t.$el.width(),l=n?a+i:a-i;l=Math.min(o,Math.max(s,l)),t.resize(l)}var t=this,n="left"===this.id,h=e.pageX;a("#dd-helper").show().on("mousemove",i).one("mouseup",function(e){a(this).hide().off("mousemove",i)})},resize:function(e){return this.$el.css("width",e),this.$center().css(this.id,e),self},show:function(){if(this.hidden){var e=this,i={},t=this.id;return i[t]=0,e.$el.css(t,-this.savedSize).show().animate(i,"fast",function(){e.resize(e.savedSize)}),e.hidden=!1,e.$toggleButton().removeClass("hidden"),e}},hide:function(){if(!this.hidden){var e=this,i={},t=this.id;return e.savedSize=this.$el.width(),i[t]=-this.savedSize,this.$el.animate(i,"fast"),this.$center().css(t,0),e.hidden=!0,e.$toggleButton().addClass("hidden"),e}},toggle:function(e){var i=this;return i.hidden?i.show():i.hide(),i.hiddenByTool=!1,i},handle_minwidth_hint:function(e){return this.$center().width()-(this.hidden?this.savedSize:0)<e?this.hidden||(this.toggle(),this.hiddenByTool=!0):this.hiddenByTool&&(this.toggle(),this.hiddenByTool=!1),self},force_panel:function(e){return"show"==e?this.show():"hide"==e?this.hide():self},toString:function(){return"SidePanel("+this.id+")"}});return{LeftPanel:h.extend({id:"left"}),RightPanel:h.extend({id:"right"}),CenterPanel:t.View.extend(n.LoggableMixin).extend({_logNamespace:"layout",initialize:function(e){this.log(this+".initialize:",e),this.prev=null},render:function(){this.log(this+".render:"),this.$el.html(this.template()),this.$("#galaxy_main").on("load",i.bind(this._iframeChangeHandler,this))},_iframeChangeHandler:function(e){var i=e.currentTarget,t=i.contentWindow&&i.contentWindow.location;t&&t.host&&(a(i).show(),this.prev&&this.prev.remove(),this.$("#center-panel").hide(),Galaxy.trigger("galaxy_main:load",{fullpath:t.pathname+t.search+t.hash,pathname:t.pathname,search:t.search,hash:t.hash}))},display:function(e){var i=this.$("#galaxy_main")[0].contentWindow||{},t=i.onbeforeunload&&i.onbeforeunload();!t||confirm(t)?(i.onbeforeunload=void 0,this.prev&&this.prev.remove(),this.prev=e,this.$("#galaxy_main").attr("src","about:blank").hide(),this.$("#center-panel").scrollTop(0).append(e.$el).show(),Galaxy.trigger("center-panel:load",e)):e&&e.remove()},template:function(){return['<div style="position: absolute; width: 100%; height: 100%">','<iframe name="galaxy_main" id="galaxy_main" frameborder="0" ','style="position: absolute; width: 100%; height: 100%;"/>','<div id="center-panel" ','style="display: none; position: absolute; width: 100%; height: 100%; padding: 10px; overflow: auto;"/>',"</div>"].join("")},toString:function(){return"CenterPanel"}})}});
//# sourceMappingURL=../../maps/layout/panel.js.map

define(["layout/masthead","layout/panel","mvc/ui/ui-modal","mvc/base-mvc"],function(i,e,t,s){return{PageLayoutView:Backbone.View.extend(s.LoggableMixin).extend({_logNamespace:"layout",el:"body",className:"full-content",_panelIds:["left","center","right"],defaultOptions:{message_box_visible:!1,message_box_content:"",message_box_class:"info",show_inactivity_warning:!1,inactivity_box_content:""},initialize:function(e){this.log(this+".initialize:",e),_.extend(this,_.pick(e,this._panelIds)),this.options=_.defaults(_.omit(e.config,this._panelIds),this.defaultOptions),Galaxy.modal=this.modal=new t.View,this.masthead=new i.View(this.options),this.$el.attr("scroll","no"),this.$el.html(this._template()),this.$el.append(this.masthead.frame.$el),this.$("#masthead").replaceWith(this.masthead.$el),this.$el.append(this.modal.$el),this.$messagebox=this.$("#messagebox"),this.$inactivebox=this.$("#inactivebox")},render:function(){return $(".select2-hidden-accessible").remove(),this.log(this+".render:"),this.masthead.render(),this.renderMessageBox(),this.renderInactivityBox(),this.renderPanels(),this._checkCommunicationServerOnline(),this},renderMessageBox:function(){if(this.options.message_box_visible){var i=this.options.message_box_content||"",e=this.options.message_box_class||"info";this.$el.addClass("has-message-box"),this.$messagebox.attr("class","panel-"+e+"-message").html(i).toggle(!!i).show()}else this.$el.removeClass("has-message-box"),this.$messagebox.hide();return this},renderInactivityBox:function(){if(this.options.show_inactivity_warning){var i=this.options.inactivity_box_content||"",e=$("<a/>").attr("href",Galaxy.root+"user/resend_verification").text("Resend verification");this.$el.addClass("has-inactivity-box"),this.$inactivebox.html(i+" ").append(e).toggle(!!i).show()}else this.$el.removeClass("has-inactivity-box"),this.$inactivebox.hide();return this},renderPanels:function(){var i=this;return this._panelIds.forEach(function(e){_.has(i,e)&&(i[e].setElement("#"+e),i[e].render())}),this.left||this.center.$el.css("left",0),this.right||this.center.$el.css("right",0),this},_template:function(){return['<div id="everything">','<div id="background"/>','<div id="masthead"/>','<div id="messagebox"/>','<div id="inactivebox" class="panel-warning-message" />',this.left?'<div id="left" />':"",this.center?'<div id="center" class="inbound" />':"",this.right?'<div id="right" />':"","</div>",'<div id="dd-helper" />'].join("")},hideSidePanels:function(){this.left&&this.left.hide(),this.right&&this.right.hide()},toString:function(){return"PageLayoutView"},_checkCommunicationServerOnline:function(){var i=window.Galaxy.config.communication_server_host,e=window.Galaxy.config.communication_server_port,t=window.Galaxy.user.attributes.preferences,s=$("#show-chat-online");t&&-1!=["1","true"].indexOf(t.communication_server)?$.ajax({url:i+":"+e}).success(function(i){null!==window.Galaxy.user.id&&"hidden"===s.css("visibility")&&s.css("visibility","visible")}).error(function(i){s.css("visibility","hidden")}):s.css("visibility","hidden")}})}});
//# sourceMappingURL=../../maps/layout/page.js.map

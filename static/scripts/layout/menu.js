<<<<<<< HEAD
define([],function(){var a=Backbone.Model.extend({initialize:function(a){this.options=a.config,this.masthead=a.masthead,this.create()},create:function(){var a=new b({id:"analysis",title:"Analyze Data",content:"",title_attribute:"Analysis home view"});this.masthead.append(a);var c={id:"workflow",title:"Workflow",content:"workflow",title_attribute:"Chain tools into workflows"};Galaxy.user.id||(c.disabled=!0);var d=new b(c);this.masthead.append(d);var e=new b({id:"shared",title:"Shared Data",content:"library/index",title_attribute:"Access published resources"});if(e.add({title:"Data Libraries deprecated",content:"library/index"}),e.add({title:"Data Libraries",content:"library/list",divider:!0}),e.add({title:"Published Histories",content:"history/list_published"}),e.add({title:"Published Workflows",content:"workflow/list_published"}),e.add({title:"Published Visualizations",content:"visualization/list_published"}),e.add({title:"Published Pages",content:"page/list_published"}),this.masthead.append(e),this.options.user_requests){var f=new b({id:"lab",title:"Lab"});f.add({title:"Sequencing Requests",content:"requests/index"}),f.add({title:"Find Samples",content:"requests/find_samples_index"}),f.add({title:"Help",content:this.options.lims_doc_url}),this.masthead.append(f)}var g={id:"visualization",title:"Visualization/Scripting",content:"visualization/list",title_attribute:"Visualize datasets"};Galaxy.user.id||(g.disabled=!0);var h=new b(g);if(Galaxy.user.id&&(h.add({title:"New Track Browser",content:"visualization/trackster",target:"_frame"}),h.add({title:"Saved Visualizations",content:"visualization/list",target:"_frame"}),h.add({title:"Launch a Galaxy Interactive Environment (GIE)",content:"gie/launch",target:"_frame"})),this.masthead.append(h),Galaxy.user.get("is_admin")){var i=new b({id:"admin",title:"Admin",content:"admin",extra_class:"admin-only",title_attribute:"Administer this Galaxy"});this.masthead.append(i)}var j=new b({id:"help",title:"Help",title_attribute:"Support, contact, and community hubs"});if(this.options.biostar_url&&(j.add({title:"Galaxy Biostar",content:this.options.biostar_url_redirect,target:"_blank"}),j.add({title:"Ask a question",content:"biostar/biostar_question_redirect",target:"_blank"})),j.add({title:"Support",content:this.options.support_url,target:"_blank"}),j.add({title:"Search",content:this.options.search_url,target:"_blank"}),j.add({title:"Mailing Lists",content:this.options.mailing_lists,target:"_blank"}),j.add({title:"Videos",content:this.options.screencasts_url,target:"_blank"}),j.add({title:"Wiki",content:this.options.wiki_url,target:"_blank"}),j.add({title:"How to Cite Galaxy",content:this.options.citation_url,target:"_blank"}),this.options.terms_url&&j.add({title:"Terms and Conditions",content:this.options.terms_url,target:"_blank"}),this.masthead.append(j),Galaxy.user.id){var k=new b({id:"user",title:"User",extra_class:"loggedin-only",title_attribute:"Account preferences and saved data"});k.add({title:"Logged in as "+Galaxy.user.get("email")}),k.add({title:"Preferences",content:"user?cntrller=user",target:"galaxy_main"}),k.add({title:"Custom Builds",content:"user/dbkeys",target:"galaxy_main"}),k.add({title:"Logout",content:"user/logout",target:"_top",divider:!0}),k.add({title:"Saved Histories",content:"history/list",target:"galaxy_main"}),k.add({title:"Saved Datasets",content:"dataset/list",target:"galaxy_main"}),k.add({title:"Saved Pages",content:"page/list",target:"_top"}),k.add({title:"API Keys",content:"user/api_keys?cntrller=user",target:"galaxy_main"}),this.options.use_remote_user&&k.add({title:"Public Name",content:"user/edit_username?cntrller=user",target:"galaxy_main"}),this.masthead.append(k)}else{var k=new b({id:"user",title:"User",extra_class:"loggedout-only",title_attribute:"Account registration or login"});k.add({title:"Login",content:"user/login",target:"galaxy_main"}),this.options.allow_user_creation&&k.add({title:"Register",content:"user/create",target:"galaxy_main"}),this.masthead.append(k)}this.options.active_view&&this.masthead.highlight(this.options.active_view)}}),b=Backbone.View.extend({options:{id:"",title:"",target:"_parent",content:"",type:"url",scratchbook:!1,onunload:null,visible:!0,disabled:!1,title_attribute:""},location:"navbar",$menu:null,events:{"click .head":"_head"},initialize:function(a){a&&(this.options=_.defaults(a,this.options)),void 0!==this.options.content&&-1===this.options.content.indexOf("//")&&(this.options.content=Galaxy.root+this.options.content),this.setElement($(this._template(this.options))),this.options.disabled&&($(this.el).find(".root").addClass("disabled"),this._attachPopover()),this.options.visible||this.hide()},show:function(){$(this.el).css({visibility:"visible"})},hide:function(){$(this.el).css({visibility:"hidden"})},add:function(a){var b={title:"Title",content:"",type:"url",target:"_parent",scratchbook:!1,divider:!1,onclick:void 0};a&&(b=_.defaults(a,b)),b.content&&-1===b.content.indexOf("//")&&(b.content=Galaxy.root+b.content),this.$menu||($(this.el).find(".root").append(this._templateMenu()),$(this.el).find(".symbol").addClass("caret"),this.$menu=$(this.el).find(".popup"));var c=$(this._templateMenuItem(b));this.$menu.append(c);var d=this;void 0!==b.onclick?c.on("click",function(a){a.preventDefault(),b.onclick()}):c.on("click",function(b){return b.preventDefault(),"_blank"===d.options.target?!0:void Galaxy.frame.add(a)}),b.divider&&this.$menu.append($(this._templateDivider()))},_head:function(a){a.preventDefault(),this.options.disabled||this.$menu||Galaxy.frame.add(this.options)},_attachPopover:function(){var a=$(this.el).find(".head");a.popover({html:!0,content:'Please <a href="'+Galaxy.root+'user/login?use_panels=True">log in</a> or <a href="'+Galaxy.root+'user/create?use_panels=True">register</a> to use this feature.',placement:"bottom"}).on("shown.bs.popover",function(){setTimeout(function(){a.popover("hide")},5e3)})},_templateMenuItem:function(a){return'<li><a href="'+a.content+'" target="'+a.target+'">'+a.title+"</a></li>"},_templateMenu:function(){return'<ul class="popup dropdown-menu"></ul>'},_templateDivider:function(){return'<li class="divider"></li>'},_template:function(a){var b='<ul id="'+a.id+'" class="nav navbar-nav" border="0" cellspacing="0"><li class="root dropdown" style=""><a class="head dropdown-toggle" data-toggle="dropdown" target="'+a.target+'" href="'+a.content+'" title="'+a.title_attribute+'">'+a.title+'<b class="symbol"></b></a></li></ul>';return b}});return{GalaxyMenu:a,GalaxyMastheadTab:b}});
=======
define(["mvc/tours"],function(a){var b=Backbone.Collection.extend({model:Backbone.Model.extend({defaults:{visible:!0,target:"_parent"}}),fetch:function(b){b=b||{},this.reset(),this.add({id:"analysis",title:"Analyze Data",url:"",tooltip:"Analysis home view"}),this.add({id:"workflow",title:"Workflow",url:"workflow",tooltip:"Chain tools into workflows",disabled:!Galaxy.user.id}),this.add({id:"shared",title:"Shared Data",url:"library/index",tooltip:"Access published resources",menu:[{title:"Data Libraries deprecated",url:"library/index"},{title:"Data Libraries",url:"library/list",divider:!0},{title:"Published Histories",url:"history/list_published"},{title:"Published Workflows",url:"workflow/list_published"},{title:"Published Visualizations",url:"visualization/list_published"},{title:"Published Pages",url:"page/list_published"}]}),b.user_requests&&this.add({id:"lab",title:"Lab",menu:[{title:"Sequencing Requests",url:"requests/index"},{title:"Find Samples",url:"requests/find_samples_index"},{title:"Help",url:b.lims_doc_url}]}),this.add({id:"visualization",title:"Visualization",url:"visualization/list",tooltip:"Visualize datasets",disabled:!Galaxy.user.id,menu:[{title:"New Track Browser",url:"visualization/trackster",target:"_frame"},{title:"Saved Visualizations",url:"visualization/list",target:"_frame"}]}),Galaxy.user.get("is_admin")&&this.add({id:"admin",title:"Admin",url:"admin",tooltip:"Administer this Galaxy",cls:"admin-only"});var c={id:"help",title:"Help",tooltip:"Support, contact, and community hubs",menu:[{title:"Support",url:b.support_url,target:"_blank"},{title:"Search",url:b.search_url,target:"_blank"},{title:"Mailing Lists",url:b.mailing_lists,target:"_blank"},{title:"Videos",url:b.screencasts_url,target:"_blank"},{title:"Wiki",url:b.wiki_url,target:"_blank"},{title:"How to Cite Galaxy",url:b.citation_url,target:"_blank"},{title:"Interactive Tours",onclick:function(){Galaxy.app?Galaxy.app.display(new a.ToursView):window.location=Galaxy.root+"#/tours"},target:"galaxy_main"}]};if(b.terms_url&&c.menu.push({title:"Terms and Conditions",url:b.terms_url,target:"_blank"}),b.biostar_url&&c.menu.unshift({title:"Ask a question",url:"biostar/biostar_question_redirect",target:"_blank"}),b.biostar_url&&c.menu.unshift({title:"Galaxy Biostar",url:b.biostar_url_redirect,target:"_blank"}),this.add(c),Galaxy.user.id){var d={id:"user",title:"User",cls:"loggedin-only",tooltip:"Account preferences and saved data",menu:[{title:"Logged in as "+Galaxy.user.get("email")},{title:"Preferences",url:"user?cntrller=user",target:"galaxy_main"},{title:"Custom Builds",url:"user/dbkeys",target:"galaxy_main"},{title:"Logout",url:"user/logout",target:"_top",divider:!0},{title:"Saved Histories",url:"history/list",target:"galaxy_main"},{title:"Saved Datasets",url:"dataset/list",target:"galaxy_main"},{title:"Saved Pages",url:"page/list",target:"_top"},{title:"API Keys",url:"user/api_keys?cntrller=user",target:"galaxy_main"}]};b.use_remote_user&&d.menu.push({title:"Public Name",url:"user/edit_username?cntrller=user",target:"galaxy_main"}),this.add(d)}else{var d={id:"user",title:"User",cls:"loggedout-only",tooltip:"Account registration or login",menu:[{title:"Login",url:"user/login",target:"galaxy_main"}]};b.allow_user_creation&&d.menu.push({title:"Register",url:"user/create",target:"galaxy_main"}),this.add(d)}var e=this.get(b.active_view);return e&&e.set("active",!0),(new jQuery.Deferred).resolve().promise()}}),c=Backbone.View.extend({initialize:function(a){this.model=a.model,this.setElement(this._template()),this.$dropdown=this.$(".dropdown"),this.$toggle=this.$(".dropdown-toggle"),this.$menu=this.$(".dropdown-menu"),this.$note=this.$(".dropdown-note"),this.listenTo(this.model,"change",this.render,this)},events:{"click .dropdown-toggle":"_toggleClick"},render:function(){var a=this;return $(".tooltip").remove(),this.$el.attr("id",this.model.id).css({visibility:this.model.get("visible")&&"visible"||"hidden"}),this.model.set("url",this._formatUrl(this.model.get("url"))),this.$note.html(this.model.get("note")||"").removeClass().addClass("dropdown-note").addClass(this.model.get("note_cls")).css({display:this.model.get("show_note")&&"block"||"none"}),this.$toggle.html(this.model.get("title")||"").removeClass().addClass("dropdown-toggle").addClass(this.model.get("cls")).addClass(this.model.get("icon")&&"fa fa-2x "+this.model.get("icon")).addClass(this.model.get("toggle")&&"toggle").attr("target",this.model.get("target")).attr("href",this.model.get("url")).attr("title",this.model.get("tooltip")).tooltip("destroy"),this.model.get("tooltip")&&this.$toggle.tooltip({placement:"bottom"}),this.$dropdown.removeClass().addClass("dropdown").addClass(this.model.get("disabled")&&"disabled").addClass(this.model.get("active")&&"active"),this.model.get("menu")&&this.model.get("show_menu")?(this.$menu.show(),$("#dd-helper").show().off().on("click",function(){$("#dd-helper").hide(),a.model.set("show_menu",!1)})):(a.$menu.hide(),$("#dd-helper").hide()),this.$menu.empty().removeClass("dropdown-menu"),this.model.get("menu")&&(_.each(this.model.get("menu"),function(b){a.$menu.append(a._buildMenuItem(b)),b.divider&&a.$menu.append($("<li/>").addClass("divider"))}),a.$menu.addClass("dropdown-menu"),a.$toggle.append($("<b/>").addClass("caret"))),this},_buildMenuItem:function(a){var b=this;return a=_.defaults(a||{},{title:"",url:"",target:"_parent"}),a.url=b._formatUrl(a.url),$("<li/>").append($("<a/>").attr("href",a.url).attr("target",a.target).html(a.title).on("click",function(c){c.preventDefault(),b.model.set("show_menu",!1),a.onclick?a.onclick():Galaxy.frame.add(a)}))},_toggleClick:function(a){function b(a,b){return $("<div/>").append($("<a/>").attr("href",Galaxy.root+b).html(a)).html()}var c=this,d=this.model;a.preventDefault(),$(".tooltip").hide(),d.trigger("dispatch",function(a){d.id!==a.id&&a.get("menu")&&a.set("show_menu",!1)}),d.get("disabled")?(this.$toggle.popover&&this.$toggle.popover("destroy"),this.$toggle.popover({html:!0,placement:"bottom",content:"Please "+b("login","user/login?use_panels=True")+" or "+b("register","user/create?use_panels=True")+" to use this feature."}).popover("show"),setTimeout(function(){c.$toggle.popover("destroy")},5e3)):d.get("menu")?d.set("show_menu",!0):d.get("onclick")?d.get("onclick")():Galaxy.frame.add(d.attributes)},_formatUrl:function(a){return"string"==typeof a&&-1===a.indexOf("//")&&"/"!=a.charAt(0)?Galaxy.root+a:a},_template:function(){return'<ul class="nav navbar-nav"><li class="dropdown"><a class="dropdown-toggle"/><ul class="dropdown-menu"/><div class="dropdown-note"/></li></ul>'}});return{Collection:b,Tab:c}});
>>>>>>> dev
//# sourceMappingURL=../../maps/layout/menu.js.map
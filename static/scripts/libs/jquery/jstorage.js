"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){var e="{}";if("userDataBehavior"==y){p.load("jStorage");try{e=p.getAttribute("jStorage")}catch(e){}try{C=p.getAttribute("jStorage_update")}catch(e){}h.jStorage=e}i(),g(),c()}function t(){"localStorage"==y||"globalStorage"==y?"addEventListener"in window?window.addEventListener("storage",r,!1):document.attachEvent("onstorage",r):"userDataBehavior"==y&&setInterval(r,1e3)}function r(){var e;clearTimeout(T),T=setTimeout(function(){if("localStorage"==y||"globalStorage"==y)e=h.jStorage_update;else if("userDataBehavior"==y){p.load("jStorage");try{e=p.getAttribute("jStorage_update")}catch(e){}}e&&e!=C&&(C=e,o())},25)}function o(){var t,r=j.parse(j.stringify(m.__jstorage_meta.CRC32));e(),t=j.parse(j.stringify(m.__jstorage_meta.CRC32));var o,n=[],i=[];for(o in r)if(r.hasOwnProperty(o)){if(!t[o]){i.push(o);continue}r[o]!=t[o]&&"2."==String(r[o]).substr(0,2)&&n.push(o)}for(o in t)t.hasOwnProperty(o)&&(r[o]||n.push(o));a(n,"updated"),a(i,"deleted")}function a(e,t){if(e=[].concat(e||[]),"flushed"==t){e=[];for(var r in v)v.hasOwnProperty(r)&&e.push(r);t="deleted"}for(var o=0,a=e.length;o<a;o++){if(v[e[o]])for(var n=0,i=v[e[o]].length;n<i;n++)v[e[o]][n](e[o],t);if(v["*"])for(var n=0,i=v["*"].length;n<i;n++)v["*"][n](e[o],t)}}function n(){var e=(+new Date).toString();if("localStorage"==y||"globalStorage"==y)try{h.jStorage_update=e}catch(e){y=!1}else"userDataBehavior"==y&&(p.setAttribute("jStorage_update",e),p.save("jStorage"));r()}function i(){if(h.jStorage)try{m=j.parse(String(h.jStorage))}catch(e){h.jStorage="{}"}else h.jStorage="{}";b=h.jStorage?String(h.jStorage).length:0,m.__jstorage_meta||(m.__jstorage_meta={}),m.__jstorage_meta.CRC32||(m.__jstorage_meta.CRC32={})}function s(){l();try{h.jStorage=j.stringify(m),p&&(p.setAttribute("jStorage",h.jStorage),p.save("jStorage")),b=h.jStorage?String(h.jStorage).length:0}catch(e){}}function u(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==e)throw new TypeError("Reserved key name");return!0}function g(){var e,t,r,o,i=1/0,u=!1,c=[];if(clearTimeout(w),m.__jstorage_meta&&"object"==_typeof(m.__jstorage_meta.TTL)){e=+new Date,r=m.__jstorage_meta.TTL,o=m.__jstorage_meta.CRC32;for(t in r)r.hasOwnProperty(t)&&(r[t]<=e?(delete r[t],delete o[t],delete m[t],u=!0,c.push(t)):r[t]<i&&(i=r[t]));i!=1/0&&(w=setTimeout(g,i-e)),u&&(s(),n(),a(c,"deleted"))}}function c(){var e;if(m.__jstorage_meta.PubSub){var t,r=O;for(e=m.__jstorage_meta.PubSub.length-1;e>=0;e--)t=m.__jstorage_meta.PubSub[e],t[0]>O&&(r=t[0],_(t[1],t[2]));O=r}}function _(e,t){if(L[e])for(var r=0,o=L[e].length;r<o;r++)L[e][r](e,j.parse(j.stringify(t)))}function l(){if(m.__jstorage_meta.PubSub){for(var e=+new Date-2e3,t=0,r=m.__jstorage_meta.PubSub.length;t<r;t++)if(m.__jstorage_meta.PubSub[t][0]<=e){m.__jstorage_meta.PubSub.splice(t,m.__jstorage_meta.PubSub.length-t);break}m.__jstorage_meta.PubSub.length||delete m.__jstorage_meta.PubSub}}function f(e,t){m.__jstorage_meta||(m.__jstorage_meta={}),m.__jstorage_meta.PubSub||(m.__jstorage_meta.PubSub=[]),m.__jstorage_meta.PubSub.unshift([+new Date,e,t]),s(),n()}function d(e,t){for(var r,o=e.length,a=t^o,n=0;o>=4;)r=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),r^=r>>>24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^r,o-=4,++n;switch(o){case 3:a^=(255&e.charCodeAt(n+2))<<16;case 2:a^=(255&e.charCodeAt(n+1))<<8;case 1:a^=255&e.charCodeAt(n),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)}return a^=a>>>13,a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0}var S=window.jQuery||window.$||(window.$={}),j={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return String(e).evalJSON()}||S.parseJSON||S.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||S.toJSON};if(!("parse"in j&&"stringify"in j))throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var w,m={__jstorage_meta:{CRC32:{}}},h={jStorage:"{}"},p=null,b=0,y=!1,v={},T=!1,C=0,L={},O=+new Date,P={isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"HTML"!==t.nodeName},encode:function(e){if(!this.isXML(e))return!1;try{return(new XMLSerializer).serializeToString(e)}catch(t){try{return e.xml}catch(e){}}return!1},decode:function(e){var t,r="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t};return!!r&&(t=r.call("DOMParser"in window&&new DOMParser||window,e,"text/xml"),!!this.isXML(t)&&t)}};S.jStorage={version:"0.4.4",set:function(e,t,r){if(u(e),r=r||{},void 0===t)return this.deleteKey(e),t;if(P.isXML(t))t={_is_xml:!0,xml:P.encode(t)};else{if("function"==typeof t)return;t&&"object"==(void 0===t?"undefined":_typeof(t))&&(t=j.parse(j.stringify(t)))}return m[e]=t,m.__jstorage_meta.CRC32[e]="2."+d(j.stringify(t),2538058380),this.setTTL(e,r.TTL||0),a(e,"updated"),t},get:function(e,t){return u(e),e in m?m[e]&&"object"==_typeof(m[e])&&m[e]._is_xml?P.decode(m[e].xml):m[e]:void 0===t?null:t},deleteKey:function(e){return u(e),e in m&&(delete m[e],"object"==_typeof(m.__jstorage_meta.TTL)&&e in m.__jstorage_meta.TTL&&delete m.__jstorage_meta.TTL[e],delete m.__jstorage_meta.CRC32[e],s(),n(),a(e,"deleted"),!0)},setTTL:function(e,t){var r=+new Date;return u(e),t=Number(t)||0,e in m&&(m.__jstorage_meta.TTL||(m.__jstorage_meta.TTL={}),t>0?m.__jstorage_meta.TTL[e]=r+t:delete m.__jstorage_meta.TTL[e],s(),g(),n(),!0)},getTTL:function(e){var t=+new Date;return u(e),e in m&&m.__jstorage_meta.TTL&&m.__jstorage_meta.TTL[e]?m.__jstorage_meta.TTL[e]-t||0:0},flush:function(){return m={__jstorage_meta:{CRC32:{}}},s(),n(),a(null,"flushed"),!0},storageObj:function(){function e(){}return e.prototype=m,new e},index:function(){var e,t=[];for(e in m)m.hasOwnProperty(e)&&"__jstorage_meta"!=e&&t.push(e);return t},storageSize:function(){return b},currentBackend:function(){return y},storageAvailable:function(){return!!y},listenKeyChange:function(e,t){u(e),v[e]||(v[e]=[]),v[e].push(t)},stopListening:function(e,t){if(u(e),v[e]){if(!t)return void delete v[e];for(var r=v[e].length-1;r>=0;r--)v[e][r]==t&&v[e].splice(r,1)}},subscribe:function(e,t){if(!(e=(e||"").toString()))throw new TypeError("Channel not defined");L[e]||(L[e]=[]),L[e].push(t)},publish:function(e,t){if(!(e=(e||"").toString()))throw new TypeError("Channel not defined");f(e,t)},reInit:function(){e()}},function(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),e=!0,window.localStorage.removeItem("_tmptest")}catch(e){}if(e)try{window.localStorage&&(h=window.localStorage,y="localStorage",C=h.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(h="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],y="globalStorage",C=h.jStorage_update)}catch(e){}else{if(p=document.createElement("link"),!p.addBehavior)return void(p=null);p.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(p);try{p.load("jStorage")}catch(e){p.setAttribute("jStorage","{}"),p.save("jStorage"),p.load("jStorage")}var o="{}";try{o=p.getAttribute("jStorage")}catch(e){}try{C=p.getAttribute("jStorage_update")}catch(e){}h.jStorage=o,y="userDataBehavior"}i(),g(),t(),c(),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&r()},!1)}()}();
//# sourceMappingURL=../../../maps/libs/jquery/jstorage.js.map

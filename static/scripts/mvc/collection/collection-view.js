"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _listView=require("mvc/list/list-view"),_listView2=_interopRequireDefault(_listView),_collectionModel=require("mvc/collection/collection-model"),_collectionModel2=_interopRequireDefault(_collectionModel),_collectionLi=require("mvc/collection/collection-li"),_collectionLi2=_interopRequireDefault(_collectionLi),_baseMvc=require("mvc/base-mvc"),_baseMvc2=_interopRequireDefault(_baseMvc),_localization=require("utils/localization"),_localization2=_interopRequireDefault(_localization),logNamespace="collections",_super=_listView2.default.ModelListPanel,CollectionView=_super.extend({_logNamespace:logNamespace,className:_super.prototype.className+" dataset-collection-panel",DatasetDCEViewClass:_collectionLi2.default.DatasetDCEListItemView,NestedDCDCEViewClass:_collectionLi2.default.NestedDCDCEListItemView,modelCollectionKey:"elements",initialize:function(e){_super.prototype.initialize.call(this,e),this.linkTarget=e.linkTarget||"_blank",this.hasUser=e.hasUser,this.panelStack=[],this.parentName=e.parentName,this.foldoutStyle=e.foldoutStyle||"foldout",this.downloadUrl=this.model.attributes.url+"/download"},_queueNewRender:function(e,t){t=void 0===t?this.fxSpeed:t;var i=this;i.log("_queueNewRender:",e,t),i._swapNewRender(e),i.trigger("rendered",i)},_filterCollection:function(){return this.model.getVisibleContents()},_getItemViewClass:function(e){switch(e.get("element_type")){case"hda":return this.DatasetDCEViewClass;case"dataset_collection":return this.NestedDCDCEViewClass}throw new TypeError("Unknown element type:",e.get("element_type"))},_getItemViewOptions:function(e){var t=_super.prototype._getItemViewOptions.call(this,e);return _.extend(t,{linkTarget:this.linkTarget,hasUser:this.hasUser,foldoutStyle:this.foldoutStyle})},_setUpItemViewListeners:function(e){var t=this;return _super.prototype._setUpItemViewListeners.call(t,e),t.listenTo(e,{"expanded:drilldown":function(e,t){this._expandDrilldownPanel(t)},"collapsed:drilldown":function(e,t){this._collapseDrilldownPanel(t)}}),this},_expandDrilldownPanel:function(e){this.panelStack.push(e),this.$("> .controls").add(this.$list()).hide(),e.parentName=this.model.get("name"),this.$el.append(e.render().$el)},_collapseDrilldownPanel:function(e){this.panelStack.pop(),this.render()},events:{"click .navigation .back":"close"},close:function(e){this.remove(),this.trigger("close")},toString:function(){return"CollectionView("+(this.model?this.model.get("name"):"")+")"}});CollectionView.prototype.templates=function(){var e=_baseMvc2.default.wrapTemplate(['<div class="controls">','<div class="navigation">','<a class="back" href="javascript:void(0)">','<span class="fa fa-icon fa-angle-left"></span>',(0,_localization2.default)("Back to "),"<%- view.parentName %>","</a>","</div>",'<div class="title">','<div class="name"><%- collection.name || collection.element_identifier %></div>','<div class="subtitle">','<% if( collection.collection_type === "list" ){ %>',(0,_localization2.default)("a list of datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',(0,_localization2.default)("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',(0,_localization2.default)("a list of paired datasets"),'<% } else if( collection.collection_type === "list:list" ){ %>',(0,_localization2.default)("a list of dataset lists"),"<% } %>","</div>","</div>",'<div class="tags-display"></div>','<div class="actions">','<a class="download-btn icon-btn" ','href="<%- view.downloadUrl %>','" title="" download="" data-original-title="Download Collection">','<span class="fa fa-floppy-o"></span>',"</a>","</div>","</div>"],"collection");return _.extend(_.clone(_super.prototype.templates),{controls:e})}();var ListCollectionView=CollectionView.extend({DatasetDCEViewClass:_collectionLi2.default.DatasetDCEListItemView,toString:function(){return"ListCollectionView("+(this.model?this.model.get("name"):"")+")"}}),PairCollectionView=ListCollectionView.extend({toString:function(){return"PairCollectionView("+(this.model?this.model.get("name"):"")+")"}}),ListOfPairsCollectionView=CollectionView.extend({NestedDCDCEViewClass:_collectionLi2.default.NestedDCDCEListItemView.extend({foldoutPanelClass:PairCollectionView}),toString:function(){return"ListOfPairsCollectionView("+(this.model?this.model.get("name"):"")+")"}}),ListOfListsCollectionView=CollectionView.extend({NestedDCDCEViewClass:_collectionLi2.default.NestedDCDCEListItemView.extend({foldoutPanelClass:PairCollectionView}),toString:function(){return"ListOfListsCollectionView("+(this.model?this.model.get("name"):"")+")"}});exports.default={CollectionView:CollectionView,ListCollectionView:ListCollectionView,PairCollectionView:PairCollectionView,ListOfPairsCollectionView:ListOfPairsCollectionView,ListOfListsCollectionView:ListOfListsCollectionView};
//# sourceMappingURL=../../../maps/mvc/collection/collection-view.js.map

"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _listItem=require("mvc/list/list-item"),_listItem2=_interopRequireDefault(_listItem),_datasetLi=require("mvc/dataset/dataset-li"),_datasetLi2=_interopRequireDefault(_datasetLi),_baseMvc=require("mvc/base-mvc"),_baseMvc2=_interopRequireDefault(_baseMvc),_localization=require("utils/localization"),_localization2=_interopRequireDefault(_localization),FoldoutListItemView=_listItem2.default.FoldoutListItemView,ListItemView=_listItem2.default.ListItemView,DCListItemView=FoldoutListItemView.extend({className:FoldoutListItemView.prototype.className+" dataset-collection",id:function(){return["dataset_collection",this.model.get("id")].join("-")},initialize:function(e){this.linkTarget=e.linkTarget||"_blank",this.hasUser=e.hasUser,FoldoutListItemView.prototype.initialize.call(this,e)},_setUpListeners:function(){FoldoutListItemView.prototype._setUpListeners.call(this),this.listenTo(this.model,"change",function(e,t){_.has(e.changed,"deleted")?this.render():_.has(e.changed,"element_count")&&this.$("> .title-bar .subtitle").replaceWith(this._renderSubtitle())})},_renderSubtitle:function(){return $(this.templates.subtitle(this.model.toJSON(),this))},_getFoldoutPanelOptions:function(){var e=FoldoutListItemView.prototype._getFoldoutPanelOptions.call(this);return _.extend(e,{linkTarget:this.linkTarget,hasUser:this.hasUser})},$selector:function(){return this.$("> .selector")},toString:function(){return"DCListItemView("+(this.model?this.model+"":"(no model)")+")"}});DCListItemView.prototype.templates=function(){var e=_.extend({},FoldoutListItemView.prototype.templates.warnings,{error:_baseMvc2.default.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',(0,_localization2.default)("There was an error getting the data for this collection"),": <%- model.error %>","</div>","<% } %>"]),purged:_baseMvc2.default.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',(0,_localization2.default)("This collection has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:_baseMvc2.default.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',(0,_localization2.default)("This collection has been deleted"),"</div>","<% } %>"])}),t=_baseMvc2.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- collection.element_identifier || collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection"),i=_baseMvc2.default.wrapTemplate(['<div class="subtitle">','<% var countText = collection.element_count? ( collection.element_count + " " ) : ""; %>','<%        if( collection.collection_type === "list" ){ %>',(0,_localization2.default)("a list of <%- countText %>datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',(0,_localization2.default)("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',(0,_localization2.default)("a list of <%- countText %>dataset pairs"),'<% } else if( collection.collection_type === "list:list" ){ %>',(0,_localization2.default)("a list of <%- countText %>dataset lists"),"<% } %>","</div>"],"collection");return _.extend({},FoldoutListItemView.prototype.templates,{warnings:e,titleBar:t,subtitle:i})}();var DCEListItemView=ListItemView.extend({className:ListItemView.prototype.className+" dataset-collection-element",initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DCEListItemView.initialize:",e),ListItemView.prototype.initialize.call(this,e)},toString:function(){return"DCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});DCEListItemView.prototype.templates=function(){var e=_baseMvc2.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element");return _.extend({},ListItemView.prototype.templates,{titleBar:e})}();var DatasetDCEListItemView=_datasetLi2.default.DatasetListItemView.extend({className:_datasetLi2.default.DatasetListItemView.prototype.className+" dataset-collection-element",initialize:function(e){e.logger&&(this.logger=this.model.logger=e.logger),this.log("DatasetDCEListItemView.initialize:",e),_datasetLi2.default.DatasetListItemView.prototype.initialize.call(this,e)},_fetchModelDetails:function(){var e=this;return e.model.inReadyState()&&!e.model.hasDetails()?e.model.fetch({silent:!0}):jQuery.when()},toString:function(){return"DatasetDCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});DatasetDCEListItemView.prototype.templates=function(){var e=_baseMvc2.default.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>","</div>"],"element");return _.extend({},_datasetLi2.default.DatasetListItemView.prototype.templates,{titleBar:e})}();var NestedDCDCEListItemView=DCListItemView.extend({className:DCListItemView.prototype.className+" dataset-collection-element",_swapNewRender:function(e){DCListItemView.prototype._swapNewRender.call(this,e);var t=this.model.get("state")||"ok";return this.$el.addClass("state-"+t),this.$el},toString:function(){return"NestedDCDCEListItemView("+(this.model?this.model+"":"(no model)")+")"}});exports.default={DCListItemView:DCListItemView,DCEListItemView:DCEListItemView,DatasetDCEListItemView:DatasetDCEListItemView,NestedDCDCEListItemView:NestedDCDCEListItemView};
//# sourceMappingURL=../../../maps/mvc/collection/collection-li.js.map

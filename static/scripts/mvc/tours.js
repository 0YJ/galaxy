define(["libs/bootstrap-tour"],function(){var a=function(a){return _.each(a.steps,function(a){a.preclick&&(a.onShow=function(){$(a.preclick).click()}),a.postclick&&(a.onHide=function(){$(a.postclick).click()}),a.textinsert&&(a.onShown=function(){$(a.element).val(a.textinsert).trigger("change")})}),a},b=Backbone.Model.extend({urlRoot:Galaxy.root+"api/tours"}),c=Backbone.Collection.extend({url:Galaxy.root+"api/tours",model:b}),d=Backbone.View.extend({initialize:function(){var a=this;this.setElement("<div/>"),this.model=new c,this.model.fetch({success:function(){a.render()},error:function(){console.error("Failed to fetch tours.")}})},render:function(){var a=this,b=_.template(["<h2>Available Galaxy Tours</h2>","<ul>","<% _.each(tours, function(tour) { %>","<li>",'<a href="#" class="tourItem" data-tour.id=<%- tour.id %>>',"<%- tour.id %>","</a>","- <%- tour.attributes.description %>","</li>","<% }); %>","</ul>"].join(""));this.$el.html(b({tours:this.model.models,Galaxy:Galaxy})).on("click",".tourItem",function(){a.giveTour($(this).data("tour.id"))})},giveTour:function(b){var c=Galaxy.root+"api/tours/"+b;$.getJSON(c,function(b){tourdata=a(b),sessionStorage.setItem("activeGalaxyTour",JSON.stringify(b));var c=new Tour({storage:window.sessionStorage,steps:tourdata.steps,debug:!0,onEnd:function(){sessionStorage.removeItem("activeGalaxyTour")}});c.init(),c.goTo(0),c.restart()})}});return{ToursView:d,hooked_tour_from_data:a}});
//# sourceMappingURL=../../maps/mvc/tours.js.map
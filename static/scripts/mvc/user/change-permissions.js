define(["mvc/form/form-view","mvc/ui/ui-misc"],function(a,b){return Backbone.View.extend({initialize:function(c){var d=this;this.model=c&&c.model||new Backbone.Model(c),window.console.log(c),this.form=new a({title:"Manage dataset permissions",name:"toolbox_filter",inputs:c.inputs,icon:"fa-universal-access",operations:{back:new b.ButtonIcon({icon:"fa-caret-left",tooltip:"Return to user preferences",title:"Preferences",onclick:function(){d.remove(),c.onclose()}})},buttons:{save:new b.Button({tooltip:"Save changes",title:"Save Permissions",icon:"fa-save",cls:"ui-button btn btn-primary",floating:"clear",onclick:function(){d._save()}})}}),this.setElement(this.form.$el)},initializedssd:function(a,b,c){var d=this;this.model=b&&b.model||new Backbone.Model(b),this.form=d._buildForm(b,a,d,c),c.append(this.form.$el)},_buildForm:function(c,d,e,f){return new a({title:"Manage dataset permissions on EMAIL",icon:"fa-universal-access",inputs:c.role_form,operations:{back:new b.ButtonIcon({icon:"fa-caret-left",tooltip:"Return to user preferences",title:"Preferences",onclick:function(){e.form.$el.remove(),d.showPreferences()}})},onchange:function(){e._savePermissions(e,d,f)}})},_updateForm:function(a,b,c,d){c.form.$el.remove(),c.form=c._buildForm(d,a,c,b),b.append(c.form.$el),c.form.message.update({message:d.message,status:"error"===d.status?"danger":"success"})},_savePermissions:function(a,b,c){var d=a.form.data.create(),e=!1,f=!1,g={};for(var h in d)h.indexOf("actionrole")>0&&null!==d[h]&&(e=!0),(h.indexOf("_in")>0||h.indexOf("_out")>0)&&null!==d[h]&&(f=!0,g[h]=d[h][0]);e&&f&&(g.update_roles=f,$.getJSON(Galaxy.root+"api/user_preferences/set_default_permissions",g,function(d){a._updateForm(b,c,a,d)}))}})});
//# sourceMappingURL=../../../maps/mvc/user/change-permissions.js.map
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _underscore=require("libs/underscore"),_underscore2=_interopRequireDefault(_underscore),_backbone=require("libs/backbone"),_backbone2=_interopRequireDefault(_backbone),_baseMvc=require("mvc/base-mvc"),_baseMvc2=_interopRequireDefault(_baseMvc),_localization=require("utils/localization"),_localization2=_interopRequireDefault(_localization),logNamespace="user",User=_backbone2.default.Model.extend(_baseMvc2.default.LoggableMixin).extend({_logNamespace:logNamespace,urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+(0,_localization2.default)("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(e){this.log("User.initialize:",e),this.on("loaded",function(e,t){this.log(this+" has loaded:",e,t)}),this.on("change",function(e,t){this.log(this+" has changed:",e,t.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(e,t){e=e||User.CURRENT_ID_STR;var i=this,o=(t=t||{}).success;return t.success=function(e,t){i.trigger("loaded",e,t),o&&o(e,t)},e===User.CURRENT_ID_STR&&(t.url=this.urlRoot+"/"+User.CURRENT_ID_STR),_backbone2.default.Model.prototype.fetch.call(this,t)},clearSessionStorage:function(){for(var e in sessionStorage)0===e.indexOf("history:")?sessionStorage.removeItem(e):"history-panel"===e&&sessionStorage.removeItem(e)},toString:function(){var e=[this.get("username")];return this.get("id")&&(e.unshift(this.get("id")),e.push(this.get("email"))),"User("+e.join(":")+")"}});User.CURRENT_ID_STR="current",User.getCurrentUserFromApi=function(e){var t=new User;return t.loadFromApi(User.CURRENT_ID_STR,e),t};var UserCollection=_backbone2.default.Collection.extend(_baseMvc2.default.LoggableMixin).extend({model:User,urlRoot:function(){return Galaxy.root+"api/users"}});exports.default={User:User};
//# sourceMappingURL=../../../maps/mvc/user/user-model.js.map

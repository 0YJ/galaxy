"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _baseMvc=require("mvc/base-mvc"),_baseMvc2=_interopRequireDefault(_baseMvc),_localization=require("utils/localization"),_localization2=_interopRequireDefault(_localization),logNamespace="user",UserQuotaMeter=Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend({_logNamespace:logNamespace,options:{warnAtPercent:85,errorAtPercent:100},initialize:function(e){this.log(this+".initialize:",e),_.extend(this.options,e),this.listenTo(this.model,"change:quota_percent change:total_disk_usage",this.render)},update:function(e){return this.log(this+" updating user data...",e),this.model.loadFromApi(this.model.get("id"),e),this},isOverQuota:function(){return null!==this.model.get("quota_percent")&&this.model.get("quota_percent")>=this.options.errorAtPercent},_render_quota:function(){var e=this.model.toJSON(),t=e.quota_percent,r=$(this._templateQuotaMeter(e)),a=r.find(".progress-bar");return this.isOverQuota()?(a.attr("class","progress-bar progress-bar-danger"),r.find(".quota-meter-text").css("color","white"),this.trigger("quota:over",e)):t>=this.options.warnAtPercent?(a.attr("class","progress-bar progress-bar-warning"),this.trigger("quota:under quota:under:approaching",e)):(a.attr("class","progress-bar progress-bar-success"),this.trigger("quota:under quota:under:ok",e)),r},_render_usage:function(){var e=$(this._templateUsage(this.model.toJSON()));return this.log(this+".rendering usage:",e),e},render:function(){var e=null;return this.log(this+".model.quota_percent:",this.model.get("quota_percent")),e=null===this.model.get("quota_percent")||void 0===this.model.get("quota_percent")?this._render_usage():this._render_quota(),this.$el.html(e),this.$el.find(".quota-meter-text").tooltip(),this},_templateQuotaMeter:function(e){return['<div id="quota-meter" class="quota-meter progress">','<div class="progress-bar" style="width: ',e.quota_percent,'%"></div>','<div class="quota-meter-text" data-placement="left" style="top: 6px"',e.nice_total_disk_usage?' title="Using '+e.nice_total_disk_usage+'.  This value is recalculated when you log out.">':">",(0,_localization2.default)("Using")," ",e.quota_percent,"%","</div>","</div>"].join("")},_templateUsage:function(e){return['<div id="quota-meter" class="quota-meter" style="background-color: transparent">','<div class="quota-meter-text" data-placement="left" data-original-title="This value is recalculated when you log out." style="top: 6px; color: white">',e.nice_total_disk_usage?(0,_localization2.default)("Using ")+e.nice_total_disk_usage:"","</div>","</div>"].join("")},toString:function(){return"UserQuotaMeter("+this.model+")"}});exports.default={UserQuotaMeter:UserQuotaMeter};
//# sourceMappingURL=../../../maps/mvc/user/user-quotameter.js.map

define("mvc/history/hdca-li",["exports","mvc/dataset/states","mvc/collection/collection-li","mvc/collection/collection-view","mvc/base-mvc","mvc/history/history-item-li","utils/localization"],function(t,e,s,n,i,a,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var l=o(e),d=o(s),c=o(n),p=(o(i),o(a)),u=o(r),m=d.default.DCListItemView,h=m.extend({className:m.prototype.className+" history-content",_setUpListeners:function(){var t=this;m.prototype._setUpListeners.call(this);var e=function(e,s){t.render()};this.model.jobStatesSummary&&this.listenTo(this.model.jobStatesSummary,"change",e),this.listenTo(this.model,{"change:tags change:visible change:state":e})},_getFoldoutPanelClass:function(){return c.default.CollectionView},_swapNewRender:function(t){m.prototype._swapNewRender.call(this,t);var e,s=this.model.jobStatesSummary;e=s?s.new()?"loading":s.errored()?"error":s.terminal()?"ok":s.running()?"running":"queued":this.model.get("job_source_id")?"loading":this.model.get("populated_state")?l.default.OK:l.default.RUNNING,this.$el.addClass("state-"+e);var n=this.stateDescription();return this.$(".state-description").html(n),this.$el},stateDescription:function(){var t,e=this.model,s=e.get("element_count"),n=e.get("job_source_type"),i=this.model.get("collection_type");t="list"==i?"list":"paired"==i?"dataset pair":"list:paired"==i?"list of pairs":"nested list";var a="";1==s?a=" with 1 item":s&&(a=" with "+s+" items");var r=e.jobStatesSummary,o=""+t+a;if(n&&"Job"!=n){if(r&&r.hasDetails()){var l=r.new(),d=l?null:r.jobCount();if(l)return'\n                        <div class="progress state-progress">\n                            <span class="note">Creating jobs.<span class="blinking">..</span></span>\n                            <div class="progress-bar info" style="width:100%">\n                        </div>';if(r.errored())return"a "+t+" with "+r.numInError()+" / "+d+" jobs in error";if(r.terminal())return"a "+o;var c=r.states().running||0,p=(r.states().ok||0)/(1*d),u=c/(1*d),m=1-p-u;return'\n                        <div class="progress state-progress">\n                            <span class="note">'+(d&&d>1?d+" jobs":"a job")+" generating a "+t+'</span>\n                            <div class="progress-bar ok" style="width:'+100*p+'%"></div>\n                            <div class="progress-bar running" style="width:'+100*u+'%"></div>\n                            <div class="progress-bar new" style="width:'+100*m+'%">\n                        </div>'}return'\n                    <div class="progress state-progress">\n                        <span class="note">Loading job data for '+t+'.<span class="blinking">..</span></span>\n                        <div class="progress-bar info" style="width:100%">\n                    </div>'}return"a "+o},toString:function(){return"HDCAListItemView("+(this.model?""+this.model:"(no model)")+")"}});h.prototype.templates=function(){var t=_.extend({},m.prototype.templates.warnings,{hidden:function(t){t.visible||(0,u.default)("This collection has been hidden")}});return _.extend({},m.prototype.templates,{warnings:t,titleBar:function(t){return'\n        <div class="title-bar clear" tabindex="0">\n            <span class="state-icon"></span>\n            <div class="title">\n                <span class="hid">'+t.hid+'</span>\n                <span class="name">'+_.escape(t.name)+'</span>\n            </div>\n            <div class="state-description">\n            </div>\n            '+p.default.nametagTemplate(t)+"\n        </div>\n    "}})}(),t.default={HDCAListItemView:h}});
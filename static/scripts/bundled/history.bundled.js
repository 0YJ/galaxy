webpackJsonp([3],[function(t,e,i){var n=i(23).GalaxyMasthead,s=i(48).GalaxyMenu,a=i(33).History,o=i(68).HistoryPanelEdit;window.app=function(t,e){if(!Galaxy.masthead||!Galaxy.menu){var i=_.extend(_.clone(Galaxy.config),{user:{requests:Galaxy.currUser.get("requests"),email:Galaxy.currUser.get("email"),valid:Galaxy.currUser.isAnonymous(),json:Galaxy.currUser.toJSON()}});Galaxy.masthead=new n(i),Galaxy.menu=new s({masthead:Galaxy.masthead,config:i}),console.debug(Galaxy.masthead),console.debug(Galaxy.menu)}return e=e||{},window.panel=new o({show_deleted:e.show_deleted,show_hidden:e.show_deleted,purgeAllowed:Galaxy.config.allow_user_dataset_purge,model:new a(e.history,e.contents)}),$(function(){panel.render().$el.appendTo((t||{}).panelLoc||"body")}),panel}},function(t,e,i){var n,s;n=[],s=function(t){t={};var e=function(i){return e.cacheNonLocalized&&!t.hasOwnProperty(i)&&(e.nonLocalized||(e.nonLocalized={}),e.nonLocalized[i]=navigator.language),t[i]||i};return e.cacheNonLocalized=!1,e}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){function t(e,i){for(var n in e){var s=e[n];s&&"object"==typeof s&&(i(s),t(s,i))}}function e(t){return/^[\],:{}\s]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}function i(t){return $("<div/>").text(t).html()}function n(t){if(t instanceof Array||(t=[t]),0===t.length)return!1;for(var e in t)if(["__null__","__undefined__",null,void 0].indexOf(t[e])>-1)return!1;return!0}function s(t){var t=t.toString();if(t){t=t.replace(/,/g,", ");var e=t.lastIndexOf(", ");return-1!=e&&(t=t.substr(0,e)+" or "+t.substr(e+1)),t}return""}function a(t){top.__utils__get__=top.__utils__get__||{},t.cache&&top.__utils__get__[t.url]?(t.success&&t.success(top.__utils__get__[t.url]),console.debug("utils.js::get() - Fetching from cache ["+t.url+"].")):o({url:t.url,data:t.data,success:function(e){top.__utils__get__[t.url]=e,t.success&&t.success(e)},error:function(e){t.error&&t.error(e)}})}function o(t){var e={contentType:"application/json",type:t.type||"GET",data:t.data||{},url:t.url};"GET"==e.type||"DELETE"==e.type?(-1==e.url.indexOf("?")?e.url+="?":e.url+="&",e.url=e.url+$.param(e.data,!0),e.data=null):(e.dataType="json",e.url=e.url,e.data=JSON.stringify(e.data)),$.ajax(e).done(function(e){if("string"==typeof e)try{e=e.replace("Infinity,",'"Infinity",'),e=jQuery.parseJSON(e)}catch(i){console.debug(i)}t.success&&t.success(e)}).fail(function(e){var i=null;try{i=jQuery.parseJSON(e.responseText)}catch(n){i=e.responseText}t.error&&t.error(i,e)})}function r(t,e){var i=$('<div class="'+t+'"></div>');i.appendTo(":eq(0)");var n=i.css(e);return i.remove(),n}function l(t){$('link[href^="'+t+'"]').length||$('<link href="'+galaxy_config.root+t+'" rel="stylesheet">').appendTo("head")}function c(t,e){return t?_.defaults(t,e):e}function d(t,e){for(var i=1,n=0;e>n;n++)i*=10;return Math.round(t*i)/i}function h(t,e,i){i=void 0!==i?i:1;var n="";if(t>=v)t/=v,n="TB";else if(t>=g)t/=g,n="GB";else if(t>=m)t/=m,n="MB";else if(t>=f)t/=f,n="KB";else{if(!(t>0))return e?"0 b":"<strong>-</strong>";n="b"}var s="b"==n?t:d(t,i);return e?s+" "+n:"<strong>"+s+"</strong> "+n}function u(){return top.__utils__uid__=top.__utils__uid__||0,"uid-"+top.__utils__uid__++}function p(){var t=new Date,e=(t.getHours()<10?"0":"")+t.getHours(),i=(t.getMinutes()<10?"0":"")+t.getMinutes();return datetime=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()+", "+e+":"+i}var f=1024,m=f*f,g=m*f,v=g*f;return{cssLoadFile:l,cssGetAttribute:r,get:a,merge:c,bytesToString:h,uid:u,time:p,request:o,sanitize:i,textify:s,validate:n,deepeach:t,isJSON:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(5),i(9),i(25),i(1)],s=function(t,e,i,n){function s(e,i){var n=Array.prototype.slice.call(arguments,0),s=n.pop();return n.unshift(s),t.defaults.apply(t,n)}function a(e,i){i=i||"model";var s=t.template(e.join(""));return function(t,e){var a={view:e||{},_l:n};return a[i]=t||{},s(a)}}var o={logger:null,_logNamespace:"?",log:function(){if(this.logger){var t=this.logger.log;return"object"==typeof this.logger.log&&(t=Function.prototype.bind.call(this.logger.log,this.logger)),t.apply(this.logger,arguments)}return void 0}};i(o);var r=e.Model.extend({initialize:function(e){if(this._checkEnabledSessionStorage(),!e.id)throw new Error("SessionStorageModel requires an id in the initial attributes");this.id=e.id;var i=this.isNew()?{}:this._read(this);this.clear({silent:!0}),this.save(t.extend({},this.defaults,i,e),{silent:!0}),this.on("change",function(){this.save()})},_checkEnabledSessionStorage:function(){try{return sessionStorage.length}catch(t){return alert("Please enable cookies in your browser for this Galaxy site"),!1}},sync:function(t,e,i){i.silent||e.trigger("request",e,{},i);var n={};switch(t){case"create":n=this._create(e);break;case"read":n=this._read(e);break;case"update":n=this._update(e);break;case"delete":n=this._delete(e)}return void 0!==n||null!==n?i.success&&i.success():i.error&&i.error(),n},_create:function(t){try{var e=t.toJSON(),i=sessionStorage.setItem(t.id,JSON.stringify(e));return null===i?i:e}catch(n){if(!(n instanceof DOMException&&navigator.userAgent.indexOf("Safari")>-1))throw n}return null},_read:function(t){return JSON.parse(sessionStorage.getItem(t.id))},_update:function(t){return t._create(t)},_delete:function(t){return sessionStorage.removeItem(t.id)},isNew:function(){return!sessionStorage.hasOwnProperty(this.id)},_log:function(){return JSON.stringify(this.toJSON(),null,"  ")},toString:function(){return"SessionStorageModel("+this.id+")"}});!function(){r.prototype=t.omit(r.prototype,"url","urlRoot")}();var l={searchAttributes:[],searchAliases:{},searchAttribute:function(e,i){var n=this.get(e);return i&&void 0!==n&&null!==n?t.isArray(n)?this._searchArrayAttribute(n,i):-1!==n.toString().toLowerCase().indexOf(i.toLowerCase()):!1},_searchArrayAttribute:function(e,i){return i=i.toLowerCase(),t.any(e,function(t){return-1!==t.toString().toLowerCase().indexOf(i.toLowerCase())})},search:function(e){var i=this;return t.filter(this.searchAttributes,function(t){return i.searchAttribute(t,e)})},matches:function(t){var e="=",i=t.split(e);if(i.length>=2){var n=i[0];return n=this.searchAliases[n]||n,this.searchAttribute(n,i[1])}return!!this.search(t).length},matchesAll:function(e){var i=this;return e=e.match(/(".*"|\w*=".*"|\S*)/g).filter(function(t){return!!t}),t.all(e,function(t){return t=t.replace(/"/g,""),i.matches(t)})}},c={hiddenUntilActivated:function(e,i){if(i=i||{},this.HUAVOptions={$elementShown:this.$el,showFn:jQuery.prototype.toggle,showSpeed:"fast"},t.extend(this.HUAVOptions,i||{}),this.HUAVOptions.hasBeenShown=this.HUAVOptions.$elementShown.is(":visible"),this.hidden=this.isHidden(),e){var n=this;e.on("click",function(t){n.toggle(n.HUAVOptions.showSpeed)})}},isHidden:function(){return this.HUAVOptions.$elementShown.is(":hidden")},toggle:function(){return this.hidden?(this.HUAVOptions.hasBeenShown||t.isFunction(this.HUAVOptions.onshowFirstTime)&&(this.HUAVOptions.hasBeenShown=!0,this.HUAVOptions.onshowFirstTime.call(this)),t.isFunction(this.HUAVOptions.onshow)&&(this.HUAVOptions.onshow.call(this),this.trigger("hiddenUntilActivated:shown",this)),this.hidden=!1):(t.isFunction(this.HUAVOptions.onhide)&&(this.HUAVOptions.onhide.call(this),this.trigger("hiddenUntilActivated:hidden",this)),this.hidden=!0),this.HUAVOptions.showFn.apply(this.HUAVOptions.$elementShown,arguments)}},d={initialize:function(t){this.draggable=t.draggable||!1},$dragHandle:function(){return this.$(".title-bar")},toggleDraggable:function(){this.draggable?this.draggableOff():this.draggableOn()},draggableOn:function(){this.draggable=!0,this.dragStartHandler=t.bind(this._dragStartHandler,this),this.dragEndHandler=t.bind(this._dragEndHandler,this);var e=this.$dragHandle().attr("draggable",!0).get(0);e.addEventListener("dragstart",this.dragStartHandler,!1),e.addEventListener("dragend",this.dragEndHandler,!1)},draggableOff:function(){this.draggable=!1;var t=this.$dragHandle().attr("draggable",!1).get(0);t.removeEventListener("dragstart",this.dragStartHandler,!1),t.removeEventListener("dragend",this.dragEndHandler,!1)},_dragStartHandler:function(t){return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",JSON.stringify(this.model.toJSON())),this.trigger("draggable:dragstart",t,this),!1},_dragEndHandler:function(t){return this.trigger("draggable:dragend",t,this),!1}},h={initialize:function(t){this.selectable=t.selectable||!1,this.selected=t.selected||!1},$selector:function(){return this.$(".selector")},_renderSelected:function(){this.$selector().find("span").toggleClass("fa-check-square-o",this.selected).toggleClass("fa-square-o",!this.selected)},toggleSelector:function(){this.$selector().is(":visible")?this.hideSelector():this.showSelector()},showSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!0,this.trigger("selectable",!0,this),this._renderSelected(),this.$selector().show(t)},hideSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!1,this.trigger("selectable",!1,this),this.$selector().hide(t)},toggleSelect:function(t){this.selected?this.deselect(t):this.select(t)},select:function(t){return this.selected||(this.trigger("selected",this,t),this.selected=!0,this._renderSelected()),!1},deselect:function(t){return this.selected&&(this.trigger("de-selected",this,t),this.selected=!1,this._renderSelected()),!1}};return{LoggableMixin:o,SessionStorageModel:r,mixin:s,SearchableModelMixin:l,HiddenUntilActivatedViewMixin:c,DraggableViewMixin:d,SelectableViewMixin:h,wrapTemplate:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(74),i(77),i(38),i(73),i(21),i(11)],s=function(t,e,i,n,s,a,o){var r=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{url:"",cls:""}),this.setElement(this._template(this.options))},_template:function(t){return'<img class="ui-image '+t.cls+'" src="'+t.url+'"/>'}}),l=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{title:"",cls:""}),this.setElement(this._template(this.options))},title:function(t){this.$el.html(t)},value:function(){return options.title},_template:function(t){return'<label class="ui-label '+t.cls+'">'+t.title+"</label>"}}),c=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{floating:"right",icon:"",tooltip:"",placement:"bottom",title:"",cls:""}),this.setElement(this._template(this.options)),$(this.el).tooltip({title:e.tooltip,placement:"bottom"})},_template:function(t){return'<div><span class="fa '+t.icon+'" class="ui-icon"/>&nbsp;'+t.title+"</div>"}}),d=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{title:"",cls:""}),this.setElement(this._template(this.options)),$(this.el).on("click",e.onclick)},_template:function(t){return'<div><a href="javascript:void(0)" class="ui-anchor '+t.cls+'">'+t.title+"</a></div>"}}),h=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{message:null,status:"info",cls:"",persistent:!1}),this.setElement('<div class="'+this.options.cls+'"/>'),this.options.message&&this.update(this.options)},update:function(e){if(this.options=t.merge(e,this.options),""!=e.message){if(this.$el.html(this._template(this.options)),this.$el.fadeIn(),this.timeout&&window.clearTimeout(this.timeout),!e.persistent){var i=this;this.timeout=window.setTimeout(function(){i.$el.is(":visible")?i.$el.fadeOut():i.$el.hide()},3e3)}}else this.$el.fadeOut()},_template:function(t){var e="ui-message alert alert-"+t.status;return t.large&&(e=("success"==t.status&&"done"||"danger"==t.status&&"error"||t.status)+"messagelarge"),'<div class="'+e+'" >'+t.message+"</div>"}}),u=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{onclick:null,searchword:""}),this.setElement(this._template(this.options));var i=this;this.options.onclick&&this.$el.on("submit",function(t){var e=i.$el.find("#search");i.options.onclick(e.val())})},_template:function(t){return'<div class="ui-search"><form onsubmit="return false;"><input id="search" class="form-control input-sm" type="text" name="search" placeholder="Search..." value="'+t.searchword+'"><button type="submit" class="btn search-btn"><i class="fa fa-search"></i></button></form></div>'}}),p=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{type:"text",placeholder:"",disabled:!1,visible:!0,cls:"",area:!1}),this.setElement(this._template(this.options)),void 0!==this.options.value&&this.value(this.options.value),this.options.disabled&&this.$el.prop("disabled",!0),this.options.visible||this.$el.hide();var i=this;this.$el.on("input",function(){i.options.onchange&&i.options.onchange(i.$el.val())})},value:function(t){return void 0!==t&&this.$el.val(t),this.$el.val()},_template:function(t){return t.area?'<textarea id="'+t.id+'" class="ui-textarea '+t.cls+'"></textarea>':'<input id="'+t.id+'" type="'+t.type+'" value="'+t.value+'" placeholder="'+t.placeholder+'" class="ui-input '+t.cls+'">'}}),f=Backbone.View.extend({initialize:function(t){this.options=t,this.setElement(this._template(this.options)),void 0!==this.options.value&&this.value(this.options.value)},value:function(t){return void 0!==t&&this.$("hidden").val(t),this.$("hidden").val()},_template:function(t){var e='<div id="'+t.id+'" >';return t.info&&(e+="<div>"+t.info+"</div>"),e+='<hidden value="'+t.value+'"/></div>'}});return{Anchor:d,Button:a.ButtonDefault,ButtonIcon:a.ButtonIcon,ButtonCheck:a.ButtonCheck,ButtonMenu:a.ButtonMenu,ButtonLink:a.ButtonLink,Icon:c,Image:r,Input:p,Label:l,Message:h,Modal:o,RadioButton:n.RadioButton,Checkbox:n.Checkbox,Radio:n.Radio,Searchbox:u,Select:e,Hidden:f,Slider:i,Drilldown:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s;n=[],s=function(){var t={UPLOAD:"upload",QUEUED:"queued",RUNNING:"running",SETTING_METADATA:"setting_metadata",NEW:"new",EMPTY:"empty",OK:"ok",PAUSED:"paused",FAILED_METADATA:"failed_metadata",NOT_VIEWABLE:"noPermission",DISCARDED:"discarded",ERROR:"error"};return t.READY_STATES=[t.OK,t.EMPTY,t.PAUSED,t.FAILED_METADATA,t.NOT_VIEWABLE,t.DISCARDED,t.ERROR],t.NOT_READY_STATES=[t.UPLOAD,t.QUEUED,t.RUNNING,t.SETTING_METADATA,t.NEW],t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s,a;!function(i,o){s=[],n=o,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(this,function(){var t=function(t){t=t||{},t.tooltipConfig=t.tooltipConfig||{placement:"bottom"},t.classes=["icon-btn"].concat(t.classes||[]),t.disabled&&t.classes.push("disabled");var e=['<a class="',t.classes.join(" "),'"',t.title?' title="'+t.title+'"':"",!t.disabled&&t.target?' target="'+t.target+'"':"",' href="',!t.disabled&&t.href?t.href:"javascript:void(0);",'">','<span class="fa ',t.faIcon,'"></span>',"</a>"].join(""),i=$(e).tooltip(t.tooltipConfig);return _.isFunction(t.onclick)&&i.click(t.onclick),i};return t})},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e=Backbone.View.extend({visible:!1,optionsDefault:{id:t.uid(),title:"",icon:"",buttons:null,body:null,scrollable:!0,nopadding:!1,operations:null,placement:"bottom",cls:"ui-portlet",operations_flt:"right"},$title:null,$content:null,$buttons:null,$operations:null,$header:null,initialize:function(e){this.options=t.merge(e,this.optionsDefault),this.setElement(this._template(this.options)),this.$content=this.$el.find(".content"),this.$title=this.$el.find(".portlet-title-text"),this.$header=this.$el.find(".portlet-header");var i=this.$el.find(".portlet-content");if(this.options.nopadding&&(i.css("padding","0px"),this.$content.css("padding","0px")),this.$buttons=$(this.el).find(".buttons"),this.options.buttons){var n=this;$.each(this.options.buttons,function(t,e){e.$el.prop("id",t),n.$buttons.append(e.$el)})}else this.$buttons.remove();if(this.$operations=$(this.el).find(".portlet-operations"),this.options.operations){var n=this;$.each(this.options.operations,function(t,e){e.$el.prop("id",t),n.$operations.append(e.$el)})}this.options.body&&this.append(this.options.body)},append:function(t){this.$content.append(t)},empty:function(){this.$content.empty()},content:function(){return this.$content},show:function(){this.$el.fadeIn("fast"),this.visible=!0},hide:function(){this.$el.fadeOut("fast"),this.visible=!1},enableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!1)},disableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!0)},hideOperation:function(t){this.$operations.find("#"+t).hide()},showOperation:function(t){this.$operations.find("#"+t).show()},setOperation:function(t,e){var i=this.$operations.find("#"+t);i.off("click"),i.on("click",e)},title:function(t){var e=this.$title;return t&&e.html(t),e.html()},disable:function(){this.$(".portlet-backdrop").show()},enable:function(){this.$(".portlet-backdrop").hide()},_template:function(t){var e='<div id="'+t.id+'" class="'+t.cls+'">';return t.title&&(e+='<div class="portlet-header"><div class="portlet-operations" style="float: '+t.operations_flt+';"></div><div class="portlet-title">',t.icon&&(e+='<i class="icon fa '+t.icon+'">&nbsp;</i>'),e+='<span class="portlet-title-text">'+t.title+"</span></div></div>"),e+='<div class="portlet-content">',"top"==t.placement&&(e+='<div class="buttons"></div>'),e+='<div class="content"></div>',"bottom"==t.placement&&(e+='<div class="buttons"></div>'),e+='</div><div class="portlet-backdrop"/></div>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s;n=[i(34),i(13),i(12),i(3),i(1)],s=function(t,e,i,n,s){var a=t.ModelListPanel,o=a.extend({className:a.prototype.className+" dataset-collection-panel",DatasetDCEViewClass:i.DatasetDCEListItemView,NestedDCDCEViewClass:i.NestedDCDCEListItemView,modelCollectionKey:"elements",initialize:function(t){a.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank",this.hasUser=t.hasUser,this.panelStack=[],this.parentName=t.parentName,this.foldoutStyle=t.foldoutStyle||"foldout"},_filterCollection:function(){return this.model.getVisibleContents()},_getItemViewClass:function(t){switch(t.get("element_type")){case"hda":return this.DatasetDCEViewClass;case"dataset_collection":return this.NestedDCDCEViewClass}throw new TypeError("Unknown element type:",t.get("element_type"))},_getItemViewOptions:function(t){var e=a.prototype._getItemViewOptions.call(this,t);return _.extend(e,{linkTarget:this.linkTarget,hasUser:this.hasUser,foldoutStyle:this.foldoutStyle})},_setUpItemViewListeners:function(t){var e=this;return a.prototype._setUpItemViewListeners.call(e,t),t.on("expanded:drilldown",function(t,e){this._expandDrilldownPanel(e)},this),t.on("collapsed:drilldown",function(t,e){this._collapseDrilldownPanel(e)},this),this},_expandDrilldownPanel:function(t){this.panelStack.push(t),this.$("> .controls").add(this.$list()).hide(),t.parentName=this.model.get("name"),this.$el.append(t.render().$el)},_collapseDrilldownPanel:function(t){this.panelStack.pop(),this.render()},events:{"click .navigation .back":"close"},close:function(t){this.$el.remove(),this.trigger("close")},toString:function(){return"CollectionPanel("+(this.model?this.model.get("name"):"")+")"}});o.prototype.templates=function(){var t=n.wrapTemplate(['<div class="controls">','<div class="navigation">','<a class="back" href="javascript:void(0)">','<span class="fa fa-icon fa-angle-left"></span>',s("Back to "),"<%- view.parentName %>","</a>","</div>",'<div class="title">','<div class="name"><%- collection.name || collection.element_identifier %></div>','<div class="subtitle">','<% if( collection.collection_type === "list" ){ %>',s("a list of datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',s("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',s("a list of paired datasets"),"<% } %>","</div>","</div>","</div>"],"collection");return _.extend(_.clone(a.prototype.templates),{controls:t})}();var r=o.extend({DatasetDCEViewClass:i.DatasetDCEListItemView,toString:function(){return"ListCollectionPanel("+(this.model?this.model.get("name"):"")+")"}}),l=r.extend({toString:function(){return"PairCollectionPanel("+(this.model?this.model.get("name"):"")+")"}}),c=o.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemView.extend({foldoutPanelClass:l}),toString:function(){return"ListOfPairsCollectionPanel("+(this.model?this.model.get("name"):"")+")"}});return{CollectionPanel:o,ListCollectionPanel:r,PairCollectionPanel:l,ListOfPairsCollectionPanel:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){var t=Backbone.View.extend({elMain:"body",optionsDefault:{title:"ui-modal",body:"",backdrop:!0,height:null,width:null,closing_events:!1,closing_callback:null,title_separator:!0},buttonList:{},initialize:function(t){t&&this._create(t)},show:function(t){this.initialize(t),this.options.height?(this.$body.css("height",this.options.height),this.$body.css("overflow","hidden")):this.$body.css("max-height",$(window).height()/2),this.options.width&&this.$dialog.css("width",this.options.width),this.visible?this.$el.show():this.$el.fadeIn("fast"),this.visible=!0},hide:function(){this.visible=!1,this.$el.fadeOut("fast"),this.options.closing_callback&&this.options.closing_callback()},enableButton:function(t){var e=this.buttonList[t];this.$buttons.find("#"+e).prop("disabled",!1)},disableButton:function(t){var e=this.buttonList[t];this.$buttons.find("#"+e).prop("disabled",!0)},showButton:function(t){var e=this.buttonList[t];this.$buttons.find("#"+e).show()},hideButton:function(t){var e=this.buttonList[t];this.$buttons.find("#"+e).hide()},getButton:function(t){var e=this.buttonList[t];return this.$buttons.find("#"+e)},scrollTop:function(){return this.$body.scrollTop()},_create:function(t){var e=this;if(this.options=_.defaults(t,this.optionsDefault),"progress"==this.options.body&&(this.options.body=$('<div class="progress progress-striped active"><div class="progress-bar progress-bar-info" style="width:100%"></div></div>')),this.$el&&(this.$el.remove(),$(document).off("keyup.ui-modal")),this.setElement(this._template(this.options.title)),this.$dialog=this.$el.find(".modal-dialog"),this.$body=this.$el.find(".modal-body"),this.$footer=this.$el.find(".modal-footer"),this.$buttons=this.$el.find(".buttons"),this.$backdrop=this.$el.find(".modal-backdrop"),this.$body.html(this.options.body),this.options.backdrop||this.$backdrop.removeClass("in"),this.options.buttons){this.buttonList={};var i=0;$.each(this.options.buttons,function(t,n){var s="button-"+i++;e.$buttons.append($('<button id="'+s+'"></button>').text(t).click(n)).append(" "),e.buttonList[t]=s})}else this.$footer.hide();$(this.elMain).append($(this.el)),this.options.closing_events&&($(document).on("keyup.ui-modal",function(t){27==t.keyCode&&e.hide()}),this.$el.find(".modal-backdrop").on("click",function(){e.hide()})),this.options.title_separator||this.$(".modal-header").css({border:"none","padding-bottom":"0px"})},_template:function(t){return'<div class="ui-modal modal"><div class="modal-backdrop fade in" style="z-index: -1;"></div><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" style="display: none;">&times;</button><h4 class="title">'+t+'</h4></div><div class="modal-body" style="position: static;"></div><div class="modal-footer"><div class="buttons" style="float: right;"></div></div></div</div></div>'}});return{View:t}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(19),i(15),i(3),i(1)],s=function(t,e,i,n){var s=t.FoldoutListItemView,a=t.ListItemView,o=s.extend({className:s.prototype.className+" dataset-collection",id:function(){return["dataset_collection",this.model.get("id")].join("-")},initialize:function(t){this.linkTarget=t.linkTarget||"_blank",this.hasUser=t.hasUser,s.prototype.initialize.call(this,t)},_setUpListeners:function(){s.prototype._setUpListeners.call(this),this.model.on("change",function(t,e){_.isEqual(_.keys(t.changed),["deleted"])&&this.render()},this)},_renderSubtitle:function(){var t=$('<div class="subtitle"></div>');switch(this.model.get("collection_type")){case"list":return t.text(n("a list of datasets"));case"paired":return t.text(n("a pair of datasets"));case"list:paired":return t.text(n("a list of paired datasets"))}return t},_getFoldoutPanelOptions:function(){var t=s.prototype._getFoldoutPanelOptions.call(this);return _.extend(t,{linkTarget:this.linkTarget,hasUser:this.hasUser})},$selector:function(){return this.$("> .selector")},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCListItemView("+t+")"}});o.prototype.templates=function(){var t=_.extend({},s.prototype.templates.warnings,{error:i.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',n("There was an error getting the data for this collection"),": <%- model.error %>","</div>","<% } %>"]),purged:i.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',n("This collection has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:i.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',n("This collection has been deleted"),"</div>","<% } %>"])}),e=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- collection.element_identifier || collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection");return _.extend({},s.prototype.templates,{warnings:t,titleBar:e})}();var r=a.extend({className:a.prototype.className+" dataset-collection-element",initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log("DCEListItemView.initialize:",t),a.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCEListItemView("+t+")"}});r.prototype.templates=function(){var t=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element");return _.extend({},a.prototype.templates,{titleBar:t})}();var l=e.DatasetListItemView.extend({className:e.DatasetListItemView.prototype.className+" dataset-collection-element",initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log("DatasetDCEListItemView.initialize:",t),e.DatasetListItemView.prototype.initialize.call(this,t)},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):jQuery.when()},toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetDCEListItemView("+t+")"}});l.prototype.templates=function(){var t=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>","</div>"],"element");return _.extend({},e.DatasetListItemView.prototype.templates,{titleBar:t})}();var c=o.extend({className:o.prototype.className+" dataset-collection-element",_swapNewRender:function(t){o.prototype._swapNewRender.call(this,t);var e=this.model.get("state")||"ok";return this.$el.addClass("state-"+e),this.$el},toString:function(){var t=this.model?this.model+"":"(no model)";return"NestedDCDCEListItemView("+t+")"}});return{DCListItemView:o,DCEListItemView:r,DatasetDCEListItemView:l,NestedDCDCEListItemView:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(29),i(3),i(1)],s=function(t,e,i){var n={defaults:{model_class:"DatasetCollectionElement",element_identifier:null,element_index:null,element_type:null},_mergeObject:function(t){return _.extend(t,t.object,{element_id:t.id}),delete t.object,t},constructor:function(t,e){t=this._mergeObject(t),this.idAttribute="element_id",Backbone.Model.apply(this,arguments)},parse:function(t,e){var i=t;return i=this._mergeObject(i)}},s=Backbone.Model.extend(e.LoggableMixin).extend(n),a=Backbone.Collection.extend(e.LoggableMixin).extend({model:s,initialize:function(t,e){this.debug(this+"(DCECollection).initialize:",t,e),e=e||{}},toString:function(){return["DatasetCollectionElementCollection(",this.length,")"].join("")}}),o=t.DatasetAssociation.extend(e.mixin(n,{url:function(){var t=window.galaxy_config&&galaxy_config.root?galaxy_config.root:"/";return this.has("history_id")?t+"api/histories/"+this.get("history_id")+"/contents/"+this.get("id"):(console.warn("no endpoint for non-hdas within a collection yet"),t+"api/datasets")},defaults:_.extend({},t.DatasetAssociation.prototype.defaults,n.defaults),constructor:function(t,e){this.debug("	 DatasetDCE.constructor:",t,e),n.constructor.call(this,t,e)},initialize:function(e,i){this.debug(this+"(DatasetDCE).initialize:",e,i),t.DatasetAssociation.prototype.initialize.call(this,e,i)},hasDetails:function(){return _.has(this.attributes,"annotation")},toString:function(){var t=this.get("element_identifier");return["DatasetDCE(",t,")"].join("")}})),r=a.extend({model:o,initialize:function(t,e){this.debug(this+"(DatasetDCECollection).initialize:",t,e),a.prototype.initialize.call(this,t,e)},toString:function(){return["DatasetDCECollection(",this.length,")"].join("")}}),l=Backbone.Model.extend(e.LoggableMixin).extend(e.SearchableModelMixin).extend({defaults:{collection_type:null,deleted:!1},collectionClass:a,initialize:function(t,e){this.debug(this+"(DatasetCollection).initialize:",t,e,this),this.elements=this._createElementsModel(),this.on("change:elements",function(){this.log("change:elements"),this.elements=this._createElementsModel()})},_createElementsModel:function(){this.debug(this+"._createElementsModel",this.collectionClass,this.get("elements"),this.elements);var t=this.get("elements")||[];return this.unset("elements",{silent:!0}),this.elements=new this.collectionClass(t),this.elements},toJSON:function(){var t=Backbone.Model.prototype.toJSON.call(this);return this.elements&&(t.elements=this.elements.toJSON()),t},inReadyState:function(){var t=this.get("populated");return this.isDeletedOrPurged()||t},hasDetails:function(){return this.debug("hasDetails:",this.elements.length),0!==this.elements.length},getVisibleContents:function(t){return this.elements},"delete":function(t){return this.get("deleted")?jQuery.when():this.save({deleted:!0},t)},undelete:function(t){return!this.get("deleted")||this.get("purged")?jQuery.when():this.save({deleted:!1},t)},isDeletedOrPurged:function(){return this.get("deleted")||this.get("purged")},searchAttributes:["name"],toString:function(){var t=[this.get("id"),this.get("name")||this.get("element_identifier")];return"DatasetCollection("+t.join(",")+")"}}),c=l.extend({collectionClass:r,initialize:function(t,e){this.debug(this+"(ListDatasetCollection).initialize:",t,e),l.prototype.initialize.call(this,t,e)},toString:function(){return["ListDatasetCollection(",this.get("name"),")"].join("")}}),d=c.extend({initialize:function(t,e){this.debug(this+"(PairDatasetCollection).initialize:",t,e),c.prototype.initialize.call(this,t,e)},toString:function(){return["PairDatasetCollection(",this.get("name"),")"].join("")}}),h=l.extend(e.mixin(n,{constructor:function(t,e){this.debug("	 NestedDCDCE.constructor:",t,e),n.constructor.call(this,t,e)},toString:function(){var t=this.object?""+this.object:this.get("element_identifier");return["NestedDCDCE(",t,")"].join("")}})),u=a.extend({model:h,initialize:function(t,e){this.debug(this+"(NestedDCDCECollection).initialize:",t,e),a.prototype.initialize.call(this,t,e)},toString:function(){return["NestedDCDCECollection(",this.length,")"].join("")}}),p=d.extend(e.mixin(n,{constructor:function(t,e){this.debug("	 NestedPairDCDCE.constructor:",t,e),n.constructor.call(this,t,e)},toString:function(){var t=this.object?""+this.object:this.get("element_identifier");return["NestedPairDCDCE(",t,")"].join("")}})),f=u.extend({model:p,initialize:function(t,e){this.debug(this+"(NestedPairDCDCECollection).initialize:",t,e),u.prototype.initialize.call(this,t,e);
},toString:function(){return["NestedPairDCDCECollection(",this.length,")"].join("")}}),m=l.extend({collectionClass:f,initialize:function(t,e){this.debug(this+"(ListPairedDatasetCollection).initialize:",t,e),l.prototype.initialize.call(this,t,e)},toString:function(){return["ListPairedDatasetCollection(",this.get("name"),")"].join("")}});return{ListDatasetCollection:c,PairDatasetCollection:d,ListPairedDatasetCollection:m}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(16),i(6),i(3),i(11),i(42),i(1),i(40)],s=function(t,e,i,n,s,a){function o(t){var e=t.toJSON(),i=d(e,{creationFn:function(e,i){return e=e.map(function(t){return{id:t.id,name:t.name,src:"dataset"===t.history_content_type?"hda":"hdca"}}),t.createHDCA(e,"list",i)}});return i}var r=Backbone.View.extend(i.LoggableMixin).extend({tagName:"li",className:"collection-element",initialize:function(t){this.element=t.element||{},this.selected=t.selected||!1},render:function(){return this.$el.attr("data-element-id",this.element.id).attr("draggable",!0).html(this.template({element:this.element})),this.selected&&this.$el.addClass("selected"),this},template:_.template(['<a class="name" title="',a("Click to rename"),'" href="javascript:void(0)">',"<%= element.name %>","</a>",'<button class="discard btn btn-sm" title="',a("Remove this dataset from the list"),'">',a("Discard"),"</button>"].join("")),select:function(t){this.$el.toggleClass("selected",t),this.trigger("select",{source:this,selected:this.$el.hasClass("selected")})},discard:function(){var t=this,e=this.$el.parent().width();this.$el.animate({"margin-right":e},"fast",function(){t.trigger("discard",{source:t}),t.destroy()})},destroy:function(){this.off(),this.$el.remove()},events:{click:"_click","click .name":"_clickName","click .discard":"_clickDiscard",dragstart:"_dragstart",dragend:"_dragend",dragover:"_sendToParent",drop:"_sendToParent"},_click:function(t){t.stopPropagation(),this.select(t)},_clickName:function(t){t.stopPropagation(),t.preventDefault();var e=([a("Enter a new name for the element"),":\n(",a("Note that changing the name here will not rename the dataset"),")"].join(""),prompt(a("Enter a new name for the element")+":",this.element.name));e&&(this.element.name=e,this.render())},_clickDiscard:function(t){t.stopPropagation(),this.discard()},_dragstart:function(t){t.originalEvent&&(t=t.originalEvent),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(this.element)),this.$el.addClass("dragging"),this.$el.parent().trigger("collection-element.dragstart",[this])},_dragend:function(t){this.$el.removeClass("dragging"),this.$el.parent().trigger("collection-element.dragend",[this])},_sendToParent:function(t){this.$el.parent().trigger(t)},toString:function(){return"DatasetCollectionElementView()"}}),l=Backbone.View.extend(i.LoggableMixin).extend({elementViewClass:r,collectionClass:t.HistoryListDatasetCollection,className:"list-collection-creator collection-creator flex-row-container",minElements:1,defaultAttributes:{creationFn:function(){throw new TypeError("no creation fn for creator")},oncreate:function(){},oncancel:function(){},autoscrollDist:24,highlightClr:"rgba( 64, 255, 255, 1.0 )"},initialize:function(t){this.metric("ListCollectionCreator.initialize",t);var e=this;_.each(this.defaultAttributes,function(i,n){i=t[n]||i,e[n]=i}),e.initialElements=t.elements||[],this._instanceSetUp(),this._elementsSetUp(),this._setUpBehaviors()},_instanceSetUp:function(){this.selectedIds={},this.$dragging=null,this.blocking=!1},_elementsSetUp:function(){this.invalidElements=[],this.workingElements=[],this.elementViews=[],this.workingElements=this.initialElements.slice(0),this._ensureElementIds(),this._validateElements(),this._mangleDuplicateNames(),this._sortElements()},_ensureElementIds:function(){return this.workingElements.forEach(function(t){t.hasOwnProperty("id")||(t.id=_.uniqueId())}),this.workingElements},_validateElements:function(){var t=this;return t.invalidElements=[],this.workingElements=this.workingElements.filter(function(e){var i=t._isElementInvalid(e);return i&&t.invalidElements.push({element:e,text:i}),!i}),this.workingElements},_isElementInvalid:function(t){return"dataset"!==t.history_content_type?a("is not a dataset"):t.state!==e.OK?a(_.contains(e.NOT_READY_STATES,t.state)?"hasn't finished running yet":"has errored, is paused, or is not accessible"):t.deleted||t.purged?a("has been deleted or purged"):null},_mangleDuplicateNames:function(){var t=900,e=1,i={};this.workingElements.forEach(function(n){for(var s=n.name;i.hasOwnProperty(s);)if(s=n.name+" ("+e+")",e+=1,e>=t)throw new Error("Safety hit in while loop - thats impressive");n.name=s,i[n.name]=!0})},_sortElements:function(t){},render:function(t,e){return this.workingElements.length<this.minElements?this._renderInvalid(t,e):(this.$el.empty().html(this.templates.main()),this._renderHeader(t),this._renderMiddle(t),this._renderFooter(t),this._addPluginComponents(),this.$(".collection-name").focus(),this.trigger("rendered",this),this)},_renderInvalid:function(t,e){return this.$el.empty().html(this.templates.invalidInitial({problems:this.invalidElements,elements:this.workingElements})),"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),this.trigger("rendered",this),this},_renderHeader:function(t,e){var i=this.$(".header").empty().html(this.templates.header()).find(".help-content").prepend($(this.templates.helpContent()));return this.invalidElements.length&&this._invalidElementsAlert(),i},_renderMiddle:function(t,e){var i=this.$(".middle").empty().html(this.templates.middle());return this._renderList(t),i},_renderFooter:function(t,e){var i=this.$(".footer").empty().html(this.templates.footer());return"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),i},_addPluginComponents:function(){this.$(".help-content i").hoverhighlight(".collection-creator",this.highlightClr)},_invalidElementsAlert:function(){this._showAlert(this.templates.invalidElements({problems:this.invalidElements}),"alert-warning")},_validationWarning:function(t,e){var i="validation-warning";"name"===t&&(t=this.$(".collection-name").add(this.$(".collection-name-prompt")),this.$(".collection-name").focus().select()),e?(t=t||this.$("."+i),t.removeClass(i)):t.addClass(i)},_disableNameAndCreate:function(t){t=_.isUndefined(t)?!0:t,t&&(this.$(".collection-name").prop("disabled",!0),this.$(".create-collection").toggleClass("disabled",!0))},$list:function(){return this.$(".collection-elements")},_renderClearSelected:function(){_.size(this.selectedIds)?this.$(".collection-elements-controls > .clear-selected").show():this.$(".collection-elements-controls > .clear-selected").hide()},_renderList:function(t,e){var i=this,n=jQuery("<div/>"),s=i.$list();_.each(this.elementViews,function(t){t.destroy(),i.removeElementView(t)}),i.workingElements.forEach(function(t){var e=i._createElementView(t);n.append(e.$el)}),i._renderClearSelected(),s.empty().append(n.children()),_.invoke(i.elementViews,"render"),s.height()>s.css("max-height")?s.css("border-width","1px 0px 1px 0px"):s.css("border-width","0px")},_createElementView:function(t){var e=new this.elementViewClass({element:t,selected:_.has(this.selectedIds,t.id)});return this.elementViews.push(e),this._listenToElementView(e),e},_listenToElementView:function(t){var e=this;e.listenTo(t,{select:function(t){var i=t.source.element;t.selected?e.selectedIds[i.id]=!0:delete e.selectedIds[i.id],e.trigger("elements:select",t)},discard:function(t){e.trigger("elements:discard",t)}})},addElementView:function(t){},removeElementView:function(t){delete this.selectedIds[t.element.id],this._renderClearSelected(),this.elementViews=_.without(this.elementViews,t),this.stopListening(t)},_renderNoElementsLeft:function(){this._disableNameAndCreate(!0),this.$(".collection-elements").append(this.templates.noElementsLeft())},_elementToJSON:function(t){return t},createList:function(t){if(!this.workingElements.length){var e=a("No valid elements for final list")+". ";return e+='<a class="cancel-create" href="javascript:void(0);">'+a("Cancel")+"</a> ",e+=a("or"),e+=' <a class="reset" href="javascript:void(0);">'+a("start over")+"</a>.",void this._showAlert(e)}var i=this,n=this.workingElements.map(function(t){return i._elementToJSON(t)});return i.blocking=!0,i.creationFn(n,t).always(function(){i.blocking=!1}).fail(function(t,e,n){i.trigger("error",{xhr:t,status:e,message:a("An error occurred while creating this collection")})}).done(function(t,e,n){i.trigger("collection:created",t,e,n),i.metric("collection:created",t),"function"==typeof i.oncreate&&i.oncreate.call(this,t,e,n)})},_setUpBehaviors:function(){return this.on("error",this._errorHandler),this.once("rendered",function(){this.trigger("rendered:initial",this)}),this.on("elements:select",function(t){this._renderClearSelected()}),this.on("elements:discard",function(t){var e=t.source.element;this.removeElementView(t.source),this.workingElements=_.without(this.workingElements,e),this.workingElements.length||this._renderNoElementsLeft()}),this},_errorHandler:function(t){this.error(t);var e=this;if(content=t.message||a("An error occurred"),t.xhr){var i=t.xhr,n=t.message;0===i.readyState&&0===i.status?content+=": "+a("Galaxy could not be reached and may be updating.")+a(" Try again in a few minutes."):i.responseJSON?content+=":<br /><pre>"+JSON.stringify(i.responseJSON)+"</pre>":content+=": "+n}e._showAlert(content,"alert-danger")},events:{"click .more-help":"_clickMoreHelp","click .less-help":"_clickLessHelp","click .main-help":"_toggleHelp","click .header .alert button":"_hideAlert","click .reset":"reset","click .clear-selected":"clearSelectedElements","click .collection-elements":"clearSelectedElements","dragover .collection-elements":"_dragoverElements","drop .collection-elements":"_dropElements","collection-element.dragstart .collection-elements":"_elementDragstart","collection-element.dragend   .collection-elements":"_elementDragend","change .collection-name":"_changeName","keydown .collection-name":"_nameCheckForEnter","click .cancel-create":function(t){"function"==typeof this.oncancel&&this.oncancel.call(this)},"click .create-collection":"_clickCreate"},_clickMoreHelp:function(t){t.stopPropagation(),this.$(".main-help").addClass("expanded"),this.$(".more-help").hide()},_clickLessHelp:function(t){t.stopPropagation(),this.$(".main-help").removeClass("expanded"),this.$(".more-help").show()},_toggleHelp:function(t){t.stopPropagation(),this.$(".main-help").toggleClass("expanded"),this.$(".more-help").toggle()},_showAlert:function(t,e){e=e||"alert-danger",this.$(".main-help").hide(),this.$(".header .alert").attr("class","alert alert-dismissable").addClass(e).show().find(".alert-message").html(t)},_hideAlert:function(t){this.$(".main-help").show(),this.$(".header .alert").hide()},reset:function(){this._instanceSetUp(),this._elementsSetUp(),this.render()},clearSelectedElements:function(t){this.$(".collection-elements .collection-element").removeClass("selected"),this.$(".collection-elements-controls > .clear-selected").hide()},_dragoverElements:function(t){t.preventDefault();var e=this.$list();this._checkForAutoscroll(e,t.originalEvent.clientY);var i=this._getNearestElement(t.originalEvent.clientY);this.$(".element-drop-placeholder").remove();var n=$('<div class="element-drop-placeholder"></div>');i.size()?i.before(n):e.append(n)},_checkForAutoscroll:function(t,e){var i=2,n=t.offset(),s=t.scrollTop(),a=e-n.top,o=n.top+t.outerHeight()-e;a>=0&&a<this.autoscrollDist?t.scrollTop(s-i):o>=0&&o<this.autoscrollDist&&t.scrollTop(s+i)},_getNearestElement:function(t){for(var e=4,i=this.$(".collection-elements li.collection-element").toArray(),n=0;n<i.length;n++){var s=$(i[n]),a=s.offset().top,o=Math.floor(s.outerHeight()/2)+e;if(a+o>t&&t>a-o)return s}return $()},_dropElements:function(t){t.originalEvent&&(t=t.originalEvent),t.preventDefault(),t.dataTransfer.dropEffect="move";var e=this._getNearestElement(t.clientY);return e.size()?this.$dragging.insertBefore(e):this.$dragging.insertAfter(this.$(".collection-elements .collection-element").last()),this._syncOrderToDom(),!1},_syncOrderToDom:function(){var t=this,e=[];this.$(".collection-elements .collection-element").each(function(){var i=$(this).attr("data-element-id"),n=_.findWhere(t.workingElements,{id:i});n?e.push(n):console.error("missing element: ",i)}),this.workingElements=e,this._renderList()},_elementDragstart:function(t,e){e.select(!0),this.$dragging=this.$(".collection-elements .collection-element.selected")},_elementDragend:function(t,e){$(".element-drop-placeholder").remove(),this.$dragging=null},_changeName:function(t){this._validationWarning("name",!!this._getName())},_nameCheckForEnter:function(t){13!==t.keyCode||this.blocking||this._clickCreate()},_getName:function(){return _.escape(this.$(".collection-name").val())},_clickCreate:function(t){var e=this._getName();e?this.blocking||this.createList(e):this._validationWarning("name")},templates:{main:_.template(['<div class="header flex-row no-flex"></div>','<div class="middle flex-row flex-row-container"></div>','<div class="footer flex-row no-flex"></div>'].join("")),header:_.template(['<div class="main-help well clear">','<a class="more-help" href="javascript:void(0);">',a("More help"),"</a>",'<div class="help-content">','<a class="less-help" href="javascript:void(0);">',a("Less"),"</a>","</div>","</div>",'<div class="alert alert-dismissable">','<button type="button" class="close" data-dismiss="alert" ','title="',a("Close and show more help"),'" aria-hidden="true">&times;</button>','<span class="alert-message"></span>',"</div>"].join("")),middle:_.template(['<div class="collection-elements-controls">','<a class="reset" href="javascript:void(0);" ','title="',a("Undo all reordering and discards"),'">',a("Start over"),"</a>",'<a class="clear-selected" href="javascript:void(0);" ','title="',a("De-select all selected datasets"),'">',a("Clear selected"),"</a>","</div>",'<div class="collection-elements scroll-container flex-row">',"</div>"].join("")),footer:_.template(['<div class="attributes clear">','<div class="clear">','<input class="collection-name form-control pull-right" ','placeholder="',a("Enter a name for your new collection"),'" />','<div class="collection-name-prompt pull-right">',a("Name"),":</div>","</div>","</div>",'<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',a("Cancel"),"</button>",'<div class="create-other btn-group dropup">','<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">',a("Create a different kind of collection"),' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">','<li><a href="#">',a("Create a <i>single</i> pair"),"</a></li>",'<li><a href="#">',a("Create a list of <i>unpaired</i> datasets"),"</a></li>","</ul>","</div>","</div>",'<div class="main-options pull-right">','<button class="create-collection btn btn-primary">',a("Create list"),"</button>","</div>","</div>"].join("")),helpContent:_.template(["<p>",a(["Collections of datasets are permanent, ordered lists of datasets that can be passed to tools and ","workflows in order to have analyses done on each member of the entire group. This interface allows ","you to create a collection and re-order the final collection."].join("")),"</p>","<ul>","<li>",a(["Rename elements in the list by clicking on ",'<i data-target=".collection-element .name">the existing name</i>.'].join("")),"</li>","<li>",a(["Discard elements from the final created list by clicking on the ",'<i data-target=".collection-element .discard">"Discard"</i> button.'].join("")),"</li>","<li>",a(["Reorder the list by clicking and dragging elements. Select multiple elements by clicking on ",'<i data-target=".collection-element">them</i> and you can then move those selected by dragging the ',"entire group. Deselect them by clicking them again or by clicking the ",'the <i data-target=".clear-selected">"Clear selected"</i> link.'].join("")),"</li>","<li>",a(['Click the <i data-target=".reset">"Start over"</i> link to begin again as if you had just opened ',"the interface."].join("")),"</li>","<li>",a(['Click the <i data-target=".cancel-create">"Cancel"</i> button to exit the interface.'].join("")),"</li>","</ul><br />","<p>",a(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>.'].join("")),"</p>"].join("")),invalidElements:_.template([a("The following selections could not be included due to problems:"),"<ul><% _.each( problems, function( problem ){ %>","<li><b><%= problem.element.name %></b>: <%= problem.text %></li>","<% }); %></ul>"].join("")),noElementsLeft:_.template(['<li class="no-elements-left-message">',a("No elements left! "),a("Would you like to "),'<a class="reset" href="javascript:void(0)">',a("start over"),"</a>?","</li>"].join("")),invalidInitial:_.template(['<div class="header flex-row no-flex">','<div class="alert alert-warning" style="display: block">','<span class="alert-message">',"<% if( _.size( problems ) ){ %>",a("The following selections could not be included due to problems"),":","<ul><% _.each( problems, function( problem ){ %>","<li><b><%= problem.element.name %></b>: <%= problem.text %></li>","<% }); %></ul>","<% } else if( _.size( elements ) < 1 ){ %>",a("No datasets were selected"),".","<% } %>","<br />",a("At least one element is needed for the collection"),". ",a("You may need to "),'<a class="cancel-create" href="javascript:void(0)">',a("cancel"),"</a> ",a("and reselect new elements"),".","</span>","</div>","</div>",'<div class="footer flex-row no-flex">','<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',a("Cancel"),"</button>","</div>","</div>","</div>"].join(""))},toString:function(){return"ListCollectionCreator"}}),c=function(t,e,i){var s,o=jQuery.Deferred(),r=Galaxy.modal||new n.View;return e=_.defaults(e||{},{elements:t,oncancel:function(){r.hide(),o.reject("cancelled")},oncreate:function(t,e){r.hide(),o.resolve(e)}}),s=new i(e),r.show({title:e.title||a("Create a collection"),body:s.$el,width:"80%",height:"min-content",closing_events:!0}),s.render(),window._collectionCreator=s,o},d=function(t,e){return e=e||{},e.title=a("Create a collection from a list of datasets"),c(t,e,l)};return{DatasetCollectionElementView:r,ListCollectionCreator:l,collectionCreatorModal:c,listCollectionCreatorModal:d,createListCollection:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(19),i(6),i(7),i(3),i(1)],s=function(t,e,i,n,s){var a=t.ListItemView,o=a.extend({className:a.prototype.className+" dataset",id:function(){return["dataset",this.model.get("id")].join("-")},initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log(this+".initialize:",t),a.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank"},_setUpListeners:function(){a.prototype._setUpListeners.call(this),this.model.on("change",function(t,e){this.model.changedAttributes().state&&this.model.inReadyState()&&this.expanded&&!this.model.hasDetails()?this.model.fetch():this.render()},this)},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):jQuery.when()},remove:function(t,e){var i=this;t=t||this.fxSpeed,this.$el.fadeOut(t,function(){Backbone.View.prototype.remove.call(i),e&&e.call(i)})},render:function(t){return a.prototype.render.call(this,t)},_swapNewRender:function(t){return a.prototype._swapNewRender.call(this,t),this.model.has("state")&&this.$el.addClass("state-"+this.model.get("state")),this.$el},_renderPrimaryActions:function(){return[this._renderDisplayButton()]},_renderDisplayButton:function(){var t=this.model.get("state");if(t===e.NOT_VIEWABLE||t===e.DISCARDED||!this.model.get("accessible"))return null;var n={target:this.linkTarget,classes:"display-btn"};if(this.model.get("purged"))n.disabled=!0,n.title=s("Cannot display datasets removed from disk");else if(t===e.UPLOAD)n.disabled=!0,n.title=s("This dataset must finish uploading before it can be viewed");else if(t===e.NEW)n.disabled=!0,n.title=s("This dataset is not yet viewable");else{n.title=s("View data"),n.href=this.model.urls.display;var a=this;n.onclick=function(t){Galaxy.frame&&Galaxy.frame.active&&(Galaxy.frame.add_dataset(a.model.get("id")),t.preventDefault())}}return n.faIcon="fa-eye",i(n)},_renderDetails:function(){if(this.model.get("state")===e.NOT_VIEWABLE)return $(this.templates.noAccess(this.model.toJSON(),this));var t=a.prototype._renderDetails.call(this);return t.find(".actions .left").empty().append(this._renderSecondaryActions()),t.find(".summary").html(this._renderSummary()).prepend(this._renderDetailMessages()),t.find(".display-applications").html(this._renderDisplayApplications()),this._setUpBehaviors(t),t},_renderSummary:function(){var t=this.model.toJSON(),e=this.templates.summaries[t.state];return(e=e||this.templates.summaries.unknown)(t,this)},_renderDetailMessages:function(){var t=this,e=$('<div class="detail-messages"></div>'),i=t.model.toJSON();return _.each(t.templates.detailMessages,function(n){e.append($(n(i,t)))}),e},_renderDisplayApplications:function(){return this.model.isDeletedOrPurged()?"":[this.templates.displayApplications(this.model.get("display_apps"),this),this.templates.displayApplications(this.model.get("display_types"),this)].join("")},_renderSecondaryActions:function(){switch(this.debug("_renderSecondaryActions"),this.model.get("state")){case e.NOT_VIEWABLE:return[];case e.OK:case e.FAILED_METADATA:case e.ERROR:return[this._renderDownloadButton(),this._renderShowParamsButton()]}return[this._renderShowParamsButton()]},_renderShowParamsButton:function(){return i({title:s("View details"),classes:"params-btn",href:this.model.urls.show_params,target:this.linkTarget,faIcon:"fa-info-circle"})},_renderDownloadButton:function(){return this.model.get("purged")||!this.model.hasData()?null:_.isEmpty(this.model.get("meta_files"))?$(['<a class="download-btn icon-btn" href="',this.model.urls.download,'" title="'+s("Download")+'">','<span class="fa fa-floppy-o"></span>',"</a>"].join("")):this._renderMetaFileDownloadButton()},_renderMetaFileDownloadButton:function(){var t=this.model.urls;return $(['<div class="metafile-dropdown dropdown">','<a class="download-btn icon-btn" href="javascript:void(0)" data-toggle="dropdown"',' title="'+s("Download")+'">','<span class="fa fa-floppy-o"></span>',"</a>",'<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">','<li><a href="'+t.download+'">',s("Download dataset"),"</a></li>",_.map(this.model.get("meta_files"),function(e){return['<li><a href="',t.meta_download+e.file_type,'">',s("Download")," ",e.file_type,"</a></li>"].join("")}).join("\n"),"</ul>","</div>"].join("\n"))},events:_.extend(_.clone(a.prototype.events),{"click .display-btn":function(t){this.trigger("display",this,t)},"click .params-btn":function(t){this.trigger("params",this,t)},"click .download-btn":function(t){this.trigger("download",this,t)}}),toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetListItemView("+t+")"}});return o.prototype.templates=function(){var t=_.extend({},a.prototype.templates.warnings,{failed_metadata:n.wrapTemplate(['<% if( model.state === "failed_metadata" ){ %>','<div class="warningmessagesmall">',s("An error occurred setting the metadata for this dataset"),"</div>","<% } %>"]),error:n.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',s("There was an error getting the data for this dataset"),": <%- model.error %>","</div>","<% } %>"]),purged:n.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',s("This dataset has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:n.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',s("This dataset has been deleted"),"</div>","<% } %>"])}),i=n.wrapTemplate(['<div class="details">','<div class="summary"></div>','<div class="actions clear">','<div class="left"></div>','<div class="right"></div>',"</div>","<% if( !dataset.deleted && !dataset.purged ){ %>",'<div class="tags-display"></div>','<div class="annotation-display"></div>','<div class="display-applications"></div>',"<% if( dataset.peek ){ %>",'<pre class="dataset-peek"><%= dataset.peek %></pre>',"<% } %>","<% } %>","</div>"],"dataset"),o=n.wrapTemplate(['<div class="details">','<div class="summary">',s("You do not have permission to view this dataset"),"</div>","</div>"],"dataset"),r={};r[e.OK]=r[e.FAILED_METADATA]=n.wrapTemplate(["<% if( dataset.misc_blurb ){ %>",'<div class="blurb">','<span class="value"><%- dataset.misc_blurb %></span>',"</div>","<% } %>","<% if( dataset.file_ext ){ %>",'<div class="datatype">','<label class="prompt">',s("format"),"</label>",'<span class="value"><%- dataset.file_ext %></span>',"</div>","<% } %>","<% if( dataset.metadata_dbkey ){ %>",'<div class="dbkey">','<label class="prompt">',s("database"),"</label>",'<span class="value">',"<%- dataset.metadata_dbkey %>","</span>","</div>","<% } %>","<% if( dataset.misc_info ){ %>",'<div class="info">','<span class="value"><%- dataset.misc_info %></span>',"</div>","<% } %>"],"dataset"),r[e.NEW]=n.wrapTemplate(["<div>",s("This is a new dataset and not all of its data are available yet"),"</div>"],"dataset"),r[e.NOT_VIEWABLE]=n.wrapTemplate(["<div>",s("You do not have permission to view this dataset"),"</div>"],"dataset"),r[e.DISCARDED]=n.wrapTemplate(["<div>",s("The job creating this dataset was cancelled before completion"),"</div>"],"dataset"),r[e.QUEUED]=n.wrapTemplate(["<div>",s("This job is waiting to run"),"</div>"],"dataset"),r[e.RUNNING]=n.wrapTemplate(["<div>",s("This job is currently running"),"</div>"],"dataset"),r[e.UPLOAD]=n.wrapTemplate(["<div>",s("This dataset is currently uploading"),"</div>"],"dataset"),r[e.SETTING_METADATA]=n.wrapTemplate(["<div>",s("Metadata is being auto-detected"),"</div>"],"dataset"),r[e.PAUSED]=n.wrapTemplate(["<div>",s('This job is paused. Use the "Resume Paused Jobs" in the history menu to resume'),"</div>"],"dataset"),r[e.ERROR]=n.wrapTemplate(["<% if( !dataset.purged ){ %>","<div><%- dataset.misc_blurb %></div>","<% } %>",'<span class="help-text">',s("An error occurred with this dataset"),":</span>",'<div class="job-error-text"><%- dataset.misc_info %></div>'],"dataset"),r[e.EMPTY]=n.wrapTemplate(["<div>",s("No data"),": <i><%- dataset.misc_blurb %></i></div>"],"dataset"),r.unknown=n.wrapTemplate(['<div>Error: unknown dataset state: "<%- dataset.state %>"</div>'],"dataset");var l={resubmitted:n.wrapTemplate(["<% if( model.resubmitted ){ %>",'<div class="resubmitted-msg infomessagesmall">',s("The job creating this dataset has been resubmitted"),"</div>","<% } %>"])},c=n.wrapTemplate(["<% _.each( apps, function( app ){ %>",'<div class="display-application">','<span class="display-application-location"><%- app.label %></span> ','<span class="display-application-links">',"<% _.each( app.links, function( link ){ %>",'<a target="<%= link.target %>" href="<%= link.href %>">',"<% print( _l( link.text ) ); %>","</a> ","<% }); %>","</span>","</div>","<% }); %>"],"apps");return _.extend({},a.prototype.templates,{warnings:t,details:i,noAccess:o,summaries:r,detailMessages:l,displayApplications:c})}(),{DatasetListItemView:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(13),i(17),i(1)],s=function(t,e,i){function n(t){return function(e,i){return this.isNew()&&(i=i||{},i.url=this.urlRoot+this.get("history_id")+"/contents",e=e||{},e.type="dataset_collection"),t.call(this,e,i)}}var s=e.HistoryContentMixin,a=t.ListDatasetCollection,o=t.PairDatasetCollection,r=t.ListPairedDatasetCollection,l=a.extend(s).extend({defaults:_.extend(_.clone(a.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"list",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){a.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(a.prototype.save),toString:function(){return["HistoryListDatasetCollection(",this.get("name"),")"].join("")}}),c=o.extend(s).extend({defaults:_.extend(_.clone(o.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"paired",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){o.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(o.prototype.save),toString:function(){return["HistoryPairDatasetCollection(",this.get("name"),")"].join("")}}),d=r.extend(s).extend({defaults:_.extend(_.clone(r.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"list:paired",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){r.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(r.prototype.save),toString:function(){return["HistoryListPairedDatasetCollection(",this.get("name"),")"].join("")}});return{HistoryListDatasetCollection:l,HistoryPairDatasetCollection:c,HistoryListPairedDatasetCollection:d}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(3),i(1)],s=function(t,e,i){var n=function(t,e){return[t,e].join("-")},s={defaults:{history_id:null,history_content_type:null,hid:null,visible:!0},idAttribute:"type_id",constructor:function(t,e){t.type_id=n(t.history_content_type,t.id),this.debug("HistoryContentMixin.constructor:",t.type_id),Backbone.Model.apply(this,arguments)},_typeIdStr:function(){return n(this.get("history_content_type"),this.get("id"))},initialize:function(t,e){this.on("change:id",this._createTypeId)},_createTypeId:function(){this.set("type_id",this._typeIdStr())},isNew:function(){return!this.get("id")},hidden:function(){return!this.get("visible")},isVisible:function(t,e){var i=!0;return t||!this.get("deleted")&&!this.get("purged")||(i=!1),e||this.get("visible")||(i=!1),i},urlRoot:(window.Galaxy?Galaxy.options.root:"/")+"api/histories/",url:function(){var t=this.urlRoot+this.get("history_id")+"/contents/"+this.get("history_content_type")+"s/"+this.get("id");return t},hide:function(t){return this.get("visible")?this.save({visible:!1},t):jQuery.when()},unhide:function(t){return this.get("visible")?jQuery.when():this.save({visible:!0},t)},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t=this.get("hid")+' :"'+this.get("name")+'",'+t),"HistoryContent("+t+")"}},a=Backbone.Model.extend(e.LoggableMixin).extend(s);return{typeIdStr:n,HistoryContentMixin:s,HistoryContent:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(17),i(31),i(16),i(3),i(1)],s=function(t,e,i,n,s){var a=Backbone.Collection.extend(n.LoggableMixin).extend({model:function(t,n){if("dataset"===t.history_content_type)return new e.HistoryDatasetAssociation(t,n);if("dataset_collection"===t.history_content_type){switch(t.collection_type){case"list":return new i.HistoryListDatasetCollection(t,n);case"paired":return new i.HistoryPairDatasetCollection(t,n);case"list:paired":return new i.HistoryListPairedDatasetCollection(t,n)}return{validationError:"Unknown collection_type: "+t.history_content_type}}return{validationError:"Unknown history_content_type: "+t.history_content_type}},initialize:function(t,e){e=e||{},this.historyId=e.historyId,this.model.prototype.idAttribute="type_id",this.on("all",function(){this.debug(this+".event:",arguments)})},urlRoot:galaxy_config.root+"api/histories",url:function(){return this.urlRoot+"/"+this.historyId+"/contents"},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},running:function(){var t=[];return this.each(function(e){var i=!e.inReadyState();i&&t.push(e.get("id"))}),t},getByHid:function(t){return _.first(this.filter(function(e){
return e.get("hid")===t}))},getVisible:function(t,e,i){i=i||[],this.debug("checking isVisible");var n=new a(this.filter(function(i){return i.isVisible(t,e)}));return _.each(i,function(t){_.isFunction(t)&&(n=new a(n.filter(t)))}),n},hidden:function(){function t(t){return t.hidden()}return new a(this.filter(t))},deleted:function(){function t(t){return t.get("deleted")}return new a(this.filter(t))},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},fetchAllDetails:function(t){t=t||{};var e={details:"all"};return t.data=t.data?_.extend(t.data,e):e,this.fetch(t)},ajaxQueue:function(t,e){var i=jQuery.Deferred(),n=this.length,s=[];if(!n)return i.resolve([]),i;var a=this.chain().reverse().map(function(o,r){return function(){var l=t.call(o,e);l.done(function(t){i.notify({curr:r,total:n,response:t,model:o})}),l.always(function(t){s.push(t),a.length?a.shift()():i.resolve(s)})}}).value();return a.shift()(),i},isCopyable:function(t){var e=["HistoryDatasetAssociation","HistoryDatasetCollectionAssociation"];return _.isObject(t)&&t.id&&_.contains(e,t.model_class)},copy:function(t){var e,i,n;_.isString(t)?(e=t,n="hda",i="dataset"):(e=t.id,n={HistoryDatasetAssociation:"hda",LibraryDatasetDatasetAssociation:"ldda",HistoryDatasetCollectionAssociation:"hdca"}[t.model_class]||"hda",i="hdca"===n?"dataset_collection":"dataset");var s=this,a=jQuery.post(this.url(),{content:e,source:n,type:i}).done(function(t){s.add([t])}).fail(function(t,o,r){s.trigger("error",s,a,{},"Error copying contents",{type:i,id:e,source:n})});return a},matches:function(t){return this.filter(function(e){return e.matches(t)})},set:function(e,i){e=_.isArray(e)?e:[e],_.each(e,function(e){e.type_id&&e.get&&e.get("type_id")||(e.type_id=t.typeIdStr(e.history_content_type,e.id))}),Backbone.Collection.prototype.set.call(this,e,i)},createHDCA:function(t,e,n,s){var a=this,o={list:i.HistoryListDatasetCollection,paired:i.HistoryPairDatasetCollection},r=new o[e]({history_id:this.historyId,name:n,element_identifiers:t});return r.save().done(function(t){a.add(r)}).fail(function(t,e,i){a.trigger("error",t,e,i)})},clone:function(){var t=Backbone.Collection.prototype.clone.call(this);return t.historyId=this.historyId,t},print:function(){var t=this;t.each(function(e){t.debug(e),e.elements&&t.debug("	 elements:",e.elements)})},toString:function(){return["HistoryContents(",[this.historyId,this.length].join(),")"].join("")}});return{HistoryContents:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(3),i(1)],s=function(t,e){var i=Backbone.View.extend(t.LoggableMixin).extend({initialize:function(t){this.expanded=t.expanded||!1,this.log("	 expanded:",this.expanded),this.fxSpeed=void 0!==t.fxSpeed?t.fxSpeed:this.fxSpeed},fxSpeed:"fast",render:function(t){var e=this._buildNewRender();return this._setUpBehaviors(e),this._queueNewRender(e,t),this},_buildNewRender:function(){var t=$(this.templates.el(this.model.toJSON(),this));return this.expanded&&this.$details(t).replaceWith(this._renderDetails().show()),t},_queueNewRender:function(t,e){e=void 0===e?this.fxSpeed:e;var i=this;$(i).queue("fx",[function(t){this.$el.fadeOut(e,t)},function(e){i._swapNewRender(t),e()},function(t){this.$el.fadeIn(e,t)},function(t){this.trigger("rendered",i),t()}])},_swapNewRender:function(t){return this.$el.empty().attr("class",_.isFunction(this.className)?this.className():this.className).append(t.children())},_setUpBehaviors:function(t){t=t||this.$el,t.find("[title]").tooltip({placement:"bottom"})},$details:function(t){return t=t||this.$el,t.find("> .details")},_renderDetails:function(){var t=$(this.templates.details(this.model.toJSON(),this));return this._setUpBehaviors(t),t},toggleExpanded:function(t){return t=void 0===t?!this.expanded:t,t?this.expand():this.collapse(),this},expand:function(){var t=this;return t._fetchModelDetails().always(function(){t._expand()})},_fetchModelDetails:function(){return this.model.hasDetails()?jQuery.when():this.model.fetch()},_expand:function(){var t=this,e=t._renderDetails();t.$details().replaceWith(e),t.expanded=!0,t.$details().slideDown({duration:t.fxSpeed,step:function(){t.trigger("expanding",t)},complete:function(){t.trigger("expanded",t)}})},collapse:function(){this.debug(this+"(ExpandableView).collapse");var t=this;t.expanded=!1,this.$details().slideUp({duration:t.fxSpeed,step:function(){t.trigger("collapsing",t)},complete:function(){t.trigger("collapsed",t)}})}}),n=i.extend(t.mixin(t.SelectableViewMixin,t.DraggableViewMixin,{tagName:"div",className:"list-item",initialize:function(e){i.prototype.initialize.call(this,e),t.SelectableViewMixin.initialize.call(this,e),t.DraggableViewMixin.initialize.call(this,e),this._setUpListeners()},_setUpListeners:function(){return this.on("selectable",function(t){t?this.$(".primary-actions").hide():this.$(".primary-actions").show()},this),this},_buildNewRender:function(){var t=i.prototype._buildNewRender.call(this);return t.children(".warnings").replaceWith(this._renderWarnings()),t.children(".title-bar").replaceWith(this._renderTitleBar()),t.children(".primary-actions").append(this._renderPrimaryActions()),t.find("> .title-bar .subtitle").replaceWith(this._renderSubtitle()),t},_swapNewRender:function(t){return i.prototype._swapNewRender.call(this,t),this.selectable&&this.showSelector(0),this.draggable&&this.draggableOn(),this.$el},_renderWarnings:function(){var t=this,e=$('<div class="warnings"></div>'),i=t.model.toJSON();return _.each(t.templates.warnings,function(n){e.append($(n(i,t)))}),e},_renderTitleBar:function(){return $(this.templates.titleBar(this.model.toJSON(),this))},_renderPrimaryActions:function(){return[]},_renderSubtitle:function(){return $(this.templates.subtitle(this.model.toJSON(),this))},events:{"click .title-bar":"_clickTitleBar","keydown .title-bar":"_keyDownTitleBar","click .selector":"toggleSelect"},_clickTitleBar:function(t){t.stopPropagation(),t.altKey?(this.toggleSelect(t),this.selectable||this.showSelector()):this.toggleExpanded()},_keyDownTitleBar:function(t){var e=32,i=13;return!t||"keydown"!==t.type||t.keyCode!==e&&t.keyCode!==i?!0:(this.toggleExpanded(),t.stopPropagation(),!1)},toString:function(){var t=this.model?this.model+"":"(no model)";return"ListItemView("+t+")"}}));n.prototype.templates=function(){var e=t.wrapTemplate(['<div class="list-element">','<div class="warnings"></div>','<div class="selector">','<span class="fa fa-2x fa-square-o"></span>',"</div>",'<div class="primary-actions"></div>','<div class="title-bar"></div>','<div class="details"></div>',"</div>"]),i={},n=t.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element"),s=t.wrapTemplate(['<div class="subtitle"></div>']),a=t.wrapTemplate(['<div class="details"></div>']);return{el:e,warnings:i,titleBar:n,subtitle:s,details:a}}();var s=n.extend({foldoutStyle:"foldout",foldoutPanelClass:null,initialize:function(t){"drilldown"===this.foldoutStyle&&(this.expanded=!1),this.foldoutStyle=t.foldoutStyle||this.foldoutStyle,this.foldoutPanelClass=t.foldoutPanelClass||this.foldoutPanelClass,n.prototype.initialize.call(this,t),this.foldout=this._createFoldoutPanel()},_renderDetails:function(){if("drilldown"===this.foldoutStyle)return $();var t=n.prototype._renderDetails.call(this);return this._attachFoldout(this.foldout,t)},_createFoldoutPanel:function(){var t=this.model,e=this._getFoldoutPanelClass(t),i=this._getFoldoutPanelOptions(t),n=new e(_.extend(i,{model:t}));return n},_getFoldoutPanelClass:function(){return this.foldoutPanelClass},_getFoldoutPanelOptions:function(){return{foldoutStyle:this.foldoutStyle,fxSpeed:this.fxSpeed}},_attachFoldout:function(t,e){return e=e||this.$("> .details"),this.foldout=t.render(0),t.$("> .controls").hide(),e.append(t.$el)},expand:function(){var t=this;return t._fetchModelDetails().always(function(){"foldout"===t.foldoutStyle?t._expand():"drilldown"===t.foldoutStyle&&t._expandByDrilldown()})},_expandByDrilldown:function(){var t=this;t.foldout.on("close",function(){t.trigger("collapsed:drilldown",t,t.foldout)}),t.trigger("expanded:drilldown",t,t.foldout)}});return s.prototype.templates=function(){var e=t.wrapTemplate(['<div class="details">',"</div>"],"collection");return _.extend({},n.prototype.templates,{details:e})}(),{ExpandableView:i,ListItemView:n,FoldoutListItemView:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){return{help:function(t){var e=$('<div class="toolHelp" style="overflow: auto;"/>').append($('<div class="toolHelpBody"/>').append(t.help));return e.find("a").attr("target","_blank"),e},success:function(t){if(!t.jobs||!t.jobs.length)return this.error(t);var e=t.jobs.length,i="";i=1==e?"1 job has":e+" jobs have";var n='<div class="donemessagelarge"><p>'+i+" been successfully added to the queue - resulting in the following datasets:</p>";for(var s in t.outputs)n+='<p style="padding: 10px 20px;"><b>'+t.outputs[s].hid+": "+t.outputs[s].name+"</b></p>";return n+="<p>You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.</p></div>"},error:function(t){return'<div><p>The server could not complete the request. Please contact the Galaxy Team if this error persists.</p><textarea class="ui-textarea" disabled style="color: black; height: 300px !important;">'+JSON.stringify(t,void 0,4)+"</textarea></div>"},requirements:function(t){var e="This tool requires ";for(var i in t.requirements){var n=t.requirements[i];e+=n.name,n.version&&(e+=" (Version "+n.version+")"),i<t.requirements.length-2&&(e+=", "),i==t.requirements.length-2&&(e+=" and ")}return e+'. Click <a target="_blank" href="https://wiki.galaxyproject.org/Tools/Requirements">here</a> for more information.'}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{id:t.uid(),title:"",floating:"right",icon:"",cls:"ui-button btn btn-default",cls_wait:"btn btn-info"}),this.setElement(this._template(this.options));var i=this;$(this.el).on("click",function(){$(".tooltip").hide(),e.onclick&&!i.disabled&&e.onclick()}),$(this.el).tooltip({title:e.tooltip,placement:"bottom"})},disable:function(){this.$el.addClass("disabled"),this.disabled=!0},enable:function(){this.$el.removeClass("disabled"),this.disabled=!1},wait:function(){this.$el.removeClass(this.options.cls).addClass(this.options.cls_wait).prop("disabled",!0),this.$(".icon").removeClass(this.options.icon).addClass("fa-spinner fa-spin"),this.$(".title").html("Sending...")},unwait:function(){this.$el.removeClass(this.options.cls_wait).addClass(this.options.cls).prop("disabled",!1),this.$(".icon").removeClass("fa-spinner fa-spin").addClass(this.options.icon),this.$(".title").html(this.options.title)},_template:function(t){var e='<button id="'+t.id+'" type="submit" style="float: '+t.floating+';" type="button" class="'+t.cls+'">';return t.icon&&(e+='<i class="icon fa '+t.icon+'"/>&nbsp;'),e+='<span class="title">'+t.title+"</span></button>"}}),i=e.extend({initialize:function(t){e.prototype.initialize.call(this,t)},_template:function(t){return'<a id="'+t.id+'" class="'+t.cls+'" href="'+(t.href||"javascript:void(0)")+'" title="'+t.title+'" target="'+(t.target||"_top")+'"><span class="'+t.icon+'"/></a>'}}),n=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{title:"Select/Unselect all",icons:["fa fa-square-o","fa fa-minus-square-o","fa fa-check-square-o"],value:0}),this.setElement(this._template()),this.$title=this.$(".title"),this.$icon=this.$(".icon"),this.value(this.options.value),this.$title.html(this.options.title);var i=this;this.$el.on("click",function(){i.current=0===i.current&&2||0,i.value(i.current),i.options.onclick&&i.options.onclick()})},value:function(t,e){return void 0!==t&&(e&&0!==t&&(t=t!==e&&1||2),this.current=t,this.$icon.removeClass().addClass("icon").addClass(this.options.icons[t]),this.options.onchange&&this.options.onchange(t)),this.current},_template:function(){return'<div class="ui-button-check" ><span class="icon"/><span class="title"/></div>'}}),s=Backbone.View.extend({initialize:function(e){this.options=t.merge(e,{id:t.uid(),title:"",floating:"right",cls:"ui-button-icon",icon:"",tooltip:"",onclick:null}),this.setElement(this._template(this.options)),this.$button=this.$el.find(".button");var i=this;$(this.el).on("click",function(){$(".tooltip").hide(),e.onclick&&!i.disabled&&e.onclick()}),this.$button.tooltip({title:e.tooltip,placement:"bottom"})},disable:function(){this.$button.addClass("disabled"),this.disabled=!0},enable:function(){this.$button.removeClass("disabled"),this.disabled=!1},setIcon:function(t){this.$("i").removeClass(this.options.icon).addClass(t),this.options.icon=t},_template:function(t){var e="";t.title&&(e="width: auto;");var i='<div id="'+t.id+'" style="float: '+t.floating+"; "+e+'" class="'+t.cls+'"><div class="button">';return i+=t.title?'<i class="icon fa '+t.icon+'"/>&nbsp;<span class="title">'+t.title+"</span>":'<i class="icon fa '+t.icon+'"/>',i+="</div></div>"}}),a=Backbone.View.extend({$menu:null,initialize:function(e){this.options=t.merge(e,{id:"",title:"",floating:"right",pull:"right",icon:null,onclick:null,cls:"ui-button-icon ui-button-menu",tooltip:"",target:"",href:"",onunload:null,visible:!0,tag:""}),this.setElement($(this._template(this.options)));var i=$(this.el).find(".root"),n=this;i.on("click",function(t){$(".tooltip").hide(),t.preventDefault(),n.options.onclick&&n.options.onclick()}),this.options.visible||this.hide(),i.tooltip({title:e.tooltip,placement:"bottom"})},show:function(){$(this.el).show()},hide:function(){$(this.el).hide()},addMenu:function(e){var i={title:"",target:"",href:"",onclick:null,divider:!1,icon:null,cls:"button-menu btn-group"};i=t.merge(e,i),this.$menu||($(this.el).append(this._templateMenu()),this.$menu=$(this.el).find(".menu"));var n=$(this._templateMenuItem(i));n.on("click",function(t){t.preventDefault(),i.onclick&&i.onclick()}),this.$menu.append(n),i.divider&&this.$menu.append($(this._templateDivider()))},_templateMenuItem:function(t){var e='<li><a class="dropdown-item" href="'+t.href+'" target="'+t.target+'">';return t.icon&&(e+='<i class="fa '+t.icon+'"/>'),e+=" "+t.title+"</a></li>"},_templateMenu:function(){return'<ul class="menu dropdown-menu pull-'+this.options.pull+'" role="menu"/>'},_templateDivider:function(){return'<li class="divider"/>'},_template:function(t){var e="",i="";t.title?e="width: auto;":i="margin: 0px;";var n='<div id="'+t.id+'" style="float: '+t.floating+"; "+e+'" class="dropdown '+t.cls+'"><div class="root button dropdown-toggle" data-toggle="dropdown" style="'+i+'"><i class="icon fa '+t.icon+'"/>';return t.title&&(n+='&nbsp;<span class="title">'+t.title+"</span>"),n+="</div></div>"}});return{ButtonDefault:e,ButtonLink:i,ButtonIcon:s,ButtonCheck:n,ButtonMenu:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e=Backbone.View.extend({row:null,row_count:0,optionsDefault:{content:"No content available.",onchange:null,ondblclick:null,onconfirm:null,cls:"ui-table",cls_tr:""},events:{click:"_onclick",dblclick:"_ondblclick"},initialize:function(e){this.options=t.merge(e,this.optionsDefault);var i=$(this._template(this.options));this.$thead=i.find("thead"),this.$tbody=i.find("tbody"),this.$tmessage=i.find("tmessage"),this.setElement(i),this.row=this._row()},addHeader:function(t){var e=$("<th></th>");e.append(t),this.row.append(e)},appendHeader:function(){this.$thead.append(this.row),this.row=$("<tr></tr>")},add:function(t,e,i){var n=$("<td></td>");e&&n.css("width",e),i&&n.css("text-align",i),n.append(t),this.row.append(n)},append:function(t,e){this._commit(t,e,!1)},prepend:function(t,e){this._commit(t,e,!0)},get:function(t){return this.$el.find("#"+t)},del:function(t){var e=this.$tbody.find("#"+t);e.length>0&&(e.remove(),this.row_count--,this._refresh())},delAll:function(){this.$tbody.empty(),this.row_count=0,this._refresh()},value:function(t){this.before=this.$tbody.find(".current").attr("id"),void 0!==t&&(this.$tbody.find("tr").removeClass("current"),t&&this.$tbody.find("#"+t).addClass("current"));var e=this.$tbody.find(".current").attr("id");return void 0===e?null:(e!=this.before&&this.options.onchange&&this.options.onchange(t),e)},size:function(){return this.$tbody.find("tr").length},_commit:function(t,e,i){this.del(t),this.row.attr("id",t),i?this.$tbody.prepend(this.row):this.$tbody.append(this.row),e&&(this.row.hide(),this.row.fadeIn()),this.row=this._row(),this.row_count++,this._refresh()},_row:function(){return $('<tr class="'+this.options.cls_tr+'"></tr>')},_onclick:function(t){var e=this.value(),i=$(t.target).closest("tr").attr("id");""!=i&&i&&e!=i&&(this.options.onconfirm?this.options.onconfirm(i):this.value(i))},_ondblclick:function(t){var e=this.value();e&&this.options.ondblclick&&this.options.ondblclick(e)},_refresh:function(){0==this.row_count?this.$tmessage.show():this.$tmessage.hide()},_template:function(t){return'<div><table class="'+t.cls+'"><thead></thead><tbody></tbody></table><tmessage>'+t.content+"</tmessage><div>"}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){var t=Backbone.View.extend({el_masthead:"#everything",options:null,$background:null,list:[],initialize:function(t){this.options=t,$("body").off(),this.setElement($(this._template(t))),$(this.el_masthead).append($(this.el)),this.$background=$(this.el).find("#masthead-background");var e=this;$(window).on("beforeunload",function(){var t="";for(key in e.list)if(e.list[key].options.onunload){var i=e.list[key].options.onunload();i&&(t+=i+" ")}return""!=t?t:void 0})},events:{click:"_click",mousedown:function(t){t.preventDefault()}},append:function(t){return this._add(t,!0)},prepend:function(t){return this._add(t,!1)},highlight:function(t){var e=$(this.el).find("#"+t+"> li");e&&e.addClass("active")},_add:function(t,e){var i=$(this.el).find("#"+t.location);if(i){var n=$(t.el);n.addClass("masthead-item"),e?i.append(n):i.prepend(n),this.list.push(t)}return null},_click:function(t){var e=$(this.el).find(".popup");e&&e.hide();var i=$(t.target).closest(".masthead-item").find(".popup");$(t.target).hasClass("head")?(i.show(),this.$background.show()):this.$background.hide()},_template:function(t){var e=t.brand?"/ "+t.brand:"";return'<div><div id="masthead" class="navbar navbar-fixed-top navbar-inverse"><div style="position: relative; right: -50%; float: left;"><div id="navbar" style="display: block; position: relative; right: 50%;"></div></div><div class="navbar-brand"><a href="'+t.logo_url+'"><img style="margin-left: 0.35em;" border="0" src="'+galaxy_config.root+'static/images/galaxyIcon_noText.png"><span id="brand"> Galaxy '+e+'</span></a></div><div class="quota-meter-container"></div><div id="iconbar" class="iconbar"></div></div><div id="masthead-background" style="display: none; position: absolute; top: 33px; width: 100%; height: 100%; z-index: 1010"></div></div>'}}),e=Backbone.View.extend({options:{id:"",icon:"fa-cog",tooltip:"",with_number:!1,onclick:function(){alert("clicked")},onunload:null,visible:!0},location:"iconbar",initialize:function(t){t&&(this.options=_.defaults(t,this.options)),this.setElement($(this._template(this.options)));var e=this;$(this.el).find(".icon").tooltip({title:this.options.tooltip,placement:"bottom"}).on("mouseup",e.options.onclick),this.options.visible||this.hide()},show:function(){$(this.el).css({visibility:"visible"})},hide:function(){$(this.el).css({visibility:"hidden"})},icon:function(t){$(this.el).find(".icon").removeClass(this.options.icon).addClass(t),this.options.icon=t},toggle:function(){$(this.el).addClass("toggle")},untoggle:function(){$(this.el).removeClass("toggle")},number:function(t){$(this.el).find(".number").text(t)},_template:function(t){var e='<div id="'+t.id+'" class="symbol"><div class="icon fa fa-2x '+t.icon+'"></div>';return t.with_number&&(e+='<div class="number"></div>'),e+="</div>"}}),i=Backbone.View.extend({options:{id:"",title:"",target:"_parent",content:"",type:"url",scratchbook:!1,onunload:null,visible:!0,disabled:!1,title_attribute:""},location:"navbar",$menu:null,events:{"click .head":"_head"},initialize:function(t){t&&(this.options=_.defaults(t,this.options)),void 0!==this.options.content&&-1===this.options.content.indexOf("//")&&(this.options.content=galaxy_config.root+this.options.content),this.setElement($(this._template(this.options))),this.options.disabled&&($(this.el).find(".root").addClass("disabled"),this._attachPopover()),this.options.visible||this.hide()},show:function(){$(this.el).css({visibility:"visible"})},hide:function(){$(this.el).css({visibility:"hidden"})},add:function(t){var e={title:"Title",content:"",type:"url",target:"_parent",scratchbook:!1,divider:!1};t&&(e=_.defaults(t,e)),e.content&&-1===e.content.indexOf("//")&&(e.content=galaxy_config.root+e.content),this.$menu||($(this.el).find(".root").append(this._templateMenu()),$(this.el).find(".symbol").addClass("caret"),this.$menu=$(this.el).find(".popup"));var i=$(this._templateMenuItem(e));this.$menu.append(i);var n=this;i.on("click",function(e){return e.preventDefault(),"_blank"===n.options.target?!0:void Galaxy.frame.add(t)}),e.divider&&this.$menu.append($(this._templateDivider()))},_head:function(t){t.preventDefault(),this.options.disabled||this.$menu||Galaxy.frame.add(this.options)},_attachPopover:function(){var t=$(this.el).find(".head");t.popover({html:!0,content:'Please <a href="'+galaxy_config.root+'user/login?use_panels=True">log in</a> or <a href="'+galaxy_config.root+'user/create?use_panels=True">register</a> to use this feature.',placement:"bottom"}).on("shown.bs.popover",function(){setTimeout(function(){t.popover("hide")},5e3)})},_templateMenuItem:function(t){return'<li><a href="'+t.content+'" target="'+t.target+'">'+t.title+"</a></li>"},_templateMenu:function(){return'<ul class="popup dropdown-menu"></ul>'},_templateDivider:function(){return'<li class="divider"></li>'},_template:function(t){var e='<ul id="'+t.id+'" class="nav navbar-nav" border="0" cellspacing="0"><li class="root dropdown" style=""><a class="head dropdown-toggle" data-toggle="dropdown" target="'+t.target+'" href="'+t.content+'" title="'+t.title_attribute+'">'+t.title+'<b class="symbol"></b></a></li></ul>';return e}});return{GalaxyMasthead:t,GalaxyMastheadTab:i,GalaxyMastheadIcon:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){var t=Backbone.View.extend({initialize:function(t,e){this.$button=t,this.$button.size()||(this.$button=$("<div/>")),this.options=e||[];var i=this;this.$button.click(function(t){return $(".popmenu-wrapper").remove(),i._renderAndShow(t),!1})},_renderAndShow:function(t){this.render(),this.$el.appendTo("body").css(this._getShownPosition(t)).show(),this._setUpCloseBehavior()},render:function(){if(this.$el.addClass("popmenu-wrapper").hide().css({position:"absolute"}).html(this.template(this.$button.attr("id"),this.options)),this.options.length){var t=this;this.$el.find("li").each(function(e,i){var n=t.options[e];n.func&&$(this).children("a.popupmenu-option").click(function(e){n.func.call(t,e,n),e.preventDefault()})})}return this},template:function(t,e){return['<ul id="',t,'-menu" class="dropdown-menu">',this._templateOptions(e),"</ul>"].join("")},_templateOptions:function(t){return t.length?_.map(t,function(t){if(t.divider)return'<li class="divider"></li>';if(t.header)return['<li class="head"><a href="javascript:void(0);">',t.html,"</a></li>"].join("");var e=t.href||"javascript:void(0);",i=t.target?' target="'+t.target+'"':"",n=t.checked?'<span class="fa fa-check"></span>':"";return['<li><a class="popupmenu-option" href="',e,'"',i,">",n,t.html,"</a></li>"].join("")}).join(""):"<li>(no options)</li>"},_getShownPosition:function(t){var e=this.$el.width(),i=t.pageX-e/2;return i=Math.min(i,$(document).scrollLeft()+$(window).width()-e-5),i=Math.max(i,$(document).scrollLeft()+5),{top:t.pageY,left:i}},_setUpCloseBehavior:function(){function t(t){if($(document).off("click.close_popup"),window.parent!==window)try{$(window.parent.document).off("click.close_popup")}catch(i){}else try{$("iframe#galaxy_main").contents().off("click.close_popup")}catch(i){}e.remove()}var e=this;if($("html").one("click.close_popup",t),window.parent!==window)try{$(window.parent.document).find("html").one("click.close_popup",t)}catch(i){}else try{$("iframe#galaxy_main").contents().one("click.close_popup",t)}catch(i){}},addItem:function(t,e){return e=e>=0?e:this.options.length,this.options.splice(e,0,t),this},removeItem:function(t){return t>=0&&this.options.splice(t,1),this},findIndexByHtml:function(t){for(var e=0;e<this.options.length;e++)if(_.has(this.options[e],"html")&&this.options[e].html===t)return e;return null},findItemByHtml:function(t){return this.options[this.findIndexByHtml(t)]},toString:function(){return"PopupMenu"}});return t.create=function(e,i){return new t(e,i)},t.make_popupmenu=function(e,i){var n=[];return _.each(i,function(t,e){var i={html:e};null===t?i.header=!0:"function"===jQuery.type(t)&&(i.func=t),n.push(i)}),new t($(e),n)},t.convertLinksToOptions=function(t,e){t=$(t),e=e||"a";var i=[];return t.find(e).each(function(t,e){var n={},s=$(t);if(n.html=s.text(),s.attr("href")){var a=s.attr("href"),o=s.attr("target"),r=s.attr("confirm");n.func=function(){if(!r||confirm(r))switch(o){case"_parent":window.parent.location=a;break;case"_top":window.top.location=a;break;default:window.location=a}}}i.push(n)}),i},t.fromExistingDom=function(e,i,n){e=$(e),i=$(i);var s=t.convertLinksToOptions(i,n);return i.remove(),new t(e,s)},t.make_popup_menus=function(e,i,n){e=e||document,i=i||"div[popupmenu]",n=n||function(t,e){return"#"+t.attr("popupmenu")};var s=[];return $(e).find(i).each(function(){var i=$(this),a=$(e).find(n(i,e));s.push(t.fromDom(a,i)),a.addClass("popup")}),s},t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){function t(t,e){var i=void 0!==t.prototype?t.prototype:t;return void 0!==e&&(i._logNamespace=e),["debug","info","warn","error","metric"].forEach(function(t){i[t]=function(){return this.logger?this.logger.emit?this.logger.emit(t,this._logNamespace,arguments):this.logger[t]?this.logger[t].apply(this.logger,arguments):void 0:void 0}}),t}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(3),i(1)],s=function(t,e){var i=Backbone.View.extend(t.LoggableMixin).extend(t.HiddenUntilActivatedViewMixin).extend({tagName:"div",className:"annotation-display",initialize:function(t){t=t||{},this.tooltipConfig=t.tooltipConfig||{placement:"bottom"},this.listenTo(this.model,"change:annotation",function(){this.render()}),this.hiddenUntilActivated(t.$activator,t)},render:function(){var t=this;return this.$el.html(this._template()),this.$el.find("[title]").tooltip(this.tooltipConfig),this.$annotation().make_text_editable({use_textarea:!0,on_finish:function(e){t.$annotation().text(e),t.model.save({annotation:e},{silent:!0}).fail(function(){t.$annotation().text(t.model.previous("annotation"))})}}),this},_template:function(){var t=this.model.get("annotation");return['<label class="prompt">',e("Annotation"),"</label>",'<div class="annotation" title="',e("Edit annotation"),'">',_.escape(t),"</div>"].join("")},$annotation:function(){return this.$el.find(".annotation")},remove:function(){this.$annotation.off(),this.stopListening(this.model),Backbone.View.prototype.remove.call(this)},toString:function(){return["AnnotationEditor(",this.model+"",")"].join("")}});return{AnnotationEditor:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(3),i(1)],s=function(t,e){var i=Backbone.Model.extend(t.LoggableMixin).extend({initialize:function(){var t=this.attributes.content,e=new BibtexParser(t).entries[0];this.entry=e,this._fields={};var i=e.Fields;for(key in i){var n=i[key],s=key.toLowerCase();this._fields[s]=n}},entryType:function(){return this.entry.EntryType},fields:function(){return this._fields}}),n=Backbone.Collection.extend(t.LoggableMixin).extend({urlRoot:galaxy_config.root+"api",partial:!0,model:i}),s=n.extend({url:function(){return this.urlRoot+"/histories/"+this.history_id+"/citations"}}),a=n.extend({url:function(){return this.urlRoot+"/tools/"+this.tool_id+"/citations"},partial:!1});return{Citation:i,HistoryCitationCollection:s,ToolCitationCollection:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(15),i(35),i(26),i(7),i(3),i(36),i(1)],s=function(t,e,i,n,s,a,o,r){var l=e.DatasetListItemView,c=l.extend({initialize:function(t){l.prototype.initialize.call(this,t),this.hasUser=t.hasUser,this.purgeAllowed=t.purgeAllowed||!1,this.tagsEditorShown=t.tagsEditorShown||!1,this.annotationEditorShown=t.annotationEditorShown||!1},_renderPrimaryActions:function(){var e=l.prototype._renderPrimaryActions.call(this);return this.model.get("state")===t.NOT_VIEWABLE?e:l.prototype._renderPrimaryActions.call(this).concat([this._renderEditButton(),this._renderDeleteButton()])},_renderEditButton:function(){if(this.model.get("state")===t.DISCARDED||!this.model.get("accessible"))return null;var e=this.model.get("purged"),i=this.model.get("deleted"),n={title:r("Edit attributes"),href:this.model.urls.edit,target:this.linkTarget,faIcon:"fa-pencil",classes:"edit-btn"};return i||e?(n.disabled=!0,e?n.title=r("Cannot edit attributes of datasets removed from disk"):i&&(n.title=r("Undelete dataset to edit attributes"))):_.contains([t.UPLOAD,t.NEW],this.model.get("state"))&&(n.disabled=!0,n.title=r("This dataset is not yet editable")),s(n)},_renderDeleteButton:function(){if(!this.model.get("accessible"))return null;var t=this,e=this.model.isDeletedOrPurged();return s({title:r(e?"Dataset is already deleted":"Delete"),disabled:e,faIcon:"fa-times",classes:"delete-btn",onclick:function(){t.$el.find(".icon-btn.delete-btn").trigger("mouseout"),t.model["delete"]()}})},_renderDetails:function(){var e=l.prototype._renderDetails.call(this),i=this.model.get("state");return!this.model.isDeletedOrPurged()&&_.contains([t.OK,t.FAILED_METADATA],i)&&(this._renderTags(e),this._renderAnnotation(e),this._makeDbkeyEditLink(e)),this._setUpBehaviors(e),e},_renderSecondaryActions:function(){var e=l.prototype._renderSecondaryActions.call(this);switch(this.model.get("state")){case t.UPLOAD:case t.NEW:case t.NOT_VIEWABLE:return e;case t.ERROR:return e.unshift(this._renderErrButton()),e.concat([this._renderRerunButton()]);case t.OK:case t.FAILED_METADATA:return e.concat([this._renderRerunButton(),this._renderVisualizationsButton()])}return e.concat([this._renderRerunButton()])},_renderErrButton:function(){return s({title:r("View or report this error"),href:this.model.urls.report_error,classes:"report-error-btn",target:this.linkTarget,faIcon:"fa-bug"})},_renderRerunButton:function(){var t=this.model.get("creating_job");return this.model.get("rerunnable")?s({title:r("Run this job again"),href:this.model.urls.rerun,classes:"rerun-btn",target:this.linkTarget,faIcon:"fa-refresh",onclick:function(e){e.preventDefault();var i=new o.View({job_id:t});i.deferred.execute(function(){Galaxy.app.display(i.$el)})}}):void 0},_renderVisualizationsButton:function(){var t=this.model.get("visualizations");if(this.model.isDeletedOrPurged()||!this.hasUser||!this.model.hasData()||_.isEmpty(t))return null;if(!_.isObject(t[0]))return this.warn("Visualizations have been switched off"),null;var e=$(this.templates.visualizations(t,this));return e.find('[target="galaxy_main"]').attr("target",this.linkTarget),this._addScratchBookFn(e.find(".visualization-link").addBack(".visualization-link")),e},_addScratchBookFn:function(t){t.click(function(t){Galaxy.frame&&Galaxy.frame.active&&(Galaxy.frame.add({title:"Visualization",
type:"url",content:$(this).attr("href")}),t.preventDefault(),t.stopPropagation())})},_renderTags:function(t){if(this.hasUser){var e=this;this.tagsEditor=new i.TagsEditor({model:this.model,el:t.find(".tags-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.tagsEditorShown=!0},onhide:function(){e.tagsEditorShown=!1},$activator:s({title:r("Edit dataset tags"),classes:"tag-btn",faIcon:"fa-tags"}).appendTo(t.find(".actions .right"))}),this.tagsEditorShown&&this.tagsEditor.toggle(!0)}},_renderAnnotation:function(t){if(this.hasUser){var e=this;this.annotationEditor=new n.AnnotationEditor({model:this.model,el:t.find(".annotation-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.annotationEditorShown=!0},onhide:function(){e.annotationEditorShown=!1},$activator:s({title:r("Edit dataset annotation"),classes:"annotate-btn",faIcon:"fa-comment"}).appendTo(t.find(".actions .right"))}),this.annotationEditorShown&&this.annotationEditor.toggle(!0)}},_makeDbkeyEditLink:function(t){if("?"===this.model.get("metadata_dbkey")&&!this.model.isDeletedOrPurged()){var e=$('<a class="value">?</a>').attr("href",this.model.urls.edit).attr("target",this.linkTarget);t.find(".dbkey .value").replaceWith(e)}},events:_.extend(_.clone(l.prototype.events),{"click .undelete-link":"_clickUndeleteLink","click .purge-link":"_clickPurgeLink","click .edit-btn":function(t){this.trigger("edit",this,t)},"click .delete-btn":function(t){this.trigger("delete",this,t)},"click .rerun-btn":function(t){this.trigger("rerun",this,t)},"click .report-err-btn":function(t){this.trigger("report-err",this,t)},"click .visualization-btn":function(t){this.trigger("visualize",this,t)},"click .dbkey a":function(t){this.trigger("edit",this,t)}}),_clickUndeleteLink:function(t){return this.model.undelete(),!1},_clickPurgeLink:function(t){return this.model.purge(),!1},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAEditView("+t+")"}});return c.prototype.templates=function(){var t=_.extend({},l.prototype.templates.warnings,{failed_metadata:a.wrapTemplate(['<% if( dataset.state === "failed_metadata" ){ %>','<div class="failed_metadata-warning warningmessagesmall">',r("An error occurred setting the metadata for this dataset"),'<br /><a href="<%= dataset.urls.edit %>" target="<%= view.linkTarget %>">',r("Set it manually or retry auto-detection"),"</a>","</div>","<% } %>"],"dataset"),deleted:a.wrapTemplate(["<% if( dataset.deleted && !dataset.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',r("This dataset has been deleted"),'<br /><a class="undelete-link" href="javascript:void(0);">',r("Undelete it"),"</a>","<% if( view.purgeAllowed ){ %>",'<br /><a class="purge-link" href="javascript:void(0);">',r("Permanently remove it from disk"),"</a>","<% } %>","</div>","<% } %>"],"dataset")}),e=a.wrapTemplate(["<% if( visualizations.length === 1 ){ %>",'<a class="visualization-btn visualization-link icon-btn" href="<%= visualizations[0].href %>"',' target="<%= visualizations[0].target %>" title="',r("Visualize in"),' <%= visualizations[0].html %>">','<span class="fa fa-bar-chart-o"></span>',"</a>","<% } else { %>",'<div class="visualizations-dropdown dropdown">','<a class="visualization-btn icon-btn" data-toggle="dropdown" title="',r("Visualize"),'">','<span class="fa fa-bar-chart-o"></span>',"</a>",'<ul class="dropdown-menu" role="menu">',"<% _.each( visualizations, function( visualization ){ %>",'<li><a class="visualization-link" href="<%= visualization.href %>"',' target="<%= visualization.target %>">',"<%= visualization.html %>","</a></li>","<% }); %>","</ul>","</div>","<% } %>"],"visualizations");return _.extend({},l.prototype.templates,{warnings:t,visualizations:e})}(),{DatasetListItemEdit:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(3),i(1)],s=function(t,e,i){var n=e.SearchableModelMixin,s=Backbone.Model.extend(e.LoggableMixin).extend(e.mixin(n,{defaults:{state:t.NEW,deleted:!1,purged:!1,name:"(unnamed dataset)",accessible:!0,data_type:"",file_ext:"",file_size:0,meta_files:[],misc_blurb:"",misc_info:"",tags:[]},initialize:function(e,i){this.debug(this+"(Dataset).initialize",e,i),
//!! this state is not in trans.app.model.Dataset.states - set it here -
this.get("accessible")||this.set("state",t.NOT_VIEWABLE),this.urls=this._generateUrls(),this._setUpListeners()},_generateUrls:function(){var t=this.get("id");if(!t)return{};var e={purge:"datasets/"+t+"/purge_async",display:"datasets/"+t+"/display/?preview=True",edit:"datasets/"+t+"/edit",download:"datasets/"+t+"/display?to_ext="+this.get("file_ext"),report_error:"dataset/errors?id="+t,rerun:"tool_runner/rerun?id="+t,show_params:"datasets/"+t+"/show_params",visualization:"visualization",meta_download:"dataset/get_metadata_file?hda_id="+t+"&metadata_name="},i=window.galaxy_config&&galaxy_config.root?galaxy_config.root:"/";return _.each(e,function(t,n){e[n]=i+t}),this.urls=e,e},_setUpListeners:function(){this.on("change:state",function(t,e){this.log(this+" has changed state:",t,e),this.inReadyState()&&this.trigger("state:ready",t,e,this.previous("state"))}),this.on("change:id change:file_ext",function(t){this._generateUrls()})},toJSON:function(){var t=Backbone.Model.prototype.toJSON.call(this);return _.extend(t,{urls:this.urls})},isDeletedOrPurged:function(){return this.get("deleted")||this.get("purged")},inReadyState:function(){var e=_.contains(t.READY_STATES,this.get("state"));return this.isDeletedOrPurged()||e},hasDetails:function(){return _.has(this.attributes,"genome_build")},hasData:function(){return this.get("file_size")>0},fetch:function(t){var e=this;return Backbone.Model.prototype.fetch.call(this,t).always(function(){e._generateUrls()})},"delete":function(t){return this.get("deleted")?jQuery.when():this.save({deleted:!0},t)},undelete:function(t){return!this.get("deleted")||this.get("purged")?jQuery.when():this.save({deleted:!1},t)},purge:function(t){if(this.get("purged"))return jQuery.when();t=t||{},t.url=this.urls.purge;var e=this,n=jQuery.ajax(t);return n.done(function(t,i,n){e.set({deleted:!0,purged:!0})}),n.fail(function(n,s,a){var o=i("Unable to purge dataset"),r="Removal of datasets by users is not allowed in this Galaxy instance";n.responseJSON&&n.responseJSON.error?o=n.responseJSON.error:-1!==n.responseText.indexOf(r)&&(o=r),n.responseText=o,e.trigger("error",e,n,t,i(o),{error:o})}),n},searchAttributes:["name","file_ext","genome_build","misc_blurb","misc_info","annotation","tags"],searchAliases:{title:"name",format:"file_ext",database:"genome_build",blurb:"misc_blurb",description:"misc_blurb",info:"misc_info",tag:"tags"},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t='"'+this.get("name")+'",'+t),"Dataset("+t+")"}})),a=Backbone.Collection.extend(e.LoggableMixin).extend({model:s,urlRoot:(window.galaxy_config&&galaxy_config.root?galaxy_config.root:"/")+"api/datasets",url:function(){return this.urlRoot},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},ajaxQueue:function(t,e){var i=jQuery.Deferred(),n=this.length,s=[];if(!n)return i.resolve([]),i;var a=this.chain().reverse().map(function(o,r){return function(){var l=t.call(o,e);l.done(function(t){i.notify({curr:r,total:n,response:t,model:o})}),l.always(function(t){s.push(t),a.length?a.shift()():i.resolve(s)})}}).value();return a.shift()(),i},matches:function(t){return this.filter(function(e){return e.matches(t)})},toString:function(){return["DatasetAssociationCollection(",this.length,")"].join("")}});return{DatasetAssociation:s,DatasetAssociationCollection:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(15),i(3),i(1)],s=function(t,e,i){var n=t.DatasetListItemView,s=n.extend({className:n.prototype.className+" history-content",initialize:function(t,e){n.prototype.initialize.call(this,t,e)},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAListItemView("+t+")"}});return s.prototype.templates=function(){var t=e.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="hid"><%- dataset.hid %></span> ','<span class="name"><%- dataset.name %></span>',"</div>","</div>"],"dataset"),s=_.extend({},n.prototype.templates.warnings,{hidden:e.wrapTemplate(["<% if( !dataset.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',i("This dataset has been hidden"),"</div>","<% } %>"],"dataset")});return _.extend({},n.prototype.templates,{titleBar:t,warnings:s})}(),{HDAListItemView:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(29),i(17),i(3),i(1)],s=function(t,e,i,n){var s=t.DatasetAssociation,a=e.HistoryContentMixin,o=s.extend(i.mixin(a,{constructor:function(t,e){a.constructor.call(this,t,e)},defaults:_.extend({},s.prototype.defaults,a.defaults,{model_class:"HistoryDatasetAssociation"}),initialize:function(t,e){s.prototype.initialize.call(this,t,e),a.initialize.call(this,t,e)},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t=this.get("hid")+' :"'+this.get("name")+'",'+t),"HDA("+t+")"}}));return{HistoryDatasetAssociation:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(6),i(12),i(10),i(3),i(1)],s=function(t,e,i,n,s){var a=e.DCListItemView,o=a.extend({className:a.prototype.className+" history-content",_setUpListeners:function(){a.prototype._setUpListeners.call(this),this.model.on({"change:populated change:visible":function(t,e){this.render()}},this)},_getFoldoutPanelClass:function(){switch(this.model.get("collection_type")){case"list":return i.ListCollectionPanel;case"paired":return i.PairCollectionPanel;case"list:paired":return i.ListOfPairsCollectionPanel}throw new TypeError("Uknown collection_type: "+this.model.get("collection_type"))},_swapNewRender:function(e){a.prototype._swapNewRender.call(this,e);var i=this.model.get("populated")?t.OK:t.RUNNING;return this.$el.addClass("state-"+i),this.$el},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDCAListItemView("+t+")"}});return o.prototype.templates=function(){var t=_.extend({},a.prototype.templates.warnings,{hidden:n.wrapTemplate(["<% if( !collection.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',s("This collection has been hidden"),"</div>","<% } %>"],"collection")}),e=n.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="hid"><%- collection.hid %></span> ','<span class="name"><%- collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection");return _.extend({},a.prototype.templates,{warnings:t,titleBar:e})}(),{HDCAListItemView:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(18),i(2),i(3),i(1)],s=function(t,e,i,n){var s=Backbone.Model.extend(i.LoggableMixin).extend(i.mixin(i.SearchableModelMixin,{defaults:{model_class:"History",id:null,name:"Unnamed History",state:"new",diskSize:0,deleted:!1},urlRoot:galaxy_config.root+"api/histories",initialize:function(e,i,n){n=n||{},this.logger=n.logger||null,this.log(this+".initialize:",e,i,n),this.log("creating history contents:",i),this.contents=new t.HistoryContents(i||[],{historyId:this.get("id")}),this._setUpListeners(),this.updateTimeoutId=null},_setUpListeners:function(){this.on("error",function(t,e,i,n,s){this.errorHandler(t,e,i,n,s)}),this.contents&&this.listenTo(this.contents,"error",function(){this.trigger.apply(this,["error:contents"].concat(jQuery.makeArray(arguments)))}),this.on("change:id",function(t,e){this.contents&&(this.contents.historyId=e)},this)},errorHandler:function(t,e,i,n,s){this.clearUpdateTimeout()},nice_size:function(){return e.bytesToString(this.get("size"),!0,2)},toJSON:function(){return _.extend(Backbone.Model.prototype.toJSON.call(this),{nice_size:this.nice_size()})},get:function(t){return"nice_size"===t?this.nice_size():Backbone.Model.prototype.get.apply(this,arguments)},ownedByCurrUser:function(){return Galaxy&&Galaxy.currUser?Galaxy.currUser.isAnonymous()||Galaxy.currUser.id!==this.get("user_id")?!1:!0:!1},contentsCount:function(){return _.reduce(_.values(this.get("state_details")),function(t,e){return t+e},0)},searchAttributes:["name","annotation","tags"],searchAliases:{title:"name",tag:"tags"},checkForUpdates:function(t){return this.contents.running().length?this.setUpdateTimeout():(this.trigger("ready"),_.isFunction(t)&&t.call(this)),this},setUpdateTimeout:function(t){t=t||s.UPDATE_DELAY;var e=this;return this.clearUpdateTimeout(),this.updateTimeoutId=setTimeout(function(){e.refresh()},t),this.updateTimeoutId},clearUpdateTimeout:function(){this.updateTimeoutId&&(clearTimeout(this.updateTimeoutId),this.updateTimeoutId=null)},refresh:function(t,e){t=t||[],e=e||{};var i=this;e.data=e.data||{},t.length&&(e.data.details=t.join(","));var n=this.contents.fetch(e);return n.done(function(t){i.checkForUpdates(function(){this.fetch()})}),n},_delete:function(t){return this.get("deleted")?jQuery.when():this.save({deleted:!0},t)},purge:function(t){return this.get("purged")?jQuery.when():this.save({deleted:!0,purged:!0},t)},undelete:function(t){return this.get("deleted")?this.save({deleted:!1},t):jQuery.when()},copy:function(t,e,i){if(t=void 0!==t?t:!0,!this.id)throw new Error("You must set the history ID before copying it.");var n={history_id:this.id};t&&(n.current=!0),e&&(n.name=e),i||(n.all_datasets=!1);var a=this,o=jQuery.post(this.urlRoot,n);return t?o.then(function(t){var e=new s(t);return e.setAsCurrent().done(function(){a.trigger("copied",a,t)})}):o.done(function(t){a.trigger("copied",a,t)})},setAsCurrent:function(){var t=this,e=jQuery.getJSON(galaxy_config.root+"history/set_as_current?id="+this.id);return e.done(function(){t.trigger("set-as-current",t)}),e},toString:function(){return"History("+this.get("id")+","+this.get("name")+")"}}));s.UPDATE_DELAY=4e3,s.getHistoryData=function(t,e){function i(e){return"current"===t?jQuery.getJSON(galaxy_config.root+"history/current_history_json"):jQuery.ajax(galaxy_config.root+"api/histories/"+t)}function n(t){return t&&t.empty}function s(t){if(n(t))return[];_.isFunction(a)&&(a=a(t)),_.isFunction(o)&&(o=o(t));var e={};return a.length&&(e.dataset_details=a.join(",")),o.length&&(e.dataset_collection_details=o.join(",")),jQuery.ajax(galaxy_config.root+"api/histories/"+t.id+"/contents",{data:e})}e=e||{};var a=e.detailIdsFn||[],o=e.hdcaDetailIds||[],r=jQuery.Deferred(),l=null,c=e.historyFn||i,d=e.contentsFn||s,h=c(t);h.done(function(t){l=t,r.notify({status:"history data retrieved",historyJSON:l})}),h.fail(function(t,e,i){r.reject(t,"loading the history")});var u=h.then(d);return u.then(function(t){r.notify({status:"contents data retrieved",historyJSON:l,contentsJSON:t}),r.resolve(l,t)}),u.fail(function(t,e,i){r.reject(t,"loading the contents",{history:l})}),r};var a={fetch:function(t){return t=t||{},t.data=t.data||this._buildFetchData(t),t.traditional=!0,Backbone.Collection.prototype.fetch.call(this,t)},_fetchOptions:["order","limit","offset","view","keys"],_buildFetchData:function(t){var e={},i=this._fetchDefaults();t=_.defaults(t||{},i),e=_.pick(t,this._fetchOptions);var n=_.has(t,"filters")?t.filters:i.filters||{};return _.isEmpty(n)||_.extend(e,this._buildFetchFilters(n)),e},_fetchDefaults:function(){return{}},_buildFetchFilters:function(t){var e={q:[],qv:[]};return _.each(t,function(t,i){t===!0&&(t="True"),t===!1&&(t="False"),e.q.push(i),e.qv.push(t)}),e}},o=Backbone.Collection.extend(i.LoggableMixin).extend(a).extend({model:s,DEFAULT_ORDER:"update_time",sortOrders:{update_time:{getter:function(t){return new Date(t.get("update_time"))},asc:!1},"update_time-asc":{getter:function(t){return new Date(t.get("update_time"))},asc:!0},name:{getter:function(t){return t.get("name")},asc:!0},"name-dsc":{getter:function(t){return t.get("name")},asc:!1},size:{getter:function(t){return t.get("size")},asc:!1},"size-asc":{getter:function(t){return t.get("size")},asc:!0}},initialize:function(t,e){e=e||{},this.log("HistoryCollection.initialize",arguments),this.includeDeleted=e.includeDeleted||!1,this.setOrder(e.order||this.DEFAULT_ORDER),this.currentHistoryId=e.currentHistoryId,this.allFetched=e.allFetched||!1,this.setUpListeners()},urlRoot:(window.galaxy_config?galaxy_config.root:"/")+"api/histories",url:function(){return this.urlRoot},_fetchDefaults:function(){var t={order:this.order,view:"detailed"};return this.includeDeleted||(t.filters={deleted:!1,purged:!1}),t},setUpListeners:function(){this.on({"change:deleted":function(t){this.debug("change:deleted",this.includeDeleted,t.get("deleted")),!this.includeDeleted&&t.get("deleted")&&this.remove(t)},copied:function(t,e){this.setCurrent(new s(e,[]))},"set-as-current":function(t){var e=this.currentHistoryId;this.trigger("no-longer-current",e),this.currentHistoryId=t.id}},this)},sort:function(t){return t=t||{},this.setOrder(t.order),Backbone.Collection.prototype.sort.call(this,t)},setOrder:function(t){var e=this,i=this.sortOrders[t];if(!_.isUndefined(i))return e.order=t,e.comparator=function(t,n){var s=e.currentHistoryId;return t.id===s?-1:n.id===s?1:(t=i.getter(t),n=i.getter(n),i.asc?t===n?0:t>n?1:-1:t===n?0:t>n?-1:1)},e.trigger("changed-order",e.order,e),e},fetch:function(t){if(t=t||{},this.allFetched)return jQuery.when({});var e=this,i=_.defaults(t,{remove:!1,offset:e.length>=1?e.length-1:0,order:e.order}),n=t.limit;return _.isUndefined(n)||(i.limit=n),a.fetch.call(this,i).done(function(t){var i=_.isArray(t)?t.length:0;(!n||n>i)&&(e.allFetched=!0,e.trigger("all-fetched",e))})},create:function(t,e,i,n){var a=this,o=jQuery.getJSON(galaxy_config.root+"history/create_new_current");return o.done(function(t){a.setCurrent(new s(t,[],i||{}))})},setCurrent:function(t,e){return e=e||{},this.unshift(t,e),this.currentHistoryId=t.get("id"),e.silent||this.trigger("new-current",t,this),this},reset:function(t,e){return this.allFetched=!1,Backbone.Collection.prototype.reset.call(this,t,e)},toString:function(){return"HistoryCollection("+this.length+")"}});return{History:s,HistoryCollection:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(19),i(79),i(3),i(1),i(41)],s=function(t,e,i,n){var s=Backbone.View.extend(i.LoggableMixin).extend({viewClass:t.ListItemView,collectionClass:Backbone.Collection,tagName:"div",className:"list-panel",fxSpeed:"fast",emptyMsg:n("This list is empty"),noneFoundMsg:n("No matching items found"),searchPlaceholder:n("search"),initialize:function(t,i){t=t||{},t.logger&&(this.logger=t.logger),this.log(this+".initialize:",t),this.fxSpeed=_.has(t,"fxSpeed")?t.fxSpeed:this.fxSpeed,this.filters=[],this.searchFor=t.searchFor||"",this.indicator=new e(this.$el),this.selecting=void 0!==t.selecting?t.selecting:!0,this.selected=t.selected||[],this.lastSelected=null,this.dragItems=t.dragItems||!1,this.viewClass=t.viewClass||this.viewClass,this.views=[],this.collection=t.collection||new this.collectionClass([]),this.filters=t.filters||[],this.$scrollContainer=t.$scrollContainer||this.$scrollContainer,this.title=t.title||"",this.subtitle=t.subtitle||"",this._setUpListeners()},freeViews:function(){return _.each(this.views,function(t){t.off()}),this.views=[],this},_setUpListeners:function(){return this.off(),this.on("error",function(t,e,i,n,s){console.error(t,e,i,n,s)},this),this.on("loading",function(){this._showLoadingIndicator("loading...",40)},this),this.on("loading-done",function(){this._hideLoadingIndicator(40)},this),this.once("rendered",function(){this.trigger("rendered:initial",this)},this),this.logger&&this.on("all",function(t){this.log(this+"",arguments)},this),this._setUpCollectionListeners(),this._setUpViewListeners(),this},_setUpCollectionListeners:function(){return this.log(this+"._setUpCollectionListeners",this.collection),this.collection.off(),this.collection.on("error",function(t,e,i,n,s){this.trigger("error",t,e,i,n,s)},this),this.collection.on("reset",function(){this.renderItems()},this),this.collection.on("add",this.addItemView,this),this.collection.on("remove",this.removeItemView,this),this.logger&&this.collection.on("all",function(t){this.info(this+"(collection)",arguments)},this),this},_setUpViewListeners:function(){this.log(this+"._setUpViewListeners"),this.on("view:selected",function(t,e){if(e&&e.shiftKey&&this.lastSelected){var i=this.viewFromModelId(this.lastSelected);i&&this.selectRange(t,i)}else e&&e.altKey&&!this.selecting&&this.showSelectors();this.selected.push(t.model.id),this.lastSelected=t.model.id},this),this.on("view:de-selected",function(t,e){this.selected=_.without(this.selected,t.model.id)},this)},render:function(t){this.log(this+".render",t);var e=this._buildNewRender();return this._setUpBehaviors(e),this._queueNewRender(e,t),this},_buildNewRender:function(){this.debug(this+"(ListPanel)._buildNewRender");var t=$(this.templates.el({},this));return this._renderControls(t),this._renderTitle(t),this._renderSubtitle(t),this._renderSearch(t),this.renderItems(t),t},_renderControls:function(t){this.debug(this+"(ListPanel)._renderControls");var e=$(this.templates.controls({},this));return t.find(".controls").replaceWith(e),e},_renderTitle:function(t){},_renderSubtitle:function(t){},_queueNewRender:function(t,e){e=void 0===e?this.fxSpeed:e;var i=this;i.log("_queueNewRender:",t,e),$(i).queue("fx",[function(t){this.$el.fadeOut(e,t)},function(e){i._swapNewRender(t),e()},function(t){this.$el.fadeIn(e,t)},function(t){i.trigger("rendered",i),t()}])},_swapNewRender:function(t){return this.$el.empty().attr("class",this.className).append(t.children()),this.selecting&&this.showSelectors(0),this},_setUpBehaviors:function(t){return t=t||this.$el,t.find(".controls [title]").tooltip({placement:"bottom"}),this._renderMultiselectActionMenu(t),this},_renderMultiselectActionMenu:function(t){t=t||this.$el;var e=t.find(".list-action-menu"),i=this.multiselectActions();if(!i.length)return e.empty();var s=$(['<div class="list-action-menu btn-group">','<button class="list-action-menu-btn btn btn-default dropdown-toggle" data-toggle="dropdown">',n("For all selected"),"...","</button>",'<ul class="dropdown-menu pull-right" role="menu">',"</ul>","</div>"].join("")),a=i.map(function(t){var e=['<li><a href="javascript:void(0);">',t.html,"</a></li>"].join("");return $(e).click(function(e){return e.preventDefault(),t.func(e)})});return s.find("ul").append(a),e.replaceWith(s),s},multiselectActions:function(){return[]},$scrollContainer:function(){return this.$el.parent().parent()},$list:function(t){return(t||this.$el).find("> .list-items")},$messages:function(t){return(t||this.$el).find("> .controls .messages")},$emptyMessage:function(t){return(t||this.$el).find("> .empty-message")},renderItems:function(t){t=t||this.$el;var e=this;e.log(this+".renderItems",t);var i=e.$list(t);return e.views=e._filterCollection().map(function(t){return e._createItemView(t).render(0)}),i.empty(),e.views.length?(e._attachItems(t),e.$emptyMessage(t).hide()):e._renderEmptyMessage(t).show(),e.trigger("views:ready",e.views),e.views},_filterCollection:function(){var t=this;return t.collection.filter(_.bind(t._filterItem,t))},_filterItem:function(t){var e=this;return _.every(e.filters.map(function(e){return e.call(t)}))&&(!e.searchFor||t.matchesAll(e.searchFor))},_createItemView:function(t){var e=this._getItemViewClass(t),i=_.extend(this._getItemViewOptions(t),{model:t}),n=new e(i);return this._setUpItemViewListeners(n),n},_getItemViewClass:function(t){return this.viewClass},_getItemViewOptions:function(t){return{fxSpeed:this.fxSpeed,expanded:!1,selectable:this.selecting,selected:_.contains(this.selected,t.id),draggable:this.dragItems}},_setUpItemViewListeners:function(t){var e=this;return t.on("all",function(){var t=Array.prototype.slice.call(arguments,0);t[0]="view:"+t[0],e.trigger.apply(e,t)}),t.on("draggable:dragstart",function(t,e){var i={},n=this.getSelectedModels();i=n.length?n.toJSON():[e.model.toJSON()],t.dataTransfer.setData("text",JSON.stringify(i))},this),e},_attachItems:function(t){return this.$list(t).append(this.views.map(function(t){return t.$el})),this},_renderEmptyMessage:function(t){this.debug("_renderEmptyMessage",t,this.searchFor);var e=this.searchFor?this.noneFoundMsg:this.emptyMsg;return this.$emptyMessage(t).text(e)},expandAll:function(){_.each(this.views,function(t){t.expand()})},collapseAll:function(){_.each(this.views,function(t){t.collapse()})},addItemView:function(t,e,i){this.log(this+".addItemView:",t);var n=this;if(!n._filterItem(t))return void 0;var s=n._createItemView(t);return $(s).queue("fx",[function(t){n.$emptyMessage().fadeOut(n.fxSpeed,t)},function(t){n._attachView(s),t()}]),s},_attachView:function(t){var e=this;e.views.push(t),e.$list().append(t.render(0).$el.hide()),e.trigger("view:attached",t),t.$el.slideDown(e.fxSpeed,function(){e.trigger("view:attached:rendered")})},removeItemView:function(t,e,i){this.log(this+".removeItemView:",t);var n=this,s=n.viewFromModel(t);return s?(n.views=_.without(n.views,s),n.trigger("view:removed",s),$({}).queue("fx",[function(t){s.$el.fadeOut(n.fxSpeed,t)},function(t){s.remove(),n.trigger("view:removed:rendered"),n.views.length?t():n._renderEmptyMessage().fadeIn(n.fxSpeed,t)}]),s):void 0},viewFromModelId:function(t){for(var e=0;e<this.views.length;e++)if(this.views[e].model.id===t)return this.views[e];return void 0},viewFromModel:function(t){return t?this.viewFromModelId(t.id):void 0},viewsWhereModel:function(t){return this.views.filter(function(e){var i=e.model.toJSON();for(var n in t)if(t.hasOwnProperty(n)&&i[n]!==e.model.get(n))return!1;return!0})},viewRange:function(t,e){if(t===e)return t?[t]:[];var i=this.views.indexOf(t),n=this.views.indexOf(e);return-1===i||-1===n?i===n?[]:-1===i?[e]:[t]:n>i?this.views.slice(i,n+1):this.views.slice(n,i+1)},_renderSearch:function(t){return t.find(".controls .search-input").searchInput({placeholder:this.searchPlaceholder,initialVal:this.searchFor,onfirstsearch:_.bind(this._firstSearch,this),onsearch:_.bind(this.searchItems,this),onclear:_.bind(this.clearSearch,this)}),t},_firstSearch:function(t){return this.log("onFirstSearch",t),this.searchItems(t)},searchItems:function(t){return this.searchFor=t,this.trigger("search:searching",t,this),this.renderItems(),this.$("> .controls .search-query").val(t),this},clearSearch:function(t){return this.searchFor="",this.trigger("search:clear",this),this.$("> .controls .search-query").val(""),this.renderItems(),this},showSelectors:function(t){t=void 0!==t?t:this.fxSpeed,this.selecting=!0,this.$(".list-actions").slideDown(t),_.each(this.views,function(e){e.showSelector(t)})},hideSelectors:function(t){t=void 0!==t?t:this.fxSpeed,this.selecting=!1,this.$(".list-actions").slideUp(t),_.each(this.views,function(e){e.hideSelector(t)}),this.selected=[],this.lastSelected=null},toggleSelectors:function(){this.selecting?this.hideSelectors():this.showSelectors()},selectAll:function(t){_.each(this.views,function(e){e.select(t)})},deselectAll:function(t){this.lastSelected=null,_.each(this.views,function(e){e.deselect(t)})},selectRange:function(t,e){var i=this.viewRange(t,e);return _.each(i,function(t){t.select()}),i},getSelectedViews:function(){return _.filter(this.views,function(t){return t.selected})},getSelectedModels:function(){return new this.collection.constructor(_.map(this.getSelectedViews(),function(t){return t.model}))},_showLoadingIndicator:function(t,i,n){this.debug("_showLoadingIndicator",this.indicator,t,i,n),i=void 0!==i?i:this.fxSpeed,this.indicator||(this.indicator=new e(this.$el,this.$el.parent()),this.debug("	 created",this.indicator)),this.$el.is(":visible")?(this.$el.fadeOut(i),this.indicator.show(t,i,n)):this.indicator.show(0,n)},_hideLoadingIndicator:function(t,e){this.debug("_hideLoadingIndicator",this.indicator,t,e),t=void 0!==t?t:this.fxSpeed,this.indicator&&this.indicator.hide(t,e)},scrollPosition:function(){return this.$scrollContainer().scrollTop()},scrollTo:function(t,e){return e=e||0,this.$scrollContainer().animate({scrollTop:t},e),this},scrollToTop:function(t){return this.scrollTo(0,t)},scrollToItem:function(t,e){if(!t)return this;var i=t.$el.position().top;return this.scrollTo(i,e)},scrollToId:function(t,e){return this.scrollToItem(this.viewFromModelId(t),e)},events:{"click .select-all":"selectAll","click .deselect-all":"deselectAll"},toString:function(){return"ListPanel("+this.collection+")"}});s.prototype.templates=function(){var t=i.wrapTemplate(["<div>",'<div class="controls"></div>','<div class="list-items"></div>','<div class="empty-message infomessagesmall"></div>',"</div>"]),e=i.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%= view.title %></div>',"</div>",'<div class="subtitle"><%= view.subtitle %></div>','<div class="actions"></div>','<div class="messages"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',n("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',n("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"]);return{el:t,controls:e}}();var a=s.extend({modelCollectionKey:"contents",initialize:function(t){s.prototype.initialize.call(this,t),this.selecting=void 0!==t.selecting?t.selecting:!1,this.setModel(this.model,t)},setModel:function(t,e){if(e=e||{},this.debug(this+".setModel:",t,e),this.freeModel(),this.freeViews(),t){var i=this.model?this.model.get("id"):null;this.model=t,this.logger&&(this.model.logger=this.logger),this._setUpModelListeners(),this.collection.off(),this.collection=this.model[this.modelCollectionKey]?this.model[this.modelCollectionKey]:e.collection||new this.collectionClass([]),this._setUpCollectionListeners(),i&&t.get("id")!==i&&this.trigger("new-model",this)}return this},freeModel:function(){return this.model&&this.stopListening(this.model),this},_setUpModelListeners:function(){return this.log(this+"._setUpModelListeners",this.model),this.model.on("error",function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("error"),this.trigger.apply(this,t)},this),this},_renderControls:function(t){this.debug(this+"(ListPanel)._renderControls");var e=this.model?this.model.toJSON():{},i=$(this.templates.controls(e,this));return t.find(".controls").replaceWith(i),i},toString:function(){return"ModelListPanel("+this.model+")"}});return a.prototype.templates=function(){var t=i.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%= model.name %></div>',"</div>",'<div class="subtitle"><%= view.subtitle %></div>','<div class="actions"></div>','<div class="messages"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',n("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',n("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"]);return _.extend(_.clone(s.prototype.templates),{controls:t})}(),{ListPanel:s,ModelListPanel:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(3),i(1)],s=function(t,e){var i=Backbone.View.extend(t.LoggableMixin).extend(t.HiddenUntilActivatedViewMixin).extend({tagName:"div",className:"tags-display",initialize:function(t){this.listenTo(this.model,"change:tags",function(){this.render()}),this.hiddenUntilActivated(t.$activator,t)},render:function(){var t=this;return this.$el.html(this._template()),this.$input().select2({placeholder:"Add tags",width:"100%",tags:function(){return t._getTagsUsed()}}),this._setUpBehaviors(),this},_template:function(){return['<label class="prompt">',e("Tags"),"</label>",'<input class="tags-input" value="',this.tagsToCSV(),'" />'].join("")},tagsToCSV:function(){var t=this.model.get("tags");return!_.isArray(t)||_.isEmpty(t)?"":t.map(function(t){return _.escape(t)}).sort().join(",")},$input:function(){return this.$el.find("input.tags-input")},_getTagsUsed:function(){return Galaxy.currUser.get("tags_used")},_setUpBehaviors:function(){var t=this;this.$input().on("change",function(e){t.model.save({tags:e.val},{silent:!0}),e.added&&t._addNewTagToTagsUsed(e.added.text+"")})},_addNewTagToTagsUsed:function(t){var e=Galaxy.currUser.get("tags_used");_.contains(e,t)||(e.push(t),e.sort(),Galaxy.currUser.set("tags_used",e))},remove:function(){this.$input.off(),this.stopListening(this.model),Backbone.View.prototype.remove.call(this)},toString:function(){return["TagsEditor(",this.model+"",")"].join("")}});return{TagsEditor:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(4),i(70),i(71)],s=function(t,e,i,n){var s=i.extend({initialize:function(s){var a=this;i.prototype.initialize.call(this,t.merge({customize:function(t){t.buttons={execute:execute_btn=new e.Button({icon:"fa-check",tooltip:"Execute: "+t.name+" ("+t.version+")",title:"Execute",cls:"btn btn-primary",floating:"clear",onclick:function(){execute_btn.wait(),a.form.portlet.disable(),n.submit(a.form,t,function(){execute_btn.unwait(),a.form.portlet.enable()})}})},t.job_id&&t.job_remap&&(t.inputs.rerun_remap_job_id={label:"Resume dependencies from this job",name:"rerun_remap_job_id",type:"select",display:"radio",ignore:"__ignore__",value:"__ignore__",options:[["Yes",t.job_id],["No","__ignore__"]],help:"The previous run of this tool failed and other tools were waiting for it to finish successfully. Use this option to resume those tools using the new output(s) of this tool run."})}},s))}});return{View:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(8),i(4)],s=function(t,e,i){var n=Backbone.View.extend({initialize:function(t){var n=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new i.Message({cls:"ui-margin-top"}),this.portlet=new e.View({cls:"ui-portlet-section"}),this.select=new i.Select.View({optional:t.optional}),this.button=new i.ButtonIcon({icon:"fa fa-sign-in",floating:"left",tooltip:"Insert new "+this.name,onclick:function(){n.add({id:n.select.value(),name:n.select.text()})}}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-portlet").append(this.portlet.$el),this.$(".ui-list-button").append(this.button.$el),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.portlet.empty(),$.isArray(t))for(var e in t){var i=t[e],n=null,s=null;"string"!=$.type(i)?(n=i.id,s=i.name):n=s=i,null!=n&&this.add({id:n,name:s})}this._refresh()}var a=[];return this.$(".ui-list-id").each(function(){a.push({id:$(this).prop("id"),name:$(this).find(".ui-list-name").html()})}),0==a.length?null:a},add:function(e){var i=this;if(0===this.$('[id="'+e.id+'"]').length)if(t.validate(e.id)){var n=$(this._templateRow({id:e.id,name:e.name}));n.on("click",function(){n.remove(),i._refresh()}),n.on("mouseover",function(){n.addClass("portlet-highlight")}),n.on("mouseout",function(){n.removeClass("portlet-highlight")}),this.portlet.append(n),this._refresh()}else this.message.update({message:"Please select a valid "+this.name+".",status:"danger"});else this.message.update({message:"This "+this.name+" is already in the list."})},update:function(t){this.select.update(t)},_refresh:function(){this.$(".ui-list-id").length>0?(!this.multiple&&this.button.disable(),this.$(".ui-list-portlet").show()):(this.button.enable(),this.$(".ui-list-portlet").hide()),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list"><div class="ui-margin-top"><span class="ui-list-button"/><span class="ui-list-select"/></div><div class="ui-list-message"/><div class="ui-list-portlet"/></div>'},_templateRow:function(t){return'<div id="'+t.id+'" class="ui-list-id"><span class="ui-list-delete fa fa-trash"/><span class="ui-list-name">'+t.name+"</span></div>"}});return{View:n}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(21)],s=function(t,e){var i=Backbone.View.extend({initialize:function(i){var n=this;this.options=t.merge(i,{
visible:!0,data:[],id:t.uid(),error_text:"No options available.",wait_text:"Please wait...",multiple:!1}),this.setElement('<div class="ui-options"/>'),this.$message=$("<div/>"),this.$options=$(this._template(i)),this.$menu=$('<div class="ui-options-menu"/>'),this.$el.append(this.$message),this.$el.append(this.$menu),this.$el.append(this.$options),this.options.multiple&&(this.all_button=new e.ButtonCheck({onclick:function(){n.$("input").prop("checked",0!==n.all_button.value()),n.trigger("change")}}),this.$menu.append(this.all_button.$el)),this.options.visible||this.$el.hide(),this.update(this.options.data),void 0!==this.options.value&&this.value(this.options.value),this.on("change",function(){this.options.onchange&&this.options.onchange(this.value())})},update:function(t){var e=this._getValue();if(this.$options.empty(),this._templateOptions)this.$options.append(this._templateOptions(t));else for(var i in t){var n=$(this._templateOption(t[i]));n.addClass("ui-option"),n.tooltip({title:t[i].tooltip,placement:"bottom"}),this.$options.append(n)}var s=this;this.$("input").on("change",function(){s.value(s._getValue()),s.trigger("change")}),this.value(e),this.unwait()},value:function(t){if(void 0!==t&&(this.$("input").prop("checked",!1),null!==t)){t instanceof Array||(t=[t]);for(var e in t)this.$('input[value="'+t[e]+'"]').first().prop("checked",!0)}var i=this._getValue();if(this.all_button){var n=i;n=n instanceof Array?n.length:0,this.all_button.value(n,this._size())}return i},exists:function(t){if(void 0!==t){t instanceof Array||(t=[t]);for(var e in t)if(this.$('input[value="'+t[e]+'"]').length>0)return!0}return!1},first:function(){var t=this.$("input").first();return t.length>0?t.val():null},wait:function(){0==this._size()&&(this._messageShow(this.options.wait_text,"info"),this.$options.hide(),this.$menu.hide())},unwait:function(){var t=this._size();0==t?(this._messageShow(this.options.error_text,"danger"),this.$options.hide(),this.$menu.hide()):(this._messageHide(),this.$options.css("display","inline-block"),this.$menu.show())},_getValue:function(){var e=[];return this.$(":checked").each(function(){e.push($(this).val())}),t.validate(e)?this.options.multiple?e:e[0]:null},_size:function(){return this.$(".ui-option").length},_messageShow:function(t,e){this.$message.show(),this.$message.removeClass(),this.$message.addClass("ui-message alert alert-"+e),this.$message.html(t)},_messageHide:function(){this.$message.hide()},_template:function(){return'<div class="ui-options-list"/>'}}),n=i.extend({_templateOption:function(e){var i=t.uid();return'<div class="ui-option"><input id="'+i+'" type="'+this.options.type+'" name="'+this.options.id+'" value="'+e.value+'"/><label class="ui-options-label" for="'+i+'">'+e.label+"</label></div>"}}),s={};s.View=n.extend({initialize:function(t){t.type="radio",n.prototype.initialize.call(this,t)}});var a={};a.View=n.extend({initialize:function(t){t.multiple=!0,t.type="checkbox",n.prototype.initialize.call(this,t)}});var o={};return o.View=i.extend({initialize:function(t){i.prototype.initialize.call(this,t)},value:function(t){return void 0!==t&&(this.$("input").prop("checked",!1),this.$("label").removeClass("active"),this.$('[value="'+t+'"]').prop("checked",!0).closest("label").addClass("active")),this._getValue()},_templateOption:function(t){var e="fa "+t.icon;t.label||(e+=" no-padding");var i='<label class="btn btn-default">';return t.icon&&(i+='<i class="'+e+'"/>'),i+='<input type="radio" name="'+this.options.id+'" value="'+t.value+'"/>',t.label&&(i+=t.label),i+="</label>"},_template:function(){return'<div class="btn-group ui-radiobutton" data-toggle="buttons"/>'}}),{Base:i,BaseIcons:n,Radio:s,RadioButton:o,Checkbox:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(5),i(9),i(3),i(1)],s=function(t,e,i,n){var s=e.Model.extend(i.LoggableMixin).extend({urlRoot:function(){return Galaxy.options.root+"api/users"},defaults:{id:null,username:"("+n("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(t){this.log("User.initialize:",t),this.on("loaded",function(t,e){this.log(this+" has loaded:",t,e)}),this.on("change",function(t,e){this.log(this+" has changed:",t,e.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(t,i){t=t||s.CURRENT_ID_STR,i=i||{};var n=this,a=i.success;return i.success=function(t,e){n.trigger("loaded",t,e),a&&a(t,e)},t===s.CURRENT_ID_STR&&(i.url=this.urlRoot+"/"+s.CURRENT_ID_STR),e.Model.prototype.fetch.call(this,i)},clearSessionStorage:function(){for(var t in sessionStorage)0===t.indexOf("history:")?sessionStorage.removeItem(t):"history-panel"===t&&sessionStorage.removeItem(t)},toString:function(){var t=[this.get("username")];return this.get("id")&&(t.unshift(this.get("id")),t.push(this.get("email"))),"User("+t.join(":")+")"}});s.CURRENT_ID_STR="current",s.getCurrentUserFromApi=function(t){var e=new s;return e.loadFromApi(s.CURRENT_ID_STR,t),e};e.Collection.extend(i.LoggableMixin).extend({model:s,urlRoot:function(){return Galaxy.options.root+"api/users"}});return{User:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s,a;!function(i){s=[],n=i,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(function(){jQuery.fn.extend({hoverhighlight:function(t,e){return t=t||"body",this.size()?($(this).each(function(){var i=$(this),n=i.data("target");n&&i.mouseover(function(i){$(n,t).css({background:e})}).mouseout(function(t){$(n).css({background:""})})}),this):this}})})},function(t,e,i){var n,s,a;!function(i){s=[],n=i,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(function(){function t(t,i){function n(t){var e=$(this).parent().children("input");e.focus().val("").trigger("clear:searchInput"),i.onclear()}function s(t,e){$(this).trigger("search:searchInput",e),"function"==typeof i.onfirstsearch&&p?(p=!1,i.onfirstsearch(e)):i.onsearch(e)}function a(){return['<input type="text" name="',i.name,'" placeholder="',i.placeholder,'" ','class="search-query ',i.classes,'" ',"/>"].join("")}function o(){return $(a()).focus(function(t){$(this).select()}).keyup(function(t){if(t.preventDefault(),t.stopPropagation(),$(this).val()||$(this).blur(),t.which===d&&i.escWillClear)n.call(this,t);else{var e=$(this).val();t.which===h||i.minSearchLen&&e.length>=i.minSearchLen?s.call(this,t,e):e.length||n.call(this,t)}}).on("change",function(t){s.call(this,t,$(this).val())}).val(i.initialVal)}function r(){return $(['<span class="search-clear fa fa-times-circle" ','title="',e("clear search (esc)"),'"></span>'].join("")).tooltip({placement:"bottom"}).click(function(t){n.call(this,t)})}function l(){return $(['<span class="search-loading fa fa-spinner fa-spin" ','title="',e("loading..."),'"></span>'].join("")).hide().tooltip({placement:"bottom"})}function c(){u.find(".search-loading").toggle(),u.find(".search-clear").toggle()}var d=27,h=13,u=$(t),p=!0,f={initialVal:"",name:"search",placeholder:"search",classes:"",onclear:function(){},onfirstsearch:null,onsearch:function(t){},minSearchLen:0,escWillClear:!0,oninit:function(){}};return"string"===jQuery.type(i)?("toggle-loading"===i&&c(),u):("object"===jQuery.type(i)&&(i=jQuery.extend(!0,{},f,i)),u.addClass("search-input").prepend([o(),r(),l()]))}var e=window._l||function(t){return t};jQuery.fn.extend({searchInput:function(e){return this.each(function(){return t(this,e)})}})})},function(t,e,i){var n,s;n=[],s=function(){function t(t,e){var i=/(-?[0-9\.]+)/g,n=t.toString().toLowerCase()||"",s=e.toString().toLowerCase()||"",a=String.fromCharCode(0),o=n.replace(i,a+"$1"+a).split(a),r=s.replace(i,a+"$1"+a).split(a),l=new Date(n).getTime(),c=l?new Date(s).getTime():null;if(c){if(c>l)return-1;if(l>c)return 1}for(var d,h,u=0,p=Math.max(o.length,r.length);p>u;u++){if(d=parseFloat(o[u])||o[u],h=parseFloat(r[u])||r[u],h>d)return-1;if(d>h)return 1}return 0}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},,,,function(t,e,i){var n,s;n=[i(2)],s=function(t){var e=Backbone.View.extend({optionsDefault:{title_new:"",operations:null,onnew:null,max:null,onchange:null},initialize:function(e){this.visible=!1,this.$nav=null,this.$content=null,this.first_tab=null,this.current_id=null,this.options=t.merge(e,this.optionsDefault);var i=$(this._template(this.options));this.$nav=i.find(".tab-navigation"),this.$content=i.find(".tab-content"),this.setElement(i),this.list={};var n=this;if(this.options.operations&&$.each(this.options.operations,function(t,e){e.$el.prop("id",t),n.$nav.find(".operations").append(e.$el)}),this.options.onnew){var s=$(this._template_tab_new(this.options));this.$nav.append(s),s.tooltip({title:"Add a new tab",placement:"bottom",container:n.$el}),s.on("click",function(t){s.tooltip("hide"),n.options.onnew()})}},size:function(){return _.size(this.list)},current:function(){return this.$el.find(".tab-pane.active").attr("id")},add:function(t){var e=this,i=t.id,n=$(this._template_tab(t)),s=$(this._template_tab_content(t));if(this.list[i]=t.ondel?!0:!1,this.options.onnew?this.$nav.find("#new-tab").before(n):this.$nav.append(n),s.append(t.$el),this.$content.append(s),1==this.size()&&(n.addClass("active"),s.addClass("active"),this.first_tab=i),this.options.max&&this.size()>=this.options.max&&this.$el.find("#new-tab").hide(),t.ondel){var a=n.find("#delete");a.tooltip({title:"Delete this tab",placement:"bottom",container:e.$el}),a.on("click",function(){return a.tooltip("destroy"),e.$el.find(".tooltip").remove(),t.ondel(),!1})}n.on("click",function(n){n.preventDefault(),t.onclick?t.onclick():e.show(i)}),this.current_id||(this.current_id=i)},del:function(t){this.$el.find("#tab-"+t).remove(),this.$el.find("#"+t).remove(),this.first_tab==t&&(this.first_tab=null),null!=this.first_tab&&this.show(this.first_tab),this.list[t]&&delete this.list[t],this.size()<this.options.max&&this.$el.find("#new-tab").show()},delRemovable:function(){for(var t in this.list)this.del(t)},show:function(t){this.$el.fadeIn("fast"),this.visible=!0,t&&(this.$el.find("#tab-"+this.current_id).removeClass("active"),this.$el.find("#"+this.current_id).removeClass("active"),this.$el.find("#tab-"+t).addClass("active"),this.$el.find("#"+t).addClass("active"),this.current_id=t),this.options.onchange&&this.options.onchange(t)},hide:function(){this.$el.fadeOut("fast"),this.visible=!1},hideOperation:function(t){this.$nav.find("#"+t).hide()},showOperation:function(t){this.$nav.find("#"+t).show()},setOperation:function(t,e){var i=this.$nav.find("#"+t);i.off("click"),i.on("click",e)},title:function(t,e){var i=this.$el.find("#tab-title-text-"+t);return e&&i.html(e),i.html()},retitle:function(t){var e=0;for(var i in this.list)this.title(i,++e+": "+t)},_template:function(t){return'<div class="ui-tabs tabbable tabs-left"><ul id="tab-navigation" class="tab-navigation nav nav-tabs"><div class="operations" style="float: right; margin-bottom: 4px;"></div></ul><div id="tab-content" class="tab-content"/></div>'},_template_tab_new:function(t){return'<li id="new-tab"><a href="javascript:void(0);"><i class="ui-tabs-add fa fa-plus-circle"/>'+t.title_new+"</a></li>"},_template_tab:function(t){var e='<li id="tab-'+t.id+'" class="tab-element"><a id="tab-title-link-'+t.id+'" title="" href="#'+t.id+'" data-original-title=""><span id="tab-title-text-'+t.id+'" class="tab-title-text">'+t.title+"</span>";return t.ondel&&(e+='<i id="delete" class="ui-tabs-delete fa fa-minus-circle"/>'),e+="</a></li>"},_template_tab_content:function(t){return'<div id="'+t.id+'" class="tab-pane"/>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s;n=[i(23)],s=function(t){var e=Backbone.Model.extend({initialize:function(t){this.options=t.config,this.masthead=t.masthead,this.create()},create:function(){var e=new t.GalaxyMastheadTab({id:"analysis",title:"Analyze Data",content:"",title_attribute:"Analysis home view"});this.masthead.append(e);var i={id:"workflow",title:"Workflow",content:"workflow",title_attribute:"Chain tools into workflows"};Galaxy.user.id||(i.disabled=!0);var n=new t.GalaxyMastheadTab(i);this.masthead.append(n);var s=new t.GalaxyMastheadTab({id:"shared",title:"Shared Data",content:"library/index",title_attribute:"Access published resources"});if(s.add({title:"Data Libraries",content:"library/index"}),s.add({title:"Data Libraries Beta",content:"library/list",divider:!0}),s.add({title:"Published Histories",content:"history/list_published"}),s.add({title:"Published Workflows",content:"workflow/list_published"}),s.add({title:"Published Visualizations",content:"visualization/list_published"}),s.add({title:"Published Pages",content:"page/list_published"}),this.masthead.append(s),this.options.user_requests){var a=new t.GalaxyMastheadTab({id:"lab",title:"Lab"});a.add({title:"Sequencing Requests",content:"requests/index"}),a.add({title:"Find Samples",content:"requests/find_samples_index"}),a.add({title:"Help",content:this.options.lims_doc_url}),this.masthead.append(a)}var o={id:"visualization",title:"Visualization",content:"visualization/list",title_attribute:"Visualize datasets"};Galaxy.user.id||(o.disabled=!0);var r=new t.GalaxyMastheadTab(o);if(Galaxy.user.id&&(r.add({title:"New Track Browser",content:"visualization/trackster",target:"_frame"}),r.add({title:"Saved Visualizations",content:"visualization/list",target:"_frame"})),this.masthead.append(r),Galaxy.user.get("is_admin")){var l=new t.GalaxyMastheadTab({id:"admin",title:"Admin",content:"admin",extra_class:"admin-only",title_attribute:"Administer this Galaxy"});this.masthead.append(l)}var c=new t.GalaxyMastheadTab({id:"help",title:"Help",title_attribute:"Support, contact, and community hubs"});if(this.options.biostar_url&&(c.add({title:"Galaxy Biostar",content:this.options.biostar_url_redirect,target:"_blank"}),c.add({title:"Ask a question",content:"biostar/biostar_question_redirect",target:"_blank"})),c.add({title:"Support",content:this.options.support_url,target:"_blank"}),c.add({title:"Search",content:this.options.search_url,target:"_blank"}),c.add({title:"Mailing Lists",content:this.options.mailing_lists,target:"_blank"}),c.add({title:"Videos",content:this.options.screencasts_url,target:"_blank"}),c.add({title:"Wiki",content:this.options.wiki_url,target:"_blank"}),c.add({title:"How to Cite Galaxy",content:this.options.citation_url,target:"_blank"}),this.options.terms_url&&c.add({title:"Terms and Conditions",content:this.options.terms_url,target:"_blank"}),this.masthead.append(c),Galaxy.user.id){var d=new t.GalaxyMastheadTab({id:"user",title:"User",extra_class:"loggedin-only",title_attribute:"Account preferences and saved data"});d.add({title:"Logged in as "+Galaxy.user.get("email")}),d.add({title:"Preferences",content:"user?cntrller=user",target:"galaxy_main"}),d.add({title:"Custom Builds",content:"user/dbkeys",target:"galaxy_main"}),d.add({title:"Logout",content:"user/logout",target:"_top",divider:!0}),d.add({title:"Saved Histories",content:"history/list",target:"galaxy_main"}),d.add({title:"Saved Datasets",content:"dataset/list",target:"galaxy_main"}),d.add({title:"Saved Pages",content:"page/list",target:"_top"}),d.add({title:"API Keys",content:"user/api_keys?cntrller=user",target:"galaxy_main"}),this.options.use_remote_user&&d.add({title:"Public Name",content:"user/edit_username?cntrller=user",target:"galaxy_main"}),this.masthead.append(d)}else{var d=new t.GalaxyMastheadTab({id:"user",title:"User",extra_class:"loggedout-only",title_attribute:"Account registration or login"});d.add({title:"Login",content:"user/login",target:"galaxy_main"}),this.options.allow_user_creation&&d.add({title:"Register",content:"user/create",target:"galaxy_main"}),this.masthead.append(d)}this.options.active_view&&this.masthead.highlight(this.options.active_view)}});return{GalaxyMenu:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},,,,,,function(t,e,i){var n,s;n=[i(3),i(27),i(1)],s=function(t,e,i){var n=Backbone.View.extend({tagName:"div",className:"citations",render:function(){return this.$el.append("<p>"+this.formattedReference()+"</p>"),this},formattedReference:function(){var t=this.model,e=t.entryType(),i=t.fields(),n="",s=this._asSentence((i.author?i.author:"")+(i.year?" ("+i.year+")":""))+" ",a=i.title||"",o=i.pages?"pp. "+i.pages:"",r=i.address;if("article"==e){var l=(i.volume?i.volume:"")+(i.number?" ("+i.number+")":"")+(o?", "+o:"");n=s+this._asSentence(a)+(i.journal?"In <em>"+i.journal+", ":"")+this._asSentence(l)+this._asSentence(i.address)+"</em>"}else n="inproceedings"==e||"proceedings"==e?s+this._asSentence(a)+(i.booktitle?"In <em>"+i.booktitle+", ":"")+(o?o:"")+(r?", "+r:"")+".</em>":"mastersthesis"==e||"phdthesis"==e?s+this._asSentence(a)+(i.howpublished?i.howpublished+". ":"")+(i.note?i.note+".":""):"techreport"==e?s+this._asSentence(a)+this._asSentence(i.institution)+this._asSentence(i.number)+this._asSentence(i.type):"book"==e||"inbook"==e||"incollection"==e?s+" "+this._formatBookInfo(i):s+" "+this._asSentence(a)+this._asSentence(i.howpublished)+this._asSentence(i.note);var c="";i.doi&&(c="http://dx.doi.org/"+i.doi,n+='[<a href="'+c+'" target="_blank">doi:'+i.doi+"</a>]");var d=i.url||c;return d&&(n+='[<a href="'+d+'" target="_blank">Link</a>]'),n},_formatBookInfo:function(t){var e="";return t.chapter&&(e+=t.chapter+" in "),t.title&&(e+="<em>"+t.title+"</em>"),t.editor&&(e+=", Edited by "+t.editor+", "),t.publisher&&(e+=", "+t.publisher),t.pages&&(e+=", pp. "+t.pages),t.series&&(e+=", <em>"+t.series+"</em>"),t.volume&&(e+=", Vol."+t.volume),t.issn&&(e+=", ISBN: "+t.issn),e+"."},_asSentence:function(t){return t&&t.trim()?t+". ":""}}),s=Backbone.View.extend({el:"#citations",initialize:function(){this.listenTo(this.collection,"add",this.renderCitation)},events:{"click .citations-to-bibtex":"showBibtex","click .citations-to-formatted":"showFormatted"},renderCitation:function(t){var e=new n({model:t});this.$(".citations-formatted").append(e.render().el);var i=this.$(".citations-bibtex-text");i.val(i.val()+"\n\r"+t.attributes.content)},render:function(){this.$el.html(this.citationsElement()),this.collection.each(function(t){this.renderCitation(t)},this),this.showFormatted()},showBibtex:function(){this.$(".citations-to-formatted").show(),this.$(".citations-to-bibtex").hide(),this.$(".citations-bibtex").show(),this.$(".citations-formatted").hide(),this.$(".citations-bibtex-text").select()},showFormatted:function(){this.$(".citations-to-formatted").hide(),this.$(".citations-to-bibtex").show(),this.$(".citations-bibtex").hide(),this.$(".citations-formatted").show()},partialWarningElement:function(){return this.collection.partial?['<div style="padding:5px 10px">',"<b>Warning: This is a experimental feature.</b> Most Galaxy tools will not annotate"," citations explicitly at this time. When writing up your analysis, please manually"," review your histories and find all references"," that should be cited in order to completely describe your work. Also, please remember to",' <a href="https://wiki.galaxyproject.org/CitingGalaxy">cite Galaxy</a>.',"</div>"].join(""):""},citationsElement:function(){return['<div class="toolForm">','<div class="toolFormTitle">',i("Citations"),' <button type="button" class="btn btn-xs citations-to-bibtex" title="Show all in BibTeX format."><i class="fa fa-pencil-square-o"></i> Show BibTeX</button>',' <button type="button" class="btn btn-xs citations-to-formatted" title="Return to formatted citation list."><i class="fa fa-times"></i> Hide BibTeX</button>',"</div>",'<div class="toolFormBody" style="padding:5px 10px">',this.partialWarningElement(),'<span class="citations-formatted" style="word-wrap: break-word;"></span>',"</div>",'<div class="citations-bibtex toolFormBody" style="padding:5px 10px">','<textarea style="width: 100%; height: 500px;" class="citations-bibtex-text"></textarea>',"</div>","</div>"].join("")}});return{CitationView:n,CitationListView:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(12),i(28),i(3),i(1)],s=function(t,e,i,n){var s=t.DCListItemView,a=s.extend({initialize:function(t){s.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCListItemEdit("+t+")"}}),o=t.DCEListItemView,r=o.extend({initialize:function(t){o.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCEListItemEdit("+t+")"}}),l=e.DatasetListItemEdit.extend({initialize:function(t){e.DatasetListItemEdit.prototype.initialize.call(this,t)},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):jQuery.when()},_renderDeleteButton:function(){return null},toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetDCEListItemEdit("+t+")"}});l.prototype.templates=function(){return _.extend({},e.DatasetListItemEdit.prototype.templates,{titleBar:t.DatasetDCEListItemView.prototype.templates.titleBar})}();var c=t.NestedDCDCEListItemView.extend({toString:function(){var t=this.model?this.model+"":"(no model)";return"NestedDCDCEListItemEdit("+t+")"}});return{DCListItemEdit:a,DCEListItemEdit:r,DatasetDCEListItemEdit:l,NestedDCDCEListItemEdit:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(10),i(13),i(55),i(3),i(1)],s=function(t,e,i,n,s){var a=t.CollectionPanel,o=a.extend({DatasetDCEViewClass:i.DatasetDCEListItemEdit,NestedDCDCEViewClass:i.NestedDCDCEListItemEdit,initialize:function(t){a.prototype.initialize.call(this,t)},_setUpBehaviors:function(t){if(t=t||this.$el,a.prototype._setUpBehaviors.call(this,t),this.model&&Galaxy.currUser&&!Galaxy.currUser.isAnonymous()){var e=this,i="> .controls .name";t.find(i).attr("title",s("Click to rename collection")).tooltip({placement:"bottom"}).make_text_editable({on_finish:function(t){var n=e.model.get("name");t&&t!==n?(e.$el.find(i).text(t),e.model.save({name:t}).fail(function(){e.$el.find(i).text(e.model.previous("name"))})):e.$el.find(i).text(n)}})}},toString:function(){return"CollectionPanelEdit("+(this.model?this.model.get("name"):"")+")"}}),r=o.extend({DatasetDCEViewClass:i.DatasetDCEListItemEdit,toString:function(){return"ListCollectionPanelEdit("+(this.model?this.model.get("name"):"")+")"}}),l=r.extend({toString:function(){return"PairCollectionPanelEdit("+(this.model?this.model.get("name"):"")+")"}}),c=l.extend({_setUpBehaviors:function(t){a.prototype._setUpBehaviors.call(this,t)},toString:function(){return"NestedPairCollectionPanelEdit("+(this.model?this.model.get("name"):"")+")"}}),d=o.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemEdit.extend({foldoutPanelClass:c}),toString:function(){return"ListOfPairsCollectionPanelEdit("+(this.model?this.model.get("name"):"")+")"}});return{CollectionPanelEdit:o,ListCollectionPanelEdit:r,PairCollectionPanelEdit:l,ListOfPairsCollectionPanelEdit:d}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(82),i(42),i(14),i(3),i(1),i(40)],s=function(t,e,i,n,s){function a(t){function e(){return i.length||(i=[new RegExp(this.filters[0]),new RegExp(this.filters[1])]),i}t=t||{},t.createPair=t.createPair||function(t){return this.debug("creating pair:",t.listA[t.indexA].name,t.listB[t.indexB].name),t=t||{},this._pair(t.listA.splice(t.indexA,1)[0],t.listB.splice(t.indexB,1)[0],{silent:!0})};var i=[];return t.preprocessMatch=t.preprocessMatch||function(t){var i=e.call(this);return _.extend(t,{matchTo:t.matchTo.name.replace(i[0],""),possible:t.possible.name.replace(i[1],"")})},function(e){this.debug("autopair _strategy ---------------------------"),e=e||{};var i,n=e.listA,s=e.listB,a=0,o={score:0,index:null},r=[];for(this.debug("starting list lens:",n.length,s.length),this.debug("bestMatch (starting):",JSON.stringify(o,null,"  "));a<n.length;){var l=n[a];for(o.score=0,i=0;i<s.length;i++){var c=s[i];if(this.debug(a+":"+l.name),this.debug(i+":"+c.name),n[a]!==s[i]&&(o=t.match.call(this,t.preprocessMatch.call(this,{matchTo:l,possible:c,index:i,bestMatch:o})),this.debug("bestMatch:",JSON.stringify(o,null,"  ")),1===o.score)){this.debug("breaking early due to perfect match");break}}var d=t.scoreThreshold.call(this);if(this.debug("scoreThreshold:",d),this.debug("bestMatch.score:",o.score),o.score>=d?(this.debug("creating pair"),r.push(t.createPair.call(this,{listA:n,indexA:a,listB:s,indexB:o.index})),this.debug("list lens now:",n.length,s.length)):a+=1,!n.length||!s.length)return r}return this.debug("paired:",JSON.stringify(r,null,"  ")),this.debug("autopair _strategy ---------------------------"),r}}function o(t){var e=t.toJSON();return c(e,{historyId:t.historyId})}var r=Backbone.View.extend(n.LoggableMixin).extend({tagName:"li",className:"dataset paired",initialize:function(t){this.pair=t.pair||{}},template:_.template(['<span class="forward-dataset-name flex-column"><%= pair.forward.name %></span>','<span class="pair-name-column flex-column">','<span class="pair-name"><%= pair.name %></span>',"</span>",'<span class="reverse-dataset-name flex-column"><%= pair.reverse.name %></span>'].join("")),render:function(){return this.$el.attr("draggable",!0).data("pair",this.pair).html(this.template({pair:this.pair})).addClass("flex-column-container"),this},events:{dragstart:"_dragstart",dragend:"_dragend",dragover:"_sendToParent",drop:"_sendToParent"},_dragstart:function(t){t.currentTarget.style.opacity="0.4",t.originalEvent&&(t=t.originalEvent),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(this.pair)),this.$el.parent().trigger("pair.dragstart",[this])},_dragend:function(t){t.currentTarget.style.opacity="1.0",this.$el.parent().trigger("pair.dragend",[this])},_sendToParent:function(t){this.$el.parent().trigger(t)},toString:function(){return"PairView("+this.pair.name+")"}}),l=Backbone.View.extend(n.LoggableMixin).extend({className:"list-of-pairs-collection-creator collection-creator flex-row-container",initialize:function(t){this.metric("PairedCollectionCreator.initialize",t),t=_.defaults(t,{datasets:[],filters:this.DEFAULT_FILTERS,automaticallyPair:!0,strategy:"lcs",matchPercentage:.9,twoPassAutopairing:!0}),this.initialList=t.datasets,this.historyId=t.historyId,this.filters=this.commonFilters[t.filters]||this.commonFilters[this.DEFAULT_FILTERS],_.isArray(t.filters)&&(this.filters=t.filters),this.automaticallyPair=t.automaticallyPair,this.strategy=this.strategies[t.strategy]||this.strategies[this.DEFAULT_STRATEGY],_.isFunction(t.strategy)&&(this.strategy=t.strategy),this.matchPercentage=t.matchPercentage,this.twoPassAutopairing=t.twoPassAutopairing,this.removeExtensions=!0,this.oncancel=t.oncancel,this.oncreate=t.oncreate,this.autoscrollDist=t.autoscrollDist||24,this.unpairedPanelHidden=!1,this.pairedPanelHidden=!1,this.$dragging=null,this.blocking=!1,this._setUpBehaviors(),this._dataSetUp()},commonFilters:{illumina:["_1","_2"],Rs:["_R1","_R2"]},DEFAULT_FILTERS:"illumina",strategies:{simple:"autopairSimple",lcs:"autopairLCS",levenshtein:"autopairLevenshtein"},DEFAULT_STRATEGY:"lcs",_dataSetUp:function(){this.paired=[],this.unpaired=[],this.selectedIds=[],this._sortInitialList(),this._ensureIds(),this.unpaired=this.initialList.slice(0),this.automaticallyPair&&(this.autoPair(),this.once("rendered:initial",function(){this.trigger("autopair")}))},_sortInitialList:function(){this._sortDatasetList(this.initialList)},_sortDatasetList:function(t){return t.sort(function(t,i){return e(t.name,i.name)}),t},_ensureIds:function(){return this.initialList.forEach(function(t){t.hasOwnProperty("id")||(t.id=_.uniqueId())}),this.initialList},_splitByFilters:function(){function t(t,e){return e.test(t.name)}var e=this.filters.map(function(t){return new RegExp(t)}),i=[[],[]];return this.unpaired.forEach(function(n){e.forEach(function(e,s){t(n,e)&&i[s].push(n)})}),i},_addToUnpaired:function(t){var i=function(n,s){if(n===s)return n;var a=Math.floor((s-n)/2)+n,o=e(t.name,this.unpaired[a].name);if(0>o)return i(n,a);if(o>0)return i(a+1,s);for(;this.unpaired[a]&&this.unpaired[a].name===t.name;)a++;return a}.bind(this);this.unpaired.splice(i(0,this.unpaired.length),0,t)},autoPair:function(t){var e=this._splitByFilters(),i=[];return this.twoPassAutopairing&&(i=this.autopairSimple({listA:e[0],listB:e[1]}),e=this._splitByFilters()),t=t||this.strategy,e=this._splitByFilters(),i=i.concat(this[t].call(this,{listA:e[0],listB:e[1]}))},autopairSimple:a({scoreThreshold:function(){return 1},match:function(t){return t=t||{},t.matchTo===t.possible?{index:t.index,score:1}:t.bestMatch}}),autopairLevenshtein:a({scoreThreshold:function(){return this.matchPercentage},match:function(e){e=e||{};var i=t(e.matchTo,e.possible),n=1-i/Math.max(e.matchTo.length,e.possible.length);return n>e.bestMatch.score?{index:e.index,score:n}:e.bestMatch}}),autopairLCS:a({scoreThreshold:function(){return this.matchPercentage},match:function(t){t=t||{};var e=this._naiveStartingAndEndingLCS(t.matchTo,t.possible).length,i=e/Math.max(t.matchTo.length,t.possible.length);return i>t.bestMatch.score?{index:t.index,score:i}:t.bestMatch}}),_naiveStartingAndEndingLCS:function(t,e){for(var i="",n="",s=0,a=0;s<t.length&&s<e.length&&t[s]===e[s];)i+=t[s],s+=1;if(s===t.length)return t;if(s===e.length)return e;for(s=t.length-1,a=e.length-1;s>=0&&a>=0&&t[s]===e[a];)n=[t[s],n].join(""),s-=1,a-=1;return i+n},_pair:function(t,e,i){i=i||{};var n=this._createPair(t,e,i.name);return this.paired.push(n),this.unpaired=_.without(this.unpaired,t,e),i.silent||this.trigger("pair:new",n),n},_createPair:function(t,e,i){if(!t||!e||t===e)throw new Error("Bad pairing: "+[JSON.stringify(t),JSON.stringify(e)]);return i=i||this._guessNameForPair(t,e),{forward:t,name:i,reverse:e}},_guessNameForPair:function(t,e,i){i=void 0!==i?i:this.removeExtensions;var n=t.name,s=e.name,a=this._naiveStartingAndEndingLCS(n.replace(this.filters[0],""),s.replace(this.filters[1],""));if(i){var o=a.lastIndexOf(".");if(o>0){var r=a.slice(o,a.length);a=a.replace(r,""),n=n.replace(r,""),s=s.replace(r,"")}}return a||n+" & "+s},_unpair:function(t,e){if(e=e||{},!t)throw new Error("Bad pair: "+JSON.stringify(t));return this.paired=_.without(this.paired,t),this._addToUnpaired(t.forward),this._addToUnpaired(t.reverse),e.silent||this.trigger("pair:unpair",[t]),t},unpairAll:function(){for(var t=[];this.paired.length;)t.push(this._unpair(this.paired[0],{silent:!0}));this.trigger("pair:unpair",t)},_pairToJSON:function(t,e){return e=e||"hda",{collection_type:"paired",src:"new_collection",name:t.name,element_identifiers:[{name:"forward",id:t.forward.id,src:e},{name:"reverse",id:t.reverse.id,src:e}]}},createList:function(t){var e=this,i=window.Galaxy&&Galaxy.options.root?Galaxy.options.root:"/",n=i+"api/histories/"+this.historyId+"/contents/dataset_collections",s={type:"dataset_collection",collection_type:"list:paired",name:_.escape(t||e.$(".collection-name").val()),element_identifiers:e.paired.map(function(t){return e._pairToJSON(t)})};return e.blocking=!0,jQuery.ajax(n,{type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(s)}).always(function(){e.blocking=!1}).fail(function(t,i,n){e._ajaxErrHandler(t,i,n)}).done(function(t,i,n){e.trigger("collection:created",t,i,n),e.metric("collection:created",t),"function"==typeof e.oncreate&&e.oncreate.call(this,t,i,n)})},_ajaxErrHandler:function(t,e,i){this.error(t,e,i);var n=s("An error occurred while creating this collection");t&&(n+=0===t.readyState&&0===t.status?": "+s("Galaxy could not be reached and may be updating.")+s(" Try again in a few minutes."):t.responseJSON?"<br /><pre>"+JSON.stringify(t.responseJSON)+"</pre>":": "+i),creator._showAlert(n,"alert-danger")},render:function(t,e){return this.$el.empty().html(l.templates.main()),this._renderHeader(t),this._renderMiddle(t),this._renderFooter(t),this._addPluginComponents(),this.trigger("rendered",this),this},_renderHeader:function(t,e){var i=this.$(".header").empty().html(l.templates.header()).find(".help-content").prepend($(l.templates.helpContent()));return this._renderFilters(),i},_renderFilters:function(){return this.$(".forward-column .column-header input").val(this.filters[0]).add(this.$(".reverse-column .column-header input").val(this.filters[1]));
},_renderMiddle:function(t,e){var i=this.$(".middle").empty().html(l.templates.middle());return this.unpairedPanelHidden?this.$(".unpaired-columns").hide():this.pairedPanelHidden&&this.$(".paired-columns").hide(),this._renderUnpaired(),this._renderPaired(),i},_renderUnpaired:function(t,e){var i,n,a=this,o=[],r=this._splitByFilters();return this.$(".forward-column .title").text([r[0].length,s("unpaired forward")].join(" ")),this.$(".forward-column .unpaired-info").text(this._renderUnpairedDisplayStr(this.unpaired.length-r[0].length)),this.$(".reverse-column .title").text([r[1].length,s("unpaired reverse")].join(" ")),this.$(".reverse-column .unpaired-info").text(this._renderUnpairedDisplayStr(this.unpaired.length-r[1].length)),this.$(".unpaired-columns .column-datasets").empty(),this.$(".autopair-link").toggle(0!==this.unpaired.length),0===this.unpaired.length?void this._renderUnpairedEmpty():(n=r[1].map(function(t,e){return void 0!==r[0][e]&&r[0][e]!==t&&o.push(a._renderPairButton()),a._renderUnpairedDataset(t)}),i=r[0].map(function(t){return a._renderUnpairedDataset(t)}),i.length||n.length?(this.$(".unpaired-columns .forward-column .column-datasets").append(i).add(this.$(".unpaired-columns .paired-column .column-datasets").append(o)).add(this.$(".unpaired-columns .reverse-column .column-datasets").append(n)),void this._adjUnpairedOnScrollbar()):void this._renderUnpairedNotShown())},_renderUnpairedDisplayStr:function(t){return["(",t," ",s("filtered out"),")"].join("")},_renderUnpairedDataset:function(t){return $("<li/>").attr("id","dataset-"+t.id).addClass("dataset unpaired").attr("draggable",!0).addClass(t.selected?"selected":"").append($("<span/>").addClass("dataset-name").text(t.name)).data("dataset",t)},_renderPairButton:function(){return $("<li/>").addClass("dataset unpaired").append($("<span/>").addClass("dataset-name").text(s("Pair these datasets")))},_renderUnpairedEmpty:function(){var t=$('<div class="empty-message"></div>').text("("+s("no remaining unpaired datasets")+")");return this.$(".unpaired-columns .paired-column .column-datasets").empty().prepend(t),t},_renderUnpairedNotShown:function(){var t=$('<div class="empty-message"></div>').text("("+s("no datasets were found matching the current filters")+")");return this.$(".unpaired-columns .paired-column .column-datasets").empty().prepend(t),t},_adjUnpairedOnScrollbar:function(){var t=this.$(".unpaired-columns").last(),e=this.$(".unpaired-columns .reverse-column .dataset").first();if(e.size()){var i=t.offset().left+t.outerWidth(),n=e.offset().left+e.outerWidth(),s=Math.floor(i)-Math.floor(n);this.$(".unpaired-columns .forward-column").css("margin-left",s>0?s:0)}},_renderPaired:function(t,e){if(this.$(".paired-column-title .title").text([this.paired.length,s("paired")].join(" ")),this.$(".unpair-all-link").toggle(0!==this.paired.length),0===this.paired.length)return void this._renderPairedEmpty();this.$(".remove-extensions-link").show(),this.$(".paired-columns .column-datasets").empty();var i=this;this.paired.forEach(function(t,e){var n=new r({pair:t});i.$(".paired-columns .column-datasets").append(n.render().$el).append(['<button class="unpair-btn">','<span class="fa fa-unlink" title="',s("Unpair"),'"></span>',"</button>"].join(""))})},_renderPairedEmpty:function(){var t=$('<div class="empty-message"></div>').text("("+s("no paired datasets yet")+")");return this.$(".paired-columns .column-datasets").empty().prepend(t),t},_renderFooter:function(t,e){var i=this.$(".footer").empty().html(l.templates.footer());return this.$(".remove-extensions").prop("checked",this.removeExtensions),"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),i},_addPluginComponents:function(){this._chooseFiltersPopover(".choose-filters-link"),this.$(".help-content i").hoverhighlight(".collection-creator","rgba( 64, 255, 255, 1.0 )")},_chooseFiltersPopover:function(t){function e(t,e){return['<button class="filter-choice btn" ','data-forward="',t,'" data-reverse="',e,'">',s("Forward"),": ",t,", ",s("Reverse"),": ",e,"</button>"].join("")}var i=$(_.template(['<div class="choose-filters">','<div class="help">',s("Choose from the following filters to change which unpaired reads are shown in the display"),":</div>",_.values(this.commonFilters).map(function(t){return e(t[0],t[1])}).join(""),"</div>"].join(""))({}));return this.$(t).popover({container:".collection-creator",placement:"bottom",html:!0,content:i})},_validationWarning:function(t,e){var i="validation-warning";"name"===t&&(t=this.$(".collection-name").add(this.$(".collection-name-prompt")),this.$(".collection-name").focus().select()),e?(t=t||this.$("."+i),t.removeClass(i)):t.addClass(i)},_setUpBehaviors:function(){return this.once("rendered",function(){this.trigger("rendered:initial",this)}),this.on("pair:new",function(){this._renderUnpaired(),this._renderPaired(),this.$(".paired-columns").scrollTop(8e6)}),this.on("pair:unpair",function(t){this._renderUnpaired(),this._renderPaired(),this.splitView()}),this.on("filter-change",function(){this.filters=[this.$(".forward-unpaired-filter input").val(),this.$(".reverse-unpaired-filter input").val()],this.metric("filter-change",this.filters),this._renderFilters(),this._renderUnpaired()}),this.on("autopair",function(){this._renderUnpaired(),this._renderPaired();var t,e=null;this.paired.length?(e="alert-success",t=this.paired.length+" "+s("pairs created"),this.unpaired.length||(t+=": "+s("all datasets have been successfully paired"),this.hideUnpaired(),this.$(".collection-name").focus())):t=s("Could not automatically create any pairs from the given dataset names"),this._showAlert(t,e)}),this},events:{"click .more-help":"_clickMoreHelp","click .less-help":"_clickLessHelp","click .header .alert button":"_hideAlert","click .forward-column .column-title":"_clickShowOnlyUnpaired","click .reverse-column .column-title":"_clickShowOnlyUnpaired","click .unpair-all-link":"_clickUnpairAll","change .forward-unpaired-filter input":function(t){this.trigger("filter-change")},"focus .forward-unpaired-filter input":function(t){$(t.currentTarget).select()},"click .autopair-link":"_clickAutopair","click .choose-filters .filter-choice":"_clickFilterChoice","click .clear-filters-link":"_clearFilters","change .reverse-unpaired-filter input":function(t){this.trigger("filter-change")},"focus .reverse-unpaired-filter input":function(t){$(t.currentTarget).select()},"click .forward-column .dataset.unpaired":"_clickUnpairedDataset","click .reverse-column .dataset.unpaired":"_clickUnpairedDataset","click .paired-column .dataset.unpaired":"_clickPairRow","click .unpaired-columns":"clearSelectedUnpaired","mousedown .unpaired-columns .dataset":"_mousedownUnpaired","click .paired-column-title":"_clickShowOnlyPaired","mousedown .flexible-partition-drag":"_startPartitionDrag","click .paired-columns .dataset.paired":"selectPair","click .paired-columns":"clearSelectedPaired","click .paired-columns .pair-name":"_clickPairName","click .unpair-btn":"_clickUnpair","dragover .paired-columns .column-datasets":"_dragoverPairedColumns","drop .paired-columns .column-datasets":"_dropPairedColumns","pair.dragstart .paired-columns .column-datasets":"_pairDragstart","pair.dragend   .paired-columns .column-datasets":"_pairDragend","change .remove-extensions":function(t){this.toggleExtensions()},"change .collection-name":"_changeName","keydown .collection-name":"_nameCheckForEnter","click .cancel-create":function(t){"function"==typeof this.oncancel&&this.oncancel.call(this)},"click .create-collection":"_clickCreate"},_clickMoreHelp:function(t){this.$(".main-help").addClass("expanded"),this.$(".more-help").hide()},_clickLessHelp:function(t){this.$(".main-help").removeClass("expanded"),this.$(".more-help").show()},_showAlert:function(t,e){e=e||"alert-danger",this.$(".main-help").hide(),this.$(".header .alert").attr("class","alert alert-dismissable").addClass(e).show().find(".alert-message").html(t)},_hideAlert:function(t){this.$(".main-help").show(),this.$(".header .alert").hide()},_clickShowOnlyUnpaired:function(t){this.$(".paired-columns").is(":visible")?this.hidePaired():this.splitView()},_clickShowOnlyPaired:function(t){this.$(".unpaired-columns").is(":visible")?this.hideUnpaired():this.splitView()},hideUnpaired:function(t,e){this.unpairedPanelHidden=!0,this.pairedPanelHidden=!1,this._renderMiddle(t,e)},hidePaired:function(t,e){this.unpairedPanelHidden=!1,this.pairedPanelHidden=!0,this._renderMiddle(t,e)},splitView:function(t,e){return this.unpairedPanelHidden=this.pairedPanelHidden=!1,this._renderMiddle(t,e),this},_clickUnpairAll:function(t){this.metric("unpairAll"),this.unpairAll()},_clickAutopair:function(t){var e=this.autoPair();this.metric("autopair",e.length,this.unpaired.length),this.trigger("autopair")},_clickFilterChoice:function(t){var e=$(t.currentTarget);this.$(".forward-unpaired-filter input").val(e.data("forward")),this.$(".reverse-unpaired-filter input").val(e.data("reverse")),this._hideChooseFilters(),this.trigger("filter-change")},_hideChooseFilters:function(){this.$(".choose-filters-link").popover("hide"),this.$(".popover").css("display","none")},_clearFilters:function(t){this.$(".forward-unpaired-filter input").val(""),this.$(".reverse-unpaired-filter input").val(""),this.trigger("filter-change")},_clickUnpairedDataset:function(t){return t.stopPropagation(),this.toggleSelectUnpaired($(t.currentTarget))},toggleSelectUnpaired:function(t,e){e=e||{};var i=t.data("dataset"),n=void 0!==e.force?e.force:!t.hasClass("selected");return t.size()&&void 0!==i?(n?(t.addClass("selected"),e.waitToPair||this.pairAllSelected()):t.removeClass("selected"),t):t},pairAllSelected:function(t){t=t||{};var e=this,i=[],n=[],s=[];return e.$(".unpaired-columns .forward-column .dataset.selected").each(function(){i.push($(this).data("dataset"))}),e.$(".unpaired-columns .reverse-column .dataset.selected").each(function(){n.push($(this).data("dataset"))}),i.length=n.length=Math.min(i.length,n.length),i.forEach(function(t,i){try{s.push(e._pair(t,n[i],{silent:!0}))}catch(a){e.error(a)}}),s.length&&!t.silent&&this.trigger("pair:new",s),s},clearSelectedUnpaired:function(){this.$(".unpaired-columns .dataset.selected").removeClass("selected")},_mousedownUnpaired:function(t){if(t.shiftKey){var e=this,i=$(t.target).addClass("selected"),n=function(t){e.$(t.target).filter(".dataset").addClass("selected")};i.parent().on("mousemove",n),$(document).one("mouseup",function(t){i.parent().off("mousemove",n),e.pairAllSelected()})}},_clickPairRow:function(t){var e=$(t.currentTarget).index(),i=$(".unpaired-columns .forward-column .dataset").eq(e).data("dataset"),n=$(".unpaired-columns .reverse-column .dataset").eq(e).data("dataset");this._pair(i,n)},_startPartitionDrag:function(t){function e(t){n.$(".flexible-partition-drag").css("color",""),$("body").css("cursor","").unbind("mousemove",i)}function i(t){var e=t.pageY-s;n.adjPartition(e)||$("body").trigger("mouseup"),n._adjUnpairedOnScrollbar(),s+=e}var n=this,s=t.pageY;$("body").css("cursor","ns-resize"),n.$(".flexible-partition-drag").css("color","black"),$("body").mousemove(i),$("body").one("mouseup",e)},adjPartition:function(t){var e=this.$(".unpaired-columns"),i=this.$(".paired-columns"),n=parseInt(e.css("height"),10),s=parseInt(i.css("height"),10);n=Math.max(10,n+t),s-=t;var a=0>t;if(a){if(this.unpairedPanelHidden)return!1;if(10>=n)return this.hideUnpaired(),!1}else this.unpairedPanelHidden&&(e.show(),this.unpairedPanelHidden=!1);if(a)this.pairedPanelHidden&&(i.show(),this.pairedPanelHidden=!1);else{if(this.pairedPanelHidden)return!1;if(15>=s)return this.hidePaired(),!1}return e.css({height:n+"px",flex:"0 0 auto"}),!0},selectPair:function(t){t.stopPropagation(),$(t.currentTarget).toggleClass("selected")},clearSelectedPaired:function(t){this.$(".paired-columns .dataset.selected").removeClass("selected")},_clickPairName:function(t){t.stopPropagation();var e=$(t.currentTarget),i=e.parent().parent(),n=i.index(".dataset.paired"),s=this.paired[n],a=prompt("Enter a new name for the pair:",s.name);a&&(s.name=a,s.customizedName=!0,e.text(s.name))},_clickUnpair:function(t){var e=Math.floor($(t.currentTarget).index(".unpair-btn"));this._unpair(this.paired[e])},_dragoverPairedColumns:function(t){t.preventDefault();var e=this.$(".paired-columns .column-datasets");this._checkForAutoscroll(e,t.originalEvent.clientY);var i=this._getNearestPairedDatasetLi(t.originalEvent.clientY);$(".element-drop-placeholder").remove();var n=$('<div class="element-drop-placeholder"></div>');i.size()?i.before(n):e.append(n)},_checkForAutoscroll:function(t,e){var i=2,n=t.offset(),s=t.scrollTop(),a=e-n.top,o=n.top+t.outerHeight()-e;a>=0&&a<this.autoscrollDist?t.scrollTop(s-i):o>=0&&o<this.autoscrollDist&&t.scrollTop(s+i)},_getNearestPairedDatasetLi:function(t){for(var e=4,i=this.$(".paired-columns .column-datasets li").toArray(),n=0;n<i.length;n++){var s=$(i[n]),a=s.offset().top,o=Math.floor(s.outerHeight()/2)+e;if(a+o>t&&t>a-o)return s}return $()},_dropPairedColumns:function(t){t.preventDefault(),t.dataTransfer.dropEffect="move";var e=this._getNearestPairedDatasetLi(t.originalEvent.clientY);return e.size()?this.$dragging.insertBefore(e):this.$dragging.insertAfter(this.$(".paired-columns .unpair-btn").last()),this._syncPairsToDom(),!1},_syncPairsToDom:function(){var t=[];this.$(".paired-columns .dataset.paired").each(function(){t.push($(this).data("pair"))}),this.paired=t,this._renderPaired()},_pairDragstart:function(t,e){e.$el.addClass("selected");var i=this.$(".paired-columns .dataset.selected");this.$dragging=i},_pairDragend:function(t,e){$(".element-drop-placeholder").remove(),this.$dragging=null},toggleExtensions:function(t){var e=this;e.removeExtensions=void 0!==t?t:!e.removeExtensions,_.each(e.paired,function(t){t.customizedName||(t.name=e._guessNameForPair(t.forward,t.reverse))}),e._renderPaired(),e._renderFooter()},_changeName:function(t){this._validationWarning("name",!!this._getName())},_nameCheckForEnter:function(t){13!==t.keyCode||this.blocking||this._clickCreate()},_getName:function(){return _.escape(this.$(".collection-name").val())},_clickCreate:function(t){var e=this._getName();e?this.blocking||this.createList():this._validationWarning("name")},_printList:function(t){var e=this;_.each(t,function(i){t===e.paired&&e._printPair(i)})},_printPair:function(t){this.debug(t.forward.name,t.reverse.name,": ->",t.name)},toString:function(){return"PairedCollectionCreator"}});l.templates=l.templates||{main:_.template(['<div class="header flex-row no-flex"></div>','<div class="middle flex-row flex-row-container"></div>','<div class="footer flex-row no-flex">'].join("")),header:_.template(['<div class="main-help well clear">','<a class="more-help" href="javascript:void(0);">',s("More help"),"</a>",'<div class="help-content">','<a class="less-help" href="javascript:void(0);">',s("Less"),"</a>","</div>","</div>",'<div class="alert alert-dismissable">','<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>','<span class="alert-message"></span>',"</div>",'<div class="column-headers vertically-spaced flex-column-container">','<div class="forward-column flex-column column">','<div class="column-header">','<div class="column-title">','<span class="title">',s("Unpaired forward"),"</span>",'<span class="title-info unpaired-info"></span>',"</div>",'<div class="unpaired-filter forward-unpaired-filter pull-left">','<input class="search-query" placeholder="',s("Filter this list"),'" />',"</div>","</div>","</div>",'<div class="paired-column flex-column no-flex column">','<div class="column-header">','<a class="choose-filters-link" href="javascript:void(0)">',s("Choose filters"),"</a>",'<a class="clear-filters-link" href="javascript:void(0);">',s("Clear filters"),"</a><br />",'<a class="autopair-link" href="javascript:void(0);">',s("Auto-pair"),"</a>","</div>","</div>",'<div class="reverse-column flex-column column">','<div class="column-header">','<div class="column-title">','<span class="title">',s("Unpaired reverse"),"</span>",'<span class="title-info unpaired-info"></span>',"</div>",'<div class="unpaired-filter reverse-unpaired-filter pull-left">','<input class="search-query" placeholder="',s("Filter this list"),'" />',"</div>","</div>","</div>","</div>"].join("")),middle:_.template(['<div class="unpaired-columns flex-column-container scroll-container flex-row">','<div class="forward-column flex-column column">','<ol class="column-datasets"></ol>',"</div>",'<div class="paired-column flex-column no-flex column">','<ol class="column-datasets"></ol>',"</div>",'<div class="reverse-column flex-column column">','<ol class="column-datasets"></ol>',"</div>","</div>",'<div class="flexible-partition">','<div class="flexible-partition-drag" title="',s("Drag to change"),'"></div>','<div class="column-header">','<div class="column-title paired-column-title">','<span class="title"></span>',"</div>",'<a class="unpair-all-link" href="javascript:void(0);">',s("Unpair all"),"</a>","</div>","</div>",'<div class="paired-columns flex-column-container scroll-container flex-row">','<ol class="column-datasets"></ol>',"</div>"].join("")),footer:_.template(['<div class="attributes clear">','<div class="clear">','<label class="remove-extensions-prompt pull-right">',s("Remove file extensions from pair names"),"?",'<input class="remove-extensions pull-right" type="checkbox" />',"</label>","</div>",'<div class="clear">','<input class="collection-name form-control pull-right" ','placeholder="',s("Enter a name for your new list"),'" />','<div class="collection-name-prompt pull-right">',s("Name"),":</div>","</div>","</div>",'<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',s("Cancel"),"</button>",'<div class="create-other btn-group dropup">','<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">',s("Create a different kind of collection"),' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">','<li><a href="#">',s("Create a <i>single</i> pair"),"</a></li>",'<li><a href="#">',s("Create a list of <i>unpaired</i> datasets"),"</a></li>","</ul>","</div>","</div>",'<div class="main-options pull-right">','<button class="create-collection btn btn-primary">',s("Create list"),"</button>","</div>","</div>"].join("")),helpContent:_.template(["<p>",s(["Collections of paired datasets are ordered lists of dataset pairs (often forward and reverse reads). ","These collections can be passed to tools and workflows in order to have analyses done on each member of ","the entire group. This interface allows you to create a collection, choose which datasets are paired, ","and re-order the final collection."].join("")),"</p>","<p>",s(['Unpaired datasets are shown in the <i data-target=".unpaired-columns">unpaired section</i> ',"(hover over the underlined words to highlight below). ",'Paired datasets are shown in the <i data-target=".paired-columns">paired section</i>.',"<ul>To pair datasets, you can:","<li>Click a dataset in the ",'<i data-target=".unpaired-columns .forward-column .column-datasets,','.unpaired-columns .forward-column">forward column</i> ',"to select it then click a dataset in the ",'<i data-target=".unpaired-columns .reverse-column .column-datasets,','.unpaired-columns .reverse-column">reverse column</i>.',"</li>",'<li>Click one of the "Pair these datasets" buttons in the ','<i data-target=".unpaired-columns .paired-column .column-datasets,','.unpaired-columns .paired-column">middle column</i> ',"to pair the datasets in a particular row.","</li>",'<li>Click <i data-target=".autopair-link">"Auto-pair"</i> ',"to have your datasets automatically paired based on name.","</li>","</ul>"].join("")),"</p>","<p>",s(["<ul>You can filter what is shown in the unpaired sections by:","<li>Entering partial dataset names in either the ",'<i data-target=".forward-unpaired-filter input">forward filter</i> or ','<i data-target=".reverse-unpaired-filter input">reverse filter</i>.',"</li>","<li>Choosing from a list of preset filters by clicking the ",'<i data-target=".choose-filters-link">"Choose filters" link</i>.',"</li>","<li>Entering regular expressions to match dataset names. See: ",'<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions"',' target="_blank">MDN\'s JavaScript Regular Expression Tutorial</a>. ',"Note: forward slashes (\\) are not needed.","</li>","<li>Clearing the filters by clicking the ",'<i data-target=".clear-filters-link">"Clear filters" link</i>.',"</li>","</ul>"].join("")),"</p>","<p>",s(["To unpair individual dataset pairs, click the ",'<i data-target=".unpair-btn">unpair buttons ( <span class="fa fa-unlink"></span> )</i>. ','Click the <i data-target=".unpair-all-link">"Unpair all" link</i> to unpair all pairs.'].join("")),"</p>","<p>",s(['You can include or remove the file extensions (e.g. ".fastq") from your pair names by toggling the ','<i data-target=".remove-extensions-prompt">"Remove file extensions from pair names?"</i> control.'].join("")),"</p>","<p>",s(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>. ',"(Note: you do not have to pair all unpaired datasets to finish.)"].join("")),"</p>"].join(""))};var c=function(t,e){var i,n=jQuery.Deferred();if(e=_.defaults(e||{},{datasets:t,oncancel:function(){Galaxy.modal.hide(),n.reject("cancelled")},oncreate:function(t,e){Galaxy.modal.hide(),n.resolve(e)}}),!window.Galaxy||!Galaxy.modal)throw new Error("Galaxy or Galaxy.modal not found");return i=new l(e),Galaxy.modal.show({title:"Create a collection of paired datasets",body:i.$el,width:"80%",height:"800px",closing_events:!0}),i.render(),window.creator=i,n};return{PairedCollectionCreator:l,pairedCollectionCreatorModal:c,createListOfPairsCollection:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(14),i(16),i(3),i(1)],s=function(t,e,i,n){function s(t){var e=t.toJSON(),i=l(e,{creationFn:function(e,i){return e=[{name:"forward",src:"hda",id:e[0].id},{name:"reverse",src:"hda",id:e[1].id}],t.createHDCA(e,"paired",i)}});return i}var a=Backbone.View.extend(i.LoggableMixin).extend({tagName:"li",className:"collection-element",initialize:function(t){this.element=t.element||{},this.identifier=t.identifier},render:function(){return this.$el.attr("data-element-id",this.element.id).html(this.template({identifier:this.identifier,element:this.element})),this},template:_.template(['<span class="identifier"><%= identifier %></span>','<span class="name"><%= element.name %></span>'].join("")),destroy:function(){this.off(),this.$el.remove()},toString:function(){return"DatasetCollectionElementView()"}}),o=t.ListCollectionCreator,r=o.extend({elementViewClass:a,collectionClass:e.HistoryPairDatasetCollection,className:"pair-collection-creator collection-creator flex-row-container",_mangleDuplicateNames:function(){},render:function(t,e){return 2===this.workingElements.length?o.prototype.render.call(this,t,e):this._renderInvalid(t,e)},_renderList:function(t,e){var i=this,n=jQuery("<div/>"),s=i.$list();_.each(this.elementViews,function(t){t.destroy(),i.removeElementView(t)}),n.append(i._createForwardElementView().$el),n.append(i._createReverseElementView().$el),s.empty().append(n.children()),_.invoke(i.elementViews,"render")},_createForwardElementView:function(){return this._createElementView(this.workingElements[0],{identifier:"forward"})},_createReverseElementView:function(){return this._createElementView(this.workingElements[1],{identifier:"reverse"})},_createElementView:function(t,e){var i=new this.elementViewClass(_.extend(e,{element:t}));return this.elementViews.push(i),i},swap:function(){this.workingElements=[this.workingElements[1],this.workingElements[0]],this._renderList()},events:_.extend(_.clone(o.prototype.events),{"click .swap":"swap"}),templates:_.extend(_.clone(o.prototype.templates),{middle:_.template(['<div class="collection-elements-controls">','<a class="swap" href="javascript:void(0);" title="',n("Swap forward and reverse datasets"),'">',n("Swap"),"</a>","</div>",'<div class="collection-elements scroll-container flex-row">',"</div>"].join("")),helpContent:_.template(["<p>",n(["Pair collections are permanent collections containing two datasets: one forward and one reverse. ","Often these are forward and reverse reads. The pair collections can be passed to tools and ","workflows in order to have analyses done on both datasets. This interface allows ","you to create a pair, name it, and swap which is forward and which reverse."].join("")),"</p>","<ul>","<li>",n(['Click the <i data-target=".swap">"Swap"</i> link to make your forward dataset the reverse ',"and the reverse dataset forward."].join("")),"</li>","<li>",n(['Click the <i data-target=".cancel-create">"Cancel"</i> button to exit the interface.'].join("")),"</li>","</ul><br />","<p>",n(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>.'].join("")),"</p>"].join("")),invalidInitial:_.template(['<div class="header flex-row no-flex">','<div class="alert alert-warning" style="display: block">','<span class="alert-message">',"<% if( _.size( problems ) ){ %>",n("The following selections could not be included due to problems"),"<ul><% _.each( problems, function( problem ){ %>","<li><b><%= problem.element.name %></b>: <%= problem.text %></li>","<% }); %></ul>","<% } else if( _.size( elements ) === 0 ){ %>",n("No datasets were selected"),".","<% } else if( _.size( elements ) === 1 ){ %>",n("Only one dataset was selected"),": <%= elements[0].name %>","<% } else if( _.size( elements ) > 2 ){ %>",n("Too many datasets were selected"),': <%= _.pluck( elements, "name" ).join( ", ") %>',"<% } %>","<br />",n("Two (and only two) elements are needed for the pair"),". ",n("You may need to "),'<a class="cancel-create" href="javascript:void(0)">',n("cancel"),"</a> ",n("and reselect new elements"),".","</span>","</div>","</div>",'<div class="footer flex-row no-flex">','<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',n("Cancel"),"</button>","</div>","</div>","</div>"].join(""))}),toString:function(){return"PairCollectionCreator"}}),l=function(e,i){return i=i||{},i.title=n("Create a collection from a pair of datasets"),t.collectionCreatorModal(e,i,r)};return{PairCollectionCreator:r,pairCollectionCreatorModal:l,createPairCollection:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){return Backbone.Model.extend({initialize:function(t){this.app=t},checksum:function(){var t="",e=this;return this.app.section.$el.find(".section-row").each(function(){var i=$(this).attr("id"),n=e.app.field_list[i];n&&(t+=i+":"+JSON.stringify(n.value&&n.value())+":"+n.collapsed+";")}),t},create:function(){function t(t,e,n){i.map_dict[t]=e,s[t]=n}function e(n,s){for(var a in s){var o=s[a];if(o.input){var r=o.input,l=n;switch(""!=n&&(l+="|"),l+=r.name,r.type){case"repeat":var c="section-",d=[],h=null;for(var u in o){var p=u.indexOf(c);-1!=p&&(p+=c.length,d.push(parseInt(u.substr(p))),h||(h=u.substr(0,p)))}d.sort(function(t,e){return t-e});var a=0;for(var f in d)e(l+"_"+a++,o[h+d[f]]);break;case"conditional":var m=i.app.field_list[r.id].value();t(l+"|"+r.test_param.name,r.id,m);var g=i.matchCase(r,m);-1!=g&&e(l,s[r.id+"-section-"+g]);break;case"section":e(!r.flat&&l||"",o);break;default:var v=i.app.field_list[r.id];if(v&&v.value){var m=v.value();if((void 0===r.ignore||r.ignore!=m)&&(v.collapsed&&r.collapsible_value&&(m=r.collapsible_value),t(l,r.id,m),r.payload))for(var _ in r.payload)t(_,r.id,r.payload[_])}}}}}var i=this,n={};this._iterate(this.app.section.$el,n);var s={};return this.map_dict={},e("",n),s},match:function(t){return this.map_dict&&this.map_dict[t]},matchCase:function(t,e){"boolean"==t.test_param.type&&(e="true"==e?t.test_param.truevalue||"true":t.test_param.falsevalue||"false");for(var i in t.cases)if(t.cases[i].value==e)return i;return-1},matchModel:function(t,e){function i(t,n){for(var a in n){var o=n[a],r=o.name;switch(""!=t&&(r=t+"|"+r),o.type){case"repeat":for(var l in o.cache)i(r+"_"+l,o.cache[l]);break;case"conditional":var c=o.test_param&&o.test_param.value,d=s.matchCase(o,c);-1!=d&&i(r,o.cases[d].inputs);break;case"section":i(r,o.inputs);break;default:var h=s.map_dict[r];h&&e(h,o)}}}var n={},s=this;return i("",t.inputs),n},matchResponse:function(t){function e(t,s){if("string"==typeof s){var a=n.map_dict[t];a&&(i[a]=s)}else for(var o in s){var r=o;if(""!==t){var l="|";s instanceof Array&&(l="_"),r=t+l+r}e(r,s[o])}}var i={},n=this;return e("",t),i},_iterate:function(t,e){var i=this,n=$(t).children();n.each(function(){var t=this,n=$(t).attr("id");if($(t).hasClass("section-row")){e[n]={};var s=i.app.input_list[n];s&&(e[n]={input:s}),i._iterate(t,e[n])}else i._iterate(t,e)})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){return Backbone.View.extend({initialize:function(t,e){this.app=t,this.text_enable=t.options.text_enable||"Enable",this.text_disable=t.options.text_disable||"Disable",this.cls_enable=t.options.cls_enable||"fa fa-caret-square-o-down",this.cls_disable=t.options.cls_disable||"fa fa-caret-square-o-up",this.field=e.field,this.default_value=e.default_value,this.setElement(this._template(e)),this.$field=this.$el.find(".ui-table-form-field"),this.$optional=this.$el.find(".ui-table-form-optional"),this.$optional_icon=this.$el.find(".ui-table-form-optional").find(".icon"),this.$error_text=this.$el.find(".ui-table-form-error-text"),this.$error=this.$el.find(".ui-table-form-error"),this.$field.prepend(this.field.$el),this.field.collapsed=e.collapsible&&e.value&&JSON.stringify(e.value)==JSON.stringify(e.collapsible_value),this._refresh();var i=this;this.$optional.on("click",function(){i.field.collapsed=!i.field.collapsed,i._refresh(),i.app.trigger("change")})},error:function(t){this.$error_text.html(t),this.$error.show(),this.$el.addClass("ui-error")},reset:function(){this.$error.hide(),this.$el.removeClass("ui-error")},_refresh:function(){this.$optional_icon.removeClass().addClass("icon"),this.field.collapsed?(this.$field.hide(),this._tooltip(this.text_enable,this.cls_enable),this.field.value&&this.field.value(this.default_value)):(this.$field.fadeIn("fast"),this._tooltip(this.text_disable,this.cls_disable),this.app.trigger("change"))},_tooltip:function(t,e){this.$optional.length&&this.$optional_icon.addClass(e).tooltip({placement:"bottom"}).attr("data-original-title",t).tooltip("fixTitle").tooltip("hide")},_template:function(t){var e='<div class="ui-table-form-element input-name-'+t.name+'"><div class="ui-table-form-error ui-error"><span class="fa fa-arrow-down"/><span class="ui-table-form-error-text"/></div><div class="ui-table-form-title">';return e+=t.collapsible?'<div class="ui-table-form-optional"><i class="icon"/>'+t.label+"</div>":t.label,e+='</div><div class="ui-table-form-field">',e+='<div class="ui-table-form-info">',t.help&&(e+=t.help,t.argument&&-1==t.help.indexOf("("+t.argument+")")&&(e+=" ("+t.argument+")")),e+="</div>",e+="</div></div>"}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(4),i(64),i(76),i(75),i(72)],s=function(t,e,i,n,s,a){return Backbone.Model.extend({types:{text:"_fieldText",select:"_fieldSelect",data_column:"_fieldSelect",genomebuild:"_fieldSelect",data:"_fieldData",data_collection:"_fieldData",integer:"_fieldSlider","float":"_fieldSlider","boolean":"_fieldBoolean",drill_down:"_fieldDrilldown",color:"_fieldColor",hidden:"_fieldHidden",hidden_data:"_fieldHidden",baseurl:"_fieldHidden",library_data:"_fieldLibrary",ftpfile:"_fieldFtp"},initialize:function(t,e){this.app=t},create:function(t){void 0===t.value&&(t.value=null),void 0===t.default_value&&(t.default_value=t.value);
var e=null,i=this.types[t.type];return i&&"function"==typeof this[i]&&(e=this[i].call(this,t)),e||(this.app.incompatible=!0,e=t.options?this._fieldSelect(t):this._fieldText(t),console.debug("tools-form::_addRow() : Auto matched field type ("+t.type+").")),void 0!==t.value&&e.value(t.value),e},_fieldData:function(e){if(this.app.options.is_workflow)return e.info="Data input '"+e.name+"' ("+t.textify(e.extensions.toString())+")",e.value=null,this._fieldHidden(e);var n=this;return new i.View(this.app,{id:"field-"+e.id,extensions:e.extensions,optional:e.optional,multiple:e.multiple,type:e.type,data:e.options,onchange:function(){n.app.trigger("change")}})},_fieldSelect:function(t){if(0==t.options.length&&this.app.options.is_workflow)return this._fieldText(t);"data_column"==t.type&&(t.error_text="Missing columns in referenced dataset.");var i=[];for(var n in t.options){var s=t.options[n];i.push({label:s[0],value:s[1]})}var a=e.Select;switch(t.display){case"checkboxes":a=e.Checkbox;break;case"radio":a=e.Radio}var o=this;return new a.View({id:"field-"+t.id,data:i,error_text:t.error_text||"No options available",optional:t.optional&&null===t.default_value,multiple:t.multiple,optional:t.optional,searchable:t.searchable,onchange:function(){o.app.trigger("change")}})},_fieldDrilldown:function(t){if(0==t.options.length&&this.app.options.is_workflow)return this._fieldText(t);var i=this;return new e.Drilldown.View({id:"field-"+t.id,data:t.options,display:t.display,onchange:function(){i.app.trigger("change")}})},_fieldText:function(i){if(i.options)if(i.area=i.multiple,t.validate(i.value)){if($.isArray(i.value)){var n="";for(var s in i.value){if(n+=String(i.value[s]),!i.multiple)break;n+="\n"}i.value=n}}else i.value="";var a=this;return new e.Input({id:"field-"+i.id,area:i.area,onchange:function(){a.app.trigger("change")}})},_fieldSlider:function(t){var i=this;return new e.Slider.View({id:"field-"+t.id,precise:"float"==t.type,min:t.min,max:t.max,onchange:function(){i.app.trigger("change")}})},_fieldHidden:function(t){return new e.Hidden({id:"field-"+t.id,info:t.info})},_fieldBoolean:function(t){var i=this;return new e.RadioButton.View({id:"field-"+t.id,data:[{label:"Yes",value:"true"},{label:"No",value:"false"}],onchange:function(){i.app.trigger("change")}})},_fieldColor:function(t){var e=this;return new a({id:"field-"+t.id,onchange:function(){e.app.trigger("change")}})},_fieldLibrary:function(t){var e=this;return new n.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:function(){e.app.trigger("change")}})},_fieldFtp:function(t){var e=this;return new s.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:function(){e.app.trigger("change")}})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(22),i(8),i(4)],s=function(t,e,i,n){var s=Backbone.View.extend({optionsDefault:{title:"Section",max:null,min:null},initialize:function(i){this.options=t.merge(i,this.optionsDefault),this.setElement("<div/>");this.button_new=new n.ButtonIcon({icon:"fa-plus",title:"Insert "+i.title_new,tooltip:"Add new "+i.title_new+" block",floating:"clear",onclick:function(){i.onnew&&i.onnew()}}),this.table=new e.View({cls:"ui-table-plain",content:""}),this.$el.append(this.table.$el),this.$el.append($("<div/>").append(this.button_new.$el)),this.list={},this.n=0},size:function(){return this.n},add:function(t){if(!t.id||this.list[t.id])return void console.debug("form-repeat::add - Duplicate repeat block id.");this.n++;var e=new n.ButtonIcon({icon:"fa-trash-o",tooltip:"Delete this repeat block",cls:"ui-button-icon-plain",onclick:function(){t.ondel&&t.ondel()}}),s=new i.View({id:t.id,title:"placeholder",cls:"ui-portlet-repeat",operations:{button_delete:e}});s.append(t.$el),s.$el.addClass("section-row"),this.list[t.id]=s,this.table.add(s.$el),this.table.append("row_"+t.id,!0),this.options.max>0&&this.n>=this.options.max&&this.button_new.disable(),this._refresh()},del:function(t){if(!this.list[t])return void console.debug("form-repeat::del - Invalid repeat block id.");this.n--;var e=this.table.get("row_"+t);e.remove(),delete this.list[t],this.button_new.enable(),this._refresh()},_refresh:function(){var t=0;for(var e in this.list){var i=this.list[e];i.title(++t+": "+this.options.title),this.n>this.options.min?i.showOperation("button_delete"):i.hideOperation("button_delete")}}});return{View:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(22),i(4),i(8),i(62),i(60),i(61)],s=function(t,e,i,n,s,a,o){var r=Backbone.View.extend({initialize:function(t,i){this.app=t,this.inputs=i.inputs,i.cls="ui-table-plain",i.cls_tr="section-row",this.table=new e.View(i),this.parameters=new o(t,i),this.setElement(this.table.$el),this.render()},render:function(){this.table.delAll();for(var t in this.inputs)this.add(this.inputs[t])},add:function(e){var i=jQuery.extend(!0,{},e);i.id=e.id=t.uid(),this.app.input_list[i.id]=i;var n=i.type;switch(n){case"conditional":this._addConditional(i);break;case"repeat":this._addRepeat(i);break;case"section":this._addSection(i);break;default:this._addRow(i)}},_addConditional:function(t){var e=this;t.test_param.id=t.id;var i=this._addRow(t.test_param);i.options.onchange=function(i){var n=e.app.data.matchCase(t,i);for(var s in t.cases){var a=t.cases[s],o=t.id+"-section-"+s,r=e.table.get(o),l=!1;for(var c in a.inputs)if(!a.inputs[c].hidden){l=!0;break}s==n&&l?r.fadeIn("fast"):r.hide()}e.app.trigger("change")};for(var n in t.cases){var s=t.id+"-section-"+n,a=new r(this.app,{inputs:t.cases[n].inputs});a.$el.addClass("ui-table-section"),this.table.add(a.$el),this.table.append(s)}i.trigger("change")},_addRepeat:function(t){function e(e){var s=t.id+"-section-"+n++,a=new r(i.app,{inputs:e});o.add({id:s,$el:a.$el,ondel:function(){o.del(s),i.app.trigger("change")}})}for(var i=this,n=0,o=new s.View({title:t.title,title_new:t.title,min:t.min,max:t.max,onnew:function(){e(t.inputs),i.app.trigger("change")}}),l=t.min,c=_.size(t.cache),d=0;d<Math.max(c,l);d++){var h=null;h=c>d?t.cache[d]:t.inputs,e(h)}var u=new a(this.app,{label:t.title,help:t.help,field:o});this.table.add(u.$el),this.table.append(t.id)},_addSection:function(t){var e=this,s=new r(e.app,{inputs:t.inputs}),a=new i.ButtonIcon({icon:"fa-eye-slash",tooltip:"Show/hide section",cls:"ui-button-icon-plain"}),o=new n.View({title:t.title,cls:"ui-portlet-section",operations:{button_visible:a}});o.append(s.$el),o.append($("<div/>").addClass("ui-table-form-info").html(t.help));var l=!1;o.$content.hide(),o.$header.css("cursor","pointer"),o.$header.on("click",function(){l?(l=!1,o.$content.hide(),a.setIcon("fa-eye-slash")):(l=!0,o.$content.fadeIn("fast"),a.setIcon("fa-eye"))}),this.app.on("expand",function(t){o.$el.find("#"+t).length>0&&!l&&o.$header.trigger("click")}),t.expanded&&o.$header.trigger("click"),this.table.add(o.$el),this.table.append(t.id)},_addRow:function(t){var e=t.id,i=this.parameters.create(t);this.app.field_list[e]=i;var n=new a(this.app,{name:t.name,label:t.label||t.name,value:t.value,default_value:t.default_value,collapsible:t.collapsible,collapsible_value:t.collapsible_value,help:t.help,argument:t.argument,field:i});return this.app.element_list[e]=n,this.table.add(n.$el),this.table.append(e),t.hidden&&this.table.get(e).hide(),i}});return{View:r}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(4),i(46),i(20)],s=function(t,e,i,n){var s=Backbone.View.extend({initialize:function(i,n){this.app=i,this.options=n,this.history={};var s=this;this.setElement('<div class="ui-select-content"/>'),this.list={};var a=[];"data_collection"==n.type?this.mode="collection":n.multiple?this.mode="multiple":this.mode="single",this.current=this.mode,this.list={};var o=t.textify(n.extensions),r="No dataset available.";o&&(r="No "+o+" dataset available.");var l="No dataset list available.";o&&(l="No "+o+" dataset collection available."),"single"==this.mode&&(a.push({icon:"fa-file-o",value:"single",tooltip:"Single dataset"}),this.select_single=new e.Select.View({optional:n.optional,error_text:r,onchange:function(){s.trigger("change")}}),this.list.single={field:this.select_single,type:"hda"}),("single"==this.mode||"multiple"==this.mode)&&(a.push({icon:"fa-files-o",value:"multiple",tooltip:"Multiple datasets"}),this.select_multiple=new e.Select.View({multiple:!0,searchable:!1,optional:n.optional,error_text:r,onchange:function(){s.trigger("change")}}),this.list.multiple={field:this.select_multiple,type:"hda"}),("single"==this.mode||"multiple"==this.mode||"collection"==this.mode)&&(a.push({icon:"fa-folder-o",value:"collection",tooltip:"Dataset collection"}),this.select_collection=new e.Select.View({error_text:l,optional:n.optional,onchange:function(){s.trigger("change")}}),this.list.collection={field:this.select_collection,type:"hdca"}),this.button_type=new e.RadioButton.View({value:this.current,data:a,onchange:function(t){s.current=t,s.refresh(),s.trigger("change")}}),this.$batch=$(this.template_batch());var c=_.size(this.list),d=0;c>1&&(this.$el.append(this.button_type.$el),d=Math.max(0,35*_.size(this.list))+"px");for(var h in this.list)this.$el.append(this.list[h].field.$el.css({"margin-left":d}));this.$el.append(this.$batch.css({"margin-left":d})),this.update(n.data),void 0!==this.options.value&&this.value(this.options.value),this.refresh(),this.on("change",function(){n.onchange&&n.onchange(s.value())})},wait:function(){for(var t in this.list)this.list[t].field.wait()},unwait:function(){for(var t in this.list)this.list[t].field.unwait()},update:function(t){function e(t,e){if(t){var n=[];for(var s in e){var a=e[s];n.push({label:a.hid+": "+a.name,value:a.id}),i.history[a.id+"_"+a.src]=a}t.update(n)}}var i=this;e(this.select_single,t.hda),e(this.select_multiple,t.hda),e(this.select_collection,t.hdca)},value:function(t){if(void 0!==t)if(t&&t.values)try{var e=[];for(var i in t.values)e.push(t.values[i].id);t&&t.values.length>0&&"hdca"==t.values[0].src?(this.current="collection",this.select_collection.value(e[0])):"multiple"==this.mode?(this.current="multiple",this.select_multiple.value(e)):(this.current="single",this.select_single.value(e[0]))}catch(n){console.debug("tools-select-content::value() - Skipped.")}else for(var i in this.list)this.list[i].field.value(null);this.refresh();var s=this._select().value();if(null===s)return null;if(s instanceof Array||(s=[s]),0===s.length)return null;var a={batch:this._batch(),values:[]};for(var i in s){var o=this.history[s[i]+"_"+this.list[this.current].type];if(!o)return null;a.values.push(o)}return a.values.sort(function(t,e){return t.hid-e.hid}),a},refresh:function(){this.button_type.value(this.current);for(var t in this.list){var e=this.list[t].field.$el;this.current==t?e.show():e.hide()}this._batch()?this.$batch.show():this.$batch.hide()},_select:function(){return this.list[this.current].field},_batch:function(){if("collection"==this.current){var t=this.history[this._select().value()+"_hdca"];if(t&&t.map_over_type)return!0}return"single"!=this.current&&"single"==this.mode?!0:!1},template_batch:function(){return'<div class="ui-table-form-info"><i class="fa fa-sitemap" style="font-size: 1.2em; padding: 2px 5px;"/>This is a batch mode input field. A separate job will be triggered for each dataset.</div>'}});return{View:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(8),i(4),i(63),i(59)],s=function(t,e,i,n,s){return Backbone.View.extend({initialize:function(e){this.optionsDefault={is_workflow:!1,initial_errors:!1,cls:"ui-portlet-limited"},this.options=t.merge(e,this.optionsDefault),console.debug(this.options);var n=parent.Galaxy;n&&n.modal?this.modal=n.modal:this.modal=new i.Modal.View,this.setElement("<div/>"),this._build()},update:function(t){var e=this;this.data.matchModel(t,function(t,i){var n=e.input_list[t];if(n&&n.options&&!_.isEqual(n.options,i.options)){n.options=i.options;var s=e.field_list[t];if(s.update){var a=[];if(-1!=["data","data_collection","drill_down"].indexOf(n.type))a=n.options;else for(var o in i.options){var r=i.options[o];r.length>2&&a.push({label:r[0],value:r[1]})}s.update(a),s.trigger("change"),console.debug("Updating options for "+t)}}})},wait:function(t){for(var e in this.input_list){var i=this.field_list[e],n=this.input_list[e];n.is_dynamic&&i.wait&&i.unwait&&(t?i.wait():i.unwait())}},highlight:function(t,e,i){var n=this.element_list[t];if(n&&(n.error(e||"Please verify this parameter."),this.trigger("expand",t),!i))if(self==top){var s=this.$el.parents().filter(function(){return"auto"==$(this).css("overflow")}).first();s.animate({scrollTop:s.scrollTop()+n.$el.offset().top-50},500)}else $("html, body").animate({scrollTop:n.$el.offset().top-20},500)},errors:function(t){if(this.trigger("reset"),t&&t.errors){var e=this.data.matchResponse(t.errors);for(var i in this.element_list){this.element_list[i];e[i]&&this.highlight(i,e[i],!0)}}},_build:function(){var t=this;this.off("change"),this.off("reset"),this.field_list={},this.input_list={},this.element_list={},this.data=new s(this),this._renderForm(),this.data.create(),this.options.initial_errors&&this.errors(this.options);var e=this.data.checksum();this.on("change",function(){var i=t.data.checksum();i!=e&&(e=i,t.options.onchange&&t.options.onchange())}),this.on("reset",function(){for(var t in this.element_list)this.element_list[t].reset()})},_renderForm:function(){this.message=new i.Message,this.section=new n.View(this,{inputs:this.options.inputs}),$(".tooltip").remove(),this.portlet=new e.View({icon:"fa-wrench",title:this.options.title,cls:this.options.cls,operations:this.options.operations,buttons:this.options.buttons}),this.portlet.append(this.message.$el.addClass("ui-margin-top")),this.portlet.append(this.section.$el),this.$el.empty(),this.$el.append(this.portlet.$el),this.options.message&&this.message.update({persistent:!0,status:"warning",message:this.options.message}),console.debug("tools-form-base::initialize() - Completed.")}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(28),i(30),i(3),i(1)],s=function(t,e,i,n){var s=t.DatasetListItemEdit,a=s.extend({className:s.prototype.className+" history-content",_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):t.model.has("rerunnable")?jQuery.when():t.model.fetch({silent:!0,data:{keys:["rerunnable","creating_job"].join(",")}})},events:_.extend(_.clone(s.prototype.events),{"click .unhide-link":function(t){return this.model.unhide(),!1}}),toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAListItemEdit("+t+")"}});return a.prototype.templates=function(){var t=_.extend({},s.prototype.templates.warnings,{hidden:i.wrapTemplate(["<% if( !dataset.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',n("This dataset has been hidden"),'<br /><a class="unhide-link" a href="javascript:void(0);">',n("Unhide it"),"</a>","</div>","<% } %>"],"dataset")});return _.extend({},s.prototype.templates,{titleBar:e.HDAListItemView.prototype.templates.titleBar,warnings:t})}(),{HDAListItemEdit:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(32),i(56),i(7),i(1)],s=function(t,e,i,n){var s=t.HDCAListItemView,a=s.extend({_getFoldoutPanelClass:function(){switch(this.model.get("collection_type")){case"list":return e.ListCollectionPanelEdit;case"paired":return e.PairCollectionPanelEdit;case"list:paired":return e.ListOfPairsCollectionPanelEdit}throw new TypeError("Uknown collection_type: "+this.model.get("collection_type"))},_renderPrimaryActions:function(){return this.log(this+"._renderPrimaryActions"),s.prototype._renderPrimaryActions.call(this).concat([this._renderDeleteButton()])},_renderDeleteButton:function(){var t=this,e=this.model.get("deleted");return i({title:n(e?"Dataset collection is already deleted":"Delete"),classes:"delete-btn",faIcon:"fa-times",disabled:e,onclick:function(){t.$el.find(".icon-btn.delete-btn").trigger("mouseout"),t.model["delete"]()}})},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDCAListItemEdit("+t+")"}});return{HDCAListItemEdit:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(69),i(18),i(6),i(31),i(66),i(67),i(35),i(26),i(14),i(58),i(57),i(7),i(24),i(1)],s=function(t,e,i,n,s,a,o,r,l,c,d,h,u,p){var f=t.HistoryPanel,m=f.extend({HDAViewClass:s.HDAListItemEdit,HDCAViewClass:a.HDCAListItemEdit,initialize:function(t){t=t||{},f.prototype.initialize.call(this,t),this.tagsEditor=null,this.annotationEditor=null,this.purgeAllowed=t.purgeAllowed||!1,this.annotationEditorShown=t.annotationEditorShown||!1,this.tagsEditorShown=t.tagsEditorShown||!1},_setUpListeners:function(){var t=this;f.prototype._setUpListeners.call(t),t.on("drop",function(e,i){t.dataDropped(i),t.dropTargetOff()}),t.on("view:attached view:removed",function(){t._renderCounts()},t)},_setUpCollectionListeners:function(){return f.prototype._setUpCollectionListeners.call(this),this.collection.on("change:deleted",this._handleHdaDeletionChange,this),this.collection.on("change:visible",this._handleHdaVisibleChange,this),this.collection.on("change:purged",function(t){this.model.fetch()},this),this},_setUpModelListeners:function(){return f.prototype._setUpModelListeners.call(this),this.model.on("change:size",this.updateHistoryDiskSize,this),this},_buildNewRender:function(){var t=f.prototype._buildNewRender.call(this);return this.model?(Galaxy&&Galaxy.currUser&&Galaxy.currUser.id&&Galaxy.currUser.id===this.model.get("user_id")&&(this._renderTags(t),this._renderAnnotation(t)),t):t},renderItems:function(t){var e=f.prototype.renderItems.call(this,t);return this._renderCounts(t),e},_renderCounts:function(t){function e(t,e){return['<a class="',t,'" href="javascript:void(0);">',e,"</a>"].join("")}t=t||this.$el;var i=this.collection.where({deleted:!0}),n=this.collection.where({visible:!1}),s=[];return this.views.length&&s.push([this.views.length,p("shown")].join(" ")),i.length&&s.push(this.showDeleted?e("toggle-deleted-link",p("hide deleted")):[i.length,e("toggle-deleted-link",p("deleted"))].join(" ")),n.length&&s.push(this.showHidden?e("toggle-hidden-link",p("hide hidden")):[n.length,e("toggle-hidden-link",p("hidden"))].join(" ")),t.find("> .controls .subtitle").html(s.join(", "))},_renderTags:function(t){var e=this;this.tagsEditor=new o.TagsEditor({model:this.model,el:t.find(".controls .tags-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.toggleHDATagEditors(!0,e.fxSpeed)},onhide:function(){e.toggleHDATagEditors(!1,e.fxSpeed)},$activator:h({title:p("Edit history tags"),classes:"history-tag-btn",faIcon:"fa-tags"}).appendTo(t.find(".controls .actions"))})},_renderAnnotation:function(t){var e=this;this.annotationEditor=new r.AnnotationEditor({model:this.model,el:t.find(".controls .annotation-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.toggleHDAAnnotationEditors(!0,e.fxSpeed)},onhide:function(){e.toggleHDAAnnotationEditors(!1,e.fxSpeed)},$activator:h({title:p("Edit history annotation"),classes:"history-annotate-btn",faIcon:"fa-comment"}).appendTo(t.find(".controls .actions"))})},_setUpBehaviors:function(t){if(t=t||this.$el,f.prototype._setUpBehaviors.call(this,t),this.model&&Galaxy.currUser&&!Galaxy.currUser.isAnonymous()&&Galaxy.currUser.id===this.model.get("user_id")){var e=this,i="> .controls .name";t.find(i).attr("title",p("Click to rename history")).tooltip({placement:"bottom"}).make_text_editable({on_finish:function(t){var n=e.model.get("name");t&&t!==n?(e.$el.find(i).text(t),e.model.save({name:t}).fail(function(){e.$el.find(i).text(e.model.previous("name"))})):e.$el.find(i).text(n)}})}},multiselectActions:function(){var t=this,e=[{html:p("Hide datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.hide;t.getSelectedModels().ajaxQueue(e)}},{html:p("Unhide datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.unhide;t.getSelectedModels().ajaxQueue(e)}},{html:p("Delete datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype["delete"];t.getSelectedModels().ajaxQueue(e)}},{html:p("Undelete datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.undelete;t.getSelectedModels().ajaxQueue(e)}}];return t.purgeAllowed&&e.push({html:p("Permanently delete datasets"),func:function(){if(confirm(p("This will permanently remove the data in your datasets. Are you sure?"))){var e=n.HistoryDatasetAssociation.prototype.purge;t.getSelectedModels().ajaxQueue(e)}}}),e=e.concat(t._collectionActions())},_collectionActions:function(){var t=this;return[{html:p("Build Dataset List"),func:function(){l.createListCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}},{html:p("Build Dataset Pair"),func:function(){c.createPairCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}},{html:p("Build List of Dataset Pairs"),func:function(){d.createListOfPairsCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}}]},_attachItems:function(t){return this.$list(t).append(this.views.reverse().map(function(t){return t.$el})),this},_attachView:function(t){var e=this;e.views.unshift(t),e.$list().prepend(t.render(0).$el.hide()),e.trigger("view:attached",t),t.$el.slideDown(e.fxSpeed,function(){e.trigger("view:attached:rendered")})},_getItemViewOptions:function(t){var e=f.prototype._getItemViewOptions.call(this,t);return _.extend(e,{purgeAllowed:this.purgeAllowed,tagsEditorShown:this.tagsEditor&&!this.tagsEditor.hidden,annotationEditorShown:this.annotationEditor&&!this.annotationEditor.hidden}),e},_handleHdaDeletionChange:function(t){t.get("deleted")&&!this.showDeleted&&this.removeItemView(t),this._renderCounts()},_handleHdaVisibleChange:function(t){t.hidden()&&!this.showHidden&&this.removeItemView(t),this._renderCounts()},toggleHDATagEditors:function(t){var e=Array.prototype.slice.call(arguments,1);_.each(this.views,function(t){t.tagsEditor&&t.tagsEditor.toggle.apply(t.tagsEditor,e)})},toggleHDAAnnotationEditors:function(t){var e=Array.prototype.slice.call(arguments,1);_.each(this.views,function(t){t.annotationEditor&&t.annotationEditor.toggle.apply(t.annotationEditor,e)})},events:_.extend(_.clone(f.prototype.events),{"click .show-selectors-btn":"toggleSelectors","click .toggle-deleted-link":function(t){this.toggleShowDeleted()},"click .toggle-hidden-link":function(t){this.toggleShowHidden()}}),updateHistoryDiskSize:function(){this.$el.find(".history-size").text(this.model.get("nice_size"))},dropTargetOn:function(){if(this.dropTarget)return this;this.dropTarget=!0;var t={dragenter:_.bind(this.dragenter,this),dragover:_.bind(this.dragover,this),dragleave:_.bind(this.dragleave,this),drop:_.bind(this.drop,this)},e=this._renderDropTarget();this.$list().before([this._renderDropTargetHelp(),e]);for(var i in t)t.hasOwnProperty(i)&&e.on(i,t[i]);return this},_renderDropTarget:function(){return this.$(".history-drop-target").remove(),$("<div/>").addClass("history-drop-target").css({height:"64px",margin:"0px 10px 10px 10px",border:"1px dashed black","border-radius":"3px"})},_renderDropTargetHelp:function(){return this.$(".history-drop-target-help").remove(),$("<div/>").addClass("history-drop-target-help").css({margin:"10px 10px 4px 10px",color:"grey","font-size":"80%","font-style":"italic"}).text(p("Drag datasets here to copy them to the current history"))},dropTargetOff:function(){if(!this.dropTarget)return this;this.dropTarget=!1;var t=this.$(".history-drop-target").get(0);for(var e in this._dropHandlers)this._dropHandlers.hasOwnProperty(e)&&t.off(e,this._dropHandlers[e]);return this.$(".history-drop-target").remove(),this.$(".history-drop-target-help").remove(),this},dropTargetToggle:function(){return this.dropTarget?this.dropTargetOff():this.dropTargetOn(),this},dragenter:function(t){t.preventDefault(),t.stopPropagation(),this.$(".history-drop-target").css("border","2px solid black")},dragover:function(t){t.preventDefault(),t.stopPropagation()},dragleave:function(t){t.preventDefault(),t.stopPropagation(),this.$(".history-drop-target").css("border","1px dashed black")},drop:function(t){t.preventDefault(),t.dataTransfer.dropEffect="move";var e=this,i=t.dataTransfer.getData("text");try{i=JSON.parse(i)}catch(n){this.warn("error parsing JSON from drop:",i)}return this.trigger("droptarget:drop",t,i,e),!1},dataDropped:function(t){var e=this;return _.isObject(t)&&"HistoryDatasetAssociation"===t.model_class&&t.id?e.model.contents.copy(t.id):jQuery.when()},toString:function(){return"HistoryPanelEdit("+(this.model?this.model.get("name"):"")+")"}});return{HistoryPanelEdit:m}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(34),i(33),i(18),i(30),i(32),i(10),i(39),i(7),i(24),i(3),i(1),i(41)],s=function(t,e,i,n,s,a,o,r,l,c,d){var h=c.SessionStorageModel.extend({defaults:{expandedIds:{},show_deleted:!1,show_hidden:!1},addExpanded:function(t){var e="expandedIds";this.save(e,_.extend(this.get(e),_.object([t.id],[t.get("id")])))},removeExpanded:function(t){var e="expandedIds";this.save(e,_.omit(this.get(e),t.id))},toString:function(){return"HistoryPrefs("+this.id+")"}});h.storageKeyPrefix="history:",h.historyStorageKey=function(t){if(!t)throw new Error("HistoryPrefs.historyStorageKey needs valid id: "+t);return h.storageKeyPrefix+t},h.get=function(t){return new h({id:h.historyStorageKey(t)})},h.clearAll=function(t){for(var e in sessionStorage)0===e.indexOf(h.storageKeyPrefix)&&sessionStorage.removeItem(e)};var u=t.ModelListPanel,p=u.extend({HDAViewClass:n.HDAListItemView,HDCAViewClass:s.HDCAListItemView,collectionClass:i.HistoryContents,modelCollectionKey:"contents",tagName:"div",className:u.prototype.className+" history-panel",emptyMsg:d("This history is empty"),noneFoundMsg:d("No matching datasets found"),searchPlaceholder:d("search datasets"),initialize:function(t){u.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank"},freeModel:function(){return u.prototype.freeModel.call(this),this.model&&this.model.clearUpdateTimeout(),this},_setUpListeners:function(){u.prototype._setUpListeners.call(this),this.on({error:function(t,e,i,n,s){this.errorHandler(t,e,i,n,s)},"loading-done":function(){this.views.length||this.trigger("empty-history",this)},"views:ready view:attached view:removed":function(t){this._renderSelectButton()}})},loadHistoryWithDetails:function(t,e,i,n){this.info("loadHistoryWithDetails:",t,e,i,n);var s=function(t){return _.values(h.get(t.id).get("expandedIds"))};return this.loadHistory(t,e,i,n,s)},loadHistory:function(t,i,n,s,a){this.info("loadHistory:",t,i,n,s,a);var o=this;i=i||{},o.trigger("loading",o);var r=e.History.getHistoryData(t,{historyFn:n,contentsFn:s,detailIdsFn:i.initiallyExpanded||a});return o._loadHistoryFromXHR(r,i).fail(function(e,n,s){o.trigger("error",o,e,i,d("An error was encountered while "+n),{historyId:t,history:s||{}})}).always(function(){o.trigger("loading-done",o)})},_loadHistoryFromXHR:function(t,e){var i=this;return t.then(function(t,n){i.JSONToModel(t,n,e),i.render()}),t.fail(function(t,e){i.render()}),t},refreshContents:function(t,e){return this.model?this.model.refresh(t,e):$.when()},JSONToModel:function(t,i,n){this.log("JSONToModel:",t,i,n),n=n||{};var s=new e.History(t,i,n);return this.setModel(s),s},setModel:function(t,e){e=e||{},u.prototype.setModel.call(this,t,e),this.model&&this._setUpWebStorage(e.initiallyExpanded,e.show_deleted,e.show_hidden)},_setUpWebStorage:function(t,e,i){return this.storage&&this.stopListening(this.storage),this.storage=new h({id:h.historyStorageKey(this.model.get("id"))}),_.isObject(t)&&this.storage.set("expandedIds",t),_.isBoolean(e)&&this.storage.set("show_deleted",e),_.isBoolean(i)&&this.storage.set("show_hidden",i),this.trigger("new-storage",this.storage,this),this.log(this+" (init'd) storage:",this.storage.get()),this.listenTo(this.storage,{"change:show_deleted":function(t,e){this.showDeleted=e},"change:show_hidden":function(t,e){this.showHidden=e}},this),this.showDeleted=void 0!==e?e:this.storage.get("show_deleted"),this.showHidden=void 0!==i?i:this.storage.get("show_hidden"),this},_buildNewRender:function(){var t=u.prototype._buildNewRender.call(this);return this._renderSelectButton(t),t},_renderSelectButton:function(t){if(t=t||this.$el,!this.multiselectActions().length)return null;if(!this.views.length)return this.hideSelectors(),t.find(".controls .actions .show-selectors-btn").remove(),null;var e=t.find(".controls .actions .show-selectors-btn");return e.size()?e:r({title:d("Operations on multiple datasets"),classes:"show-selectors-btn",faIcon:"fa-check-square-o"}).prependTo(t.find(".controls .actions"))},_getItemViewClass:function(t){var e=t.get("history_content_type");switch(e){case"dataset":return this.HDAViewClass;case"dataset_collection":return this.HDCAViewClass}throw new TypeError("Unknown history_content_type: "+e)},_filterItem:function(t){var e=this;return u.prototype._filterItem.call(e,t)&&(!t.hidden()||e.showHidden)&&(!t.isDeletedOrPurged()||e.showDeleted)},_getItemViewOptions:function(t){var e=u.prototype._getItemViewOptions.call(this,t);return _.extend(e,{linkTarget:this.linkTarget,expanded:!!this.storage.get("expandedIds")[t.id],hasUser:this.model.ownedByCurrUser()})},_setUpItemViewListeners:function(t){var e=this;return u.prototype._setUpItemViewListeners.call(e,t),t.on("expanded",function(t){e.storage.addExpanded(t.model)}),t.on("collapsed",function(t){e.storage.removeExpanded(t.model)}),this},getSelectedModels:function(){var t=u.prototype.getSelectedModels.call(this);return t.historyId=this.collection.historyId,t},events:_.extend(_.clone(u.prototype.events),{"click .show-selectors-btn":"toggleSelectors","click .messages [class$=message]":"clearMessages"}),toggleShowDeleted:function(t,e){return t=void 0!==t?t:!this.showDeleted,e=void 0!==e?e:!0,this.showDeleted=t,e&&this.storage.set("show_deleted",t),this.renderItems(),this.trigger("show-deleted",t),this.showDeleted},toggleShowHidden:function(t,e){return t=void 0!==t?t:!this.showHidden,e=void 0!==e?e:!0,this.showHidden=t,e&&this.storage.set("show_hidden",t),this.renderItems(),this.trigger("show-hidden",t),this.showHidden},_firstSearch:function(t){var e=this,i=".history-search-input";return this.log("onFirstSearch",t),e.model.contents.haveDetails()?void e.searchItems(t):(e.$el.find(i).searchInput("toggle-loading"),void e.model.contents.fetchAllDetails({silent:!0}).always(function(){e.$el.find(i).searchInput("toggle-loading")}).done(function(){e.searchItems(e.searchFor)}))},errorHandler:function(t,e,i,n,s){if(this.error(t,e,i,n,s),e&&0===e.status&&0===e.readyState);else if(e&&502===e.status);else{var a=this._parseErrorMessage(t,e,i,n,s);this.$messages().is(":visible")?this.displayMessage("error",a.message,a.details):this.once("rendered",function(){this.displayMessage("error",a.message,a.details)})}},_parseErrorMessage:function(t,e,i,n,s,a){var r=Galaxy.currUser,l={message:this._bePolite(n),details:{message:n,raven:window.Raven&&_.isFunction(Raven.lastEventId)?Raven.lastEventId():void 0,agent:navigator.userAgent,url:window.Galaxy?Galaxy.lastAjax.url:void 0,data:window.Galaxy?Galaxy.lastAjax.data:void 0,options:e?_.omit(i,"xhr"):i,xhr:e,source:_.isFunction(t.toJSON)?t.toJSON():t+"",user:r instanceof o.User?r.toJSON():r+""}};if(_.extend(l.details,s||{}),e&&_.isFunction(e.getAllResponseHeaders)){var c=e.getAllResponseHeaders();c=_.compact(c.split("\n")),c=_.map(c,function(t){return t.split(": ")}),l.details.xhr.responseHeaders=_.object(c)}return l},_bePolite:function(t){return t=t||d("An error occurred while getting updates from the server"),t+". "+d("Please contact a Galaxy administrator if the problem persists")+"."},displayMessage:function(t,e,i){var n=this;this.scrollToTop();var s=this.$messages(),a=$("<div/>").addClass(t+"message").html(e);if(!_.isEmpty(i)){var o=$('<a href="javascript:void(0)">Details</a>').click(function(){return Galaxy.modal.show(n._messageToModalOptions(t,e,i)),!1});a.append(" ",o)}return s.append(a)},_messageToModalOptions:function(t,e,i){var n=this,s={
title:"Details"};if(_.isObject(i)){i=_.omit(i,_.functions(i));var a=JSON.stringify(i,null,"  "),o=$("<pre/>").text(a);s.body=$("<div/>").append(o)}else s.body=$("<div/>").html(i);return s.buttons={Ok:function(){Galaxy.modal.hide(),n.clearMessages()}},s},clearMessages:function(t){var e=_.isUndefined(t)?this.$messages().children('[class$="message"]'):$(t.currentTarget);return e.fadeOut(this.fxSpeed,function(){$(this).remove()}),this},scrollToHid:function(t){return this.scrollToItem(_.first(this.viewsWhereModel({hid:t})))},toString:function(){return"HistoryPanel("+(this.model?this.model.get("name"):"")+")"}});return p.prototype.templates=function(){var t=c.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%= history.name %></div>',"</div>",'<div class="subtitle"></div>','<div class="history-size"><%= history.nice_size %></div>','<div class="actions"></div>','<div class="messages">',"<% if( history.deleted && history.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',d("This history has been purged and deleted"),"</div>","<% } else if( history.deleted ){ %>",'<div class="deleted-msg warningmessagesmall">',d("This history has been deleted"),"</div>","<% } else if( history.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',d("This history has been purged"),"</div>","<% } %>","<% if( history.message ){ %>",'<div class="<%= history.message.level || "info" %>messagesmall">',"<%= history.message.text %>","</div>","<% } %>","</div>",'<div class="tags-display"></div>','<div class="annotation-display"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',d("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',d("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"],"history");return _.extend(_.clone(u.prototype.templates),{controls:t})}(),{HistoryPanel:p}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(81),i(4),i(65),i(20),i(27),i(54)],s=function(t,e,i,n,s,a,o){return Backbone.View.extend({initialize:function(i){this.options=t.merge(i,{}),this.setElement("<div/>"),this.deferred=new e,i.inputs?this._buildForm(i):this._buildModel(i,!0)},_buildForm:function(e){var i=this;this.options=t.merge(e,this.options),this.options=t.merge({icon:"fa-wrench",title:"<b>"+e.name+"</b> "+e.description+" (Galaxy Tool Version "+e.version+")",operations:this._operations(),onchange:function(t){i.deferred.reset(),i.deferred.execute(function(){i._updateModel()})}},this.options),this.options.customize&&this.options.customize(this.options),this.form=new n(this.options),this._footer(),this.$el.empty(),this.$el.append(this.form.$el)},_buildModel:function(e,n){var s=this;this.options.id=e.id,this.options.version=e.version;var a="",o={};e.job_id?a=Galaxy.root+"api/jobs/"+e.job_id+"/build_for_rerun":(a=Galaxy.root+"api/tools/"+e.id+"/build",Galaxy.params&&Galaxy.params.tool_id==e.id&&(o=$.extend({},Galaxy.params),e.version&&(o.tool_version=e.version)));var r=this.deferred.register();t.request({type:"GET",url:a,data:o,success:function(t){s._buildForm(t.tool_model||t),!n&&s.form.message.update({status:"success",message:"Now you are using '"+s.options.name+"' version "+s.options.version+".",persistent:!1}),s.deferred.done(r),console.debug("tools-form::initialize() - Initial tool model ready."),console.debug(t)},error:function(t){s.deferred.done(r),console.debug("tools-form::initialize() - Initial tool model request failed."),console.debug(t);var e=t&&t.err_msg||"Uncaught error.";s.$el.is(":empty")?s.$el.prepend(new i.Message({message:e,status:"danger",persistent:!0,large:!0}).$el):Galaxy.modal.show({title:"Tool request failed",body:e,buttons:{Close:function(){Galaxy.modal.hide()}}})}})},_updateModel:function(){var e=this.options.update_url||Galaxy.root+"api/tools/"+this.options.id+"/build",i=this,n=this.form,s={tool_id:this.options.id,tool_version:this.options.version,inputs:$.extend(!0,{},i.form.data.create())};n.wait(!0);var a=this.deferred.register();console.debug("tools-form-base::_updateModel() - Sending current state (see below)."),console.debug(s),t.request({type:"POST",url:e,data:s,success:function(t){i.form.update(t.tool_model||t),i.options.update&&i.options.update(t),n.wait(!1),console.debug("tools-form-base::_updateModel() - Received new model (see below)."),console.debug(t),i.deferred.done(a)},error:function(t){i.deferred.done(a),console.debug("tools-form-base::_updateModel() - Refresh request failed."),console.debug(t)}})},_operations:function(){var t=this,e=this.options,n=new i.ButtonMenu({icon:"fa-cubes",title:!e.narrow&&"Versions"||null,tooltip:"Select another tool version"});if(!e.is_workflow&&e.versions&&e.versions.length>1)for(var a in e.versions){var o=e.versions[a];o!=e.version&&n.addMenu({title:"Switch to "+o,version:o,icon:"fa-cube",onclick:function(){var i=e.id.replace(e.version,this.version),n=this.version;t.deferred.reset(),t.deferred.execute(function(){t._buildModel({id:i,version:n})})}})}else n.$el.hide();var r=new i.ButtonMenu({icon:"fa-caret-down",title:!e.narrow&&"Options"||null,tooltip:"View available options"});return e.biostar_url&&(r.addMenu({icon:"fa-question-circle",title:"Question?",tooltip:"Ask a question about this tool (Biostar)",onclick:function(){window.open(e.biostar_url+"/p/new/post/")}}),r.addMenu({icon:"fa-search",title:"Search",tooltip:"Search help for this tool (Biostar)",onclick:function(){window.open(e.biostar_url+"/local/search/page/?q="+e.name)}})),r.addMenu({icon:"fa-share",title:"Share",tooltip:"Share this tool",onclick:function(){prompt("Copy to clipboard: Ctrl+C, Enter",window.location.origin+Galaxy.root+"root?tool_id="+e.id)}}),Galaxy.user&&Galaxy.user.get("is_admin")&&r.addMenu({icon:"fa-download",title:"Download",tooltip:"Download this tool",onclick:function(){window.location.href=Galaxy.root+"api/tools/"+e.id+"/download"}}),e.requirements&&e.requirements.length>0&&r.addMenu({icon:"fa-info-circle",title:"Requirements",tooltip:"Display tool requirements",onclick:function(){this.visible?(this.visible=!1,t.form.message.update({message:""})):(this.visible=!0,t.form.message.update({persistent:!0,message:s.requirements(e),status:"info"}))}}),e.sharable_url&&r.addMenu({icon:"fa-external-link",title:"See in Tool Shed",tooltip:"Access the repository",onclick:function(){window.open(e.sharable_url)}}),{menu:r,versions:n}},_footer:function(){var t=this.options;if(""!=t.help&&this.form.$el.append(s.help(t)),t.citations){var e=$("<div/>"),i=new a.ToolCitationCollection;i.tool_id=t.id;var n=new o.CitationListView({el:e,collection:i});n.render(),i.fetch(),this.form.$el.append(e)}}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(20)],s=function(t,e){return{submit:function(i,n,s){var a=this,o={tool_id:n.id,tool_version:n.version,inputs:i.data.create()};return i.trigger("reset"),this._validation(i,o)?(console.debug(o),void t.request({type:"POST",url:galaxy_config.root+"api/tools",data:o,success:function(t){s&&s(),i.$el.replaceWith(e.success(t)),a._refreshHdas()},error:function(t){if(s&&s(),console.debug(t),t&&t.err_data){var n=i.data.matchResponse(t.err_data);for(var a in n){i.highlight(a,n[a]);break}}else i.modal.show({title:"Job submission failed",body:t&&t.err_msg||e.error(o),buttons:{Close:function(){i.modal.hide()}}})}})):(console.debug("tools-jobs::submit - Submission canceled. Validation failed."),void(s&&s()))},_validation:function(t,e){var i=e.inputs,n=-1,s=null;for(var a in i){var o=i[a],r=t.data.match(a),l=t.field_list[r],c=t.input_list[r];if(r&&c&&l){if(!c.optional&&null==o)return t.highlight(r),!1;if(o&&o.batch){var d=o.values.length,h=null;if(d>0&&(h=o.values[0]&&o.values[0].src),h)if(null===s)s=h;else if(s!==h)return t.highlight(r,"Please select either dataset or dataset list fields for all batch mode fields."),!1;if(-1===n)n=d;else if(n!==d)return t.highlight(r,"Please make sure that you select the same number of inputs for all batch mode fields. This field contains <b>"+d+"</b> selection(s) while a previous field contains <b>"+n+"</b>."),!1}}else console.debug("tools-jobs::_validation - Retrieving input objects failed.")}return!0},_refreshHdas:function(t,e){parent.Galaxy&&parent.Galaxy.currHistoryPanel&&parent.Galaxy.currHistoryPanel.refreshContents(t,e)}}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){return Backbone.View.extend({colors:{standard:["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],base:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],theme:[["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7e","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"]]},initialize:function(e){this.options=t.merge(e,{}),this.setElement(this._template()),this.$panel=this.$(".ui-color-picker-panel"),this.$view=this.$(".ui-color-picker-view"),this.$value=this.$(".ui-color-picker-value"),this.$header=this.$(".ui-color-picker-header"),this._build(),this.visible=!1,this.value(this.options.value),this.$boxes=this.$(".ui-color-picker-box");var i=this;this.$boxes.on("click",function(){i.value($(this).css("background-color")),i.$header.trigger("click")}),this.$header.on("click",function(){i.visible=!i.visible,i.visible?i.$view.fadeIn("fast"):i.$view.fadeOut("fast")})},value:function(t){return void 0!==t&&null!==t&&(this.$value.css("background-color",t),this.$(".ui-color-picker-box").empty(),this.$(this._getValue()).html(this._templateCheck()),this.options.onchange&&this.options.onchange(t)),this._getValue()},_getValue:function(){function t(t){return("0"+parseInt(t).toString(16)).slice(-2)}var e=this.$value.css("background-color");return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+t(e[1])+t(e[2])+t(e[3]):null},_build:function(){this._content({label:"Theme Colors",colors:this.colors.base,padding:10});for(var t in this.colors.theme){var e={};0==t?e.bottom=!0:t!=this.colors.theme.length-1?(e.top=!0,e.bottom=!0):(e.top=!0,e.padding=5),e.colors=this.colors.theme[t],this._content(e)}this._content({label:"Standard Colors",colors:this.colors.standard,padding:5})},_content:function(t){var e=(t.label,t.colors),i=t.padding,n=t.top,s=t.bottom,a=$(this._templateContent()),o=a.find(".label");t.label?o.html(t.label):o.hide();var r=a.find(".line");this.$panel.append(a);for(var l in e){var c=$(this._templateBox(e[l]));n&&(c.css("border-top","none"),c.css("border-top-left-radius","0px"),c.css("border-top-right-radius","0px")),s&&(c.css("border-bottom","none"),c.css("border-bottom-left-radius","0px"),c.css("border-bottom-right-radius","0px")),r.append(c)}return i&&r.css("padding-bottom",i),a},_templateCheck:function(){return'<div class="ui-color-picker-check fa fa-check"/>'},_templateContent:function(){return'<div class="ui-color-picker-content"><div class="label"/><div class="line"/></div>'},_templateBox:function(t){return'<div id="'+t+'" class="ui-color-picker-box" style="background-color: #'+t+';"/>'},_template:function(){return'<div class="ui-color-picker"><div class="ui-color-picker-header"><div class="ui-color-picker-value"/><div class="ui-color-picker-label">Select a color</div></div><div class="ui-color-picker-view ui-input"><div class="ui-color-picker-panel"/></div>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,n){var s,a;s=[n(2),n(38)],a=function(t,e){var n=e.BaseIcons.extend({initialize:function(t){t.type=t.display||"checkbox",t.multiple="checkbox"==t.display,e.BaseIcons.prototype.initialize.call(this,t),this.initial=!0},value:function(t){var i=e.BaseIcons.prototype.value.call(this,t);if(this.initial&&null!==i&&this.header_index){this.initial=!1;var n=i;$.isArray(n)||(n=[n]);for(var s in n){var a=this.header_index[n[s]];for(var o in a)this._setState(a[o],!0)}}return i},_setState:function(t,e){var i=this.$(".button-"+t),n=this.$(".subgroup-"+t);i.data("is_expanded",e),e?(n.fadeIn("fast"),i.removeClass("toggle-expand"),i.addClass("toggle")):(n.hide(),i.removeClass("toggle"),i.addClass("toggle-expand"))},_templateOptions:function(e){function n(t,e){var i=t.find(".button-"+e);i.on("click",function(){a._setState(e,!i.data("is_expanded"))})}function s(e,o,r){r=r||[];for(i in o){var l=o[i],c=l.options.length>0,d=r.slice(0);a.header_index[l.value]=d.slice(0);var h=$("<div/>");if(c){var u=t.uid(),p=$('<span class="button-'+u+' ui-drilldown-button form-toggle icon-button toggle-expand"/>'),f=$('<div class="subgroup-'+u+'" style="display: none; margin-left: 25px;"/>');d.push(u);var m=$("<div/>");m.append(p),m.append(a._templateOption({label:l.name,value:l.value})),h.append(m),s(f,l.options,d),h.append(f),n(h,u)}else h.append(a._templateOption({label:l.name,value:l.value}));e.append(h)}}var a=this;this.header_index={};var o=$("<div/>");return s(o,e),o},_template:function(t){return'<div class="ui-options-list drilldown-container" id="'+t.id+'"/>'}});return{View:n}}.apply(e,s),!(void 0!==a&&(t.exports=a))},function(t,e,i){var n,s;n=[i(2),i(21)],s=function(t,e){var i=Backbone.View.extend({optionsDefault:{id:t.uid(),cls:"ui-select",error_text:"No options available",empty_text:"Nothing selected",visible:!0,wait:!1,multiple:!1,searchable:!0,optional:!1},initialize:function(i){var n=this;this.options=t.merge(i,this.optionsDefault),this.setElement(this._template(this.options)),this.$select=this.$el.find(".select"),this.$icon=this.$el.find(".icon"),this.$button=this.$el.find(".button"),this.options.multiple&&(this.options.searchable&&(this.all_button=new e.ButtonCheck({onclick:function(){var t=[];0!==n.all_button.value()&&(t=n._availableOptions()),n.value(t),n.trigger("change")}}),this.$el.prepend(this.all_button.$el)),this.$el.addClass("ui-select-multiple"),this.$select.prop("multiple",!0),this.$button.remove()),this.update(this.options.data),void 0!==this.options.value&&this.value(this.options.value),this.options.visible||this.hide(),this.options.wait?this.wait():this.show(),this.$select.on("change",function(){n.trigger("change")}),this.on("change",function(){n.options.onchange&&n.options.onchange(this.value())})},value:function(t){void 0!==t&&(null===t&&(t="__null__"),(this.exists(t)||this.options.multiple)&&(this.$select.val(t),this.$select.select2&&this.$select.select2("val",t)));var e=this._getValue();return this.all_button&&this.all_button.value($.isArray(e)&&e.length||0,this._size()),e},first:function(){var t=this.$select.find("option").first();return t.length>0?t.val():null},text:function(){return this.$select.find("option:selected").text()},show:function(){this.unwait(),this.$select.show(),this.$el.show()},hide:function(){this.$el.hide()},wait:function(){this.$icon.removeClass(),this.$icon.addClass("fa fa-spinner fa-spin")},unwait:function(){this.$icon.removeClass(),this.$icon.addClass("fa fa-caret-down")},disabled:function(){return this.$select.is(":disabled")},enable:function(){this.$select.prop("disabled",!1)},disable:function(){this.$select.prop("disabled",!0)},update:function(t){var e=this._getValue();this.$select.find("option").remove(),!this.options.multiple&&this.options.optional&&this.$select.append(this._templateOption({value:"__null__",label:this.options.empty_text}));for(var i in t)this.$select.append(this._templateOption(t[i]));0==this._size()?(this.disable(),this.$select.append(this._templateOption({value:"__null__",label:this.options.error_text}))):this.enable(),this.options.searchable&&(this.$select.select2("destroy"),this.$select.select2(),this.$(".select2-container .select2-search input").off("blur")),this.value(e),null!==this._getValue()||this.options.multiple&&this.options.optional||this.value(this.first())},setOnChange:function(t){this.options.onchange=t},exists:function(t){return this.$select.find('option[value="'+t+'"]').length>0},_getValue:function(){var e=this.$select.val();return t.validate(e)?e:null},_availableOptions:function(){var t=[];return this.$select.find("option").each(function(e,i){t.push($(i).attr("value"))}),t},_size:function(){return this.$select.find("option").length},_templateOption:function(t){return'<option value="'+t.value+'">'+t.label+"</option>"},_template:function(t){return'<div id="'+t.id+'" class="'+t.cls+'"><select id="'+t.id+'_select" class="select"/><div class="button"><i class="icon"/></div></div>'}});return{View:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(37)],s=function(t,e){var i=Backbone.View.extend({initialize:function(i){var n=this;this.ftpfile_list=new e.View({name:"file",optional:i.optional,multiple:i.multiple,onchange:function(){i.onchange&&i.onchange(n.value())}}),this.setElement(this.ftpfile_list.$el),t.get({url:galaxy_config.root+"api/remote_files",success:function(t){var e=[];for(var i in t)e.push({value:t[i].path,label:t[i].path});n.ftpfile_list.update(e)}})},value:function(t){return this.ftpfile_list.value(t)}});return{View:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2),i(4),i(22),i(37)],s=function(t,e,i,n){var s=Backbone.Collection.extend({url:galaxy_config.root+"api/libraries?deleted=false"}),a=Backbone.Collection.extend({initialize:function(){var t=this;this.config=new Backbone.Model({library_id:null}),this.config.on("change",function(){t.fetch({reset:!0})})},url:function(){return galaxy_config.root+"api/libraries/"+this.config.get("library_id")+"/contents"}}),o=Backbone.View.extend({initialize:function(t){var i=this;this.libraries=new s,this.datasets=new a,this.options=t,this.library_select=new e.Select.View({onchange:function(t){i.datasets.config.set("library_id",t)}}),this.dataset_list=new n.View({name:"dataset",optional:t.optional,multiple:t.multiple,onchange:function(){i.trigger("change")}}),this.libraries.on("reset",function(){var t=[];i.libraries.each(function(e){t.push({value:e.id,label:e.get("name")})}),i.library_select.update(t)}),this.datasets.on("reset",function(){var t=[],e=i.library_select.text();null!==e&&i.datasets.each(function(e){"file"===e.get("type")&&t.push({value:e.id,label:e.get("name")})}),i.dataset_list.update(t)}),this.on("change",function(){t.onchange&&t.onchange(i.value())}),this.setElement(this._template()),this.$(".library-select").append(this.library_select.$el),this.$el.append(this.dataset_list.$el),this.libraries.fetch({reset:!0,success:function(){i.library_select.trigger("change"),void 0!==i.options.value&&i.value(i.options.value)}})},value:function(t){return this.dataset_list.value(t)},_template:function(){return'<div class="ui-select-library"><div class="library ui-margin-bottom"><span class="library-title">Select Library</span><span class="library-select"/></div></div>'}});return{View:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[i(2)],s=function(t){var e=Backbone.View.extend({optionsDefault:{id:t.uid(),min:null,max:null,step:null,precise:!1,split:1e4},initialize:function(e){var i=this;this.options=t.merge(e,this.optionsDefault),this.setElement(this._template(this.options)),this.useslider=null!==this.options.max&&null!==this.options.min&&this.options.max>this.options.min,null===this.options.step&&(this.options.step=1,this.options.precise&&this.useslider&&(this.options.step=(this.options.max-this.options.min)/this.options.split)),this.useslider?(this.$slider=this.$el.find("#slider"),this.$slider.slider(this.options),this.$slider.on("slide",function(t,e){i.value(e.value)})):this.$el.find(".ui-form-slider-text").css("width","100%"),this.$text=this.$el.find("#text"),void 0!==this.options.value&&this.value(this.options.value),this.$text.on("change",function(){i.value($(this).val())});var n=[];this.$text.on("keyup",function(t){n[t.which]=!1,i.options.onchange&&i.options.onchange($(this).val())}),this.$text.on("keydown",function(t){var e=t.which;n[e]=!0,8==e||9==e||13==e||37==e||39==e||e>=48&&57>=e||e>=96&&105>=e||(190==e||110==e)&&-1==$(this).val().indexOf(".")&&i.options.precise||(189==e||109==e)&&-1==$(this).val().indexOf("-")||n[91]||n[17]||event.preventDefault()})},value:function(t){return void 0!==t&&(null!==t&&""!==t&&(isNaN(t)&&(t=0),null!==this.options.max&&(t=Math.min(t,this.options.max)),null!==this.options.min&&(t=Math.max(t,this.options.min))),this.$slider&&this.$slider.slider("value",t),this.$text.val(t),this.options.onchange&&this.options.onchange(t)),this.$text.val()},_template:function(t){return'<div id="'+t.id+'" class="ui-form-slider"><input id="text" type="text" class="ui-form-slider-text"/><div id="slider" class="ui-form-slider-element"/></div>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s,a;!function(i,o){s=[],n=o,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(this,function(){function t(t,e){function i(){var i=['<div class="loading-indicator">','<div class="loading-indicator-text">','<span class="fa fa-spinner fa-spin fa-lg"></span>','<span class="loading-indicator-message">loading...</span>',"</div>","</div>"].join("\n"),n=$(i).hide().css(e.css||{position:"fixed"}),s=n.children(".loading-indicator-text");return e.cover?(n.css({"z-index":2,top:t.css("top"),bottom:t.css("bottom"),left:t.css("left"),right:t.css("right"),opacity:.5,"background-color":"white","text-align":"center"}),s=n.children(".loading-indicator-text").css({"margin-top":"20px"})):(s=n.children(".loading-indicator-text").css({margin:"12px 0px 0px 10px",opacity:"0.85",color:"grey"}),s.children(".loading-indicator-message").css({margin:"0px 8px 0px 0px","font-style":"italic"})),n}var n=this;return e=jQuery.extend({cover:!1},e||{}),n.show=function(e,s,a){return e=e||"loading...",s=s||"fast",t.parent().find(".loading-indicator").remove(),n.$indicator=i().insertBefore(t),n.message(e),n.$indicator.fadeIn(s,a),n},n.message=function(t){n.$indicator.find("i").text(t)},n.hide=function(t,e){return t=t||"fast",n.$indicator&&n.$indicator.size()?n.$indicator.fadeOut(t,function(){n.$indicator.remove(),e&&e()}):e&&e(),n},n}return t})},,function(t,e,i){var n,s;n=[i(2)],s=function(t){return Backbone.Model.extend({queue:[],process:{},counter:0,initialize:function(){this.on("refresh",function(){if(this.queue.length>0&&this.ready()){var t=this.queue[0];this.queue.splice(0,1),t&&t()}})},execute:function(t){this.queue.push(t),this.trigger("refresh")},register:function(){var e=t.uid();return this.process[e]=!0,this.counter++,console.debug("Deferred:register() - Register "+e),e},done:function(t){this.process[t]&&(delete this.process[t],this.counter--,console.debug("Deferred:done() - Unregister "+t),this.trigger("refresh"))},reset:function(){this.queue=[]},ready:function(){return 0==this.counter}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;n=[],s=function(){function t(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n=[];for(i=0;i<=e.length;i++)n[i]=[i];var s;for(s=0;s<=t.length;s++)n[0][s]=s;for(i=1;i<=e.length;i++)for(s=1;s<=t.length;s++)e.charAt(i-1)===t.charAt(s-1)?n[i][s]=n[i-1][s-1]:n[i][s]=Math.min(n[i-1][s-1]+1,Math.min(n[i][s-1]+1,n[i-1][s]+1));return n[e.length][t.length]}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))}]);
//# sourceMappingURL=history.bundled.js.map
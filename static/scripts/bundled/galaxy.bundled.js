webpackJsonp([6],{0:function(t,e,i){var n=i(91).GalaxyApp;window.GalaxyApp=n,console.debug("galaxy.js, GalaxyApp is now in window"),e=n},1:function(t,e,i){var n,s;n=[],s=function(t){t={};var e=function(i){return e.cacheNonLocalized&&!t.hasOwnProperty(i)&&(e.nonLocalized||(e.nonLocalized={}),e.nonLocalized[i]=navigator.language),t[i]||i};return e.cacheNonLocalized=!1,e}.apply(e,n),!(void 0!==s&&(t.exports=s))},3:function(t,e,i){var n,s;n=[i(5),i(9),i(25),i(1)],s=function(t,e,i,n){function s(e,i){var n=Array.prototype.slice.call(arguments,0),s=n.pop();return n.unshift(s),t.defaults.apply(t,n)}function a(e,i){i=i||"model";var s=t.template(e.join(""));return function(t,e){var a={view:e||{},_l:n};return a[i]=t||{},s(a)}}var o={logger:null,_logNamespace:"?",log:function(){if(this.logger){var t=this.logger.log;return"object"==typeof this.logger.log&&(t=Function.prototype.bind.call(this.logger.log,this.logger)),t.apply(this.logger,arguments)}return void 0}};i(o);var r=e.Model.extend({initialize:function(e){if(this._checkEnabledSessionStorage(),!e.id)throw new Error("SessionStorageModel requires an id in the initial attributes");this.id=e.id;var i=this.isNew()?{}:this._read(this);this.clear({silent:!0}),this.save(t.extend({},this.defaults,i,e),{silent:!0}),this.on("change",function(){this.save()})},_checkEnabledSessionStorage:function(){try{return sessionStorage.length}catch(t){return alert("Please enable cookies in your browser for this Galaxy site"),!1}},sync:function(t,e,i){i.silent||e.trigger("request",e,{},i);var n={};switch(t){case"create":n=this._create(e);break;case"read":n=this._read(e);break;case"update":n=this._update(e);break;case"delete":n=this._delete(e)}return void 0!==n||null!==n?i.success&&i.success():i.error&&i.error(),n},_create:function(t){try{var e=t.toJSON(),i=sessionStorage.setItem(t.id,JSON.stringify(e));return null===i?i:e}catch(n){if(!(n instanceof DOMException&&navigator.userAgent.indexOf("Safari")>-1))throw n}return null},_read:function(t){return JSON.parse(sessionStorage.getItem(t.id))},_update:function(t){return t._create(t)},_delete:function(t){return sessionStorage.removeItem(t.id)},isNew:function(){return!sessionStorage.hasOwnProperty(this.id)},_log:function(){return JSON.stringify(this.toJSON(),null,"  ")},toString:function(){return"SessionStorageModel("+this.id+")"}});!function(){r.prototype=t.omit(r.prototype,"url","urlRoot")}();var l={searchAttributes:[],searchAliases:{},searchAttribute:function(e,i){var n=this.get(e);return i&&void 0!==n&&null!==n?t.isArray(n)?this._searchArrayAttribute(n,i):-1!==n.toString().toLowerCase().indexOf(i.toLowerCase()):!1},_searchArrayAttribute:function(e,i){return i=i.toLowerCase(),t.any(e,function(t){return-1!==t.toString().toLowerCase().indexOf(i.toLowerCase())})},search:function(e){var i=this;return t.filter(this.searchAttributes,function(t){return i.searchAttribute(t,e)})},matches:function(t){var e="=",i=t.split(e);if(i.length>=2){var n=i[0];return n=this.searchAliases[n]||n,this.searchAttribute(n,i[1])}return!!this.search(t).length},matchesAll:function(e){var i=this;return e=e.match(/(".*"|\w*=".*"|\S*)/g).filter(function(t){return!!t}),t.all(e,function(t){return t=t.replace(/"/g,""),i.matches(t)})}},c={hiddenUntilActivated:function(e,i){if(i=i||{},this.HUAVOptions={$elementShown:this.$el,showFn:jQuery.prototype.toggle,showSpeed:"fast"},t.extend(this.HUAVOptions,i||{}),this.HUAVOptions.hasBeenShown=this.HUAVOptions.$elementShown.is(":visible"),this.hidden=this.isHidden(),e){var n=this;e.on("click",function(t){n.toggle(n.HUAVOptions.showSpeed)})}},isHidden:function(){return this.HUAVOptions.$elementShown.is(":hidden")},toggle:function(){return this.hidden?(this.HUAVOptions.hasBeenShown||t.isFunction(this.HUAVOptions.onshowFirstTime)&&(this.HUAVOptions.hasBeenShown=!0,this.HUAVOptions.onshowFirstTime.call(this)),t.isFunction(this.HUAVOptions.onshow)&&(this.HUAVOptions.onshow.call(this),this.trigger("hiddenUntilActivated:shown",this)),this.hidden=!1):(t.isFunction(this.HUAVOptions.onhide)&&(this.HUAVOptions.onhide.call(this),this.trigger("hiddenUntilActivated:hidden",this)),this.hidden=!0),this.HUAVOptions.showFn.apply(this.HUAVOptions.$elementShown,arguments)}},d={initialize:function(t){this.draggable=t.draggable||!1},$dragHandle:function(){return this.$(".title-bar")},toggleDraggable:function(){this.draggable?this.draggableOff():this.draggableOn()},draggableOn:function(){this.draggable=!0,this.dragStartHandler=t.bind(this._dragStartHandler,this),this.dragEndHandler=t.bind(this._dragEndHandler,this);var e=this.$dragHandle().attr("draggable",!0).get(0);e.addEventListener("dragstart",this.dragStartHandler,!1),e.addEventListener("dragend",this.dragEndHandler,!1)},draggableOff:function(){this.draggable=!1;var t=this.$dragHandle().attr("draggable",!1).get(0);t.removeEventListener("dragstart",this.dragStartHandler,!1),t.removeEventListener("dragend",this.dragEndHandler,!1)},_dragStartHandler:function(t){return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",JSON.stringify(this.model.toJSON())),this.trigger("draggable:dragstart",t,this),!1},_dragEndHandler:function(t){return this.trigger("draggable:dragend",t,this),!1}},h={initialize:function(t){this.selectable=t.selectable||!1,this.selected=t.selected||!1},$selector:function(){return this.$(".selector")},_renderSelected:function(){this.$selector().find("span").toggleClass("fa-check-square-o",this.selected).toggleClass("fa-square-o",!this.selected)},toggleSelector:function(){this.$selector().is(":visible")?this.hideSelector():this.showSelector()},showSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!0,this.trigger("selectable",!0,this),this._renderSelected(),this.$selector().show(t)},hideSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!1,this.trigger("selectable",!1,this),this.$selector().hide(t)},toggleSelect:function(t){this.selected?this.deselect(t):this.select(t)},select:function(t){return this.selected||(this.trigger("selected",this,t),this.selected=!0,this._renderSelected()),!1},deselect:function(t){return this.selected&&(this.trigger("de-selected",this,t),this.selected=!1,this._renderSelected()),!1}};return{LoggableMixin:o,SessionStorageModel:r,mixin:s,SearchableModelMixin:l,HiddenUntilActivatedViewMixin:c,DraggableViewMixin:d,SelectableViewMixin:h,wrapTemplate:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},25:function(t,e,i){var n,s;n=[],s=function(){function t(t,e){var i=void 0!==t.prototype?t.prototype:t;return void 0!==e&&(i._logNamespace=e),["debug","info","warn","error","metric"].forEach(function(t){i[t]=function(){return this.logger?this.logger.emit?this.logger.emit(t,this._logNamespace,arguments):this.logger[t]?this.logger[t].apply(this.logger,arguments):void 0:void 0}}),t}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},39:function(t,e,i){var n,s;n=[i(5),i(9),i(3),i(1)],s=function(t,e,i,n){var s=e.Model.extend(i.LoggableMixin).extend({urlRoot:function(){return Galaxy.options.root+"api/users"},defaults:{id:null,username:"("+n("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(t){this.log("User.initialize:",t),this.on("loaded",function(t,e){this.log(this+" has loaded:",t,e)}),this.on("change",function(t,e){this.log(this+" has changed:",t,e.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(t,i){t=t||s.CURRENT_ID_STR,i=i||{};var n=this,a=i.success;return i.success=function(t,e){n.trigger("loaded",t,e),a&&a(t,e)},t===s.CURRENT_ID_STR&&(i.url=this.urlRoot+"/"+s.CURRENT_ID_STR),e.Model.prototype.fetch.call(this,i)},clearSessionStorage:function(){for(var t in sessionStorage)0===t.indexOf("history:")?sessionStorage.removeItem(t):"history-panel"===t&&sessionStorage.removeItem(t)},toString:function(){var t=[this.get("username")];return this.get("id")&&(t.unshift(this.get("id")),t.push(this.get("email"))),"User("+t.join(":")+")"}});s.CURRENT_ID_STR="current",s.getCurrentUserFromApi=function(t){var e=new s;return e.loadFromApi(s.CURRENT_ID_STR,t),e};e.Collection.extend(i.LoggableMixin).extend({model:s,urlRoot:function(){return Galaxy.options.root+"api/users"}});return{User:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))},91:function(t,e,i){var n,s;n=[i(5),i(9),i(39),i(120),i(25),i(1)],s=function(t,e,i,n,s,a){function o(t,e){console.debug("GalaxyApp:",t,e);var i=this;return i._init(t||{},e||{})}return console.debug("app-base id",jQuery.id),jQuery.id||(jQuery.id="app-base"),s(o,"GalaxyApp"),o.prototype._init=function(i,n){var s=this;return t.extend(s,e.Events),s._processOptions(i),s.debug("GalaxyApp.options: ",s.options),s.root=i.root||"/",s._patchGalaxy(window.Galaxy),s._initLogger(i.loggerOptions||{}),s.debug("GalaxyApp.logger: ",s.logger),s._initLocale(),s.debug("GalaxyApp.localize: ",s.localize),s.config=i.config||{},s.debug("GalaxyApp.config: ",s.config),s._initUser(i.user||{}),s.debug("GalaxyApp.user: ",s.user),s._setUpListeners(),s.trigger("ready",s),s},o.prototype.defaultOptions={patchExisting:!0,root:"/"},o.prototype._processOptions=function(t){var e=this,i=e.defaultOptions;e.debug("_processOptions: ",t),e.options={};for(var n in i)i.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i[n]);return e},o.prototype._patchGalaxy=function(t){var e=this;if(e.options.patchExisting&&t){e.debug("found existing Galaxy object:",t);for(var i in t)t.hasOwnProperty(i)&&(e.debug("	 patching in "+i+" to Galaxy"),e[i]=t[i])}},o.prototype._initLogger=function(t){var e=this;return e.debug("_initLogger:",t),e.logger=new n.MetricsLogger(t),e},o.prototype._initLocale=function(t){var e=this;return e.debug("_initLocale:",t),e.localize=a,window._l=e.localize,e},o.prototype._initUser=function(t){var e=this;return e.debug("_initUser:",t),e.user=new i.User(t),e.currUser=e.user,e},o.prototype._setUpListeners=function(){var t=this;return t.lastAjax={},$(document).bind("ajaxSend",function(e,i,n){var s=n.data;try{s=JSON.parse(s)}catch(a){}t.lastAjax={url:location.href.slice(0,-1)+n.url,data:s}}),t},o.prototype.toString=function(){var t=this.user.get("email")||"(anonymous)";return"GalaxyApp("+t+")"},{GalaxyApp:o}}.apply(e,n),!(void 0!==s&&(t.exports=s))},120:function(t,e,i){var n,s;n=[],s=function(){function t(t){t=t||{};var e=this;return e.userId=window.bootstrapped&&window.bootstrapped.user?window.bootstrapped.user.id:null,e.userId=e.userId||t.userId||null,e.consoleLogger=t.consoleLogger||null,e._init(t),e}function e(t){var e=this;return e._init(t||{})}return t.ALL=0,t.DEBUG=10,t.INFO=20,t.WARN=30,t.ERROR=40,t.METRIC=50,t.NONE=100,t.defaultOptions={logLevel:t.NONE,consoleLevel:t.NONE,defaultNamespace:"Galaxy",clientPrefix:"client.",maxCacheSize:3e3,postSize:1e3,addTime:!0,cacheKeyPrefix:"logs-",postUrl:"/api/metrics",delayPostInMs:6e5,getPingData:void 0,onServerResponse:void 0},t.prototype._init=function(e){var i=this;i.options={};for(var n in t.defaultOptions)t.defaultOptions.hasOwnProperty(n)&&(i.options[n]=e.hasOwnProperty(n)?e[n]:t.defaultOptions[n]);return i.options.logLevel=i._parseLevel(i.options.logLevel),i.options.consoleLevel=i._parseLevel(i.options.consoleLevel),i._sending=!1,i._waiting=null,i._postSize=i.options.postSize,i._initCache(),i},t.prototype._initCache=function(){try{this.cache=new e({maxSize:this.options.maxCacheSize,key:this.options.cacheKeyPrefix+this.userId})}catch(i){this._emitToConsole("warn","MetricsLogger",["Could not intitialize logging cache:",i]),this.options.logLevel=t.NONE}},t.prototype._parseLevel=function(e){var i=typeof e;if("number"===i)return e;if("string"===i){var n=e.toUpperCase();if(t.hasOwnProperty(n))return t[n]}throw new Error("Unknown log level: "+e)},t.prototype.emit=function(t,e,i){var n=this;return e=e||n.options.defaultNamespace,t&&i?(t=n._parseLevel(t),t>=n.options.logLevel&&n._addToCache(t,e,i),n.consoleLogger&&t>=n.options.consoleLevel&&n._emitToConsole(t,e,i),n):n},t.prototype._addToCache=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_addToCache:",arguments,this.options.addTime,this.cache.length()]);var n=this;try{var s=n.cache.add(n._buildEntry(t,e,i));s>=n._postSize&&n._postCache()}catch(a){n._emitToConsole("warn","MetricsLogger",["Metrics logger could not stringify logArguments:",e,i]),n._emitToConsole("error","MetricsLogger",[a])}return n},t.prototype._buildEntry=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_buildEntry:",arguments]);var n={level:t,namespace:this.options.clientPrefix+e,args:i};return this.options.addTime&&(n.time=(new Date).toISOString()),n},t.prototype._postCache=function(t){if(t=t||{},this._emitToConsole("info","MetricsLogger",["_postCache",t,this._postSize]),!this.options.postUrl||this._sending)return jQuery.when({});var e=this,i=t.count||e._postSize,n=e.cache.get(i),s=n.length,a="function"==typeof e.options.getPingData?e.options.getPingData():{};return a.metrics=JSON.stringify(n),e._sending=!0,jQuery.post(e.options.postUrl,a).always(function(){e._sending=!1}).fail(function(t,i,n){e._postSize=e.options.maxCacheSize,this.emit("error","MetricsLogger",["_postCache error:",t.readyState,t.status,t.responseJSON||t.responseText])}).done(function(t){"function"==typeof e.options.onServerResponse&&e.options.onServerResponse(t),e.cache.remove(s),e._postSize=e.options.postSize})},t.prototype._delayPost=function(){var t=this;t._waiting=setTimeout(function(){t._waiting=null},t.options.delayPostInMs)},t.prototype._emitToConsole=function(e,i,n){var s=this;if(!s.consoleLogger)return s;var a=Array.prototype.slice.call(n,0);return a.unshift(i),e>=t.METRIC&&"function"==typeof s.consoleLogger.info?s.consoleLogger.info.apply(s.consoleLogger,a):e>=t.ERROR&&"function"==typeof s.consoleLogger.error?s.consoleLogger.error.apply(s.consoleLogger,a):(e>=t.WARN&&"function"==typeof s.consoleLogger.warn?s.consoleLogger.warn.apply(s.consoleLogger,a):e>=t.INFO&&"function"==typeof s.consoleLogger.info?s.consoleLogger.info.apply(s.consoleLogger,a):e>=t.DEBUG&&"function"==typeof s.consoleLogger.debug?s.consoleLogger.debug.apply(s.consoleLogger,a):"function"==typeof s.consoleLogger.log&&s.consoleLogger.log.apply(s.consoleLogger,a),s)},t.prototype.log=function(){this.emit(1,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.debug=function(){this.emit(t.DEBUG,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.info=function(){this.emit(t.INFO,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.warn=function(){this.emit(t.WARN,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.error=function(){this.emit(t.ERROR,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.metric=function(){this.emit(t.METRIC,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},e.defaultOptions={maxSize:5e3},e.prototype._init=function(t){if(!this._hasStorage())throw new Error("LoggingCache needs localStorage");if(!t.key)throw new Error("LoggingCache needs key for localStorage");return this.key=t.key,this._initStorage(),this.maxSize=t.maxSize||e.defaultOptions.maxSize,this},e.prototype._hasStorage=function(){var t="test";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return!1}},e.prototype._initStorage=function(){return null===localStorage.getItem(this.key)?this.empty():this},e.prototype.add=function(t){var e=this,i=e._fetchAndParse(),n=i.length+1-e.maxSize;return n>0&&i.splice(0,n),i.push(t),e._unparseAndStore(i),i.length},e.prototype._fetchAndParse=function(){var t=this;return JSON.parse(localStorage.getItem(t.key))},e.prototype._unparseAndStore=function(t){var e=this;return localStorage.setItem(e.key,JSON.stringify(t))},e.prototype.length=function(){return this._fetchAndParse().length},e.prototype.get=function(t){return this._fetchAndParse().slice(0,t)},e.prototype.remove=function(t){var e=this._fetchAndParse(),i=e.splice(0,t);return this._unparseAndStore(e),i},e.prototype.empty=function(){return localStorage.setItem(this.key,"[]"),this},e.prototype.stringify=function(t){return JSON.stringify(this.get(t))},e.prototype.print=function(){console.log(JSON.stringify(this._fetchAndParse(),null,"  "))},{MetricsLogger:t,LoggingCache:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}});
//# sourceMappingURL=galaxy.bundled.js.map
webpackJsonp([5],{0:function(t,e,i){var n=i(117).GalaxyApp;window.GalaxyApp=n,e=n},65:function(t,e,i){var n,s;n=[i(3),i(2),i(6),i(5)],s=function(t,e,i,n){var s="user",a=e.Model.extend(i.LoggableMixin).extend({_logNamespace:s,urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+n("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(t){this.log("User.initialize:",t),this.on("loaded",function(t,e){this.log(this+" has loaded:",t,e)}),this.on("change",function(t,e){this.log(this+" has changed:",t,e.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(t,i){t=t||a.CURRENT_ID_STR,i=i||{};var n=this,s=i.success;return i.success=function(t,e){n.trigger("loaded",t,e),s&&s(t,e)},t===a.CURRENT_ID_STR&&(i.url=this.urlRoot+"/"+a.CURRENT_ID_STR),e.Model.prototype.fetch.call(this,i)},clearSessionStorage:function(){for(var t in sessionStorage)0===t.indexOf("history:")?sessionStorage.removeItem(t):"history-panel"===t&&sessionStorage.removeItem(t)},toString:function(){var t=[this.get("username")];return this.get("id")&&(t.unshift(this.get("id")),t.push(this.get("email"))),"User("+t.join(":")+")"}});a.CURRENT_ID_STR="current",a.getCurrentUserFromApi=function(t){var e=new a;return e.loadFromApi(a.CURRENT_ID_STR,t),e};e.Collection.extend(i.LoggableMixin).extend({model:a,urlRoot:function(){return Galaxy.root+"api/users"}});return{User:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},117:function(t,e,i){var n,s;(function(a){n=[i(3),i(2),i(6),i(65),i(146),i(111),i(5)],s=function(t,e,i,n,s,o,r){function l(t,e){var i=this;return i._init(t||{},e||{})}o(l,"GalaxyApp");var c="galaxy:debug",h=c+":namespaces",d=!1;try{d="true"==localStorage.getItem(c)}catch(u){console.log(r("localStorage not available for debug flag retrieval"))}return l.prototype._init=function(i,n){var s=this;return t.extend(s,e.Events),d&&(s.logger=console,console.debug("debugging galaxy:","options:",i,"bootstrapped:",n)),s._processOptions(i),s.root=i.root||"/",s._initConfig(i.config||n.config||{}),s._patchGalaxy(window.Galaxy),s._initLogger(s.options.loggerOptions||{}),s.debug("GalaxyApp.options: ",s.options),s.debug("GalaxyApp.config: ",s.config),s.debug("GalaxyApp.logger: ",s.logger),s._initLocale(),s.debug("GalaxyApp.localize: ",s.localize),s.config=i.config||{},s.debug("GalaxyApp.config: ",s.config),s._initUser(i.user||{}),s.debug("GalaxyApp.user: ",s.user),s._setUpListeners(),s.trigger("ready",s),s},l.prototype.defaultOptions={patchExisting:!0,root:"/"},l.prototype._processOptions=function(t){var e=this,i=e.defaultOptions;e.options={};for(var n in i)i.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i[n]);return e},l.prototype._initConfig=function(t){var e=this;return e.config=t,e.config.debug=d||e.config.debug,e},l.prototype._patchGalaxy=function(t){var e=this;if(e.options.patchExisting&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},l.prototype._initLogger=function(t){var e=this;if(e.config.debug){t.consoleLogger=t.consoleLogger||console,t.consoleLevel=t.consoleLevel||s.MetricsLogger.ALL;try{t.consoleNamespaceWhitelist=localStorage.getItem(h).split(",")}catch(n){}}return e.logger=new s.MetricsLogger(t),e.emit={},["log","debug","info","warn","error","metric"].map(function(t){e.emit[t]=function(i){e.logger.emit(t,arguments[0],Array.prototype.slice.call(arguments,1))}}),e.config.debug&&(i.LoggableMixin.logger=e.logger),e},l.prototype._initLocale=function(t){var e=this;return e.debug("_initLocale:",t),e.localize=r,window._l=e.localize,e},l.prototype._initUser=function(t){var e=this;return e.debug("_initUser:",t),e.user=new n.User(t),e.user.logger=e.logger,e},l.prototype._setUpListeners=function(){var t=this;return t.lastAjax={},a(document).bind("ajaxSend",function(e,i,n){var s=n.data;try{s=JSON.parse(s)}catch(a){}t.lastAjax={url:location.href.slice(0,-1)+n.url,data:s}}),t},l.prototype.debugging=function(t){var e=this;try{if(void 0===t)return"true"===localStorage.getItem(c);if(t)return localStorage.setItem(c,!0),!0;localStorage.removeItem(c),e.debuggingNamespaces(null)}catch(i){console.log(r("localStorage not available for debug flag retrieval"))}return!1},l.prototype.debuggingNamespaces=function(t){var e=this;try{if(void 0===t){var i=localStorage.getItem(h);return"string"==typeof i?i.split(","):[]}null===t?localStorage.removeItem(h):localStorage.setItem(h,t);var n=e.debuggingNamespaces();return e.logger&&(e.logger.options.consoleNamespaceWhitelist=n),n}catch(s){console.log(r("localStorage not available for debug namespace retrieval"))}},l.prototype.toString=function(){var t=this.user?this.user.get("email")||"(anonymous)":"uninitialized";return"GalaxyApp("+t+")"},{GalaxyApp:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1))},146:function(t,e,i){var n,s;(function(i){n=[],s=function(){function t(t){t=t||{};var e=this;return e.userId=window.bootstrapped&&window.bootstrapped.user?window.bootstrapped.user.id:null,e.userId=e.userId||t.userId||null,e.consoleLogger=t.consoleLogger||null,e._init(t),e}function e(t){var e=this;return e._init(t||{})}return t.ALL=0,t.LOG=0,t.DEBUG=10,t.INFO=20,t.WARN=30,t.ERROR=40,t.METRIC=50,t.NONE=100,t.defaultOptions={logLevel:t.NONE,consoleLevel:t.NONE,defaultNamespace:"Galaxy",consoleNamespaceWhitelist:null,clientPrefix:"client.",maxCacheSize:3e3,postSize:1e3,addTime:!0,cacheKeyPrefix:"logs-",postUrl:"/api/metrics",delayPostInMs:6e5,getPingData:void 0,onServerResponse:void 0},t.prototype._init=function(e){var i=this;i.options={};for(var n in t.defaultOptions)t.defaultOptions.hasOwnProperty(n)&&(i.options[n]=e.hasOwnProperty(n)?e[n]:t.defaultOptions[n]);return i.options.logLevel=i._parseLevel(i.options.logLevel),i.options.consoleLevel=i._parseLevel(i.options.consoleLevel),i._sending=!1,i._waiting=null,i._postSize=i.options.postSize,i._initCache(),i},t.prototype._initCache=function(){try{this.cache=new e({maxSize:this.options.maxCacheSize,key:this.options.cacheKeyPrefix+this.userId})}catch(i){this._emitToConsole("warn","MetricsLogger",["Could not intitialize logging cache:",i]),this.options.logLevel=t.NONE}},t.prototype._parseLevel=function(e){var i=typeof e;if("number"===i)return e;if("string"===i){var n=e.toUpperCase();if(t.hasOwnProperty(n))return t[n]}throw new Error("Unknown log level: "+e)},t.prototype.emit=function(t,e,i){var n=this;return e=e||n.options.defaultNamespace,t&&i?(t=n._parseLevel(t),t>=n.options.logLevel&&n._addToCache(t,e,i),n.consoleLogger&&t>=n.options.consoleLevel&&n._emitToConsole(t,e,i),n):n},t.prototype._addToCache=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_addToCache:",arguments,this.options.addTime,this.cache.length()]);var n=this;try{var s=n.cache.add(n._buildEntry(t,e,i));s>=n._postSize&&n._postCache()}catch(a){n._emitToConsole("warn","MetricsLogger",["Metrics logger could not stringify logArguments:",e,i]),n._emitToConsole("error","MetricsLogger",[a])}return n},t.prototype._buildEntry=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_buildEntry:",arguments]);var n={level:t,namespace:this.options.clientPrefix+e,args:i};return this.options.addTime&&(n.time=(new Date).toISOString()),n},t.prototype._postCache=function(t){if(t=t||{},this._emitToConsole("info","MetricsLogger",["_postCache",t,this._postSize]),!this.options.postUrl||this._sending)return i.when({});var e=this,n=t.count||e._postSize,s=e.cache.get(n),a=s.length,o="function"==typeof e.options.getPingData?e.options.getPingData():{};return o.metrics=JSON.stringify(s),e._sending=!0,i.post(e.options.postUrl,o).always(function(){e._sending=!1}).fail(function(t,i,n){e._postSize=e.options.maxCacheSize,this.emit("error","MetricsLogger",["_postCache error:",t.readyState,t.status,t.responseJSON||t.responseText])}).done(function(t){"function"==typeof e.options.onServerResponse&&e.options.onServerResponse(t),e.cache.remove(a),e._postSize=e.options.postSize})},t.prototype._delayPost=function(){var t=this;t._waiting=setTimeout(function(){t._waiting=null},t.options.delayPostInMs)},t.prototype._emitToConsole=function(e,i,n){var s=this,a=s.options.consoleNamespaceWhitelist;if(!s.consoleLogger)return s;if(a&&-1===a.indexOf(i))return s;var o=Array.prototype.slice.call(n,0);return o.unshift(i),e>=t.METRIC&&"function"==typeof s.consoleLogger.info?s.consoleLogger.info.apply(s.consoleLogger,o):e>=t.ERROR&&"function"==typeof s.consoleLogger.error?s.consoleLogger.error.apply(s.consoleLogger,o):(e>=t.WARN&&"function"==typeof s.consoleLogger.warn?s.consoleLogger.warn.apply(s.consoleLogger,o):e>=t.INFO&&"function"==typeof s.consoleLogger.info?s.consoleLogger.info.apply(s.consoleLogger,o):e>=t.DEBUG&&"function"==typeof s.consoleLogger.debug?s.consoleLogger.debug.apply(s.consoleLogger,o):"function"==typeof s.consoleLogger.log&&s.consoleLogger.log.apply(s.consoleLogger,o),s)},t.prototype.log=function(){this.emit(1,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.debug=function(){this.emit(t.DEBUG,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.info=function(){this.emit(t.INFO,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.warn=function(){this.emit(t.WARN,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.error=function(){this.emit(t.ERROR,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},t.prototype.metric=function(){this.emit(t.METRIC,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},e.defaultOptions={maxSize:5e3},e.prototype._init=function(t){if(!this._hasStorage())throw new Error("LoggingCache needs localStorage");if(!t.key)throw new Error("LoggingCache needs key for localStorage");return this.key=t.key,this._initStorage(),this.maxSize=t.maxSize||e.defaultOptions.maxSize,this},e.prototype._hasStorage=function(){var t="test";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return!1}},e.prototype._initStorage=function(){return null===localStorage.getItem(this.key)?this.empty():this},e.prototype.add=function(t){var e=this,i=e._fetchAndParse(),n=i.length+1-e.maxSize;return n>0&&i.splice(0,n),i.push(t),e._unparseAndStore(i),i.length},e.prototype._fetchAndParse=function(){var t=this;return JSON.parse(localStorage.getItem(t.key))},e.prototype._unparseAndStore=function(t){var e=this;return localStorage.setItem(e.key,JSON.stringify(t))},e.prototype.length=function(){return this._fetchAndParse().length},e.prototype.get=function(t){return this._fetchAndParse().slice(0,t)},e.prototype.remove=function(t){var e=this._fetchAndParse(),i=e.splice(0,t);return this._unparseAndStore(e),i},e.prototype.empty=function(){return localStorage.setItem(this.key,"[]"),this},e.prototype.stringify=function(t){return JSON.stringify(this.get(t))},e.prototype.print=function(){console.log(JSON.stringify(this._fetchAndParse(),null,"  "))},{MetricsLogger:t,LoggingCache:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1))}});
//# sourceMappingURL=galaxy.bundled.js.map